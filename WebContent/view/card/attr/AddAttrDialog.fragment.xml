<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:l="sap.ui.layout"
    xmlns:u="sap.ui.unified"
    xmlns:f="sap.ui.layout.form"
    xmlns:table="sap.ui.table">
    <Dialog title="Добавить атрибут" stretch="true" class="sapUiContentPadding" busyIndicatorDelay="0">
        <content>
            <IconTabBar busyIndicatorDelay="0" class="sapUiResponsiveContentPadding" id="iconTabBarAttr">
                <items>
                    <IconTabFilter key="firstTab" text="Ручной ввод">
                        <l:Grid linebreakL="true" linebreakM="true" class="sapUiSmallMarginTop">
                            <l:content>
                                <Label text="Название" labelFor="inputName" required="true">
                                    <layoutData>
                                        <l:GridData span="L1 M1"/>
                                    </layoutData>
                                </Label>
                                <Input
                                    id="inputName"
                                    maxLength="200"
                                    liveChange="resetValueState"
                                    value="{mapping>/attrName}"
                                    class="sapUiSmallMarginBottom">
                                    <layoutData>
                                        <l:GridData span="L4 M4"/>
                                    </layoutData>
                                </Input>
                                <Label text="Описание" labelFor="textDescription" required="true">
                                    <layoutData>
                                        <l:GridData span="L1 M1"/>
                                    </layoutData>
                                </Label>
                                <TextArea
                                    id="textDescription"
                                    maxLength="1000"
                                    width="100%"
                                    rows="1"
                                    value="{mapping>/attrDescr}"
                                    liveChange="resetValueState"
                                    class="sapUiSmallMarginBottom">
                                    <layoutData>
                                        <l:GridData span="L6 M6"/>
                                    </layoutData>
                                </TextArea>

                              
								<Label text="Комментарий" labelFor="inputCommment">
                                    <layoutData>
                                        <l:GridData span="L1 M1"/>
                                    </layoutData>
                                </Label>
                                <Input
                                    id="inputCommment"
                                    value="{mapping>/attrComment}"
                                    class="sapUiSmallMarginBottom">
                                    <layoutData>
                                        <l:GridData span="L4 M4"/>
                                    </layoutData>
                                </Input>
                                
                                  <Label text="Ключевой атрибут">
                                    <layoutData>
                                        <l:GridData span="L1 M1"/>
                                    </layoutData>
                                </Label>
                                <CheckBox select="onSelectKeyAttr" selected="{mapping>/isKeyAttr}">
                                    <layoutData>
                                        <l:GridData span="L6 M6"/>
                                    </layoutData>
                                </CheckBox>
                            </l:content>
                        </l:Grid>
                        <Panel >
                            <headerToolbar>
                                <Toolbar height="3rem">
                                    <Title text="Сопоставление атрибутов"/>
                                </Toolbar>
                            </headerToolbar>
                            <content>
                                <f:SimpleForm
                                    id="idFormMappingAttrTO"
                                    maxContainerCols="2"
                                    editable="false"
                                    layout="ResponsiveGridLayout"
                                    labelSpanL="2"
                                    labelSpanM="2"
                                    emptySpanL="0"
                                    emptySpanM="0"
                                    columnsL="2"
                                    columnsM="2">
                                    <f:content>
                                        <Label text="Ключ"/>
                                        <Input
                                            id="keyTO"
                                            placeholder="Выберите поле из списка"
                                            showSuggestion="true"
                                            showValueHelp="true"
                                            value="{mapping>/fieldKey}"
                                            valueHelpOnly="true"
                                            valueHelpRequest="openSelectFieldHelp"/>
                                        <Label text="Краткий текст"/>
                                        <Input
                                            id="shortValueTO"
                                            placeholder="Выберите поле из списка"
                                            showSuggestion="true"
                                            showValueHelp="true"
                                            value="{mapping>/fieldValueShort}"
                                            valueHelpOnly="true"
                                            valueHelpRequest="openSelectFieldHelp"/>
                                        <Label text="Средний текст"/>
                                        <Input
                                            id="midValueTO"
                                            placeholder="Выберите поле из списка"
                                            showValueHelp="true"
                                            value="{mapping>/fieldValueMedium}"
                                            valueHelpOnly="true"
                                            valueHelpRequest="openSelectFieldHelp"/>
                                        <Label text="Полный текст"/>
                                        <Input
                                            id="fullValueTO"
                                            placeholder="Выберите поле из списка"
                                            showValueHelp="true"
                                            value="{mapping>/fieldValueFull}"
                                            valueHelpOnly="true"
                                            valueHelpRequest="openSelectFieldHelp"/>
                                        <Label text="Текст по умолчанию"/>
                                        <Input
                                            id="defaultValueTO"
                                            placeholder="Выберите поле из списка"
                                            showValueHelp="true"
                                            value="{mapping>/fieldDefault}"
                                            valueHelpOnly="true"
                                            valueHelpRequest="openSelectFieldHelp"/>
                                    </f:content>
                                </f:SimpleForm>
                            </content>
                        </Panel>
                        <Panel>
                            <headerToolbar>
                                <Toolbar height="3rem">
                                    <Title text="Справочник"/>
                                </Toolbar>
                            </headerToolbar>
                            <content>
                                <f:SimpleForm
                                    id="idFormMappingAttrDict"
                                    maxContainerCols="2"
                                    editable="false"
                                    layout="ResponsiveGridLayout"
                                    labelSpanL="2"
                                    labelSpanM="2"
                                    emptySpanL="0"
                                    emptySpanM="0"
                                    columnsL="2"
                                    columnsM="2">
                                    <f:content>
                                        <Label text="Справочник"/>
                                        <Input
                                            id="dictInput"
                                            placeholder="Выберите справочник из списка"
                                            showValueHelp="true"
                                            value="{mapping>/dictName}"
                                            valueHelpOnly="true"
                                            valueHelpRequest="openSelectDictHelp">
                                            <!-- <suggestionItems>
                                                <core:Item text="{dicts>name}"/>
                                            </suggestionItems> -->
                                        </Input>

                                        <Label text="Ключ"/>
                                        <Input
                                            id="keyDict"
                                            placeholder="Выберите поле из списка"
                                            enabled="false"
                                            showValueHelp="true"
                                            value="{mapping>/dictFieldKey}"
                                            valueHelpOnly="true"
                                            valueHelpRequest="openSelectFieldDictHelp">
                                            <!-- <suggestionItems>
                                                <core:Item text="{column}"/>
                                            </suggestionItems> -->
                                        </Input>
                                        <Label text="Краткий текст"/>
                                        <Input
                                            id="shortValueDict"
                                            placeholder="Выберите поле из списка"
                                            enabled="false"
                                            showValueHelp="true"
                                            value="{mapping>/dictFieldValueShort}"
                                            valueHelpOnly="true"
                                            valueHelpRequest="openSelectFieldDictHelp">
                                            <!-- <suggestionItems>
                                                <core:Item text="{column}"/>
                                            </suggestionItems> -->
                                        </Input>
                                        <Label text="Средний текст"/>
                                        <Input
                                            id="midValueDict"
                                            placeholder="Выберите поле из списка"
                                            enabled="false"
                                            showValueHelp="true"
                                            value="{mapping>/dictFieldValueMedium}"
                                            valueHelpOnly="true"
                                            valueHelpRequest="openSelectFieldDictHelp">
                                            <!-- <suggestionItems>
                                                <core:Item text="{column}"/>
                                            </suggestionItems> -->
                                        </Input>
                                        <Label text="Полный текст"/>
                                        <Input
                                            id="fullValueDict"
                                            placeholder="Выберите поле из списка"
                                            enabled="false"
                                            showValueHelp="true"
                                            value="{mapping>/dictFieldValueFull}"
                                            valueHelpOnly="true"
                                            valueHelpRequest="openSelectFieldDictHelp">
                                            <!-- <suggestionItems>
                                                <core:Item text="{column}"/>
                                            </suggestionItems> -->
                                        </Input>
                                        <Label text="Текст по умолчанию"/>
                                        <Input
                                            id="defualtValueDict"
                                            placeholder="Выберите поле из списка"
                                            enabled="false"
                                            showSuggestion="true"
                                            showValueHelp="true"
                                            value="{mapping>/dictFieldDefault}"
                                            valueHelpOnly="true"
                                            valueHelpRequest="openSelectFieldDictHelp">
                                            <!-- <suggestionItems>
                                                <core:Item text="{column}"/>
                                            </suggestionItems> -->
                                        </Input>
                                    </f:content>
                                </f:SimpleForm>
                            </content>
                        </Panel>
                    </IconTabFilter>

                    <!-- <IconTabFilter text="Загрузка из файла" key="secondTab" enabled="false">
                        <Link text="Скачать шаблон" href="etc/AttributeUploadTemplate.xlsx"/>
                        <u:FileUploader
                            id="fileAttributeUploader"
                            sendXHR="true"
                            useMultipart="false"
                            buttonOnly="false"
                            fileType="xlsx"
                            buttonText="Обзор ..."
                            change="onFileAttributeUploaderChange"
                            width="100%"
                            sameFilenameAllowed="true"
                            uploadComplete="onUploadAttributeComplete"
                            typeMissmatch="onTypeMissmatch"
                            style="Emphasized"/>
                        <table:Table
                            id="tableReadedAttrsFromFile"
                            selectionMode="Single"
                            selectionBehavior="RowOnly"
                            rows="{readedAttrs>/}"
                            visibleRowCount="10"
                            busyIndicatorDelay="0"
                            visible="false"
                            showNoData="false">
                            <table:toolbar>
                                <Toolbar>
                                    <Text id="uploadCountOK" visible="false"/>
                                    <Text id="uploadCountWarning" visible="false"/>
                                    <Text id="uploadCountError" visible="false"/>
                                </Toolbar>
                            </table:toolbar>
                            <table:columns>
                                <table:Column width="1%" hAlign="Center">
                                    <table:template>
                                        <core:Icon
                                            src="sap-icon://overlay"
                                            color="{
                                                    path: 'readedAttrs>status',
                                                    formatter: '.formatter.getColorForUploadStatus'
                                                }"/>
                                    </table:template>
                                </table:Column>
                                <table:Column>
                                    <Text text="Атрибут"/>
                                    <table:template>
                                        <Text text="{readedAttrs>attrName}"/>
                                    </table:template>
                                </table:Column>
                                <table:Column>
                                    <Text text="Описание"/>
                                    <table:template>
                                        <Text text="{readedAttrs>attrDescr}"/>
                                    </table:template>
                                </table:Column>
                            </table:columns>
                            <table:layoutData>
                                <FlexItemData growFactor="2"/>
                            </table:layoutData>
                        </table:Table>
                    </IconTabFilter> -->
                </items>
            </IconTabBar>
        </content>
        <buttons>
            <Button id="buttonAdd" text="Добавить" type="Accept" press="onAddAttrDialogSave"/>
            <Button text="Закрыть" press="onAddAttrDialogClose"/>
        </buttons>
    </Dialog>
</core:FragmentDefinition>
