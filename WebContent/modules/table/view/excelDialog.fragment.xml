<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:tepaup="tepaup.controls"
    xmlns:l="sap.ui.layout"
    xmlns:t="sap.ui.table"
>
  <Dialog
      title="Параметры выгрузки в Excel"
      class="sapUiPopupWithPadding excelDialog"
      contentWidth="700px"
  >
    <content>
      <VBox>
        <Label text="Выбор измерений для группировки"/>
        <tepaup:MultiComboBoxWithFixTokens
          selectionChange=".bildExcelSchemaTable"
          selectedKeys="{gSettings>/excel/dimensions}"
          items="{excelDimensions>/}">
          <core:Item
            key="{excelDimensions>key}"
            text="{excelDimensions>text}"/>
        </tepaup:MultiComboBoxWithFixTokens>
      </VBox>

      <tepaup:TablePreviewExcel
          class="sapUiSmallMarginTop"
          columns="{excelSchemaTbl>/cols}"
          rows="{excelSchemaTbl>/rows}"
      >
      </tepaup:TablePreviewExcel>

      <VBox class="sapUiSmallMargin">
        <Text
          text="Примечание: при выборе измерений для группировки не отображаются показатели сопоставления/сравнения, выведенные в столбцах."
          maxLines="3"/>
      </VBox>

    </content>

    <beginButton>
      <Button text="Выгрузить" press="handleExcelDialogApply" />
    </beginButton>
    <endButton>
      <Button text="Отменить" press="handleExcelDialogClose" />
    </endButton>

  </Dialog>
</core:FragmentDefinition>
