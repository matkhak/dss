/* SAP CVOM 4.0 Â© <2012-2014> SAP SE. All rights reserved. Build Version 5.7.3, Build context N/A */
if(requirejs&&requirejs.s&&requirejs.s.contexts&&requirejs.s.contexts._){window.__sap_viz_internal_requirejs_nextTick__=requirejs.s.contexts._.nextTick;requirejs.s.contexts._.nextTick=function(f){f();};}define('sap/viz/controls/Version',[],function(){var V={};V.VERSION='5.7.3';return V;});define('sap/viz/controls/common/config/GlobalConfig',[],function(){function f(n,s){if(n.length===0){return;}if(n.length===1){return s[n[0]];}var p=n.shift();if(s[p]!=null){return f(n,s[p]);}return;}var m=f("sap/viz/controls/common/config/GlobalConfig".split("/"),this);if(m){return m;}var G={};G.DEFAULT_UICONFIG_TYPE_BUILDER='uiconfig-builder';G.DEFAULT_UICONFIG_TYPE_CHART='uiconfig-chart';G.DEFAULT_UICONFIG_TYPE_FEEDING='uiconfig-feeding';G.DEFAULT_UICONFIG_TYPE_FRAME='uiconfig-frame';G.DEFAULT_UICONFIG_TYPE_SWITCHBAR='uiconfig-switchbar';G.DEFAULT_UICONFIG_TYPE_FILTERBAR0='uiconfig-filterbar0';G.DEFAULT_UICONFIG_TYPE_FILTERBAR='uiconfig-filterbar';G.DEFAULT_UICONFIG_TYPE_CONTEXTMENU='uiconfig-contextmenu';G.DEFAULT_UICONFIG_TYPE_CUSTOMBUTTON='uiconfig-custombutton';G.DEFAULT_UICONFIG_TYPE_ANNOTATION='uiconfig-annotation';G.DEFAULT_UICONFIG_TYPE_ANNOTATIONCONTROL='uiconfig-annotationcontrol';G.DEFAULT_UICONFIG_TYPE_MAPBUILDER='uiconfig-mapbuilder';G.DEFAULT_UICONFIG_TYPE_PROPERTYEDITOR='uiconfig-propertyeditor';var _="../src";var a=false;var b={};var d=function(){if(sap&&sap.bi&&sap.bi.framework&&sap.bi.framework.getServiceMetadata!==undefined){var s;try{s=sap.bi.framework.getServiceMetadata("sap.viz.controls.common.config");}catch(e){}if(s&&s.customProperties.defaultAssetsRoot){return s.framework.bundleUrl+"/"+s.customProperties.defaultAssetsRoot;}}return undefined;};G.registerUIConfig=function(i,u){if(i!=null){b[i]=u;}};G.defaultUIConfig=function(t){var u={};if(t!=null&&b[t]!=null&&b[t].instance){return b[t].instance();}for(var i in b){if(i&&b[i]&&b[i].instance){u[i]=b[i].instance();}}return u;};G.defaultAssetsRoot=function(p){if(arguments.length>0){_=p;a=true;G._setResourcePath();}else{if(a){return _;}var c=d();if(c){return c;}return _;}};G._setResourcePath=function(){var p=[G.defaultAssetsRoot()+"/locale/"];var c=sap.viz.api.env.Resource.path("sap.viz.api.env.Language.loadPaths");var n=c?p.concat(c):p;sap.viz.api.env.Resource.path("sap.viz.api.env.Language.loadPaths",n);};return G;});define('sap/viz/controls/common/constants/ChartConst',[],function(){var C={};C.TYPE_COLUMN="info/column";C.TYPE_STACKED_COLUMN="info/stacked_column";C.TYPE_DUAL_COLUMN="info/dual_column";C.TYPE_3D_COLUMN="viz/3d_column";C.TYPE_LINE="info/line";C.TYPE_AREA="viz/area";C.TYPE_COMBINATION="info/combination";C.TYPE_DUAL_LINE="info/dual_line";C.TYPE_DUAL_COMBINATION="viz/dual_combination";C.TYPE_PIE="info/pie";C.TYPE_DONUT="info/donut";C.TYPE_PIE_WITH_DEPTH="viz/pie_with_depth";C.TYPE_GEO_BUBBLE="viz/geobubble";C.TYPE_GEO_CHOROPLETH="viz/choropleth";C.TYPE_GEO_PIE="viz/geopie";C.TYPE_GEO_MAP='viz/geomap';C.TYPE_SCATTER="info/scatter";C.TYPE_BUBBLE="info/bubble";C.TYPE_SCATTER_MATRIX="viz/scatter_matrix";C.TYPE_HEATMAP="viz/heatmap";C.TYPE_TREEMAP="info/treemap";C.TYPE_TABLE="viz/ext/table";C.TYPE_CROSSTAB="viz/ext/crosstab";C.TYPE_RADAR="viz/radar";C.TYPE_BOXPLOT="viz/boxplot";C.TYPE_WATERFALL="viz/waterfall";C.TYPE_TAG_CLOUD="viz/tagcloud";C.TYPE_TREE="viz/tree";C.TYPE_NETWORK="viz/network";C.TYPE_FUNNEL='viz/ext/pa/funnel';C.TYPE_PC='viz/ext/pa/pc';C.TYPE_NUMBER='viz/number';C.DIRECTION_HORIZONTAL="horizontal";C.DIRECTION_VERTICAL="vertical";C.STACKING_FULL="full";C.STACKING_NORMAL="normal";C.TYPE_BAR="info/bar";C.TYPE_STACKED_BAR="info/stacked_bar";C.TYPE_100_STACKED_COLUMN="info/100_stacked_column";C.TYPE_100_STACKED_BAR="info/100_stacked_bar";C.TYPE_DUAL_BAR="info/dual_bar";C.TYPE_3D_BAR="viz/3d_bar";C.TYPE_HORIZONTAL_LINE="info/horizontal_line";C.TYPE_HORIZONTAL_AREA="viz/horizontal_area";C.TYPE_100_AREA="viz/100_area";C.TYPE_100_HORIZONTAL_AREA="viz/100_horizontal_area";C.TYPE_HORIZONTAL_COMBINATION="info/horizontal_combination";C.TYPE_DUAL_HORIZONTAL_LINE="info/dual_horizontal_line";C.TYPE_DUAL_HORIZONTAL_COMBINATION="viz/dual_horizontal_combination";C.TYPE_HORIZONTAL_BOXPLOT="viz/horizontal_boxplot";C.TYPE_HORIZONTAL_WATERFALL="viz/horizontal_waterfall";C.TYPE_MEKKO="info/mekko";C.TYPE_100_MEKKO="info/100_mekko";C.TYPE_HORIZONTAL_MEKKO="info/horizontal_mekko";C.TYPE_100_HORIZONTAL_MEKKO="info/100_horizontal_mekko";C.TYPE_TRELLIS_BAR="info/trellis_bar";C.TYPE_TRELLIS_LINE="info/trellis_line";C.TYPE_TRELLIS_HORIZONTAL_LINE="info/trellis_horizontal_line";C.TYPE_TRELLIS_COLUMN="info/trellis_column";C.TYPE_TRELLIS_DUAL_COLUMN="info/trellis_dual_column";C.TYPE_TRELLIS_DUAL_LINE="info/trellis_dual_line";C.TYPE_TRELLIS_DUAL_HORIZONTAL_LINE="info/trellis_dual_horizontal_line";C.TYPE_TRELLIS_DUAL_BAR="info/trellis_dual_bar";C.TYPE_TRELLIS_SCATTER="info/trellis_scatter";C.TYPE_TRELLIS_BUBBLE="info/trellis_bubble";C.TYPE_TRELLIS_100_STACKED_COLUMN="info/trellis_100_stacked_column";C.TYPE_TRELLIS_STACKED_COLUMN="info/trellis_stacked_column";C.TYPE_TRELLIS_STACKED_BAR="info/trellis_stacked_bar";C.TYPE_TRELLIS_100_STACKED_BAR="info/trellis_100_stacked_bar";C.TYPE_TRELLIS_PIE="info/trellis_pie";C.TYPE_TRELLIS_DONUT="info/trellis_donut";C.TYPE_TRELLIS_CHOROPLETH="viz/multi_choropleth";C.TYPE_TRELLIS_PIE_WITH_DEPTH="viz/multi_pie_with_depth";C.TYPE_TRELLIS_GEO_BUBBLE="viz/multi_geobubble";C.TYPE_TRELLIS_AREA="viz/multi_area";C.TYPE_TRELLIS_HORIZONTAL_AREA="viz/multi_horizontal_area";C.TYPE_TRELLIS_100_AREA="viz/multi_100_area";C.TYPE_TRELLIS_100_HORIZONTAL_AREA="viz/multi_100_horizontal_area";C.FEEDING_PRIMARY_VALUES="primaryValues";C.FEEDING_SECONDARY_VALUES="secondaryValues";C.FEEDING_AXIS_LABELS="axisLabels";C.MEASURE_NAMES_DIMENSION="measureNamesDimension";C.MEASURE_VALUES_GROUP="measureValuesGroup";C.ANALYSIS_AXIS="analysisAxis";C.VALUE_AXIS="valueAxis";C.SECOND_VALUE_AXIS="valueAxis2";C.CATEGORY_AXIS="categoryAxis";C.SIZE="size";C.INVALID="Invalid";C.AXIS_XAXIS="xAxis";C.AXIS_XAXIS1="xAxis1";C.AXIS_XAXIS2="xAxis2";C.AXIS_YAXIS="yAxis";C.AXIS_YAXIS1="yAxis1";C.AXIS_YAXIS2="yAxis2";C.COLOR="color";C.DATA_FRAME="dataFrame";C.TEMPLATE_INCOMPLETE="incomplete_ghost";C.TEMPLATE_DEFAULT="default";C.TEMPLATE_EMPTY="empty_ghost";C.PLAY_FIELD="playField";C.SHAPE="shape";C.TITLE="title";C.KEY_COUNT="__keysCount";return C;});define('sap/viz/controls/common/constants/DatasetTypeConst',[],function(){var D={};D.FLAT_TABLE='FlatTableDataset';D.CROSS_TABLE='CrossTableDataset';D.RAW='RawDataset';D.ARRAY_FLAT_TABLE='ArrayOfFlatTableDataset';return D;});define('sap/viz/controls/common/constants/FilterEventConst',[],function(){var F={};F.REQUEST_ADD_FILTER="requestAddFilter";F.REQUEST_REMOVE_FILTER="requestRemoveFilter";F.REQUEST_EDIT_FILTER="requestEditFilter";F.SIZE_CHANGED="sizeChanged";F.CLEAR_FILTERS="clearFilters";return F;});define('sap/viz/controls/common/utils/Utils',[],function(){var u={};var _=0;var h=Object.prototype.hasOwnProperty;u.genUID=function(){if(!_){_=0;}return"vcgen_"+(_++);};var c={'[object Boolean]':'boolean','[object Number]':'number','[object String]':'string','[object Function]':'function','[object Array]':'array','[object Date]':'date','[object RegExp]':'regexp','[object Object]':'object'};u.encodingToken="_encoded_";u.applyObjectProperty=function(o,p,a){try{if(u.isFunction(o[p])){o[p](a);}else{o[p]=a;}}catch(e){}};u.applyProperties=function(a,p){if(p){var l=p.length;for(var i=0;i<l;i++){var b=p[i];if(b){u.applyObjectProperty(a,b.name,b.value);}}}};u.getObjectProperty=function(o,p){try{if(u.isFunction(o[p])){return o[p]();}else if(o.hasOwnProperty(p)){return o[p];}}catch(e){}};u.type=function(o){return o==null?String(o):c[Object.prototype.toString.call(o)]||"object";};u.isObject=function(o){var t=typeof o;return t==='function'||t==='object'&&!!o;};u.isFunction=function(o){return u.type(o)==="function";};u.isBoolean=function(o){return u.type(o)==="boolean";};u.isString=function(o){return u.type(o)==="string";};u.isArray=function(o){return u.type(o)==="array";};u.isNumber=function(o){return u.type(o)==="number";};u.isObject=function(o){return u.type(o)==="object";};u.isPlainObject=function(o){if(!o||u.type(o)!=="object"||o.nodeType||(o&&typeof o==="object"&&"setInterval"in o)){return false;}if(o.constructor&&!h.call(o,"constructor")&&!h.call(o.constructor.prototype,"isPrototypeOf")){return false;}var k;for(k in o){}return k===undefined||h.call(o,k);},u.isEmptyObject=function(o){for(var n in o){if(o.hasOwnProperty(n)){return false;}}return u.isPlainObject(o);},u.isRegExp=function(o){return u.type(o)==="regexp";};u.sortArrayOn=function(e,p,f){if(u.isArray(e)&&u.isString(p)){e.sort(function(a,b){return f?(a[p]<b[p])-(a[p]>b[p]):(a[p]>b[p])-(a[p]<b[p]);});}};u.noop=function(){};u.delay=function(a,w){return setTimeout(function(){return a.apply(null);},w);};u.defer=function(a){return u.delay.call(null,a,1);};u.getEventPosition=function(e){var p=null;var a=null;if(e.originalEvent&&e.originalEvent.targetTouches&&e.originalEvent.targetTouches.length!==0){p=e.originalEvent.targetTouches[0].pageX;a=e.originalEvent.targetTouches[0].pageY;}else{p=e.pageX;a=e.pageY;}var b={};b.pageX=p;b.pageY=a;return b;};function d(a){if(a===null||typeof(a)!=='object'){return a;}var o=u.isArray(a)?[]:{};for(var i in a){if(a.hasOwnProperty(i)){o[i]=d(a[i]);}}return o;}u.clone=d;u.toJSON=function(a,p){if(u.isArray(a)){var r=[];for(var i=0;i<a.length;i++){r.push(p.call(null,a[i]));}return r;}else if(a){return p.call(null,a);}else{return null;}};u.fromJSON=function(j,p){if(u.isArray(j)){var r=[];for(var i=0;i<j.length;i++){r.push(p.call(null,j[i]));}return r;}else if(j){return p.call(null,j);}else{return undefined;}};u.updateJSON=function(s,n){var r=u.clone(s);r=r||{};var a=function(p){var e=u.getPropValue(n,p);if(e){u.setPropValue(r,p,e);}};a("plotArea.window.start.categoryAxis");a("plotArea.window.end.categoryAxis");var b=function(e,f){for(var p in f){if(f.hasOwnProperty(p)){var i=f[p];if(i!==undefined){if(typeof(i)!=="object"||i instanceof(Array)||i===null){e[p]=i;}else{var j=e[p];if(!j){if(i===null){j=i;}else{j=e[p]={};}}else if(!u.isObject(j)){j=e[p]={};}b(j,i);}}}}};b(r,n);return r;};u.substitute=function(s,r){if(!s){return'';}for(var i=1;i<arguments.length;i++){s=s.replace(new RegExp("\\{"+(i-1)+"\\}","g"),arguments[i]);}return s;};u.invert=function(o){var r={};for(var k in o){var v=o[k];r[v]=k;}return r;};u.encode=function(i,s){if(i.indexOf(u.encodingToken)>-1){return i;}else{var e=i+u.encodingToken+s;return e;}};u.decode=function(i){var r=i.split(u.encodingToken);return r;};u.deepEqual=function(s,t){if(typeof s==='object'&&typeof t==='object'&&u.isExist(s)&&u.isExist(t)){var k=null;for(k in s){if(s.hasOwnProperty(k)){if(!t.hasOwnProperty(k)){return false;}else if(!u.deepEqual(s[k],t[k])){return false;}}}for(k in t){if(t.hasOwnProperty(k)){if(!s.hasOwnProperty(k)){return false;}}}return true;}else{return s===t;}};u.hasCommonKeyValue=function(s,t){if(typeof s==='object'&&typeof t==='object'){var k=null;for(k in s){if(s.hasOwnProperty(k)){if(t.hasOwnProperty(k)&&u.deepEqual(s[k],t[k])){return true;}}}return false;}};u.isExist=function(o){if((typeof(o)==='undefined')||(o===null)){return false;}return true;};var g=u.genGetterSetter=function(n){return function(v){if(arguments.length>0){this[n]=v;return this;}else{return this[n];}};};u.genGetterSetters=function(p,n){n.forEach(function(e){p[e.substring(1)]=g(e);});};u.currying=function(f){var a=Array.prototype.slice.call(arguments,1);return function(){return f.apply(this,a.concat(Array.prototype.slice.call(arguments)));};};u.getPropValue=function(o,p){if(o==null){return undefined;}var a=p.split('.'),l=a.pop(),i,b,e=o;for(i=0,b=a.length;i<b;i++){e=e[a[i]];if(e==null){return undefined;}}return e[l];};u.setPropValue=function(o,p,v){var a=p.split('.'),l=a.pop(),b,t,i,e,f=o;for(i=0,e=a.length;i<e;i++){b=a[i];t=typeof f[b];if(t!=="object"&&t!=="function"){f[b]={};}f=f[b];}f[l]=v;return o;};return u;});define('sap/viz/controls/common/managers/LangManager',[],function(){var L=function(){this.__className="sap.viz.controls.common.managers.LangManager";};L.get=function(n){return sap.viz.extapi.env.Language.getResourceString(n);};return L;});define('sap/viz/controls/common/feeds/AnalyticalType',[],function(){var A={};A.UNIVERSAL='universal';A.MEASURE='measure';A.DIMENSION='dimension';A.HIERARCHY='hierarchy';A.MND='mnd';A.compatible=function(h,c){if(h===A.UNIVERSAL){return true;}else if(h===A.DIMENSION){return c===A.DIMENSION||c===A.HIERARCHY||c===A.MND;}else{return h===c;}};return A;});define('sap/viz/controls/common/utils/JsonUtil',[],function(){var J={};J.AnalysisObjectType='sap.viz.controls.common.feeds.AnalysisObject';J.HierarchyLevelObjectType='sap.viz.controls.common.feeds.HierarchyLevelObject';J.MenuItemType='sap.viz.controls.common.views.menu.MenuItem';J.MenuGroupType='sap.viz.controls.common.views.menu.MenuGroup';J._FuncMap={};J.register=function(t,f,a){var o={fromFunc:f,toFunc:a};J._FuncMap[t]=o;};J.fromJSON=function(t,j){if(J._FuncMap[t]&&J._FuncMap[t].fromFunc){return J._FuncMap[t].fromFunc(j);}else{return null;}};J.toJSON=function(t,o){if(J._FuncMap[t]&&J._FuncMap[t].toFunc){return J._FuncMap[t].toFunc(o);}else{return{};}};return J;});define('sap/viz/controls/common/views/menu/MenuGroup',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/JsonUtil'],function(u,J){var M=function(m){this.__className="sap.viz.controls.common.views.menu.MenuGroup";this._menuItems=m;};M.prototype.menuItems=function(){return this._menuItems;};M.prototype.selectedItem=function(){for(var i=0;i<this._menuItems.length;i++){if(this._menuItems[i].selected()){return this._menuItems[i];}}return null;};M.prototype.equal=function(m){if(m==null){return false;}var a=this.menuItems()||[];var b=m.menuItems()||[];if(a.length!==b.length){return false;}for(var i=0;i<a.length;i++){var c=a[i];var d=b[i];if(!(c==null&&d==null)){if(c==null){return false;}if(!c.equal(d)){return false;}}}return true;};M.toJSON=function(i){return u.toJSON(i,function(i){return{'menuItems':J.toJSON(J.MenuItemType,i._menuItems)};});};M.fromJSON=function(j){return u.fromJSON(j,function(j){return new M(J.fromJSON(J.MenuItemType,j.menuItems));});};J.register(J.MenuGroupType,M.fromJSON,M.toJSON);return M;});define('sap/viz/controls/common/feeds/HierarchyLevelObject',['require','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/JsonUtil'],function(r,u,J){var a=r||a;var H=function(i,n,b){this.__className="sap.viz.controls.common.feeds.HierarchyLevelObject";this._id=i;this._name=n;this._analysis=b;this._selected=false;};H.prototype.id=function(){return this._id;};H.prototype.name=function(v){if(arguments.length>0){this._name=v;return this;}else{return this._name;}};H.prototype.analysis=function(){return this._analysis;};H.prototype.selected=function(v){if(arguments.length>0){this._selected=v;return this;}else{return this._selected;}};H.prototype.clone=function(){var b=null;if(this._analysis){b=this._analysis.clone();}var c=new H(this._id,this._name,b);c.selected(this._selected);return c;};H.toJSON=function(i){return u.toJSON(i,function(i){return{'id':i._id,'name':i._name,'analysis':J.toJSON(J.AnalysisObjectType,i._analysis),'selected':i._selected};});};H.fromJSON=function(j){return u.fromJSON(j,function(j){var i=new H(j.id,j.name,J.fromJSON(J.AnalysisObjectType,j.analysis));i.selected(j.selected);return i;});};J.register(J.HierarchyLevelObjectType,H.fromJSON,H.toJSON);return H;});define('sap/viz/controls/common/feeds/AnalysisObject',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/views/menu/MenuGroup','sap/viz/controls/common/utils/JsonUtil','sap/viz/controls/common/feeds/HierarchyLevelObject'],function(u,L,A,M,J){var a=function(i,n,t,d,b,c,e){this.__className="sap.viz.controls.common.feeds.AnalysisObject";this._id=i;this._name=n;this._type=t;this._dataType=d;this._aggregationType=b;this._aggregationTarget=c;this._actions=null;this._hierarchyLevels=null;this._customData=e;};a.genMND=function(){return new a('mnd','',A.MND,'string');};u.genGetterSetters(a.prototype,["_id","_name","_actions","_aggregationType","_aggregationTarget","_hierarchyLevels","_customData"]);a.prototype.type=function(){return this._type;};a.prototype.dataType=function(){return this._dataType;};a.prototype.selectedHierarchyLevel=function(){if(!this._hierarchyLevels){return;}for(var i=0;i<this._hierarchyLevels.length;i++){if(this._hierarchyLevels[i].selected()){return this._hierarchyLevels[i];}}return;};a.prototype.selectedHierarchyLevelID=function(b){if(!this._hierarchyLevels){return this;}for(var i=0;i<this._hierarchyLevels.length;i++){var l=this._hierarchyLevels[i];l.selected(l.id()===b);}return this;};a.prototype.clone=function(){var c=a.fromJSON(a.toJSON(this));return c;};a.prototype.equal=function(b,o){var i;if(this.type()===A.MND&&b.type()===A.MND){return true;}if(this.type()!==b.type()||this.name()!==b.name()){return false;}if(this.type()===A.HIERARCHY&&b.type()===A.HIERARCHY){if(this.selectedHierarchyLevel().id()!==b.selectedHierarchyLevel().id()){return false;}var l=this.hierarchyLevels();var c=b.hierarchyLevels();if(!l||!c||l.length!==c.length){return false;}for(i=0;i<l.length;i++){var d=l[i];var e=c[i];if(d.id()!==e.id()){return false;}if(d.name()!==e.name()){return false;}}}if((!o||o.ignoreActions!==true)&&(this.actions()!==undefined||b.actions()!==undefined)){var f=this.actions()||[];var g=b.actions()||[];if(f.length!==g.length){return false;}for(i=0;i<f.length;i++){var m=f[i];var h=g[i];if(!(m==null&&h==null)){if(m==null){return false;}if(!m.equal(h)){return false;}}}}return true;};a.toJSON=function(i){return u.toJSON(i,function(i){return{'id':i._id,'name':i._name,'type':i._type,'dataType':i._dataType,'actions':M.toJSON(i._actions),'hierarchyLevels':J.toJSON(J.HierarchyLevelObjectType,i._hierarchyLevels),'aggregationType':i._aggregationType,'aggregationTarget':i._aggregationTarget,'customData':i._customData};});};a.fromJSON=function(j){return u.fromJSON(j,function(j){var i=new a(j.id,j.name,j.type,j.dataType,j.aggregationType,j.aggregationTarget,j.customData);if(j.actions){i.actions(M.fromJSON(j.actions));}if(j.hierarchyLevels){i.hierarchyLevels(J.fromJSON(J.HierarchyLevelObjectType,j.hierarchyLevels));}return i;});};J.register(J.AnalysisObjectType,a.fromJSON,a.toJSON);return a;});define('sap/viz/controls/common/feeds/FeedItemType',[],function(){var F=function(){this.__className="sap.viz.controls.common.feeds.FeedItemType";};F.MEASURE='Measure';F.DIMENSION='Dimension';F.SUBTOTAL='Subtotal';F.GEOGRAPHY='Geography';F.ROWS='rows';F.ROW_SUBTOTALS='r_subtotals';F.COLUMNS='columns';F.COLUMNS_SUBTOTALS='c_subtotals';F.CALCULATION='calculation';F.LEVEL='level';F.HIERARCHY='hierarchy';return F;});define('sap/viz/controls/common/feeds/FeedItem',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/AnalysisObject'],function(u,F,A){var a=function(i,t,v){this.__className="sap.viz.controls.common.feeds.FeedItem";this._id=i;if(t==='dimension'){t=F.DIMENSION;}else if(t==='measure'){t=F.MEASURE;}this._type=t;this._values=v;};a.prototype.type=function(){return this._type;};a.prototype.id=function(){return this._id;};a.prototype.values=function(v){if(arguments.length>0){this._values=v;return this;}else{return this._values;}};a.prototype.hasValues=function(){return(this._values&&this._values.length>0);};a.prototype.clone=function(){return a.fromJSON(a.toJSON(this));};a.toJSON=function(i){return u.toJSON(i,function(i){return{'id':i._id,'type':i._type,'values':A.toJSON(i._values)};});};a.fromJSON=function(j){return u.fromJSON(j,function(j){return new a(j.id,j.type,A.fromJSON(j.values));});};return a;});define('sap/viz/controls/common/feeds/SubtotalItemType',['sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/AnalyticalType'],function(L,F,A){var S=function(){this.__className="sap.viz.controls.common.feeds.SubtotalItemType";};S.action='addSubTotal';S.TOTAL='default';S.SUM='sum';S.MIN='min';S.MAX='max';S.COUNT='count';S.AVG='average';S.getAggregationType=function(t){if(t.indexOf(S.TOTAL)!==-1){return S.TOTAL;}else if(t.indexOf(S.SUM)!==-1){return S.SUM;}else if(t.indexOf(S.MIN)!==-1){return S.MIN;}else if(t.indexOf(S.MAX)!==-1){return S.MAX;}else if(t.indexOf(S.COUNT)!==-1){return S.COUNT;}else if(t.indexOf(S.AVG)!==-1){return S.AVG;}return null;};S.getSubTotalsAggregationDisplayType=function(a){switch(a){case S.SUM:return L.get('VIZ_COMMON_SUM_OF');case S.MIN:return L.get('VIZ_COMMON_MIN_OF');case S.MAX:return L.get('VIZ_COMMON_MAX_OF');case S.COUNT:return L.get('VIZ_COMMON_COUNT_OF');case S.AVG:return L.get('VIZ_COMMON_AVERAGE_OF');case S.TOTAL:return L.get('VIZ_COMMON_TOTAL_OF');default:return" ";}};S.createSubTotalsName=function(a,b){if(arguments.length<2){return;}return S.getSubTotalsAggregationDisplayType(a)+" "+b;};S.sanitizeAnalysisObjects=function(a){for(var i=0;i<a.length;i++){var t=a[i].name();if(t.indexOf(S.getSubTotalsAggregationDisplayType(S.TOTAL))!==-1){S.removeSubtotalItemTokenFromName(S.getSubTotalsAggregationDisplayType(S.TOTAL),a[i]);}else if(t.indexOf(S.getSubTotalsAggregationDisplayType(S.SUM))!==-1){S.removeSubtotalItemTokenFromName(S.getSubTotalsAggregationDisplayType(S.SUM),a[i]);}else if(t.indexOf(S.getSubTotalsAggregationDisplayType(S.MIN))!==-1){S.removeSubtotalItemTokenFromName(S.getSubTotalsAggregationDisplayType(S.MIN),a[i]);}else if(t.indexOf(S.getSubTotalsAggregationDisplayType(S.MAX))!==-1){S.removeSubtotalItemTokenFromName(S.getSubTotalsAggregationDisplayType(S.MAX),a[i]);}else if(t.indexOf(S.getSubTotalsAggregationDisplayType(S.COUNT))!==-1){S.removeSubtotalItemTokenFromName(S.getSubTotalsAggregationDisplayType(S.COUNT),a[i]);}else if(t.indexOf(S.getSubTotalsAggregationDisplayType(S.AVG))!==-1){S.removeSubtotalItemTokenFromName(S.getSubTotalsAggregationDisplayType(S.AVG),a[i]);}}return a;};S.removeSubtotalItemTokenFromName=function(t,a){var b=t.length;var c=a.name().substr(b+1);a.name(c);};S.localizeSubtotalAnalysesNames=function(f){if(!f){return;}var c={};var s=[];for(var i=0;i<f.length;i++){if(f[i].type()!==F.SUBTOTAL){f[i].values().forEach(function(k){if(k.type()===A.HIERARCHY){var l=k.hierarchyLevels();for(var j=0;j<l.length;j++){c[l[j].id()]=l[j].name();}}else{c[k.id()]=k.name();}});}else{s=f[i].values();}}for(var a=0;a<s.length;a++){var d=s[a];if(d.type()===A.HIERARCHY){var e=d.hierarchyLevels();var g=d.aggregationType();for(var b=0;b<e.length;b++){var h=e[b];h.name(S.createSubTotalsName(g,c[h.id()]));}}else if(d.aggregationTarget()){d.name(S.createSubTotalsName(d.aggregationType(),c[d.aggregationTarget()]));}}return f;};return S;});define('sap/viz/controls/common/utils/OOUtil',[],function(){var O={};O.extend=function(s,a){var b=s.prototype;s.superclass=a.prototype;var F=function(){};F.prototype=a.prototype;s.prototype=new F();for(var p in b){if(b.hasOwnProperty(p)){s.prototype[p]=b[p];}}s.prototype.constructor=s;if(a.prototype.constructor==Object.prototype.constructor){a.prototype.constructor=a;}return s;};return O;});define('sap/viz/controls/common/filter/AbstractFilter',[],function(){var A=function(t,o,a){this.__className="sap.viz.controls.common.filter.AbstractFilter";this.filterType=t;this.filteredObjectId=o;this.filteredObjectName=a;this.isReverse=true;this._isGlobalFilter=false;};A.VALUE_TYPE="VALUE_FILTER_TYPE";A.NUMERIC_RANGE_TYPE="NUMERIC_RANGE_TYPE";A.DATE_RANGE_TYPE="DATE_RANGE_TYPE";A.prototype.getType=function(){return this.filterType;};A.prototype.getFilteredObjectId=function(){return this.filteredObjectId;};A.prototype.getFilteredObjectName=function(){return this.filteredObjectName;};A.prototype.setReverseSelection=function(r){this.isReverse=r;};A.prototype.isReverseSelection=function(){return this.isReverse;};A.prototype.isEmpty=function(){return false;};A.prototype.toJSON=function(){var j={};j.filteredObjectId=this.filteredObjectId;j.filteredObjectName=this.filteredObjectName;j.filterType=this.filterType;j.isReverse=this.isReverse;j.isGlobalFilter=this._isGlobalFilter;return j;};A.prototype.analysisObjectId=function(){return this.getFilteredObjectId();};A.prototype.id=function(){return this.getFilteredObjectId();};A.prototype.filterName=function(){return this.getFilteredObjectName();};A.prototype.isExcluded=function(i){if(arguments.length>0){this.isReverse=!i;}else{return!this.isReverse;}};A.prototype.isGlobalFilter=function(i){if(arguments.length>0){this._isGlobalFilter=i;return this;}else{return this._isGlobalFilter;}};A.prototype.filterTitle=function(){return this.filteredObjectName;};A.prototype.filterContent=function(){return this.filteredObjectName;};return A;});define('sap/viz/controls/common/filter/DateRangeFilter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/managers/LangManager'],function(O,A,L){var D=function(o,a){var b=[];b.push(A.DATE_RANGE_TYPE);b.push(o);b.push(a);D.superclass.constructor.apply(this,b);this.__className="sap.viz.controls.common.filter.DateRangeFilter";this.minDate=null;this.maxDate=null;this.excludeNull=false;};O.extend(D,A);D.prototype.isEmpty=function(){if(this.minDate===null&&this.maxDate===null){return true;}return false;};D.prototype.getMin=function(){return this.minDate;};D.prototype.getMax=function(){return this.maxDate;};D.prototype.isExcludeNull=function(){return this.excludeNull;};D.prototype.setMin=function(m){this.minDate=m;};D.prototype.setMax=function(m){this.maxDate=m;};D.prototype.setExcludeNull=function(e){this.excludeNull=e;};D.prototype.toJSON=function(){var j=D.superclass.toJSON.apply(this,arguments);j.minDate=this.minDate;j.maxDate=this.maxDate;j.excludeNull=this.excludeNull;return j;};D.fromJSON=function(f){var a=new D(f.filteredObjectId,f.filteredObjectName);a.setReverseSelection(f.isReverse);a.isGlobalFilter(f.isGlobalFilter);a.minDate=f.minDate;a.maxDate=f.maxDate;a.excludeNull=f.excludeNull;return a;};D.prototype.clone=function(){var j=this.toJSON();return D.fromJSON(j);};D.prototype.filterTitle=function(){return this.filteredObjectName+'('+L.get('VIZ_COMMON_BETWEEN')+')';};D.prototype.filterContent=function(){return'('+this.minDate+'  -  '+this.maxDate+')';};return D;});define('sap/viz/controls/common/filter/NumericRangeFilter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/managers/LangManager'],function(O,A,L){var N=function(o,a){var b=[];b.push(A.NUMERIC_RANGE_TYPE);b.push(o);b.push(a);N.superclass.constructor.apply(this,b);this.__className="sap.viz.controls.common.filter.NumericRangeFilter";this.minValue=null;this.maxValue=null;this.excludeNull=false;};O.extend(N,A);N.prototype.isEmpty=function(){if(this.minValue===null&&this.maxValue===null){return true;}return false;};N.prototype.getMin=function(){return this.minValue;};N.prototype.getMax=function(){return this.maxValue;};N.prototype.isExcludeNull=function(){return this.excludeNull;};N.prototype.setMin=function(m){this.minValue=m;};N.prototype.setMax=function(m){this.maxValue=m;};N.prototype.setExcludeNull=function(e){this.excludeNull=e;};N.prototype.toJSON=function(){var j=N.superclass.toJSON.apply(this,arguments);j.minValue=this.minValue;j.maxValue=this.maxValue;j.excludeNull=this.excludeNull;return j;};N.fromJSON=function(f){var a=new N(f.filteredObjectId,f.filteredObjectName);a.setReverseSelection(f.isReverse);a.isGlobalFilter(f.isGlobalFilter);a.minValue=f.minValue;a.maxValue=f.maxValue;a.excludeNull=f.excludeNull;return a;};N.prototype.clone=function(){var j=this.toJSON();return N.fromJSON(j);};N.prototype.filterTitle=function(){return this.filteredObjectName+'('+L.get('VIZ_COMMON_BETWEEN')+')';};N.prototype.filterContent=function(){return'('+this.minValue+'  -  '+this.maxValue+')';};return N;});define('sap/viz/controls/common/filter/ValueFilter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/filter/AbstractFilter'],function(O,A){var V=function(o,a){V.superclass.constructor.apply(this,[A.VALUE_TYPE,o,a]);this.__className="sap.viz.controls.common.filter.ValueFilter";this.hierarchyLevelId=null;this.filteredValues=[];};O.extend(V,A);V.prototype.getValues=function(){return this.filteredValues;};V.prototype.isEmpty=function(){if(this.filteredValues&&this.filteredValues.length>0){return false;}else{return true;}};V.prototype.removeAllValues=function(){this.filteredValues.length=0;};V.prototype.addValue=function(v){return this.filteredValues.push(v);};V.prototype.removeValue=function(v){for(var i=0;i<this.filteredValues.length;i++){if(this.filteredValues[i].key===v.key&&this.filteredValues[i].value===v.value){this.filteredValues.splice(i,1);}}};V.prototype.toJSON=function(){var j=V.superclass.toJSON.apply(this,arguments);j.filteredValues=this.filteredValues;if(this.hierarchyLevelId){j.hierarchyLevelId=this.hierarchyLevelId;}return j;};V.fromJSON=function(f){var a=new V(f.filteredObjectId,f.filteredObjectName);a.setReverseSelection(f.isReverse);a.isGlobalFilter(f.isGlobalFilter);a.filteredValues=f.filteredValues;if(f.hierarchyLevelId){a.hierarchyLevelId=f.hierarchyLevelId;}return a;};V.prototype.clone=function(){var j=this.toJSON();return V.fromJSON(j);};V.prototype.values=function(){return this.filteredValues;};V.prototype.updateValues=function(v){return(this.filteredValues=v);};V.prototype.filterTitle=function(){return this.filteredObjectName+' ('+this.filteredValues.length+')';};V.prototype.filterContent=function(){var v="";for(var i=0,l=this.filteredValues.length;i<l;i++){var d=this.filteredValues[i].display?this.filteredValues[i].display:this.filteredValues[i].value;if(v){v+=", "+d;}else{v=d;}}return v;};return V;});define('sap/viz/controls/common/constants/CSSConst',[],function(){var C={};C.PREFIX="viz-controls-";C.COMMON_PREFIX=C.PREFIX+"common-";C.SWITCHBAR_PREFIX=C.PREFIX+"switchbar-";C.FEEDINGPANEL_PREFIX=C.PREFIX+"feeding-";C.PROPERTYEDITOR_PREFIX=C.PREFIX+"propertyeditor-";C.VIZDATAPICKER_PREFIX=C.PREFIX+"datapicker-";C.FRAME_PREFIX=C.PREFIX+"frame-";C.BUILDER_PREFIX=C.PREFIX+"builder-";C.TRELLIS_PREFIX=C.PREFIX+"trellis-";C.MAPBUILDER_PREFIX=C.PREFIX+"mapbuilder-";C.CHART_PREFIX=C.PREFIX+"chart-";C.FILTERBAR0_PREFIX=C.PREFIX+"filterbar0-";C.FILTERBAR_PREFIX=C.PREFIX+"filterbar-";C.CONTEXTMENU_PREFIX=C.PREFIX+"contextmenu-";C.CUSTOMBUTTON_PREFIX=C.PREFIX+"custombutton-";C.ANNOTATION_PREFIX=C.PREFIX+"annotation-";C.PLAYCTRL_PREFIX=C.PREFIX+"playcontrol-";C.FEEDINGSHELF_PREFIX=C.COMMON_PREFIX+"feeding-";C.ICON_PREFIX=C.COMMON_PREFIX+"icon-";C.SAP_ICON_PREFIX=C.COMMON_PREFIX+"sap-icon-";C.SLIDER_WIDTH="150px";return C;});define('sap/viz/controls/common/events/EventDispatcher',['sap/viz/controls/common/utils/Utils'],function(u){var E=function(){this.__className="sap.viz.controls.common.events.EventDispatcher";this._enableDispatchEvent=true;};E.prototype.addEventListener=function(t,l,s,p){if(!p){p=0;}var e=this._findEventListener(t,l,s);if(e){return;}e={type:t,scope:s,listener:l,priority:p};var a=this.listeners()[t];if(!a){this.listeners()[t]=a=[e];}else{var i=false;for(var n=0;n<a.length;++n){var b=a[n];if(p>b.priority){a.splice(n,0,e);i=true;break;}}if(i===false){a.push(e);}}};E.prototype.removeEventListener=function(t,l,s){var e=this._findEventListener(t,l,s);if(e){var a=this.listeners()[t];a.splice(a.indexOf(e),1);}};E.prototype.removeEventListeners=function(t){this.listeners()[t]=[];};E.prototype.removeAllEventListeners=function(){this._listeners={};};E.prototype.hasEventListener=function(t,l,s){var e=this._findEventListener(t,l,s);return e!==null;};E.prototype.hasEventListeners=function(t){var l=this.listeners()[t];if(l){return l.length>0;}return false;};E.prototype._dispatchEvent=function(e){if(this._enableDispatchEvent===undefined){this._enableDispatchEvent=true;}if(this._enableDispatchEvent){var t=e.type();var l=this.listeners()[t];if(l){var c=l.slice(0);for(var n=0;n<c.length;++n){var a=c[n];a.listener.call(a.scope,e);}}}};E.prototype.enableDispatchEvent=function(v){if(this._enableDispatchEvent===undefined){this._enableDispatchEvent=true;}if(arguments.length>=1){if(u.isBoolean(v)){this._enableDispatchEvent=v;}return this;}else{return this._enableDispatchEvent;}};E.prototype._findEventListener=function(t,l,s){var a=this.listeners()[t];if(!a){return null;}for(var n=0;n<a.length;++n){var e=a[n];if(e.listener===l&&e.scope===s){return e;}}return null;};E.prototype.listeners=function(){if(this._listeners===undefined){this._listeners={};}return this._listeners;};return E;});define('sap/viz/controls/common/UIControl',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/utils/Utils'],function($,O,E,u){var U=function U(d,a){U.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.UIControl";this._dom=d;this._dom$=$(d);this._uiConfig=a;this._uid=u.genUID();};O.extend(U,E);U.prototype.size=function(v){if(arguments.length>0){if(v.width!=null){this._dom$.width(v.width);}if(v.height!=null){this._dom$.height(v.height);}this._validateSize();return this;}else{return{'width':this._dom$.width(),'height':this._dom$.height()};}};U.prototype._validateSize=function(){};U.prototype.visible=function(v){this._dom$.css("visibility",v?"visible":"hidden");return this;};U.prototype.hide=function(){this._dom$.hide();return this;};U.prototype.show=function(){this._dom$.show();return this;};U.prototype.destroy=function(){this._dom$.removeData().off().find('*').removeData().off();this._dom$.empty();this._dom=null;};return U;});define('sap/viz/controls/common/views/drag/DropAction',[],function(){var D={};D.ACCEPT='accept';D.ACCEPT_AS_REPLACEMENT='acceptAsReplacement';D.ACCEPT_AS_COPY='acceptAsCopy';D.DENY='deny';D.AS_TRASH='asTrash';return D;});define('sap/viz/controls/common/views/drag/AnalysisToken',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/DropAction'],function($,C,O,u,U,D){var A=function(d,a,b){A.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.drag.AnalysisToken";this._domHelper$=$(d);this._domDraggable$=$(a);this._fixDragingPosition();this._defaultAction=D.DENY;this.analysisObject=b;this.playDefaultAction();};O.extend(A,U);A.prototype._fixDragingPosition=function(){var d=this._domDraggable$;var a=$.proxy(function(e,c){c.position.top=c.offset.top;c.position.left=c.offset.left;c.helper.trigger('sap.viz.controls.analysisDrag.events.drag',[e.pageX,e.pageY]);},this);var b=$.proxy(function(e,c){o();},this);var o=function(){d.off('drag',a);d.off('dragstop',b);};o();d.on('drag',a);d.on('dragstop',b);};A.prototype.defaultAction=function(v){if(arguments.length>0){this._defaultAction=v;return this;}else{return this._defaultAction;}};A.prototype.killRevertAnimation=function(){var d=this._domDraggable$;if(d){var o=d.draggable('option','revertDuration');d.draggable('option','revertDuration',0);u.defer(function(){try{d.draggable('option','revertDuration',o);}catch(e){}});}};A.prototype.dropTarget=function(v){};A.prototype.currentAction=function(v){if(arguments.length>0){this._domHelper$.data('sap.viz.controls.analysisDrag.action',v);this._domHelper$.trigger('sap.viz.controls.analysisDrag.events.dropAction',[v]);return this;}else{return this._domHelper$.data('sap.viz.controls.analysisDrag.action');}};A.prototype.playDefaultAction=function(){this.currentAction(this._defaultAction);};A.prototype.showWarn=function(w){};return A;});define('sap/viz/controls/common/views/drag/DefaultAnalysisToken',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/AnalysisToken','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/utils/Utils'],function($,C,A,O,U,a,D,b){var c=function(d,e,f){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.drag.DefaultAnalysisToken";this._dom$=$(d);this._icon$=null;this._warn$=null;this._warnspan$=null;this._dropTarget=null;this._createChildren();this._dom$.appendTo(document.body);this.currentAction(this._defaultAction);c._instance=this;};O.extend(c,a);c._ACTION_TO_CLASS=(function(){var m={};var p=C.COMMON_PREFIX;var d=p+'analysisDraggingToken-'+'icon-dropAccepted '+C.ICON_PREFIX+'checkmark';m[D.ACCEPT]=d;m[D.ACCEPT_AS_COPY]=d;d=p+'analysisDraggingToken-icon-dropAcceptedAsReplacement '+C.ICON_PREFIX+'token-replace';m[D.ACCEPT_AS_REPLACEMENT]=d;d=p+'analysisDraggingToken-'+'icon-dropDenied '+C.ICON_PREFIX+'close';m[D.DENY]=d;d=p+'analysisDraggingToken-icon-dropAsTrash';m[D.AS_TRASH]=d;return m;})();c.prototype.dropTarget=function(v){if(arguments.length>0){this._dropTarget=v;return this;}else{return this._dropTarget;}};c.prototype.currentAction=function(v){if(this._icon$){if(arguments.length>0){this._icon$.removeClass(c._ACTION_TO_CLASS[D.ACCEPT]);this._icon$.removeClass(c._ACTION_TO_CLASS[D.ACCEPT_AS_COPY]);this._icon$.removeClass(c._ACTION_TO_CLASS[D.ACCEPT_AS_REPLACEMENT]);this._icon$.removeClass(c._ACTION_TO_CLASS[D.DENY]);this._icon$.removeClass(c._ACTION_TO_CLASS[D.AS_TRASH]);this._icon$.addClass(c._ACTION_TO_CLASS[v]);}}return c.superclass.currentAction.apply(this,arguments);};c.prototype.showWarn=function(w){if(w){if(!this._warn$){this._warn$=$(document.createElement('div')).addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn').appendTo(this._dom$);this._warnspan$=$(document.createElement('span')).addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn-text').appendTo(this._warn$);}this._warnspan$.text(w);this._layoutWarn();this._dom$.bind("mousemove",$.proxy(function(e){this._layoutWarn();},this));}else{if(this._warn$){this._warn$.hide(0);this._dom$.unbind("mousemove");}}};c.prototype._layoutWarn=function(){this._warn$.removeClass(C.COMMON_PREFIX+'analysisDraggingToken-warn');this._warn$.addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn');this._warnspan$.removeClass(C.COMMON_PREFIX+'analysisDraggingToken-warn-text');this._warnspan$.addClass(C.COMMON_PREFIX+'analysisDraggingToken-warn-text');this._warn$.css({'maxWidth':$(window).width()+'px'});var d=this._dom$.outerWidth();var e=this._dom$.outerHeight();var l=this._dom$.offset().left-document.body.scrollLeft;var r=$(window).width()-this._dom$.offset().left-d;var w=false;var m=0;var f=0;var g=d;var h=this._warnspan$.outerWidth();this._warn$.hide(0);if(r>=h){m=-e;f=d;g=h;}else if(l>=h){f=-h;}else if(r>=g){w=true;m=-e;f=d;g=r;}else if(l>=g){w=true;f=-l;h=l;}else{w=true;f=-l;}g=Math.min(g,$(window).width());h=Math.min(h,$(window).width());this._warn$.css({'marginTop':m+'px','marginLeft':f+'px','minWidth':g+'px','maxWidth':h+'px'});if(w){this._warnspan$.css({'whiteSpace':'pre-line'});}this._warn$.show(0);};c.prototype._createChildren=function(){this._dom$.addClass(C.COMMON_PREFIX+'analysisDraggingToken');var n=this.analysisObject.name();if(this.analysisObject.type()===A.HIERARCHY){var s=this.analysisObject.selectedHierarchyLevel();n=s.name();}var d=$(document.createElement('span')).appendTo(this._dom$).text(n);d.addClass(C.COMMON_PREFIX+'text-ellipsis');var i=this._icon$=$(document.createElement('div')).appendTo(this._dom$);i.addClass(C.COMMON_PREFIX+'analysisDraggingToken-icon');};return c;});define('sap/viz/controls/common/managers/DragManager',['jquery','sap/viz/controls/common/views/drag/DefaultAnalysisToken','sap/viz/controls/common/views/drag/AnalysisToken','sap/viz/controls/common/views/drag/DropAction'],function($,D,A,a){var b=function(){this.__className="sap.viz.controls.common.managers.DragManager";};b._instance=null;b.instance=function(){if(!b._instance){b._instance=new b();}return b._instance;};b.enableDraggableFeeding=function(d,c,e){var f=$(d);f.off('dragstart',b._feedingDragStartHandler);f.on('dragstart',b._feedingDragStartHandler);f.addClass(b.DRAGGABLE_CLASS_ANALYSIS);f.data(b._KEY_ANALYSIS,c);f.data(b._KEY_BACKUPAOS,e);};b.disableDraggableFeeding=function(d){var c=$(d);c.off('dragstart',b._feedingDragStartHandler);c.removeClass(b.DRAGGABLE_CLASS_ANALYSIS);c.removeData(b._KEY_ANALYSIS);c.removeData(b._KEY_BACKUPAOS);};b.getDefaultHelper=function(d){var c=$(d);var e=c.data(b._KEY_ANALYSIS);if(!e){return null;}var h=document.createElement('div');var t=new D(h,d,e);var f=c.data(b._KEY_BACKUPAOS);if(f){t.backupAOs=f;}$(h).data(b._KEY_TOKEN,t);return h;};b._feedingDragStartHandler=function(e,u){var d=$(e.currentTarget);u.helper.data(b._KEY_ANALYSIS,d.data(b._KEY_ANALYSIS));u.helper.data(b._KEY_DRAGGABLE,d[0]);};b.DRAGGABLE_CLASS_ANALYSIS='viz-controls-common-analysisDraggable';b._KEY_ANALYSIS='sap.viz.controls.reserved.draggableFeeding.analysisObject';b._KEY_BACKUPAOS='sap.viz.controls.reserved.draggableFeeding.backupAnalysisObjects';b._KEY_TOKEN='sap.viz.controls.reserved.draggableFeeding.analysisToken';b._KEY_DRAGGABLE='sap.viz.controls.reserved.draggableFeeding.domDraggable';b.prototype.getAnalysisToken=function(h){var t=h.data(b._KEY_TOKEN);if(t){return t;}else{var c=h.data(b._KEY_ANALYSIS);if(c){t=new A(h[0],h.data(b._KEY_DRAGGABLE),c);h.data(b._KEY_TOKEN,t);return t;}else{return null;}}};return b;});define('sap/viz/controls/common/constants/FeedConst',[],function(){var F={'ID_GEO':'geoFeatures','ID_TRELLIS_ROW':'trellisRow','ID_TRELLIS_COLUMN':'trellisColumn','ID_DATAFRAME':'dataFrame','TYPE_SUBTOTAL':'Subtotal','ID_TIME_AXIS':'timeAxis'};return F;});define('sap/viz/controls/common/utils/PropertyFilterUtil',[],function(){var P={};var F={"viz/bubble":["plotArea.children.maxBubbleHeight","plotArea.children.maxBubbleWidth","plotArea.children.maxPriValue","plotArea.children.maxSecValue","plotArea.children.minBubbleHeight","plotArea.children.minBubbleWidth","plotArea.children.minSecValue","plotArea.children.minPriValue"],"viz/geobubble":["plotArea.children.maxValue","plotArea.children.minValue"],"info/donut":["plotArea.children.dataLabel.children.renderer","plotArea.children.sliceRenderer","plotArea.children.highlight.children.contextInfos"],"info/bar":["plotArea.children.primaryScale.children.autoMaxValue","plotArea.children.primaryScale.children.autoMinValue","plotArea.children.dataLabel.children.renderer","categoryAxis.children.labelRenderer","legendGroup.children.renderTo","legendGroup.children.computedVisibility","plotArea.children.markerRenderer"],"info/column":["plotArea.children.primaryScale.children.autoMaxValue","plotArea.children.primaryScale.children.autoMinValue","plotArea.children.dataLabel.children.renderer","categoryAxis.children.labelRenderer","legendGroup.children.renderTo","legendGroup.children.computedVisibility","plotArea.children.markerRenderer"],"info/line":["plotArea.children.primaryScale.children.autoMaxValue","plotArea.children.primaryScale.children.autoMinValue","plotArea.children.markerRenderer","plotArea.children.dataLabel.children.renderer","categoryAxis.children.labelRenderer","legendGroup.children.renderTo","legendGroup.children.computedVisibility","plotArea.children.lineRenderer"],"info/horizontal_line":["plotArea.children.primaryScale.children.autoMaxValue","plotArea.children.primaryScale.children.autoMinValue","plotArea.children.markerRenderer","plotArea.children.dataLabel.children.renderer","categoryAxis.children.labelRenderer","plotArea.children.lineRenderer"],"info/stacked_bar":["legendGroup.children.renderTo","legendGroup.children.computedVisibility"],"info/stacked_column":["legendGroup.children.renderTo","legendGroup.children.computedVisibility"],"info/combination":["legendGroup.children.renderTo","legendGroup.children.computedVisibility"],"info/bubble":["legendGroup.children.renderTo","legendGroup.children.computedVisibility"],"info/bullet":["legendGroup.children.renderTo","legendGroup.children.computedVisibility"],"info/time_bubble":["legendGroup.children.renderTo","legendGroup.children.computedVisibility"]};P.addDefaultProperties=function(p,c){var f=F[c];if(f){f.forEach(function(a){P.addProperty(p,a);});}P.addProperty(p,"interaction.behaviorType");return p;};P.addProperty=function(p,a){if(!a){return p;}p=p||{};var t=p;var b=a.split(".");for(var i=0;i<b.length;i++){if(!t.hasOwnProperty(b[i])){t[b[i]]={};}t=t[b[i]];}return p;};return P;});define('sap/viz/controls/common/metadata/MetadataBase',['sap/viz/controls/common/utils/PropertyFilterUtil','sap/viz/controls/common/constants/DatasetTypeConst'],function(P,D){var M=function(r){this._raw=r;this._support={dataset:{}};this._support.dataset[D.CROSS_TABLE]=false;this._support.dataset[D.FLAT_TABLE]=false;this._bindingDefs=null;};M.prototype.raw=function(){return this._raw;};M.prototype.support=function(){return this._support;};M.prototype.removeInvalidProperty=function(s){var a=this.getPropertiesDef();var t=this._raw.type;a=P.addDefaultProperties(a,t);this._removeInvalidProperty(s,a);};return M;});define('sap/viz/controls/common/bindingdef/BindingDef',[],function(){var B=function(s){this._id=s.id;this._name=s.name;this._type=s.type;this._min=s.min||0;this._max=s.max||Infinity;this._mndEnumerable=s.mndEnumerable!==undefined?s.mndEnumerable:false;this._mndMode=s.mndMode||'none';this._bvrPriority=s.bvrPriority!==undefined?s.bvrPriority:Number.POSITIVE_INFINITY;this._bvrMNDPriority=s.bvrMNDPriority!==undefined?s.bvrMNDPriority:Number.POSITIVE_INFINITY;};B.prototype.id=function(){return this._id;};B.prototype.name=function(){return this._name;};B.prototype.type=function(){return this._type;};B.prototype.min=function(){return this._min;};B.prototype.max=function(){return this._max;};B.prototype.mndEnumerable=function(){return this._mndEnumerable;};B.prototype.mndMode=function(){return this._mndMode;};B.prototype.bvrPriority=function(){return this._bvrPriority;};B.prototype.bvrMNDPriority=function(){return this._bvrMNDPriority;};B.prototype.equal=function(d){var e=true;e=e&&this._id===d.id();e=e&&this._name===d.name();e=e&&this._type===d.type();e=e&&this._min===d.min();e=e&&this._max===d.max();e=e&&this._mndMode===d.mndMode();e=e&&this._bvrPriority===d.bvrPriority();e=e&&this._bvrMNDPriority===d.bvrMNDPriority();return e;};return B;});define('sap/viz/controls/common/bindingdef/adaptors/InfoBindingDefAdaptor',['sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/bindingdef/BindingDef','sap/viz/controls/common/constants/ChartConst',],function(F,B,C){var _=['layout','mark','trellis'];var a=['mark','layout','trellis'];var b=function(t){if(t==='Dimension'){return'dimension';}else if(t==='Measure'){return'measure';}else{return'universal';}};var c=function(t){var d=[C.TYPE_GEO_BUBBLE,C.TYPE_SCATTER,C.TYPE_BUBBLE];return d.indexOf(t)!==-1;};return{'adapt':function(i,t){var e=window.__sap_viz_internal_enable_play_field_for_all_charts===true;e=e||c(t);var s=i.slice(0).sort(function(f,g){if(f.role==='trellis.rowCategory'&&g.role==='trellis.columnCategory'){return-1;}else if(f.role==='trellis.columnCategory'&&g.role==='trellis.rowCategory'){return 1;}else{return _.indexOf(f.role.split('.')[0])-_.indexOf(g.role.split('.')[0]);}});var d=[];i.forEach(function(f){if(!e&&f.id===C.DATA_FRAME){return;}d.push(new B({'id':f.id,'name':f.name,'type':b(f.type),'min':f.min,'max':f.max,'mndEnumerable':f.type==='Measure'&&f.role.split('.')[0]==='layout','mndMode':f.acceptMND===true?'support':'none','bvrPriority':s.indexOf(f),'bvrMNDPriority':a.indexOf(f.role.split('.')[0])*1000+s.indexOf(f)}));});return d;}};});define('sap/viz/controls/common/metadata/InfoMetadata',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/metadata/MetadataBase','sap/viz/controls/common/bindingdef/adaptors/InfoBindingDefAdaptor','require','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst'],function($,O,M,I,r,C,D){var a=function(s){a.superclass.constructor.apply(this,arguments);if(this._raw.type===C.TYPE_GEO_MAP){this._support.dataset[D.ARRAY_FLAT_TABLE]=true;}else{this._support.dataset[D.FLAT_TABLE]=true;}this._isEnablePlayField=null;};O.extend(a,M);a.prototype.getBindingDefs=function(){var i=window.__sap_viz_internal_enable_play_field_for_all_charts===true;if((i!==this._isEnablePlayField)||!this._bindingDefs){this._isEnablePlayField=i;this._bindingDefs=I.adapt(this._raw.bindings,this._raw.type);}return this._bindingDefs;};a.prototype.getBindingDefsWithBVRSorting=function(){if(!this._bindingDefsWithBVRSorting){this._bindingDefsWithBVRSorting=this.getBindingDefs().slice(0).sort(function(d,b){return d.bvrPriority()-b.bvrPriority();});}return this._bindingDefsWithBVRSorting;};a.prototype.getPropertiesDef=function(){return this._raw.properties;};a.prototype.isBuiltIn=function(){return true;};a.prototype.getCategoryAxis=function(){var b=r('sap/viz/controls/common/utils/ChartTypeUtil');var c,t=this._raw.type;if(b.isHorizontal(t)){c=['yAxis'];}else{c=['xAxis'];}return c;};a.prototype.getValueAxis=function(){var b=r('sap/viz/controls/common/utils/ChartTypeUtil');var v,t=this._raw.type;if(t===C.TYPE_SCATTER||t===C.TYPE_BUBBLE){v=['xAxis','yAxis'];}else{if(b.isHorizontal(t)){if(b.isMekkoChart(t)){v=['xAxis','yAxis2'];}else{v=['xAxis'];}}else{if(b.isMekkoChart(t)){v=['yAxis','xAxis2'];}else{v=['yAxis'];}}if(b.isDual(t)){v=[v[0],v[0]+"2"];}}return v;};a.prototype.getName=function(){return this._raw.name||this._raw.type;};a.prototype._removeInvalidProperty=function(s,d){if(!d){return;}var p;for(p in s){if(!d.hasOwnProperty(p)){delete s[p];}else if(!d[p].supportedValueType){var c=d[p].children;if(c){this._removeInvalidProperty(s[p],c);}}}};a.prototype.dataScale=function(){return this._raw.scales;};return a;});define('sap/viz/controls/common/bindingdef/adaptors/VizFeedingDefAdaptor',['sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/bindingdef/BindingDef'],function(F,B){var V={};V.adapt=function(f){var d=[];f.forEach(function(e,i,g){if(e.id==='multiplier'){d=d.concat(b(e));}else if(e.type==='Dimension'){d.push(a(e));}else if(e.type==='Measure'){d.push(_(e));}});return d;};var _=function(f){return new B({'id':f.id,'name':f.name,'type':'measure','min':f.min,'max':f.max,'mndEnumerable':true,'mndMode':'none','bvrPriority':f.mgIndex,'bvrMNDPriority':undefined});};var a=function(f){var m=f.minStackedDims!==undefined?f.minStackedDims:f.min;var d=f.maxStackedDims!==undefined?f.maxStackedDims:Number.POSITIVE_INFINITY;var e=c(f);return new B({'id':f.id,'name':f.name,'type':'dimension','min':m,'max':d,'mndMode':e.mode,'bvrPriority':f.aaIndex,'bvrMNDPriority':e.priority});};var b=function(f){var m=c(f);return[new B({'id':F.ID_TRELLIS_ROW,'name':f.name,'type':'dimension','min':0,'max':3,'mndMode':m.mode,'bvrPriority':Number.POSITIVE_INFINITY,'bvrMNDPriority':m.priority}),new B({'id':F.ID_TRELLIS_COLUMN,'name':f.name,'type':'dimension','min':0,'max':3,'mndMode':m.mode,'bvrPriority':Number.POSITIVE_INFINITY,'bvrMNDPriority':m.priority})];};var c=function(f){var m,p;if(f.acceptMND!==undefined&&f.acceptMND!==-1&&f.acceptMND!==false){m=f.max===1?'supportExclusively':'support';p=f.acceptMND*-1;}else{m='none';p=undefined;}return{'mode':m,'priority':p};};return V;});define('sap/viz/controls/common/metadata/VizMetadata',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/metadata/MetadataBase','sap/viz/controls/common/bindingdef/adaptors/VizFeedingDefAdaptor','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst'],function($,O,M,V,C,D){var a=function(){a.superclass.constructor.apply(this,arguments);if((this._raw.id===C.TYPE_TABLE)||(this._raw.id===C.TYPE_CROSSTAB)){this._support.dataset[D.RAW]=true;}else if(this._raw.id===C.TYPE_GEO_MAP){this._support.dataset[D.ARRAY_FLAT_TABLE]=true;}else{this._support.dataset[D.CROSS_TABLE]=true;}};O.extend(a,M);a.prototype.getBindingDefs=function(){if(!this._bindingDefs){this._bindingDefs=V.adapt(this._raw.allFeeds());}return this._bindingDefs;};a.prototype.getBindingDefsWithBVRSorting=function(){if(!this._bindingDefsWithBVRSorting){this._bindingDefsWithBVRSorting=this.getBindingDefs().slice(0).sort(function(d,b){return d.bvrPriority()-b.bvrPriority();});}return this._bindingDefsWithBVRSorting;};a.prototype.getPropertiesDef=function(){return this._raw.allProperties();};a.prototype.isBuiltIn=function(){return this._raw.isBuiltIn;};a.prototype.getCategoryAxis=function(){return this._raw.categoryAxis;};a.prototype.getValueAxis=function(){return this._raw.valueAxis;};a.prototype.getName=function(){return this._raw.name;};a.prototype._removeInvalidProperty=function(s,d){var p;for(p in s){if(!d.hasOwnProperty(p)){delete s[p];}else if(!d[p].supportedValueType){this._removeInvalidProperty(s[p],d[p]);}}};a.prototype.dataScale=function(){return this._raw.dataScale;};return a;});define('sap/viz/controls/common/metadata/MetadataFactory',['sap/viz/controls/common/metadata/InfoMetadata','sap/viz/controls/common/metadata/VizMetadata'],function(I,V){var _={};var U=['info/trellis_combination','info/trellis_horizontal_combination'];return{'get':function(v){if(_[v]!==undefined){return _[v];}var r,m=null;try{if(U.indexOf(v)===-1){r=sap.viz.api.metadata.Viz.get(v);if(r&&r.type){m=new I(r);}}}catch(e){}if(!m){try{r=sap.viz.api.manifest.Viz.get(v);if(r&&r[0]){m=new V(r[0]);}}catch(e){}}return(_[v]=m);}};});define('sap/viz/controls/common/utils/DatasetUtil',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/constants/DatasetTypeConst'],function(U,M,D){var a={};a.getType=function(d){if(d instanceof sap.viz.api.data.FlatTableDataset||(d&&d.type==='sap.viz.api.data.FlatTableDataset')){return D.FLAT_TABLE;}else if(d instanceof sap.viz.api.data.CrosstableDataset||(d&&d.type==='sap.viz.api.data.CrosstableDataset')){return D.CROSS_TABLE;}};var S={'viz/bubble':['bubbleWidth','bubbleHeight'],'viz/geobubble':['featureValues'],'viz/multi_geobubble':['featureValues'],'viz/multi_bubble':['bubbleWidth','bubbleHeight'],'info/bubble':['bubbleWidth','bubbleHeight'],'info/geobubble':['featureValues']};a.hasNegativeMeasureValue=function(c,f,d){if(this.getType(d)===D.FLAT_TABLE){return this._hasNegativeMeasureValueForFlattableDataset(c,f,d);}else if(this.getType(d)===D.CROSS_TABLE){return this._hasNegativeMeasureValueForCrosstableDataset(c,d);}};a._hasNegativeMeasureValueForFlattableDataset=function(c,f,d){var m=U.clone(S[c]);if(!m||!d){return false;}var b=d.data();if(!b){return false;}var v=b.data;var e=b.metadata.fields;var g=[],i,j,h;for(i=0;i<f.length;i++){for(j=0;j<m.length;j++){if(f[i].id()===m[j]){var k=f[i].values();for(h=0;h<k.length;h++){g.push(k[h]);}}}}for(i=0;i<g.length;i++){for(j=0;j<e.length;j++){if(g[i].id()===e[j].id){for(h=0;h<v.length;h++){if(U.isArray(v[h])){if(v[h][j]<0){return true;}}else{if(v[j]<0){return true;}}}}}}return false;};a._hasNegativeMeasureValueForCrosstableDataset=function(c,d){var m=U.clone(S[c]);if(!m||!d){return false;}var b=d.data();if(!b){return false;}var e=M.get(c).getBindingDefs();var f=b.measureValuesGroup;var g=[],i,j;for(i=0;i<e.length;i++){if(m.length<=0){break;}for(j=0;j<m.length;j++){if(e[i].id()===m[j]){g.push(e[i].bvrPriority());m.splice(j,1);break;}}}for(i=0;i<f.length;i++){var h=f[i];if(!h||!U.isArray(h.data)){continue;}if(g.indexOf(f[i].index)<0){continue;}for(j=0;j<h.data.length;j++){var l=h.data[j];if(!l||!U.isArray(l.values)){continue;}for(var k=0;k<l.values.length;k++){var v=l.values[k];if(!U.isArray(v)){continue;}if(this._hasNegativeValue(v)){return true;}}}}return false;};a._hasNegativeValue=function(b){var r=false;for(var i=0;i<b.length;i++){if(U.isNumber(b[i])&&b[i]<0){r=true;break;}}return r;};return a;});define('sap/viz/controls/common/utils/VizUtils',['jquery','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/utils/PropertyFilterUtil','sap/viz/controls/common/utils/DatasetUtil'],function($,M,D,U,F,A,P,a){var V={};V.hasFakeData=function(d){var h=true;if(d){h=false;if(U.isFunction(d.hasFakeData)){h=d.hasFakeData();}else{h=d.isFake===true?true:false;}}return h;};V.getDatasetType=function(d){if(d){if(a.getType(d)===D.CROSS_TABLE){return D.CROSS_TABLE;}else if(a.getType(d)===D.FLAT_TABLE){return D.FLAT_TABLE;}else{return D.RAW;}}return D.CROSS_TABLE;};V.isArrayOfFeedItem=function(o){return V._isArrayOf(o,F);};V.isArrayOfAnalysisObject=function(o){return V._isArrayOf(o,A);};V._isArrayOf=function(o,c){if(U.isArray(o)){for(var i=0;i<o.length;i++){if(!(o[i]instanceof c)){return false;}}return true;}return false;};V._parseInfoProperties=function(p){var r={};for(var n in p){if(p.hasOwnProperty(n)&&p[n]){var c=p[n];if(n==="children"){r=V._parseInfoProperties(c);}else{var b=c.name||n;if(c.hasOwnProperty("defaultValue")){r[b]=c.defaultValue}else if(U.type(c)==="object"){r[b]=V._parseInfoProperties(c);}else{r[b]=c;}}}}return r;};V._parseVizProperties=function(p){var r={};for(var n in p){if(p.hasOwnProperty(n)&&p[n]){var c=p[n];var b=c.name||n;if(c.supportedValueType==="Object"){if(c.supportedValues){r[b]=V._parseVizProperties(c.supportedValues);}}else{r[b]=c.defaultValue;}}}return r;};V._convertInfoProperties=function(b){var r={};for(var m in b){if(b.hasOwnProperty(m)){r[m]=V._parseInfoProperties(b[m])}}return r;};V._convertVizProperties=function(b){var r={};for(var m in b){if(b.hasOwnProperty(m)){r[m]=V._parseVizProperties(b[m])}}return r;};V._getAllProperties=function(t){if(!t){return null;}var m=M.get(t);if(!m){return null;}var p=m.getPropertiesDef();if(!p){return null;}return p;};V._getDefaultProperties=function(t){var p=this._getAllProperties(t);if(p){if(t&&t.indexOf("info/")===0){return V._convertInfoProperties(p);}else if(t&&t.indexOf("viz/")===0){return V._convertVizProperties(p);}else{return V._convertVizProperties(p);}}else{return null;}};V._propertyExist=function(p,b){if(!b){return false;}var c=b.split(".");var t=p;var r=false;for(var i=0;i<c.length;++i){if(t&&t.hasOwnProperty(c[i])){t=t[c[i]];r=true;}else{r=false;break;}}return r;};V.hasProperties=function(t,p){var r=[];if(!p||p.length===0){return r;}var d=V._getDefaultProperties(t);d=P.addDefaultProperties(d,t);for(var i=0;i<p.length;++i){if(U.isArray(p[i])){r[i]=false;for(var n=0;n<p[i].length;++n){r[i]=r[i]||V._propertyExist(d,p[i][n]);}}else{r[i]=V._propertyExist(d,p[i]);}}return r;};V._removeProperty=function(p,b){if(!b){return null;}var c=b.split(".");var t=p;for(var i=0;i<c.length;++i){if(t&&t.hasOwnProperty(c[i])){if(i===c.length-1){var r=t[c[i]];delete t[c[i]];return r;}else{t=t[c[i]];}}else{break;}}return null;};V._getProperty=function(p,b){if(!b){return null;}var c=b.split(".");var t=p;for(var i=0;i<c.length;++i){if(t&&t.hasOwnProperty(c[i])){if(i===c.length-1){var r=t[c[i]];return r;}else{t=t[c[i]];}}else{break;}}return null;};V.removeProperties=function(p,r){if(!r||r.length===0){return;}for(var i=0;i<r.length;++i){V._removeProperty(p,r[i]);}};V.getValueAxis=function(t){return M.get(t).getValueAxis();};V.isValueAxis=function(t,b){var v=V.getValueAxis(t);if(v){for(var i=0;i<v.length;i++){if(b===v[i]){return true;}}}return false;};V.convertValueAxisScale=function(p,s,t){if(!p||!s||!t){return;}var b=V.getValueAxis(s);var v=V.getValueAxis(t);if(!b||b.length===0){return;}var c=[];for(var i=0;i<b.length;++i){c[i]=V._removeProperty(p,b[i]+".scale");}if(v&&v.length>0){for(var n=0;n<v.length;++n){if(c[n]){p[v[n]]=p[v[n]]||{};p[v[n]]["scale"]=c[n];}}}};V.getCategoryAxis=function(t){return M.get(t).getCategoryAxis();};V.getValidProperties=function(s,t){var r=U.clone(s);M.get(t).removeInvalidProperty(r);return r;};V.convertProperties=function(s,b,t){if(!s||!b||!t||b===t){return s;}var p=U.clone(s);var c=V.getValueAxis(b);var v=V.getValueAxis(t);var i,n;if(c&&c.length!==0){var d=[];for(i=0;i<c.length;++i){d[i]=V._getProperty(s,c[i]);}if(v&&v.length>0){for(n=0;n<v.length;++n){if(d[n]){p[v[n]]=d[n];}}}}var e=V.getCategoryAxis(b);var f=V.getCategoryAxis(t);if(e&&e.length!==0){var g=[];for(i=0;i<c.length;++i){g[i]=V._getProperty(s,e[i]);}if(f&&f.length>0){for(n=0;n<f.length;++n){if(g[n]){p[f[n]]=g[n];}}}}return p;};return V;});define('sap/viz/controls/common/utils/InfoChartUtil',['jquery','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/constants/ChartConst'],function($,M,A,u,V,F,C){var a={'line':1,'column':1,'bar':1,'donut':1,'horizontal_line':1,'stacked_column':1,'stacked_bar':1,'100_stacked_column':1,'100_stacked_bar':1,'mekko':1,'100_mekko':1,'horizontal_mekko':1,'100_horizontal_mekko':1,'pie':1,'bubble':1,'scatter':1,'dual_column':1,'dual_line':1,'combination':1,'dual_bar':1,'horizontal_combination':1,'dual_stacked_column':1,'dual_stacked_bar':1,'dual_horizontal_line':1,'treemap':1,'time_value_bubble':1,'bullet':1};var I={getInfoType:function(v){var e=String(v).match(/^viz\/(multi_)?(.*)$/);if(e&&a[e[2]]){e[2]=e[2]==='time_value_bubble'?'time_bubble':e[2];e[2]=e[1]?"trellis_"+e[2]:e[2];var i="info/"+e[2];if(M.get(i)){return i;}}return null;},isInfoChart:function(t){return(/^info\/\w+$/).test(t);},getVizType:function(i){return this.isInfoChart(i)?i.replace('info/','viz/'):null;},buildInfoDataset:function(e){var f=sap.viz.data.utils.CTB2TBConvertUtil.crossTable2FlatTableData(e);return new sap.viz.api.data.FlatTableDataset(f);},buildInfoFeeding:function(f,e){var h={};for(var i=0;i<f.length;i++){var l=f[i];var v=l.values()||[];var n=h[l.id()]=[];for(var j=0;j<v.length;j++){var o=v[j];if(o.type()===A.MND){if(e){n.unshift("MeasureNamesDimension");}else{n.push("MeasureNamesDimension");}}else{if(o.type()===A.HIERARCHY){var p=(l.id()===C.DATA_FRAME);for(var k=0;k<o.hierarchyLevels().length;k++){var q=o.hierarchyLevels()[k];if(!p||q.selected()){n.push(q.id());}if(q.selected()){break;}}}else{n.push(o.id());}}}}return h;},buildInfoProperties:function(v,e,f){var i=$.extend(true,{},e);var h=V.getCategoryAxis(v);if(h&&h.length){r(i,h[0],'categoryAxis');if(h.length>1){r(i,h[1],'categoryAxis2');}}var j=V.getValueAxis(v);if(j&&j.length){r(i,j[0],'valueAxis');if(j.length>1){r(i,j[1],'valueAxis2');}}m(i,'dataLabel','plotArea.dataLabel');m(i,'background','plotArea.background');m(i,'plotArea.background.body.color','plotArea.background.color');m(i,'valueAxis.scale','plotArea.primaryScale');m(i,'valueAxis2.scale','plotArea.secondaryScale');m(i,'valueAxis2.gridline','plotArea.gridline');m(i,'valueAxis.gridline','plotArea.gridline');r(i.valueAxis,'axisline','axisLine');r(i.valueAxis2,'axisline','axisLine');r(i.categoryAxis,'axisline','axisLine');r(i.categoryAxis2,'axisline','axisLine');m(i,'valueAxis.lineSize','valueAxis.axisLine.size');m(i,'valueAxis2.lineSize','valueAxis2.axisLine.size');m(i,'categoryAxis.lineSize','categoryAxis.axisLine.size');m(i,'categoryAxis2.lineSize','categoryAxis2.axisLine.size');b(i,'valueAxis.label.formatString');b(i,'valueAxis2.label.formatString');c(i,'plotArea.dataLabel.formatString',f);c(i,'tooltip.formatString',f);return i;},buildVizProperties:function(v,i,f){var e=$.extend(true,{},i);d(e,'plotArea.dataLabel.formatString',f);d(e,'tooltip.formatString',f);m(e,'valueAxis.axisLine.size','valueAxis.lineSize');m(e,'valueAxis2.axisLine.size','valueAxis2.lineSize');m(e,'categoryAxis.axisLine.size','categoryAxis.lineSize');m(e,'categoryAxis2.axisLine.size','categoryAxis2.lineSize');r(e.valueAxis,'axisLine','axisline');r(e.valueAxis2,'axisLine','axisline');r(e.categoryAxis,'axisLine','axisline');r(e.categoryAxis2,'axisLine','axisline');m(e,'plotArea.gridline','valueAxis2.gridline',true);m(e,'plotArea.gridline','valueAxis.gridline');m(e,'plotArea.primaryScale','valueAxis.scale');m(e,'plotArea.secondaryScale','valueAxis2.scale');m(e,'plotArea.background.color','plotArea.background.body.color');m(e,'plotArea.background','background');m(e,'plotArea.dataLabel','dataLabel');var h=V.getCategoryAxis(v);if(h&&h.length){r(e,'categoryAxis',h[0]);if(h.length>1&&e.categoryAxis2){r(e,'categoryAxis2',h[1]);}}var j=V.getValueAxis(v);if(j&&j.length){r(e,'valueAxis',j[0]);if(j.length>1&&e.valueAxis2){r(e,'valueAxis2',j[1]);}}return e;},buildInfoSeries:function(f,e){var h=f['regionColor'];var k={},l=[];var n,v,o,p,q,i,j;if(!h||h.length===0){return null;}var t=f['axisLabels'];var w=f['primaryValues'];var x=false;if(h.indexOf('MeasureNamesDimension')>=0){h.splice(h.indexOf('MeasureNamesDimension'),1);x=true;}if(h.length<=0){var y;w.forEach(function(y){for(i=0;i<e.length;i++){n=e[i];if(n[y]!=null){q={};q['name']=y;p={};p['MeasureNamesDimension']=y;q['seriesData']=p;k[y]=q;break;}}});return k;}for(i=0;i<e.length;i++){n=e[i];v=false;for(j=0;j<w.length;j++){if(n[w[j]]!=null){v=true;break;}}if(v){o=n[h[0]];p={};q={};p[h[0]]=n[h[0]];for(j=1;j<h.length;j++){o=o+" / "+n[h[j]];p[h[j]]=n[h[j]];}if(x){var z,B;for(j=0;j<w.length;j++){if(!n.hasOwnProperty(w[j])){continue;}z=o+" / "+w[j];if(z&&l.indexOf(z)<0){l.push(z);B=u.clone(p);B[w[j]]=n[w[j]];q={};q['name']=z;q['seriesData']=B;k[z]=q;}}}else if(o&&l.indexOf(o)<0){l.push(o);q['name']=o;q['seriesData']=p;k[o]=q;}}}return k;}};function g(e,p){return p?p.split('.').reduce(function(o,f){return o&&typeof o=='object'?o[f]:null;},e):e;}function s(e,p,v,f){p.split('.').reduce(function(o,h,i,j){if(i<j.length-1){o[h]=o[h]!=null?o[h]:{};}else{if(f===true&&u.isObject(v)){o[h]=u.updateJSON(o[h],v);}else{o[h]=v;}}return o[h];},e);}function m(e,f,t,h){var v=g(e,f);if(v!=null){if(!h){var p=f.split('.');var i=p.pop();var j=p.join('.');delete g(e,j)[i];}s(e,t,v,true);}}var r=I._renameProperty=function(e,o,n){if(e&&o in e){e[n]=u.updateJSON(e[n],e[o]);delete e[o];}};function b(e,f){var h=g(e,f);if(!h){return;}if(u.isString(h)){return;}if(u.isArray(h)&&u.isArray(h[0])&&u.isString(h[0][0])){s(e,f,h[0][0]);}}function c(e,f,h){var i=g(e,f);if(!i){return;}if(u.isArray(i)&&u.isArray(i[0])&&u.isString(i[0][0])){if(i.length==1&&i[0].length==1){s(e,f,i[0][0]);return;}if(!h){s(e,f,i[0][0]);return;}var j=Array.prototype.filter.call(h,function(l){return l.type()===F.MEASURE;});if(!j.length){s(e,f,i[0][0]);return;}var k={};j.forEach(function(l,n){var p=null;l.values().forEach(function(o,q){var v=null;if(i[n]&&q<i[n].length){v=i[n][q];p=v;}else{v=p;}if(v){k[o.id()]=v;}});});s(e,f,k);}}function d(e,f,h){var i=g(e,f);if(!i){return;}if(u.isString(i)){s(e,f,[[i]]);}else if(u.isObject(i)){if(!h){s(e,f,null);return;}var j=Array.prototype.filter.call(h,function(l){return l.type()===F.MEASURE;});if(!j.length){s(e,f,null);return;}var k=[];j.forEach(function(l){var t=[];l.values().forEach(function(n,o){var v=i[n.id()];if(v){t.push(v);}else{t.push(null);}});k.push(t);});s(e,f,k);}}return I;});define('sap/viz/controls/common/utils/TrellisUtils',['sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/constants/ChartConst'],function(M,C){var t={};var T={};T.MULTIPLE='multi';T.TRELLIS='trellis';T._register=function(p){t[p.prefix]=p;};T._EMPTY_PROVIDER={'isMultipleChart':function(a){return false;},'supportMultiChart':function(a){return false;},'toSingleChartType':function(a){return a;},'toMultiChartType':function(a){return a;}};T._getProvider=function(a){var p=a.split('/')[0]+'/';return t[p]||T._EMPTY_PROVIDER;};T.providerName=function(a){var p=T._getProvider(a);return p.name;};T.isMultipleChart=function(a){if(!a){return false;}var p=T._getProvider(a);return p.isMultipleChart(a);};T.supportMultiChart=function(a){if(!a){return false;}var p=T._getProvider(a);return p.supportMultiChart(a);};T.toSingleChartType=function(a){if(!a){return a;}var p=T._getProvider(a);return p.toSingleChartType(a);};T.toMultiChartType=function(a){if(!a){return a;}var p=T._getProvider(a);if(p.isMultipleChart(a)){return a;}else{return p.toMultiChartType(a);}};function c(p,a){var b=p+a+'_';var d={'prefix':p,'name':a};d.isMultipleChart=function(e){if(!e){return false;}return(e.indexOf(b)===0);};d.supportMultiChart=function(e){if(e.indexOf(b)===0){return true;}var m=d.toMultiChartType(e);if(m!==e){return true;}else{return false;}};d.toSingleChartType=function(e){if(d.isMultipleChart(e)){return e.replace(b,p);}return e;};d.toMultiChartType=function(e){var m=e.replace(p,b);if(M.get(m)){return m;}return e;};return d;}T._register(c('viz/',T.MULTIPLE));T._register(c('info/',T.TRELLIS));return T;});define('sap/viz/controls/common/utils/ChartTypeUtil',['jquery','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/utils/TrellisUtils'],function($,M,C,D,L,I,T){var a={};a._CVOM_TYPE_MAPPING=function(){var d={};var e=function(f,v,g,h){var p={vizType:v};if(g){p.vizDirection=g;}if(h){p.vizStacking=h;}d[f]=p;};e(C.TYPE_STACKED_BAR,C.TYPE_STACKED_BAR,null,C.STACKING_NORMAL);e(C.TYPE_100_STACKED_BAR,C.TYPE_STACKED_BAR,null,C.STACKING_FULL);e(C.TYPE_STACKED_COLUMN,C.TYPE_STACKED_COLUMN,null,C.STACKING_NORMAL);e(C.TYPE_100_STACKED_COLUMN,C.TYPE_STACKED_COLUMN,null,C.STACKING_FULL);e(C.TYPE_MEKKO,C.TYPE_100_MEKKO,C.DIRECTION_VERTICAL,C.STACKING_NORMAL);e(C.TYPE_100_MEKKO,C.TYPE_100_MEKKO,C.DIRECTION_VERTICAL,C.STACKING_FULL);e(C.TYPE_HORIZONTAL_MEKKO,C.TYPE_100_MEKKO,C.DIRECTION_HORIZONTAL,C.STACKING_NORMAL);e(C.TYPE_100_HORIZONTAL_MEKKO,C.TYPE_100_MEKKO,C.DIRECTION_HORIZONTAL,C.STACKING_FULL);e(C.TYPE_3D_BAR,C.TYPE_3D_COLUMN,C.DIRECTION_HORIZONTAL);e(C.TYPE_3D_COLUMN,C.TYPE_3D_COLUMN,C.DIRECTION_VERTICAL);e(C.TYPE_HORIZONTAL_LINE,C.TYPE_LINE,C.DIRECTION_HORIZONTAL);e(C.TYPE_LINE,C.TYPE_LINE,C.DIRECTION_VERTICAL);e(C.TYPE_BAR,C.TYPE_BAR);e(C.TYPE_COLUMN,C.TYPE_COLUMN);e(C.TYPE_HORIZONTAL_AREA,C.TYPE_AREA,C.DIRECTION_HORIZONTAL,C.STACKING_NORMAL);e(C.TYPE_100_HORIZONTAL_AREA,C.TYPE_AREA,C.DIRECTION_HORIZONTAL,C.STACKING_FULL);e(C.TYPE_AREA,C.TYPE_AREA,C.DIRECTION_VERTICAL,C.STACKING_NORMAL);e(C.TYPE_100_AREA,C.TYPE_AREA,C.DIRECTION_VERTICAL,C.STACKING_FULL);e(C.TYPE_HORIZONTAL_COMBINATION,C.TYPE_COMBINATION,C.DIRECTION_HORIZONTAL);e(C.TYPE_COMBINATION,C.TYPE_COMBINATION,C.DIRECTION_VERTICAL);e(C.TYPE_DUAL_HORIZONTAL_LINE,C.TYPE_DUAL_LINE,C.DIRECTION_HORIZONTAL);e(C.TYPE_DUAL_LINE,C.TYPE_DUAL_LINE,C.DIRECTION_VERTICAL);e(C.TYPE_DUAL_HORIZONTAL_COMBINATION,C.TYPE_DUAL_COMBINATION,C.DIRECTION_HORIZONTAL);e(C.TYPE_DUAL_COMBINATION,C.TYPE_DUAL_COMBINATION,C.DIRECTION_VERTICAL);e(C.TYPE_HORIZONTAL_BOXPLOT,C.TYPE_BOXPLOT,C.DIRECTION_HORIZONTAL);e(C.TYPE_BOXPLOT,C.TYPE_BOXPLOT,C.DIRECTION_VERTICAL);e(C.TYPE_HORIZONTAL_WATERFALL,C.TYPE_WATERFALL,C.DIRECTION_HORIZONTAL);e(C.TYPE_WATERFALL,C.TYPE_WATERFALL,C.DIRECTION_VERTICAL);return d;};a._VIZ_TYPE_MAPPING=function(){var d={};var e=function(v,i){var n;if(v===C.TYPE_TABLE){n=L.get('VIZ_COMMON_TABLE_TEXT');}else if(v===C.TYPE_CROSSTAB){n=L.get('VIZ_COMMON_CROSSTAB_TEXT');}else{var f=M.get(v);n=f?f.getName():v;}d[v]={'id':v,'caption':n,'icon':i,'whiteIcon':i+'-white','greyIcon':i+'-grey'};var g=I.getInfoType(v);if(g){d[g]=$.extend({},d[v],{'id':g});}};e(C.TYPE_BAR,'bar');e(C.TYPE_COLUMN,'column');e(C.TYPE_STACKED_BAR,'stacked-bar');e(C.TYPE_STACKED_COLUMN,'stacked-column');e(C.TYPE_DUAL_BAR,'dual-bar');e(C.TYPE_DUAL_COLUMN,'dual-column');e(C.TYPE_3D_COLUMN,'3D-column');e(C.TYPE_100_MEKKO,'100-mekko');e(C.TYPE_LINE,'line');e(C.TYPE_AREA,'area');e(C.TYPE_COMBINATION,'combination');e(C.TYPE_DUAL_LINE,'dual-line');e(C.TYPE_DUAL_COMBINATION,'dual-combination');e(C.TYPE_PIE,'pie');e(C.TYPE_DONUT,'donut');e(C.TYPE_PIE_WITH_DEPTH,'pie-with-depth');e(C.TYPE_GEO_BUBBLE,'geo-bubble');e(C.TYPE_GEO_CHOROPLETH,'geo-choropleth');e(C.TYPE_GEO_PIE,'geo-pie');e(C.TYPE_GEO_MAP,'geo-map');e(C.TYPE_SCATTER,'scatter');e(C.TYPE_BUBBLE,'bubble');e(C.TYPE_SCATTER_MATRIX,'scatter-matrix');e(C.TYPE_HEATMAP,'heatmap');e(C.TYPE_TREEMAP,'treemap');e(C.TYPE_TABLE,'table');e(C.TYPE_CROSSTAB,'crosstab');e(C.TYPE_RADAR,'radar');e(C.TYPE_BOXPLOT,'boxplot');e(C.TYPE_WATERFALL,'waterfall');e(C.TYPE_TAG_CLOUD,'tag-cloud');e(C.TYPE_TREE,'tree');e(C.TYPE_NETWORK,'network');e(C.TYPE_FUNNEL,'funnel');e(C.TYPE_PC,'pc');e(C.TYPE_NUMBER,'number');e('sap.viz.ext.samplebar','sap.viz.ext.samplebar');e('sap.viz.ext.flagbar','sap.viz.ext.flagbar');return d;};a.getVizTypeObject=function(v){if(a.VIZ_TYPE__MAPPING==null){a.VIZ_TYPE__MAPPING=a._VIZ_TYPE_MAPPING();}var t=a.VIZ_TYPE__MAPPING[v];if(t){t=JSON.parse(JSON.stringify(t));}return t;};a.toVizProperties=function(d){if(a.CVOM_TYPE_MAPPING==null){a.CVOM_TYPE_MAPPING=a._CVOM_TYPE_MAPPING();}var p=a.CVOM_TYPE_MAPPING[d];if(!p){p={vizType:d};}return p;};a.fromVizProperties=function(t,v,d){if(!v&&!d){return t;}var e=a.toVizProperties(t).vizType;for(var f in a.CVOM_TYPE_MAPPING){if(a.CVOM_TYPE_MAPPING.hasOwnProperty(f)){var p=a.CVOM_TYPE_MAPPING[f];if(p.vizType===e&&(!v||!p.vizDirection||p.vizDirection===v)&&(!d||!p.vizStacking||p.vizStacking===d)){return f;}}}return t;};a.updateType=function(t,o){var n=t;if(o.hasOwnProperty("direction")){n=a.changeDirection(n,o["direction"]);o["direction"]=undefined;}if(o.hasOwnProperty("stacking")){n=a.changeStacking(n,o["stacking"]);o["stacking"]=undefined;}return n;};a.isMultipleChart=function(t){return T.isMultipleChart(t);};a.toMultiChartType=function(t){return T.toMultiChartType(t);};a.toSingleChartType=function(t){return T.toSingleChartType(t);};a.toTimeChartType=function(t){var s,p;if(/\//g.test(t)&&!/\/time/g.test(t)){var d=t.split('/');p=d[0];s=d[1];t=p+'/time_'+s;if(M.get(t)){return t;}}return t;};a.supportMultiChart=function(v){return T.supportMultiChart(v);};a.supportTimeChart=function(t){if(!t){return false;}if(M.get(a.toTimeChartType(t))){return true;}};a.getDirection=function(t){var d=a.toSingleChartType(t);var e=a.toVizProperties(d);if(e.vizDirection){return e.vizDirection;}return null;};a.getStacking=function(t){var d=a.toSingleChartType(t);var e=a.toVizProperties(d);if(e.vizStacking){return e.vizStacking;}return null;};a.changeDirection=function(t,d){var e=a.toSingleChartType(t);var f=a.getDirection(e);if(f===d||!f){return t;}var s=a.getStacking(e);var n=a.fromVizProperties(e,d,s);if(a.isMultipleChart(t)){return a.toMultiChartType(n);}return n;};a.changeStacking=function(t,s){var d=a.toSingleChartType(t);var e=a.getStacking(d);if(e===s||!e){return t;}var f=a.getDirection(d);var n=a.fromVizProperties(d,f,s);if(a.isMultipleChart(t)){return a.toMultiChartType(n);}return n;};a.getType=function(t,v){if(!t){return v;}var d=a.toSingleChartType(t);var e=a.getDirection(d);var s=a.getStacking(d);d=a.fromVizProperties(v,e,s);if(a.isMultipleChart(t)){return a.toMultiChartType(d);}return d;};a.getVizType=function(t){var d=a.toSingleChartType(t);return a.toVizProperties(d).vizType;};a.getDatasetType=function(t){if(a.isGeo(t)||I.isInfoChart(t)){return D.FLAT_TABLE;}else if(a.isTable(t)){return D.RAW;}else{return D.CROSS_TABLE;}};a.isTable=function(t){return(t===C.TYPE_TABLE||t===C.TYPE_CROSSTAB);};a.isGeo=function(t){return(t===C.TYPE_GEO_MAP);};a.isOldGeo=function(t){var o=[C.TYPE_GEO_CHOROPLETH,C.TYPE_GEO_BUBBLE,C.TYPE_GEO_PIE,C.TYPE_TRELLIS_GEO_BUBBLE,C.TYPE_TRELLIS_CHOROPLETH];return o.indexOf(t)>-1;};a.isInfoChart=function(t){if(t&&t.indexOf("info/")===0){return true;}return false;};a.isVizChart=function(t){if(t&&t.indexOf("viz/")===0){return true;}return false;};a.isPieChartType=function(t){if(t&&[C.TYPE_PIE,C.TYPE_DONUT].indexOf(t)>-1){return true;}return false;};a.isNotSupportMND=function(t){if(t&&[C.TYPE_PIE,C.TYPE_DONUT,C.TYPE_SCATTER,C.TYPE_BUBBLE].indexOf(t)>-1){return true;}return false;};a.isMekkoChart=function(t){if(t&&t.indexOf("mekko")>-1){return true;}return false;};a.validDynamicSeriesType=function(t){var s=['info/combination','info/horizontal_combination'];return s.indexOf(t)>-1;};a.supportTitle=function(t){if(a.isGeo(t)){return false;}else{return true;}};a.isValid=function(t){var d=M.get(t);return!!d;};a.isBuildInType=function(t){var d=M.get(t);return!!d&&!!d.isBuiltIn();};a.supportAnimation=function(t){var s=false;if(t===C.TYPE_GEO_BUBBLE){s=true;}else if(a.isGeo(t)){s=false;}else{var d=M.get(t).getBindingDefs();for(var i=0;i<d.length;i++){if(d[i].id()===C.DATA_FRAME){s=true;break;}}}return s;};a.isEmptyData=function(t,d){var e=a.getDatasetType(t);if(e===D.RAW){return false;}else if(e===D.FLAT_TABLE){return!d||d.data().data.length===0;}else{var f=d?(d.data()?d.data().analysisAxis:null):null;var g=d?(d.data()?d.data().measureValuesGroup:null):null;if((!f||f&&f.length===0)&&(!f||g&&g.length===0)){return true;}}return false;};a.getCategoryAxis=function(t){if(t==='info/bar'||t==='info/dual_bar'||t==='info/horizontal_line'||t==='info/stacked_bar'||t==='info/100_stacked_bar'||t==='info/trellis_bar'||t==='info/trellis_dual_bar'||t==='info/trellis_horizontal_line'||t==='info/trellis_stacked_bar'||t==='info/trellis_100_stacked_bar'){return['yAxis'];}else{return['xAxis'];}};a.getValueAxis=function(t){if(t==='info/bar'||t==='info/dual_bar'||t==='info/horizontal_line'||t==='info/stacked_bar'||t==='info/100_stacked_bar'||t==='info/trellis_bar'||t==='info/trellis_dual_bar'||t==='info/trellis_horizontal_line'||t==='info/trellis_stacked_bar'||t==='info/trellis_100_stacked_bar'){return['xAxis'];}else{return['yAxis'];}};a.isHorizontal=function(t){switch(t){case'info/bar':case'info/dual_bar':case'info/horizontal_line':case'info/stacked_bar':case'info/100_stacked_bar':case'info/trellis_bar':case'info/trellis_dual_bar':case'info/trellis_horizontal_line':case'info/trellis_stacked_bar':case'info/trellis_100_stacked_bar':case'viz/horizontal_area':case'viz/100_horizontal_area':case'viz/dual_horizontal_combination':case'viz/multi_horizontal_area':case'viz/multi_100_horizontal_area':case'info/dual_horizontal_line':case'info/horizontal_combination':case'info/horizontal_mekko':case'info/100_horizontal_mekko':return true;default:return false;}};a.getDataLabelValueVisibleTypes=function(t){switch(t){case'info/bar':case'info/dual_bar':return['value','valueAndColor'];default:return['value'];}};a.isDataLabelValueVisible=function(t,d,e){if(d===true){var f=a.getDataLabelValueVisibleTypes(t);return e?f.indexOf(e)>=0:false;}else{return d;}};a.updateDataLabelType=function(t,d,s){if(s===true){switch(t){case'info/bar':case'info/dual_bar':{switch(d){case'color':case'valueAndcolor':return"valueAndcolor";default:return"value";}}}}else if(s===false){switch(t){case'info/bar':case'info/dual_bar':{switch(d){case'color':case'valueAndcolor':return"color";default:return d;}}}}return d;};var _={"h:xAxis":"valueAxis","h:xAxis2":"valueAxis2","h:yAxis":"categoryAxis","h:yAxis2":"categoryAxis2","v:yAxis":"valueAxis","v:yAxis2":"valueAxis2","v:xAxis":"categoryAxis","v:xAxis2":"categoryAxis2","s:xAxis":"valueAxis","s:yAxis":"valueAxis2","mh:xAxis":"valueAxis","mh:yAxis":"categoryAxis","mh:yAxis2":"valueAxis2","mv:yAxis":"valueAxis","mv:xAxis":"categoryAxis","mv:xAxis2":"valueAxis2"},b={"h:valueAxis":"xAxis","h:valueAxis2":"xAxis2","h:categoryAxis":"yAxis","h:categoryAxis2":"yAxis2","v:categoryAxis":"xAxis","v:categoryAxis2":"xAxis2","v:valueAxis":"yAxis","v:valueAxis2":"yAxis2","s:valueAxis":"xAxis","s:valueAxis2":"yAxis","mh:valueAxis":"xAxis","mh:valueAxis2":"yAxis2","mh:categoryAxis":"yAxis","mv:valueAxis":"yAxis","mv:valueAxis2":"xAxis2","mv:categoryAxis":"xAxis"};function m(d,n,v){var p;if(a.isHorizontal(v)){p=a.isMekkoChart(v)?"mh:":"h:";}else{p=a.isMekkoChart(v)?"mv:":"v:";}if(v==="info/scatter"||v==="info/bubble"){p="s:";}return d[p+n]||n;}a.map2semanticAxis=function(n,v){return m(_,n,v);};a.map2directionAxis=function(n,v){return m(b,n,v);};a.isFullStacking=function(t){if((/\/100_/).test(t)){return true;}else{return false;}};a.isDual=function(t){if((/dual/).test(t)){return true;}else{return false;}};a.isCategoryAxis=function(t,d){if(t==='info/bar'||t==='info/dual_bar'||t==='info/horizontal_line'||t==='info/stacked_bar'||t==='info/100_stacked_bar'){return d==='yAxis'?true:false;}else{return d==='xAxis'?true:false;}};a.isSupportMorphing=function(t){if(t===C.TYPE_TREE||t===C.TYPE_NETWORK||t===C.TYPE_TABLE||t===C.TYPE_FUNNEL||t===C.TYPE_PC||t===C.TYPE_NUMBER||t===C.TYPE_GEO_BUBBLE||t===C.TYPE_GEO_CHOROPLETH||t===C.TYPE_GEO_MAP){return false;}else if(!a.isBuildInType(t)){return false;}else{return true;}};a.getChartId=function(t){if(a.isInfoChart(t)){return t.replace('info/','');}else{return t.replace('viz/','');}};a.isSuggestMND=function(t){switch(t){case C.TYPE_TRELLIS_BUBBLE:case C.TYPE_TRELLIS_SCATTER:return false;default:return true;}};var c={"categoryAxis.labelRenderer.categoryAxisLabelRenderer":[C.TYPE_BAR,C.TYPE_COLUMN,C.TYPE_DUAL_BAR,C.TYPE_DUAL_COLUMN,C.TYPE_LINE,C.TYPE_HORIZONTAL_LINE,C.TYPE_DUAL_LINE,C.TYPE_DUAL_HORIZONTAL_LINE,C.TYPE_COMBINATION,C.TYPE_HORIZONTAL_COMBINATION,C.TYPE_STACKED_BAR,C.TYPE_STACKED_COLUMN,C.TYPE_100_STACKED_BAR,C.TYPE_100_STACKED_COLUMN,C.TYPE_MEKKO,C.TYPE_100_MEKKO,C.TYPE_HORIZONTAL_MEKKO,C.TYPE_100_HORIZONTAL_MEKKO],"plotArea.markerRenderer.dataPointRenderer":[C.TYPE_COMBINATION,C.TYPE_HORIZONTAL_COMBINATION],"plotArea.markerRenderer.barShapeRenderer":[C.TYPE_BAR,C.TYPE_COLUMN,C.TYPE_DUAL_BAR,C.TYPE_DUAL_COLUMN],"plotArea.markerRenderer.lineMarkerRenderer":[C.TYPE_LINE,C.TYPE_HORIZONTAL_LINE,C.TYPE_DUAL_LINE,C.TYPE_DUAL_HORIZONTAL_LINE],"plotArea.dataLabel.renderer":[C.TYPE_BAR,C.TYPE_COLUMN,C.TYPE_DUAL_BAR,C.TYPE_DUAL_COLUMN,C.TYPE_LINE,C.TYPE_HORIZONTAL_LINE,C.TYPE_DUAL_LINE,C.TYPE_DUAL_HORIZONTAL_LINE,C.TYPE_PIE,C.TYPE_DONUT,C.TYPE_COMBINATION,C.TYPE_HORIZONTAL_COMBINATION,C.TYPE_SCATTER,C.TYPE_BUBBLE,C.TYPE_TREEMAP,C.TYPE_TRELLIS_BAR,C.TYPE_TRELLIS_LINE,C.TYPE_TRELLIS_HORIZONTAL_LINE,C.TYPE_TRELLIS_COLUMN,C.TYPE_TRELLIS_DUAL_COLUMN,C.TYPE_TRELLIS_DUAL_LINE,C.TYPE_TRELLIS_DUAL_HORIZONTAL_LINE,C.TYPE_TRELLIS_DUAL_BAR,C.TYPE_TRELLIS_SCATTER,C.TYPE_TRELLIS_BUBBLE,C.TYPE_TRELLIS_100_STACKED_COLUMN,C.TYPE_TRELLIS_STACKED_COLUMN,C.TYPE_TRELLIS_STACKED_BAR,C.TYPE_TRELLIS_100_STACKED_BAR,C.TYPE_TRELLIS_PIE,C.TYPE_TRELLIS_DONUT,C.TYPE_STACKED_BAR,C.TYPE_STACKED_COLUMN,C.TYPE_100_STACKED_BAR,C.TYPE_100_STACKED_COLUMN,C.TYPE_MEKKO,C.TYPE_100_MEKKO,C.TYPE_HORIZONTAL_MEKKO,C.TYPE_100_HORIZONTAL_MEKKO],"plotArea.dimensionLabel.renderer":[C.TYPE_TREEMAP],"plotArea.markerRenderer.bubbleMarkerRenderer":[C.TYPE_BUBBLE,C.TYPE_TRELLIS_BUBBLE],"plotArea.markerRenderer.scatterMarkerRenderer":[C.TYPE_SCATTER,C.TYPE_TRELLIS_SCATTER],"plotArea.markerRenderer.stackedBarShapeRenderer":[C.TYPE_STACKED_BAR,C.TYPE_STACKED_COLUMN,C.TYPE_100_STACKED_BAR,C.TYPE_100_STACKED_COLUMN,C.TYPE_MEKKO,C.TYPE_100_MEKKO,C.TYPE_HORIZONTAL_MEKKO,C.TYPE_100_HORIZONTAL_MEKKO]};a.hasCustomerRendererFor=function(r,t){var l=c[r];if(arguments.length>1){return!!l&&l.indexOf(t)>-1;}else{return!!l;}};return a;});define('sap/viz/controls/common/bindingdef/BindingDefUtils',['sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/metadata/MetadataFactory'],function(F,U,L,M){var B={};B.supportMND=function(v){var s=false;var d=M.get(v).getBindingDefs();d.forEach(function(a){s=s||(a.mndMode()!=='none');});return s;};B.equal=function(v,a){if(v===a){return true;}var m=M.get(v),b=M.get(a);if(m&&b){var d=m.getBindingDefs(),c=b.getBindingDefs();if(d.length!==c.length){return false;}var e=true;d.forEach(function(f,i,g){e=e&&f.equal(c[i]);});return e;}else{return false;}};B.has=function(v,i){return!!B.get(v,i);};B.get=function(v,i){var g;var d=M.get(v).getBindingDefs();d.forEach(function(a){if(!g&&a.id()===i){g=a;}});return g;};return B;});define('sap/viz/controls/common/feeds/FeedUtils',['require','sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/bindingdef/BindingDefUtils'],function(r,F,C,a,b,A,U,c,M,B){var d=r||d;var e={};e.hasRowOrColumn=function(f){var _=false;if(!f){return _;}for(var i=0;i<f.length;i++){var g=f[i];if(g instanceof a&&(g.id()===F.ID_TRELLIS_ROW||g.id()===F.ID_TRELLIS_COLUMN||g.id()==='multiplier')){if(g.values().length>0){_=true;break;}}}return _;};e.hasTime=function(f){var _=false;if(!f){return _;}for(var i=0;i<f.length;i++){var g=f[i];if(g.id()===F.ID_TIME_AXIS){if(g.values().length>0){_=true;break;}}}return _;};e.isEmptyFeeds=function(f){if(!f){return true;}for(var i=0;i<f.length;i++){var g=f[i];if(g){var v=g.values();if(v&&v.length>0){return false;}}}return true;};e._toMap=function(f){var m={};for(var i=0;i<f.length;i++){var g=f[i];if(!g){continue;}m[g.id()]={'index':i,'item':g};}return m;};e.equal=function(f,g,o){if(f===g){return true;}if(!f||!g){return false;}var i;var h=e._toMap(f);var j=e._toMap(g);var k;for(k in h){if(h.hasOwnProperty(k)){var l=h[k].item;var m=l.values();var n=j[k]?j[k].item:null;var p=j[k]?n.values():null;delete j[k];if(!n){if(m.length>0){return false;}}else{if(p.length!==m.length){return false;}else{var q;var s=e._toMap(m);var t=e._toMap(p);for(var u in s){if(s.hasOwnProperty(u)){if(t[u]===undefined){return false;}else if(s[u].index!==t[u].index){return false;}else if(!s[u].item.equal(t[u].item,o)){return false;}}}}}}}for(k in j){if(j.hasOwnProperty(k)){var v=j[k].item;var w=v.values();if(w.length>0){return false;}}}return true;};e.cloneFeeds=function(f){if(!f){return f;}if(f.length===0){return[];}var g=[];for(var i=0;i<f.length;i++){var h=f[i];g.push(h.clone());}return g;};e.removeRowAndColumnFeedItems=function(f){f=e.cloneFeeds(f);e._removeFeed(f,function(g){return g.id()===F.ID_TRELLIS_ROW||g.id()===F.ID_TRELLIS_COLUMN||g.id()==='multiplier';});return f;};e.removeSubtotal=function(f){f=e.cloneFeeds(f);e._removeFeed(f,function(g){return g.type()===F.TYPE_SUBTOTAL||g.id()===b.ROW_SUBTOTALS;});return f;};e.removeDataFrame=function(f){f=e.cloneFeeds(f);e._removeFeed(f,function(g){return g.id()===C.DATA_FRAME;});return f;};e.getNumberOfDimensionsInColumn=function(f){var n=0;f.forEach(function(g){if(g.id()===F.ID_TRELLIS_COLUMN){var h=g.values();h.forEach(function(j){if(j.type()===A.HIERARCHY){var l=j.hierarchyLevels();for(var i=0;i<l.length;i++){n++;if(l[i].selected()){break;}}}else{n++;}});return;}});return n;};e.removeMND=function(f){if(!f){return f;}f=e.cloneFeeds(f);e._removeAnalysisObject(f,function(g,h){return A.compatible(A.MND,h.type());});return f;};e.hasMND=function(f){return e.countAnalyses(f,A.MND)>0;};e.countAnalyses=function(f,t){var n=0;for(var i=0;i<f.length;i++){var g=f[i];var v=g.values();if(t){for(var j=0;j<v.length;j++){var h=v[j];if(A.compatible(t,h.type())){n++;}}}else{n+=v.length;}}return n;};e.convertFeedType=function(f){if(f===b.GEOGRAPHY){return b.DIMENSION;}return f;};e.isGeoHierarchyFeed=function(f,g,h){var l=f?f.toLowerCase():null;var i=g?g.toLowerCase():null;var j=h?h.toLowerCase():null;return l===b.GEOGRAPHY.toLowerCase()&&i===A.HIERARCHY&&j===b.GEOGRAPHY.toLowerCase();};e.feedCompatible=function(f,g,h){var l=f?f.toLowerCase():null;var i=g?g.toLowerCase():null;var j=h?h.toLowerCase():null;if(l===b.DIMENSION.toLowerCase()){return i===A.DIMENSION||i===A.HIERARCHY||i===A.MND;}else if(l===b.SUBTOTAL.toLowerCase()){return(i===b.DIMENSION.toLowerCase()||i===A.HIERARCHY);}else if(l===b.GEOGRAPHY.toLowerCase()){return(i===A.DIMENSION||i===A.HIERARCHY)&&j===b.GEOGRAPHY.toLowerCase();}else{return l===i;}};e._getFeedsValuesMap=function(f,m){m=m!==false;var g={};for(var i=0;i<f.length;i++){var h=f[i];var j=h.id();if(m&&(j===F.ID_TRELLIS_ROW||j===F.ID_TRELLIS_COLUMN)){j='multiplier';}if(!g[j]){g[j]=h.values();}else{g[j]=g[j].concat(h.values());}}return g;};e.hasMNDInValues=function(v){return(e.indexOfMNDInValues(v)!==-1);};e.indexOfMNDInValues=function(v){if(!v||!v.length){return-1;}var f=-1;for(var i=0;i<v.length;i++){var g=v[i];if(g.type()===A.MND){f=i;break;}}return f;};e.match=function(t,f,s){if(!s&&c.supportMultiChart(t)){var g=c.toSingleChartType(t);var m=c.toMultiChartType(t);return e.match(g,f,true)||e.match(m,f,true);}else{var h=e._getFeedsValuesMap(f,false);var i;for(i in h){if(h.hasOwnProperty(i)){if(!B.has(t,i)){return false;}}}return true;}};e.buildEmptyFeeds=function(v){var m=M.get(v);var f=m.getBindingDefs();var g=[];f.forEach(function(i){var t;if(i.type()==='measure'){t=b.MEASURE;}else if(i.type()==='dimension'){t=b.DIMENSION;}g.push(new a(i.id(),t,[]));});if(v==='viz/ext/table'){var h=m.raw().allFeeds();h.forEach(function(i,j,k){if(i.type==='Subtotal'){g.push(new a(i.id,i.type,[]));}});}return g;};e.merge=function(h,f){var g=e._getFeedsValuesMap(f,false);for(var i=0;i<h.length;i++){var j=h[i];if(g[j.id()]){j.values(j.values().concat(g[j.id()]));}}return h;};e.getFeed=function(f,g){for(var i=0;i<f.length;i++){var h=f[i];if(h.id()===g){return h;}}return null;};e.getFeedValues=function(f,i){var g=e.getFeed(f,i);return g?g.values():null;};e.removeAnalysisObjectByID=function(f,g,h){e._removeAnalysisObject(f,function(i,j){return i.id()===g&&j.id()===h;});return f;};e.spliceAnalysisObjects=function(f,g,i,h,j,k){var l=Array.prototype.slice.call(arguments,2);var s=false;f.forEach(function(n){if(n.id()===g){var v=n.values()||[];v.splice.apply(v,l);s=true;}});if(!s&&j){var m=A.compatible('dimension',j.type())?b.DIMENSION:b.MEASURE;var v=[];v.splice.apply(v,l);f.push(new a(g,m,v));}return f;};e.indexOfAnalysisObjectsByType=function(f,g,t){for(var i=0;i<f.length;i++){var h=f[i],v=h.values();if(h.id()!==g){continue;}for(var j=0;j<v.length;j++){if(A.compatible(t,v[j].type())){return j;}}}return-1;};e.adaptChartType=function(f,g){if(c.isGeo(g)||c.isTable(g)){return g;}return e.hasRowOrColumn(f)?c.toMultiChartType(g):c.toSingleChartType(g);};e._removeFeed=function(f,g){if(!f){return f;}for(var i=0;i<f.length;i++){var h=f[i];if(g(h)){f.splice(i,1);--i;}}return f;};e._removeAnalysisObject=function(f,g){if(!f){return f;}f.forEach(function(h){var v=h.values()||[];for(var i=0;i<v.length;i++){var j=v[i];if(g(h,j)){v.splice(i,1);--i;}}});return f;};return e;});define('sap/viz/controls/common/filter/FilterHelper',['jquery','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/DateRangeFilter','sap/viz/controls/common/filter/NumericRangeFilter','sap/viz/controls/common/filter/ValueFilter','sap/viz/controls/common/constants/FeedConst'],function($,u,A,F,a,b,D,N,V,c){var d={};d.getMapFilterItems=function(s,i,f,e){return g(s,i,f,e,true);};d._getAnalysisObject=function(e,f){for(var i=0;i<f.length;i++){if(f[i].type()!==F.DIMENSION){continue;}var h=f[i].values();for(var j=0;j<h.length;j++){if(h[j].id()===e){return h[j];}}}return null;};d.getFilterInfo=function(e){var n=e.name();var i=e.id();if(e.type()===A.HIERARCHY){var s=e.selectedHierarchyLevel();n=s.name();i=s.analysis().id();return{name:n,id:i,hierarchyLevelId:s.id(),hierarchyInfo:d._buildFilterHierarchyInfo(e)};}return{name:n,id:i};};d._buildFilterHierarchyInfo=function(e){var h=null;if(e.type()===A.HIERARCHY){h={hierarchyId:e.id(),levels:d._buildFilterHierarchyLevels(e.hierarchyLevels())};}return h;};d.getInfoFilterItems=function(s,i,f,e){return g(s,i,f,e,false);};function g(s,e,f,h,l){if(!s||s.length<1||!h||h.length<1){return f;}var p=[];var o=l?h.map(a.cloneFeeds,a):a.cloneFeeds(h);var m;for(var i=0;i<s.length;++i){var q=l?o[s[i].layerIndex]:o;if(!q){continue;}for(var j=0;j<q.length;j++){if(q[j].type()!==F.DIMENSION){continue;}if(q[j].id()===c.ID_DATAFRAME){continue;}var r=q[j].values();for(var k=0;k<r.length;k++){var t=r[k];if(t.type()===A.MND){continue;}var v=d.getFilterInfo(t);var w={};if(t.type()=='hierarchy'){w.value=s[i].data[t.selectedHierarchyLevel().id()];w.display=s[i].data[t.selectedHierarchyLevel().id()+".d"];}else{w.value=s[i].data[t.id()];w.display=s[i].data[t.id()+".d"];}var x=false;for(var n=0;n<p.length;++n){if(p[n].filterInfo.id===v.id&&p[n].filterInfo.hierarchyLevelId===v.hierarchyLevelId){x=true;var y=false;for(m=0;m<p[n].values.length;m++){if(p[n].values[m].value===w.value){y=true;}}if(!y){p[n].values.push(w);}break;}}if(!x){p.push({filterInfo:v,values:[w]});}}}}var z=f.slice(0);for(m=0;m<p.length;m++){var B=d._getFilter(z,p[m].filterInfo.id,p[m].filterInfo.hierarchyLevelId);if(B){z=d._updateFilterItem(z,B,p[m].values,e);}else{z=d._addFilterItem(z,p[m].filterInfo,p[m].values,e);}}return z;}d.getFilterItems=function(s,e,f,h,k,l){if(!s||s.length===0){return f;}var m=k.data();var n=k.info('additionalData');var i;var o=a.cloneFeeds(h);var p=false;for(i=0;i<l.length;i++){if(l[i].feedId==='multiplier'&&l[i].binding.length>0){p=true;break;}}if(p){o=d._getFilterFeeds(o);}var q=[],r=[],t=[],v;for(i=0;i<o.length;i++){if(o[i].type()!==F.DIMENSION){continue;}v=d._findAAIndex(o[i].id(),l);var w=o[i].values();var x=0;for(var j=0;j<w.length;j++){q.push(d.getFilterInfo(w[j]));if(w[j].type()===A.MND){r.push(-1);t.push(-1);}else{r.push(v);t.push(x);x++;}}}f=f.slice(0);var y={};for(i=0;i<q.length;i++){var z=q[i];v=r[i];if(v<0){continue;}if(!y[v]){y[v]=0;}var B=d._pathsIndex(z.hierarchyInfo);var C=d._getAADataLength(m,v);if(B>0&&B<C){y[v]+=B;}var E=d._getFilterValues(m,n,s,v,z.name,t[i]+y[v],z.hierarchyInfo);if(!E||E.length===0){continue;}var G=d._getFilter(f,z.id,z.hierarchyLevelId);if(G){f=d._updateFilterItem(f,G,E,e);}else{f=d._addFilterItem(f,z,E,e);}}return f;};d._getFilterFeeds=function(f){var n;var v=[];for(var i=f.length-1;i>=0;i--){if(f[i].id().indexOf('trellis')===0){v=v.concat(f[i].values().reverse());n=f[i];f.splice(i,1);}}n.values(v.reverse());n._id='multiplier';f.push(n);return f;};d._excludeFilterValues=function(f,v){var e=f.values().slice(0);var i,n;if(f.isExcluded()){for(i=0;i<v.length;i++){var h=false;for(n=0;n<e.length;n++){if(d._filterValueEquals(v[i],e[n])){h=true;break;}}if(!h){e.push(v[i]);}}}else{for(i=0;i<v.length;i++){for(n=0;n<e.length;n++){if(d._filterValueEquals(v[i],e[n])){e.splice(n,1);break;}}}}f.updateValues(e);};d._updateFilterItem=function(f,e,v,i){if(i){d._excludeFilterValues(e,v);}else{e.isExcluded(i);e.updateValues(v);}if(e.isEmpty()){var h=f.indexOf(e);f.splice(h,1);}return f;};d._getFilterValues=function(e,f,s,h,j,k,l){var v=[];for(var i in s){var m=s[i];var n=m.ctx[0]['dii_a'+h];var o=d._getValue(e,h,j,k,n);if(!o){continue;}var p=d._getInfoValue(e,f,h,j,k,n);var q;q={'value':o,'infoValue':p};if(!d._isValueExisted(v,q)){v.push(q);}}return v;};d._getAADataLength=function(e,f){var l=0;var r=e;var i=f-1;if(r&&r.analysisAxis&&r.analysisAxis[i]){var h=r.analysisAxis[i].data;if(h){l=h.length;}}return l;};d._pathsIndex=function(h){if(h&&h.levels){var l=h.levels;for(var i in l){if(l[i].selected===true){return Number(i);}}}return-1;};d._addFilterItem=function(f,i,v,e){var h=new V(i.id,i.name);h.hierarchyLevelId=i.hierarchyLevelId;h.updateValues(v);h.isExcluded(e);f.push(h);return f;};d._buildFilterHierarchyLevels=function(h){var l=[];if(h&&h.length>0){for(var i in h){var e={id:h[i].id(),name:h[i].name(),selected:h[i].selected()};l.push(e);}}return l;};d._filterValueEquals=function(v,e){if(!v&&!e){return true;}if((!v&&e)||(v&&!e)){return false;}if(v.value!==e.value){return false;}if(v.infoValue===e.infoValue){return true;}if(v.infoValue==null||e.infoValue==null){return true;}if(u.isFunction(v.infoValue.equals)){return v.infoValue.equals(e.infoValue);}else if(v.infoValue.hasOwnProperty('key')){return v.infoValue.key===e.infoValue.key;}else{return true;}};d._isValueExisted=function(e,f){var v=f.value;var h=f.infoValue;var j=false;if(!e||e.length===0){return j;}for(var i=0;i<e.length;i++){if(e[i]){j=d._filterValueEquals(e[i],f);if(j===true){break;}}}return j;};d._getFilter=function(f,e,h){var r=null;for(var i=0;i<f.length;i++){var j=f[i];if(!j.isGlobalFilter()&&j.id()===e&&(j.hierarchyLevelId==h)){r=j;break;}}return r;};d.isFilterItemExisted=function(m,i,h){var f=d._getFilter(m.filterItems(),i,h);if(f){return true;}else{return false;}};d.toJSON=function(i){return u.toJSON(i,function(i){return i.toJSON();});};d.fromJSON=function(j){return u.fromJSON(j,function(j){var f=j.filterType;var i;switch(f){case b.VALUE_TYPE:i=V.fromJSON(j);break;case b.NUMERIC_RANGE_TYPE:i=N.fromJSON(j);break;case b.DATE_RANGE_TYPE:i=D.fromJSON(j);break;}return i;});};d._findAAIndex=function(f,e){for(var i=0;i<e.length;i++){if(e[i].feedId===f){var h=e[i].binding;for(var j=0;j<h.length;j++){var k=h[j];if(k.index!=null){return k.index;}}}}return-1;};d._searchDimension=function(e,f,h,k,l){var m=f.analysisAxis;var n=0;for(var i=0;i<m.length;i++){var o=m[i];if(h===o.index){for(var j=0;j<o.data.length;j++){var p=o.data[j];var q=isNaN(l)?p.name===k:l===j;if(q){e(p,j,n);}n++;}}else{n+=o.data.length;}}};d._getValue=function(e,f,h,i,j){var v=null;d._searchDimension(function(k,i,l){v=k.values[j];},e,f,h,i);return v;};d._getInfoValue=function(e,f,h,j,k,l){var m=null;if(f&&f.length){for(var i=0;i<f.length;i++){var n=f[i];if(n.type!=='additionalData'){continue;}var o=n.info;d._searchDimension(function(p,k,q){m=o[q].infoValues[l];},e,h,j,k);return m;}}return m;};return d;});define('sap/viz/controls/common/utils/VizFeedingUtil',['jquery','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/utils/Utils'],function($,C,F,A,a,U){var V={};V.generate=function(f,v){var d=V.feedItems2feed(f);return _(v,d);};V.feedItems2feed=function(f){var d=[];f.forEach(function(e){var v=e.values();if(v.length>0){for(var i=0;i<v.length;++i){var g=v[i];var h={'feed':(e.id()===F.ID_TRELLIS_ROW||e.id()===F.ID_TRELLIS_COLUMN)?'multiplier':e.id()};if(g.type()===A.HIERARCHY){var k=g.hierarchyLevels();for(var j=0;j<k.length;j++){var l=k[j];if(l.selected()){h.objId=l.id();}}if(g.aggregationType()){h.aggregationType=g.aggregationType();}}else{if(g.type()===A.MND){h.objId=null;}else{if(g.aggregationType()){h.aggregationType=g.aggregationType();if(g.aggregationTarget()){h.objId=g.aggregationTarget();}else{h.objId=U.decode(g.id())[0];}}else{h.objId=g.id();}}}d.push(h);}}});return d;};var _=function(v,f){var d;try{d=sap.viz.api.manifest.Viz.get(v)[0].allFeeds();}catch(e){d=sap.viz.api.metadata.Viz.get(v).bindings;}var g=[];var m=[];var h=[];for(var i=0;i<d.length;i++){var l=d[i].id;var n=d[i].type;var o=[];for(var j=0;j<f.length;j++){if(f[j].feed==l){o.push(f[j]);}}if(o.length>0){var p={};p.feedId=l;p.binding=[];var q=0;for(var k=0;k<o.length;k++){if(o[k].objId!=null){if(n===a.DIMENSION){if($.inArray(d[i].aaIndex,g)==-1){p.binding[q]={};p.binding[q].type=C.ANALYSIS_AXIS;p.binding[q].index=d[i].aaIndex;g.push(d[i].aaIndex);q++;}}else{if($.inArray(d[i].mgIndex,m)==-1){p.binding[q]={};p.binding[q].type=C.MEASURE_VALUES_GROUP;p.binding[q].index=d[i].mgIndex;m.push(d[i].mgIndex);q++;}}}else if(n===a.DIMENSION){p.binding[q]={};p.binding[q].type=C.MEASURE_NAMES_DIMENSION;q++;}}h.push(p);}}g.sort();m.sort();b(h,g);c(h,m);return h;};var b=function(d,e){var j,f,k;if(e.length>0){f=e[0]-1;if(f>0){for(j=0;j<d.length;j++){for(k=0;k<d[j].binding.length;k++){if(d[j].binding[k].type==C.ANALYSIS_AXIS&&d[j].binding[k].index!=null&&d[j].binding[k].index>1){d[j].binding[k].index-=f;}}}for(j=0;j<e.length;j++){e[j]-=f;}}}for(var i=0;i<e.length-1;i++){f=e[i+1]-e[i]-1;if(f>0){for(j=0;j<d.length;j++){for(k=0;k<d[j].binding.length;k++){if(d[j].binding[k].type==C.ANALYSIS_AXIS&&d[j].binding[k].index!=null&&d[j].binding[k].index>e[i]){d[j].binding[k].index-=f;}}}for(j=i+1;j<e.length;j++){e[j]-=f;}}}};var c=function(d,m){var j,e;if(m.length>0){e=m[0]-1;if(e>0){for(j=0;j<d.length;j++){if(d[j].binding[0].type==C.MEASURE_VALUES_GROUP&&d[j].binding[0].index!=null&&d[j].binding[0].index>1){d[j].binding[0].index-=e;}}for(j=0;j<m.length;j++){m[j]-=e;}}}for(var i=0;i<m.length-1;i++){e=m[i+1]-m[i]-1;if(e>0){for(j=0;j<d.length;j++){if(d[j].binding[0].type==C.MEASURE_VALUES_GROUP&&d[j].binding[0].index!=null&&d[j].binding[0].index>m[i]){d[j].binding[0].index-=e;}}for(j=i+1;j<m.length;j++){m[j]-=e;}}}};return V;});define('sap/viz/controls/common/utils/FakeDataUtils',['jquery','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/VizFeedingUtil'],function($,C,A,F,L,U,a,V){var b={};b.fakeDimensionName="abc";b.buildFakeData=function(v,f,d){var c=V.generate(f,v);return b._buildFake(v,c,d);};b.buildFakeFeeding=function(v,f,d){f=b._buildFake(v,f,d).feeding;f=b._buildMNDFeedings(f,v);return f;};b._getMNDfeed=function(f,c){if(!c){return;}var m={priority:-1};for(var i=0;i<f.length;i++){var I=f[i].id;var d=f[i];var e=U.isNumber(d.acceptMND)?Number(d.acceptMND):-1;var g=false;for(var j=0;j<c.length;j++){if(c[j].feedId==I){if(c[j].binding.length>0){for(var k=0;k<c[j].binding.length;k++){if(c[j].binding[k].type==C.MEASURE_NAMES_DIMENSION){return I;}}}if(c[j].binding.length<d.min){if(e>m.priority){m={feedId:I,priority:d.acceptMND};}}g=true;break;}}if(!g){if(d.min>0&&e>=0){m={feedId:I,priority:d.acceptMND};}}}return m.feedId;};b._validateInput=function(f,d){var c=0;if(d&&d.analysisAxis){c=d.analysisAxis.length;}var m=0;if(d&&d.measureValuesGroup){m=d.measureValuesGroup.length;}for(var i=0;i<f.length;i++){var e=f[i];if(e.binding){for(var j=0;j<e.binding.length;j++){var g=e.binding[j].index;var t=e.binding[j].type;if(t==C.ANALYSIS_AXIS&&(g>c)){return false;}else if(t==C.MEASURE_VALUES_GROUP&&(g>m)){return false;}}}}return true;};b._buildFake=function(v,r,c){if(!b._validateInput(r,c)){c.analysisAxis=[];c.measureValuesGroup=[];return{"feeding":r,"dataset":c};}var d=sap.viz.api.manifest.Viz;var e=d.get(v)[0];var f=e.allFeeds();var g=e.id;var m=b._getMNDfeed(f,r);var h=[];var l=[];var i,j;for(i=0;i<f.length;i++){if(f[i].id==m){continue;}var n=b._getFakeToBeBuilt(f[i],r,c);if(n.nb>0){if(n.axisIndex!=null){h.push(n);}else if(n.mgIndex!=null){l.push(n);}}}if(c.analysisAxis==null){c.analysisAxis=[];}for(i=0;i<h.length;i++){var o=h[i];var p=null;for(j=0;j<c.analysisAxis.length;j++){if(c.analysisAxis[j].index==o.axisIndex){p=c.analysisAxis[j];}}if(p==null){p={};p.data=[];p.index=o.axisIndex;c.analysisAxis.push(p);}var q={};q.type=F.DIMENSION;if(h.length>1){q.name=L.get('VIZ_COMMON_FAKE_DIMENSION')+(i+1);}else{q.name=L.get('VIZ_COMMON_FAKE_DIMENSION');}q.isFake=true;var s=false;for(j=0;j<c.analysisAxis.length;j++){if(c.analysisAxis[j].data[0]!=null&&c.analysisAxis[j].data[0].values.length>0){s=true;}else{s=false;}}if(s||i>0){if(g===C.TYPE_TREE||g===C.TYPE_NETWORK){q.values=b._buildFakeDimensionValues(p.data[0].values.length);}else{q.values=b._buildFakeDimensionValues(1);}}else{var t=10;if(c.measureValuesGroup!=null&&c.measureValuesGroup[0]!=null){t=c.measureValuesGroup[0].data[0].values.length;}q.values=b._buildFakeDimensionValues(t);if(b._isGeoOrNor(v)){q.infos=b._buildFakeGeoInfos(t);}}p.data.push(q);}if(c.measureValuesGroup==null){c.measureValuesGroup=[];}var u=b._sortAxes(f,c,r);if(u){b._swapMeasure(c);}for(i=0;i<l.length;i++){var w=l[i];var x=null;for(j=0;j<c.measureValuesGroup.length;j++){if(c.measureValuesGroup[j].index==w.mgIndex){x=c.measureValuesGroup[j];}}if(x==null){x={};x.data=[];x.index=w.mgIndex;c.measureValuesGroup.push(x);}for(var k=0;k<w.nb;k++){var y={};y.type=F.MEASURE;if(w.nb>1||l.length>1){y.name=L.get('VIZ_COMMON_FAKE_MEASURE')+(i+k+1);}else{y.name=L.get('VIZ_COMMON_FAKE_MEASURE');}y.isFake=true;var z=[];for(j=c.analysisAxis.length-1;j>=0;j--){z.push(c.analysisAxis[j].data[0].values.length);}if(z.length===0){z=[1];}var B=b._buildFakeMeasureValues(z);if(!Array.isArray(B[0])){B=[B];}y.values=B;x.data.push(y);}}return{"feeding":r,"dataset":c};};b._sortAxes=function(f,r,c){var d={},i,j,e,g,h;if(r.analysisAxis.length>1){for(i=0;i<f.length;i++){var l=f[i];if(l.type===F.DIMENSION){for(j=0;j<c.length;j++){if(c[j].feedId===l.id){g=l.aaIndex;h=c[j].binding;for(var m=0;m<h.length;m++){if(h[m]&&h[m].type==C.ANALYSIS_AXIS){var o=h[m].index;for(var n=0;n<r.analysisAxis.length;n++){if(r.analysisAxis[n].index===o){d[n]=g;break;}}}}}}}}}var p=false;for(i=0;i<r.analysisAxis.length;i++){for(j=r.analysisAxis.length-1;j>=i+1;j--){if(d[j]<d[j-1]){e=r.analysisAxis[j];r.analysisAxis[j]=r.analysisAxis[j-1];r.analysisAxis[j-1]=e;p=true;}}}var q=U.clone(c);for(i=0;i<r.analysisAxis.length;i++){e=r.analysisAxis[i];g=i+1;for(j=0;j<q.length;j++){h=q[j].binding;for(var k=0;k<h.length;k++){if(h[k]&&h[k].type==C.ANALYSIS_AXIS&&h[k].index==e.index){c[j].binding[k].index=g;}}}e.index=g;}return p;};b._swapMeasure=function(r){var j;var c=r.measureValuesGroup;if(c){for(var m=0;m<c.length;m++){var d=c[m].data;if(d){for(var n=0;n<d.length;n++){var e=d[n];var l=e.values.length;var f=e.values[0].length;var g=new Array(f);for(j=0;j<f;j++){g[j]=new Array(l);}for(var i=0;i<l;i++){for(j=0;j<f;j++){g[j][i]=e.values[i][j];}}e.values=g;}}}}};b._getFakeToBeBuilt=function(f,r,c){var d=f.min;if(f.id==="treeNode"||f.id==="link"){d=f.minStackedDims;}if(d===0){return{"nb":0};}var n=0;var i,j,k,e;for(i=0;i<r.length;i++){var g=null;var m=null;if(f.id==r[i].feedId){if(f.type==F.DIMENSION){var h=r[i].binding;for(k=0;k<h.length;k++){if(h[k].index){g=h[k].index;}}if(g!==null){if(!c.analysisAxis.length){return{"nb":0,"axisIndex":g};}else{for(j=0;j<c.analysisAxis.length;j++){if(c.analysisAxis[j].index==g){n=c.analysisAxis[j].data.length;e=d-n;if(e<0){e=0;}return{"nb":e,"axisIndex":g};}}}}else{return{"nb":0};}}else if(f.type==F.MEASURE){m=r[i].binding[0].index;for(j=0;j<c.measureValuesGroup.length;j++){if(c.measureValuesGroup[j].index==m){n=c.measureValuesGroup[j].data.length;e=d-n;if(e<0){e=0;}return{"nb":e,"mgIndex":m};}}return{"nb":0,"mgIndex":m};}}}var l;if(f.type==F.DIMENSION){var o=1;for(i=0;i<r.length;i++){for(k=0;k<r[i].binding.length;k++){if(r[i].binding[k].type==C.ANALYSIS_AXIS&&r[i].binding[k].index>=o){o=r[i].binding[k].index+1;}}}l={};l.feedId=f.id;l.binding=[];l.binding[0]={};l.binding[0].type=C.ANALYSIS_AXIS;l.binding[0].index=o;r.push(l);return{"nb":d,"axisIndex":o};}else if(f.type==F.MEASURE){var p=1;for(i=0;i<r.length;i++){if(r[i].binding[0].type==C.MEASURE_VALUES_GROUP&&r[i].binding[0].index>=p){p=r[i].binding[0].index+1;}}l={};l.feedId=f.id;l.binding=[];l.binding[0]={};l.binding[0].type=C.MEASURE_VALUES_GROUP;l.binding[0].index=p;r.push(l);return{"nb":d,"mgIndex":p};}return null;};b._buildFakeMeasureValues=function(c){var v=[];var d=c[0];var i=0;if(c.length==1){for(i=0;i<d;i++){v[i]=Math.round(Math.random()*100);}}else{c.shift();for(i=0;i<d;i++){v[i]=b._buildFakeMeasureValues(c);}}return v;};b._buildFakeDimensionValues=function(n){var d=[];for(var i=0;i<n;i++){d[i]=b.fakeDimensionName+(i+1);}return d;};b._buildFakeGeoInfos=function(n){var f=[];for(var i=0;i<n;i++){f[i]='';}return f;};b._isGeoOrNor=function(t){if(t.search('geo')==-1&&t.search('choropleth')==-1){return false;}else{return true;}};b._buildMNDFeedings=function(f,t){if(!f){return;}var c=sap.viz.api.manifest.Viz;var d=c.get(t)[0];var e=d.allFeeds();var m={feedId:null,index:-1,priority:-1};for(var i=0;i<e.length;i++){var I=e[i].id;var g=e[i];var h=false;for(var j=0;j<f.length;j++){if(f[j].feedId===I){if(f[j].binding.length<g.min){if(b.canAcceptMND(g.acceptMND)){m={feedId:I,index:j,priority:g.acceptMND};}}h=true;break;}}if(!h){if(g.min>0&&b.canAcceptMND(g.acceptMND)){m={feedId:I,index:-1,priority:g.acceptMND};}}}var k=f;if(k&&m.index>=0){k[m.index].binding.push({"type":C.MEASURE_NAMES_DIMENSION});}else if(k&&m.feedId){k.push({binding:[{"type":C.MEASURE_NAMES_DIMENSION}],feedId:m.feedId});}return k;};b.canAcceptMND=function(c){c=U.isNumber(c)?Number(c):-1;return(c>=0);};return b;});define('sap/viz/controls/common/utils/FlatTableFakeDataUtil',['sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/constants/ChartConst'],function(A,L,U,I,M,C){var F={};F.fakeDimensionName="abc";F.buildFakeData=function(e,f,r){var g=a(e,f);var i,j,k,h;var m=0;var l=0;var n=0;var o=0;for(i=0;i<g.length;i++){h=g[i].index;for(j=0;j<g[i].nb;j++){if(f[h].type()==='Dimension'){o++;}else if(f[h].type()==='Measure'){n++;}}}for(i=0;i<g.length;i++){h=g[i].index;for(j=0;j<g[i].nb;j++){if(f[h].type()==='Dimension'){l++;var p={};p.semanticType="Dimension";if(o>1){p.name=L.get('VIZ_COMMON_FAKE_DIMENSION')+l;}else{p.name=L.get('VIZ_COMMON_FAKE_DIMENSION');}p.id=L.get('VIZ_COMMON_FAKE_DIMENSION')+'_'+f[h].id()+'_'+j;p.isFake=true;r.metadata.fields.push(p);for(k=0;k<r.data.length;k++){r.data[k].push(F.fakeDimensionName+(k+1));}}else if(f[h].type()==='Measure'){m++;var q={};q.semanticType="Measure";if(n>1){q.name=L.get('VIZ_COMMON_FAKE_MEASURE')+m;}else{q.name=L.get('VIZ_COMMON_FAKE_MEASURE');}q.id=L.get('VIZ_COMMON_FAKE_MEASURE')+'_'+f[h].id()+'_'+j;q.isFake=true;r.metadata.fields.push(q);for(k=0;k<r.data.length;k++){r.data[k].push(Math.round(Math.random()*100));}}}}return r;};var _=function(f,e){var m={priority:Number.MAX_VALUE,foundInFeedItems:false};var i,j,k,g,h,l,n,o;for(i=0;i<e.length;i++){g=e[i];for(j=0;j<g.values().length;j++){l=g.values()[j];if(l.type()===A.MND){m.feedId=g.id();m.foundInFeedItems=true;return m;}}for(k=0;k<f.length;k++){h=f[k];if(h.id()===g.id()){n=h.min();if(!!n&&!!h.mndMode()&&g.values().length<n){if((h.mndMode()!='support'&&g.values().length>0)||h.mndMode()=='none'){continue;}o=h.bvrMNDPriority();if(o<m.priority){m={feedId:g.id(),priority:o};}}}}}if(!m.feedId){for(i=0;i<e.length;i++){g=e[i];for(j=0;j<g.values().length;j++){l=g.values()[j];if(l.type()===A.MND){m.feedId=g.id();m.foundInFeedItems=true;return m;}}for(k=0;k<f.length;k++){h=f[k];if(h.id()===g.id()){n=h.min();if(h.mndMode()){if((h.mndMode()!='support'&&g.values().length>0)||h.mndMode()=='none'){continue;}o=h.bvrMNDPriority();if(o<m.priority){m={feedId:g.id(),priority:o};}}}}}}return m;};var a=function(e,f){var g=M.get(e).getBindingDefs();var h=[];var m=_(g,f).feedId;for(var i=0;i<g.length;i++){var k=g[i];for(var j=0;j<f.length;j++){var l=f[j];if(l.id()===m){continue;}if(k.id()===l.id()){var n=k.min();if(!!n&&l.values().length<n){h.push({id:k.id(),index:j,nb:n-l.values().length});}break;}}}return h;};var b=function(e,f,g){var h=[];var m=c(e);for(var i=0;i<f.length;i++){var l=f[i];var v=l.values()||[];var n={'feed':l.id(),'source':[]};var o=n.source;for(var j=0;j<v.length;j++){var p=v[j];if(p.type()===A.MND){if(g){o.unshift(m);}else{o.push(m);}}else{if(p.type()===A.HIERARCHY){var q=(l.id()===C.DATA_FRAME);for(var k=0;k<p.hierarchyLevels().length;k++){var r=p.hierarchyLevels()[k];if(!q||r.selected()){o.push(r.id());}if(r.selected()){break;}}}else{o.push(p.id());}}}h.push(n);}return h;};F.buildFakeBinding=function(e,f,g){var h=b(e,f,g);var j=[];if(!!e){j=a(e,f);}if(j.length>0){for(var i=0;i<f.length;i++){var l=f[i];var m=h[i].source;var o=false;var p=0;for(var k=0;k<j.length;k++){if(l.id()===j[k].id){o=true;p=j[k].nb;break;}}if(o){for(var n=0;n<p;n++){if(l.type()==='Measure'){m.push(L.get('VIZ_COMMON_FAKE_MEASURE')+'_'+l.id()+'_'+n);}if(l.type()==='Dimension'){m.push(L.get('VIZ_COMMON_FAKE_DIMENSION')+'_'+l.id()+'_'+n);}}}}}h=d(h,e,f);return h;};var c=function(e){var f=M.get(e).getBindingDefs();var m=[];for(var i=0;i<f.length;i++){var g=f[i];if(g.mndEnumerable()&&g.min()>0){m.push(g.id());}}return{measureNames:m};};var d=function(e,f,g){if(!e){return;}var h=M.get(f).getBindingDefs();var m=c(f);var j=_(h,g);if(e&&!j.foundInFeedItems){for(var i=0;i<e.length;i++){if(e[i].feed==j.feedId){e[i].source.unshift(m);break;}}}return e;};return F;});define('sap/viz/controls/services/FakeDataService',['sap/viz/controls/common/utils/FakeDataUtils','sap/viz/controls/common/utils/FlatTableFakeDataUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/VizFeedingUtil'],function(F,a,C,V){var b=function(v,r,f){this._createChart(v,r,f);};b.feedItems2feed=function(f){return V.feedItems2feed(f);};b.prototype.getVizType=function(){return this._vizType;};b.prototype.getVizDataset=function(){return this._vizDataset;};b.prototype._createChart=function(v,r,f){this._vizType=v;if(C.isInfoChart(v)){this._vizDataset=a.buildFakeData(v,f,r);}else if(C.isGeo(v)){this._vizDataset=r;}else{var c=F.buildFakeData(v,f,r);this._vizDataset=c.dataset;this._vizFeeding=c.feeding;}};return b;});define('sap/viz/controls/common/utils/IncompleteGhost',['sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/services/FakeDataService'],function(M,C,L,a,I,F){var b={};b.getDataset=function(t){var m=M.get(t),c,e;if(!m){c=new sap.viz.api.data.CrosstableDataset();return c;}else if((!a.isBuildInType(t))&&t!==C.TYPE_PC&&t!==C.TYPE_FUNNEL&&!a.isTable(t)){var f=new F(t,{},[]);c=new sap.viz.api.data.CrosstableDataset();e=f.getVizDataset();c.data(e);return c;}else{t=a.getVizType(t);if(I.isInfoChart(t)){e=b.getDataByType(t)||b.getDataInfoCommon();c=new sap.viz.api.data.FlatTableDataset();c.data(e);return c;}else{e=b.getDataByType(t)||b.getDataCommon();if(a.isTable(t)){return e;}else{c=new sap.viz.api.data.CrosstableDataset();c.data(e);return c;}}}};b.getFeeding=function(t){if(I.isInfoChart(t)){t=a.getVizType(t);var f=b.getFeedingByType(t);return f;}else{return null;}};var d={};b.getDataCommon=function(){var r={};var c=L.get('VIZ_COMMON_FAKE_DIMENSION');var e=L.get('VIZ_COMMON_FAKE_MEASURE');var f=L.get('VIZ_COMMON_LEGEND');var g=L.get('VIZ_COMMON_ITEM');if(d["cache"]){return d["cache"];}else{r={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':c,'values':['abc1','abc2','abc3','abc4','abc5','abc6','abc7','abc8','abc9']}]},{'index':2,'data':[{'isFake':true,'type':'Dimension','name':f,'values':[g+'1',g+'2',g+'3',g+'4']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':e,'values':[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]}]},{'index':2,'data':[{'isFake':true,'type':'Measure','name':e+'1','values':[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]},{'index':3,'data':[{'isFake':true,'type':'Measure','name':e+'2','values':[[46,58,90,5,10,4,79,86,30],[56,98,20,20,7,58,39,16,23],[103,98,78,40,76,29,16,59,43],[59,80,98,8,45,16,120,97,39]]}]}]};d["cache"]=r;return r;}};b.getDataByType=function(t){var r;var c=L.get('VIZ_COMMON_FAKE_DIMENSION');var e=L.get('VIZ_COMMON_FAKE_MEASURE');var f=L.get('VIZ_COMMON_LEGEND');var g=L.get('VIZ_COMMON_ITEM');switch(t){case C.TYPE_DUAL_COMBINATION:r={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':c,'values':['abc1','abc2','abc3','abc4','abc5','abc6','abc7','abc8','abc9']}]},{'index':2,'data':[{'isFake':true,'type':'Dimension','name':f,'values':[g+'1']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':e+'1','values':[[98,113,105,29,53,31,48,51,58]]}]},{'index':2,'data':[{'isFake':true,'type':'Measure','name':e+'2','values':[[57,110,27,61,28,74,50,32,65]]}]}]};break;case C.TYPE_PIE_WITH_DEPTH:case C.TYPE_FUNNEL:r={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':f,'values':[g+'1',g+'2',g+'3',g+'4',g+'5',g+'6',g+'7',g+'8',g+'9']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':e+'1','values':[[98,113,105,29,53,31,48,51,58]]}]},{'index':2,'data':[{'isFake':true,'type':'Measure','name':e+'2','values':[[57,110,27,61,28,74,50,32,65]]}]}]};break;case C.TYPE_NUMBER:r={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':c,'values':['abc1']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':e,'values':[[null]]}]}]};break;case C.TYPE_GEO_BUBBLE:case C.TYPE_GEO_CHOROPLETH:case C.TYPE_GEO_PIE:case C.TYPE_GEO_MAP:r={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':L.get('VIZ_COMMON_REGION'),'values':['United Kingdom','Italy','United States','New Zealand','Germany','China','Russia','Canada','Brazil'],'infos':[{'featureId':'UK,NAVTEQ','latLong':undefined},{'featureId':'20110484,NAVTEQ','latLong':undefined},{'featureId':'21000001,NAVTEQ','latLong':undefined},{'featureId':'23060936,NAVTEQ','latLong':undefined},{'featureId':'20147700,NAVTEQ','latLong':undefined},{'featureId':'22928332,NAVTEQ','latLong':undefined},{'featureId':'20485579,NAVTEQ','latLong':undefined},{'featureId':'21041602,NAVTEQ','latLong':undefined},{'featureId':'23028911,NAVTEQ','latLong':undefined}]}]},{'index':2,'data':[{'isFake':true,'type':'Dimension','name':f,'values':[g+'1',g+'2',g+'3',g+'4']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':e+'1','values':[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]}]},{'index':2,'data':[{'isFake':true,'type':'Measure','name':e+'2','values':[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]},{'index':3,'data':[{'isFake':true,'type':'Measure','name':e+'3','values':[[46,58,90,5,10,4,79,86,30],[56,98,20,20,7,58,39,16,23],[103,98,78,40,76,29,16,59,43],[59,80,98,8,45,16,120,97,39]]}]}]};break;case C.TYPE_SCATTER_MATRIX:r={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':f,'values':[g+'1',g+'2',g+'3',g+'4']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':e+'1','values':[[43,31,43,41]]},{'isFake':true,'type':'Measure','name':e+'2','values':[[252,124,370,170]]}]}]};break;case C.TYPE_TREE:case C.TYPE_NETWORK:r={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':c,'values':['abc1','abc2','abc3','abc4','abc1','abc2','abc3','abc4','abc1','abc2','abc3','abc4','abc1','abc2','abc3','abc4']},{'isFake':true,'type':'Dimension','name':f,'values':[g+'1',g+'1',g+'1',g+'1',g+'2',g+'2',g+'2',g+'2',g+'3',g+'3',g+'3',g+'3',g+'4',g+'4',g+'4',g+'4']}]}],'measureValuesGroup':[]};break;case C.TYPE_PC:r={'analysisAxis':[{'index':1,'data':[{'isFake':true,'type':'Dimension','name':f,'values':[g+'1',g+'1',g+'1',g+'2',g+'2',g+'3',g+'4',g+'4',g+'4',g+'5',g+'6',g+'7',g+'8',g+'9',g+'9']}]}],'measureValuesGroup':[{'index':1,'data':[{'isFake':true,'type':'Measure','name':e+'1','values':[[5.1,4.9,4.7,4.6,5,7,6.4,6.9,5.5,6.5,6.3,5.8,7.1,6.3,6.5]]},{'isFake':true,'type':'Measure','name':e+'2','values':[[3.1,8.9,2.7,6.6,5,5,6.6,6.9,7.5,2.5,2.3,5.8,8.1,1.3,2.5]]}]}]};break;case C.TYPE_TABLE:case C.TYPE_CROSSTAB:r={'isFake':true,'queryResponse':[{'dimAxes':{'rowsDim':{'count':0,'values':[]}},'metadata':{'dictionary':{'rowsDim':[],'measures':[]}},'valueAxes':[],'ranges':{'cellsDim':[{'marksNum':[]}]},'executionStatus':{'status':'ok'}},{'valueAxes':[],'executionStatus':{'status':'ok'}}]};break;case C.TYPE_STACKED_COLUMN:case C.TYPE_STACKED_BAR:r={'metadata':b.getMetadataCommon(),'data':[['abc1',g+'1',30],['abc2',g+'1',37],['abc3',g+'1',25],['abc4',g+'1',30],['abc5',g+'1',35],['abc6',g+'1',50],['abc7',g+'1',40],['abc8',g+'1',25],['abc9',g+'1',35],['abc10',g+'1',20],['abc1',g+'2',30],['abc2',g+'2',37],['abc3',g+'2',25],['abc4',g+'2',30],['abc5',g+'2',35],['abc6',g+'2',50],['abc7',g+'2',40],['abc8',g+'2',25],['abc9',g+'2',35],['abc10',g+'2',20],['abc1',g+'3',30],['abc2',g+'3',37],['abc3',g+'3',25],['abc4',g+'3',30],['abc5',g+'3',35],['abc6',g+'3',50],['abc7',g+'3',40],['abc8',g+'3',25],['abc9',g+'3',35],['abc10',g+'3',20]]};break;case C.TYPE_DUAL_BAR:case C.TYPE_DUAL_COLUMN:r={'metadata':b.getMetadataCommon(),'data':[['abc1',g+'1',30,25,30],['abc2',g+'1',37,30,35],['abc3',g+'1',25,35,30],['abc4',g+'1',30,30,37],['abc5',g+'1',35,37,25]]};break;case C.TYPE_100_MEKKO:r={'metadata':{'fields':[{'isFake':true,'id':'Axis','semanticType':'Dimension','name':c},{'isFake':true,'id':'Color','semanticType':'Dimension','name':c},{'isFake':true,'id':'Measure1','semanticType':'Measure','name':e+'1'},{'isFake':true,'id':'Measure2','semanticType':'Measure','name':e+'2'}]},'data':[['abc1','def1',25,30],['abc2','def2',30,35],['abc3','def3',35,30],['abc4','def4',30,37],['abc5','def5',37,25]]};break;case C.TYPE_PIE:case C.TYPE_DONUT:r={'metadata':{'fields':[{'isFake':true,'id':'Color','semanticType':'Dimension','name':c},{'isFake':true,'id':'Measure','semanticType':'Measure','name':e}]},'data':[[g+'1',98],[g+'1',122]]};break;}return r;};b.getMetadataCommon=function(){var c=L.get('VIZ_COMMON_FAKE_DIMENSION');var e=L.get('VIZ_COMMON_FAKE_MEASURE');var f=L.get('VIZ_COMMON_LEGEND');var g=L.get('VIZ_COMMON_ITEM');return{'fields':[{'isFake':true,'id':'Axis','semanticType':'Dimension','name':c},{'isFake':true,'id':'Color','semanticType':'Dimension','name':f},{'isFake':true,'id':'Measure','semanticType':'Measure','name':e},{'isFake':true,'id':'Measure1','semanticType':'Measure','name':e+'1'},{'isFake':true,'id':'Measure2','semanticType':'Measure','name':e+'2'}]};};b.getDataInfoCommon=function(){var c=L.get('VIZ_COMMON_ITEM');return{'metadata':b.getMetadataCommon(),'data':[['abc1',c+'1',20,25,20],['abc2',c+'1',30,30,25],['abc3',c+'1',25,35,35],['abc4',c+'1',32,55,20],['abc5',c+'1',35,40,30],['abc6',c+'1',40,25,40],['abc7',c+'1',35,35,20],['abc8',c+'1',50,20,18],['abc9',c+'1',35,30,25],['abc10',c+'1',30,37,35]]};};b.getFeedingByType=function(t){var r;switch(t){case C.TYPE_COMBINATION:r=[{feed:'valueAxis',source:['Measure1','Measure2']},{feed:'categoryAxis',source:['Axis']},{feed:'color',source:[{'measureNames':['valueAxis']},'Color']}];break;case C.TYPE_PIE:case C.TYPE_DONUT:r=[{feed:'size',source:['Measure']},{feed:'color',source:['Color']}];break;case C.TYPE_DUAL_BAR:case C.TYPE_DUAL_COLUMN:case C.TYPE_DUAL_LINE:r=[{feed:'categoryAxis',source:['Axis']},{feed:'color',source:[{'measureNames':['valueAxis','valueAxis2']},'Color']},{feed:'valueAxis',source:['Measure1']},{feed:'valueAxis2',source:['Measure2']}];break;case C.TYPE_100_MEKKO:r=[{feed:'categoryAxis',source:['Axis']},{feed:'color',source:['Color']},{feed:'valueAxis',source:['Measure1']},{feed:'valueAxis2',source:['Measure2']}];break;case C.TYPE_SCATTER:r=[{feed:'color',source:['Color']},{feed:'valueAxis',source:['Measure1']},{feed:'valueAxis2',source:['Measure2']}];break;case C.TYPE_BUBBLE:r=[{feed:'color',source:['Color']},{feed:'valueAxis',source:['Measure1']},{feed:'valueAxis2',source:['Measure2']},{feed:'bubbleWidth',source:['Measure1']}];break;case C.TYPE_TREEMAP:r=[{feed:'title',source:['Axis','Color']},{feed:'weight',source:['Measure1']},{feed:'color',source:['Measure2']}];break;default:r=[{feed:'valueAxis',source:['Measure']},{feed:'categoryAxis',source:['Axis']},{feed:'color',source:['Color']}];}return r;};return b;});define('sap/viz/controls/common/migrate/migrationchain/VersionChain',[],function(){var V=function(){this.fromVersion=null;this.toVersion=null;this._successor=null;};V.prototype.getSuccessor=function(){return this._successor;};V.prototype.setSuccessor=function(v){this._successor=v;};return V;});define('sap/viz/controls/common/migrate/migrator/MigratorHelper',[],function(){var M={};M.TYPE_PATH=['chart','type'];M.FEED_PATH=['chart','feedingItems'];M.DATA_PATH=['chart','vizInstance','data'];M.getValue=function(r,p){if(!r||!p||!p.length){return null;}var n=r;for(var i=0;i<p.length;i++){if(!n[p[i]]){return null;}n=n[p[i]];}return n;};M.setValue=function(r,p,v){if(!r||!p||!p.length){return null;}var n=r;for(var i=0;i<p.length-1;i++){if(!n[p[i]]){n[p[i]]={};}n=n[p[i]];}var l=p[p.length-1];n[l]=v;return r;};return M;});define('sap/viz/controls/common/migrate/migrator/TypeMigrator',['sap/viz/controls/common/migrate/migrator/MigratorHelper','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/InfoChartUtil'],function(M,U,I){var T={};T.migrateV1toV2=function(j){return j;};T.migrateV2toV3=function(j){var a=U.clone(j);if(!a||!a.type){return a;}var t=a.type;var b=I.getInfoType(t),i=I.isInfoChart(t);if(!i&&b){t=b;}a.type=t;return a;};T.migrate=function(t){var m=[T.migrateV1toV2,T.migrateV2toV3];var j={};j.type=t;m.forEach(function(a){j=a(j);});return j.type;};return T;});define('sap/viz/controls/common/services/feedvalidators/DuplicateValidator',['sap/viz/controls/common/feeds/FeedUtils'],function(F){var D={};D.validate=function(d,f){var v=true;var t=[],a;d.forEach(function(b){var c=F.getFeedValues(f,b.id())||[];v=v&&_(b,c);});return v;};var _=function(d,a){var v=true,m={};a.forEach(function(b){var i=b.id();if(m[i]){v=false;}m[i]=true;});return v;};return D;});define('sap/viz/controls/common/services/feedvalidators/TypeValidator',['sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType'],function(F,a,A,b){var T={};T.validate=function(d,f){var v=true;d.forEach(function(c){var e=a.getFeedValues(f,c.id())||[];v=v&&_(c,e);});return v;};var _=function(d,c){var v=true;c.forEach(function(e){v=v&&A.compatible(d.type(),e.type());if(d.id()===F.ID_GEO){v=v&&(e.dataType()===b.GEOGRAPHY.toLowerCase());}});return v;};return T;});define('sap/viz/controls/common/services/feedvalidators/AAValidator',['sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/constants/ChartConst'],function(F,a,b,C){var A={};A.validate=function(e,f){var n=0;e.forEach(function(g){if(g.type()==='dimension'){var v=a.getFeedValues(f,g.id())||[];if(v.length===0&&g.min()>0){if(g.mndMode()==='none'||a.hasMND(f)){n++;}}}});return(_(f)+n)<=2;};var _=function(f){var n=0;var e=0;for(var i=0;i<f.length;i++){var g=f[i];if(g.type()===b.DIMENSION&&c(g)){if(g.id()===F.ID_TRELLIS_ROW||g.id()===F.ID_TRELLIS_COLUMN){e=Math.min(1,e+1);}else{n++;}}}return(e+n);};var c=function(f){if(!f||!f.hasValues()||f.id()===C.DATA_FRAME){return 0;}var v=f.values();return d(v);};var d=function(v){if(!v||!v.length){return 0;}var h=a.hasMNDInValues(v);if(h&&v.length===1){return 0;}return 1;};return A;});define('sap/viz/controls/common/services/feedvalidators/MaxValidator',['sap/viz/controls/common/feeds/FeedUtils'],function(F){var M={};M.validate=function(d,f){var v=true;var n=F.countAnalyses(f);d.forEach(function(a){var b=F.getFeedValues(f,a.id())||[];v=v&&_(a,b);n-=b.length;});v=v&&n===0;return v;};var _=function(d,a){var l=a.length;if(F.hasMNDInValues(a)){l=l-1;}return l<=d.max();};return M;});define('sap/viz/controls/common/services/feedvalidators/MinValidator',['sap/viz/controls/common/feeds/FeedUtils'],function(F){var M={};M.validate=function(d,f){var v=true;d.forEach(function(a){v=v&&_(a,F.getFeedValues(f,a.id())||[]);});return v;};var _=function(d,a){var l=a.length;return l>=d.min();};return M;});define('sap/viz/controls/common/services/feedvalidators/MNDValidator',['sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedUtils'],function(F,A,a){var M={};M.validate=function(d,f,m){var v=true;var n=0;d.forEach(function(c){if(c.mndEnumerable()){var e=a.getFeedValues(f,c.id())||[];n+=e.length;}});if(a.countAnalyses(f,A.MND)>(n>0?1:0)){return false;}var t=[],b;d.forEach(function(c){if(c.type()==='dimension'){var e=a.getFeedValues(f,c.id())||[];if(m&&(c.id()===F.ID_TRELLIS_ROW||c.id()===F.ID_TRELLIS_COLUMN)){t=t.concat(e);b=c;}else{v=v&&_(c,e);}}});if(m&&b){v=v&&_(b,t);}return v;};var _=function(d,b){if(a.hasMNDInValues(b)){if(d.mndMode()==='none'){return false;}else if(d.mndMode()==='supportExclusively'){return b.length===1;}}return true;};return M;});define('sap/viz/controls/common/services/FeedValidationService',['sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/services/feedvalidators/DuplicateValidator','sap/viz/controls/common/services/feedvalidators/TypeValidator','sap/viz/controls/common/services/feedvalidators/AAValidator','sap/viz/controls/common/services/feedvalidators/MaxValidator','sap/viz/controls/common/services/feedvalidators/MinValidator','sap/viz/controls/common/services/feedvalidators/MNDValidator','sap/viz/controls/common/constants/ChartConst'],function(F,D,u,C,a,A,b,c,M,d,T,e,f,g,h,i){var j={};j.validateDimensionMin=function(v,k){var l=M.get(v).getBindingDefs();var m=[];l.forEach(function(o){if(o.type()==='dimension'){m.push(o);}});l=m;var n=true;n=n&&g.validate(l,k);return n;};j.validateOverflow=function(v,k){if(v===i.TYPE_TABLE){k=a.removeSubtotal(k);}var m=M.get(v);var l=m.getBindingDefs();var n=true;n=n&&d.validate(l,k);n=n&&T.validate(l,k);var o=window.__sap_viz_internal_disable_aa_limit_for_all_charts===true;if(!o||(m.support().dataset[D.CROSS_TABLE]&&!m.support().dataset[D.FLAT_TABLE])){n=n&&e.validate(l,k);}n=n&&f.validate(l,k);n=n&&h.validate(l,k,!C.isInfoChart(v));return n;};j.validateDuplicate=function(v,k){var l=M.get(v).getBindingDefs();var m=true;m=m&&d.validate(l,k);return m;};j.validateMND=function(v,k){var l=M.get(v).getBindingDefs();var m=true;m=m&&h.validate(l,k,!C.isInfoChart(v));return m;};j.addable=function(v,k,l,m){if(!m){var t,n;if(l===F.ID_TRELLIS_ROW||l===F.ID_TRELLIS_COLUMN){t='dimension';}else{var o=a.getFeed(k,l);t=o.type()===b.MEASURE?'measure':'dimension';}n=l===F.ID_GEO?"geography":undefined;var p='__sapVizControlsReserved_'+t+'_'+_++;m=new A(p,p,t,n);}var q=a.spliceAnalysisObjects(a.cloneFeeds(k),l,0,0,m);v=a.hasRowOrColumn(q)?C.toMultiChartType(v):C.toSingleChartType(v);return j.validateOverflow(v,q);};j.replaceable=function(v,k,r,l){var m;m=a.spliceAnalysisObjects(a.cloneFeeds(k),r,0,0,l);v=a.hasRowOrColumn(m)?C.toMultiChartType(v):C.toSingleChartType(v);if(!j.validateDuplicate(v,m)){return false;}m=a.cloneFeeds(k);var n=a.indexOfAnalysisObjectsByType(k,r,c.compatible('dimension',l.type())?'dimension':'measure');if(n!==-1){m=a.spliceAnalysisObjects(m,r,n,1,l);}else{m=a.spliceAnalysisObjects(m,r,0,0,l);}v=a.hasRowOrColumn(m)?C.toMultiChartType(v):C.toSingleChartType(v);return j.validateOverflow(v,m);};var _=0;return j;});define('sap/viz/controls/common/services/feeders/MNDFeeder',['sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/feeds/FeedUtils'],function(M,F){var a={};a.feed=function(v,f,b){var i,d;var c=F.indexOfMNDInValues(b);if(c===-1||F.hasMND(f)){return;}var m=b.splice(c,1)[0],e;var g=M.get(v).getBindingDefs();g=g.slice(0).sort(function(h,j){return h.bvrMNDPriority()-j.bvrMNDPriority();});for(i=0;i<g.length;i++){d=g[i];e=F.getFeedValues(f,d.id());if(d.mndMode()!=='none'&&d.min()>e.length){if(d.mndMode()==='support'||(d.mndMode()==='supportExclusively'&&e.length===0)){e.push(m);return;}}}for(i=0;i<g.length;i++){d=g[i];e=F.getFeedValues(f,d.id());if(d.mndMode()!=='none'&&e.length===0){e.push(m);return;}}for(i=0;i<g.length;i++){d=g[i];e=F.getFeedValues(f,d.id());if(d.mndMode()==='support'||(d.mndMode()==='supportExclusively'&&e.length===0)){e.push(m);return;}}};return a;});define('sap/viz/controls/common/services/feeders/GeoFeeder',['sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/bindingdef/BindingDefUtils','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil'],function(F,M,a,b,B,C,c){var G={};G.feed=function(v,f,d){var s=c.toSingleChartType(v);if(s!==C.TYPE_GEO_BUBBLE&&s!==C.TYPE_GEO_CHOROPLETH&&s!==C.TYPE_GEO_PIE){return;}var e,i;for(i=0;i<f.length;i++){if(f[i].id()===F.ID_GEO){e=f[i];}}if(!e){return;}var g=B.get(v,e.id());if(e.values().length>=g.max){return;}for(i=0;i<d.length;i++){if(d[i].dataType()===b.GEOGRAPHY.toLowerCase()){e.values([d[i]]);d.splice(i,1);break;}}};return G;});define('sap/viz/controls/common/services/feeders/CommonFeeder',['sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/services/FeedValidationService','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/constants/FeedConst'],function(M,F,a,A,b){var C={};C.feed=function(v,h,j,k){k=k||h;var l=j.slice(0),m,n;var o=M.get(v).getBindingDefsWithBVRSorting();var i,p;for(i=0;i<o.length&&j.length>0;i++){p=o[i],m=a.getFeed(k,p.id()),n=true;while(n&&m&&p.min()>m.values().length){n=g(v,h,m,j);}}for(i=0;i<o.length&&j.length>0;i++){p=o[i],m=a.getFeed(k,p.id()),n=true;if(m&&m.values().length===0){g(v,h,m,j);}}for(i=0;i<o.length&&j.length>0;i++){p=o[i],m=a.getFeed(k,p.id()),n=true;while(n&&m&&p.max()>m.values().length){n=g(v,h,m,j);}}_(v,k,l);};var _=function(v,h,j){var k=[],l={};h.forEach(function(o){var p=true;l[o.id()]=o.values().length;o.values().forEach(function(q,r){if(j.indexOf(q)!==-1){k.push(q);if(p){p=false;l[o.id()]=r;}}});});var t=[];j.forEach(function(o){if(k.indexOf(o)!==-1){t.push(o);}});k=t;var i,m,n;for(i=0;i<k.length;i++){m=k[i];n=f(h,m);c(v,h,l,function(o,p){if(p===m){return true;}if(p.id()==m.id()&&p!==m&&k.indexOf(p)>i){d(n,m,o,p);return true;}});}for(i=0;i<k.length;i++){m=k[i];n=f(h,m);c(v,h,l,function(o,p){if(p===m){return true;}if(e(o,m)){if(e(n,p)&&k.indexOf(p)>i){d(n,m,o,p);return true;}}});}};var c=function(v,h,i,l){var j,k,m=M.get(v).getBindingDefsWithBVRSorting();for(j=0;j<m.length;j++){var n=m[j],o=a.getFeed(h,n.id());if(o==null){continue;}var I=false;for(k=i[o.id()];k<o.values().length;k++){var p=o.values()[k];var r=l(o,p);if(r){return;}}}};var d=function(h,i,j,k){var I=h.values().indexOf(i);var l=j.values().indexOf(k);if(I!=-1&&l!=-1){var t=h.values()[I];h.values()[I]=j.values()[l];j.values()[l]=t;}};var e=function(h,j){if(!A.compatible(h.type().toLowerCase(),j.type())){return false;}var k=h.values();for(var i=0;i<k.length;i++){var t=k[i];if(t.id()==j.id()){return false;}}return true;};var f=function(h,i){var t;for(t in h){if(h[t].values().indexOf(i)!=-1){return h[t];}}return null;};var g=function(v,h,j,k){for(var i=0;i<k.length;i++){var l=k[i];if(F.addable(v,h,j.id(),l)&&j.id()!==b.ID_DATAFRAME){j.values().push(l);k.splice(i,1);return true;}}return false;};return C;});define('sap/viz/controls/common/services/BVRService',['sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/bindingdef/BindingDefUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/services/FeedValidationService','sap/viz/controls/common/services/feeders/MNDFeeder','sap/viz/controls/common/services/feeders/GeoFeeder','sap/viz/controls/common/services/feeders/CommonFeeder','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/constants/ChartConst'],function(A,a,F,b,B,C,c,M,G,d,e,f,g){var h={};h.VERSION='1.0';h.switchFeeds=function(v,i,j){var k,p=b.buildEmptyFeeds(v);if(!v||B.equal(v,i)){k=b.merge(p,j);}else if(b.isEmptyFeeds(j)){k=p;}else{if(v!==g.TYPE_TABLE||i===g.TYPE_TABLE){j=b.removeSubtotal(j);}j=j.slice(0).sort(function(q,s){var t=B.get(v,q.id());var u=B.get(v,s.id());var w=t?t.bvrPriority():Number.POSITIVE_INFINITY;var x=u?u.bvrPriority():Number.POSITIVE_INFINITY;return w-x;});k=p;var r=[];_(j,v,k,r);n(v,k,r);if(C.toSingleChartType(v)!==C.toSingleChartType(i)){o(v,k);}}return{'vizType':v,'feeds':k};};h.suggestFeeds=function(v,i,j,s){if(arguments.length===2){j=i;i=[];}i=b.merge(b.buildEmptyFeeds(v),i);i=b.cloneFeeds(i);var k;if(s&&s.length){k=[];i.forEach(function(p){if(s.indexOf(p.id())!==-1){k.push(p);}});}else{k=i;}n(v,i,j.slice(0),k);return{'vizType':v,'feeds':i};};h.suggestMND=function(v,i){return h.suggestFeeds(v,i,[A.genMND()]).feeds;};h.suggestChartWithFeeds=function(i){};var _=function(i,v,j,r){i.forEach(function(k){if(k.type()===F.MEASURE){m(k,v,j,r);}});i.forEach(function(k){if(k.type()!==F.MEASURE){m(k,v,j,r);}});};var l=(function(){var i={};var j=function(k){k.forEach(function(p){i[p]=k;});};j(['rectangleTitle','mainLabelAxis']);j(['regionColor','pieSectorColor','color']);j(['axisLabels','categoryAxis']);j(['primaryValues','valueAxis']);return i;})();var m=function(i,v,j,r){var k,p=l[i.id()]||[i.id()];p.forEach(function(q){if(!k){k=b.getFeed(j,q);}});i.values().forEach(function(q){if(k){k.values().push(q);if(!c.validateOverflow(v,j)){k.values().pop();r.push(q);}}else{if(i.id()!==f.ID_DATAFRAME){r.push(q);}}});};var n=function(v,i,r,j){j=j||i;M.feed(v,j,r);G.feed(v,j,r);d.feed(v,i,r,j);};var o=function(v,p){var q=e.get(v).getBindingDefsWithBVRSorting();for(var i=0;i<q.length;i++){var r=q[i],s=b.getFeed(p,r.id());for(var j=0;s.values().length<r.min()&&j<q.length;j++){var t=q[j];var u=b.getFeed(p,t.id());if(s.type()!=u.type()){continue;}var k=u.values().length-1;var w=t.min()>1?t.min():1;while(k>=0&&s.values().length<r.min()&&u.values().length>w){var x=u.values().splice(k,1)[0];if(x.type()!=a.MND&&c.addable(v,p,s.id(),x)){s.values().push(x);}else{u.values().splice(k,0,x);}k--;}}}};return h;});define('sap/viz/controls/common/utils/binding/generators/BindingGeneratorBase',['sap/viz/controls/common/metadata/MetadataFactory'],function(M){var B=function(s){this._visualizationType=s.visualizationType;this._bindingDefs=M.get(s.visualizationType).getBindingDefs();};B.prototype.generate=function(f){};return B;});define('sap/viz/controls/common/utils/binding/generators/VizFeedingGenerator',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/VizFeedingUtil','sap/viz/controls/common/utils/binding/generators/BindingGeneratorBase'],function(O,V,B){var a=function(s){a.superclass.constructor.apply(this,arguments);this._feeding=null;};O.extend(a,B);a.prototype.generate=function(f){return V.generate(f,this._visualizationType);};return a;});define('sap/viz/controls/common/utils/binding/generators/FTBindingGenerator',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/bindingdef/BindingDefUtils','sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/utils/binding/generators/BindingGeneratorBase'],function(O,B,F,C,A,a,b){var c=function(s){c.superclass.constructor.apply(this,arguments);};O.extend(c,b);function d(v,f){return f.reduce(function(l,e){if(e.values().length){var g=B.get(v,e.id());if(g&&g.mndEnumerable()){l.push(e.id());}}return l;},[]);}c.prototype.generate=function(f){var v=d(this._visualizationType,f);var e=[];f.forEach(function(g){var h=g.values()||[];var l=[];if(h.length===0){return;}for(var j=0;j<h.length;j++){var i=h[j];if(i.type()===A.MND){l.push({measureNames:v});}else{if(i.type()===A.HIERARCHY){var m=(g.id()===C.DATA_FRAME);for(var k=0;k<i.hierarchyLevels().length;k++){var n=i.hierarchyLevels()[k];if(!m||n.selected()){l.push(n.id());}if(n.selected()){break;}}}else{l.push(i.id());}}}e.push({feed:g.id(),source:l});});return e;};return c;});define('sap/viz/controls/common/utils/binding/generators/XTBindingGenerator',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/utils/binding/generators/BindingGeneratorBase','sap/viz/controls/common/utils/Utils'],function(O,C,A,F,B,U){var X=function(s){X.superclass.constructor.apply(this,arguments);};O.extend(X,B);X.prototype.generate=function(f){var b=m(f);return g(this._bindingDefs,b);};var m=function(f){var b={};f.forEach(function(a){var v=a.values();if(v.length===0){return;}var c=a.id().indexOf('multiplier')!==-1?a.id().split('.')[0]:a.id();b[c]=[];for(var i=0;i<v.length;++i){var d=v[i];var o;if(d.type()===A.HIERARCHY){var h=d.hierarchyLevels();for(var j=0;j<h.length;j++){var l=h[j];if(l.selected()){o=l.id();}}}else{if(d.type()===A.MND){o=":mnd";}else{if(d.aggregationType()){if(d.aggregationTarget()){o=d.aggregationTarget();}else{o=U.decode(d.id())[0];}}else{o=d.id();}}}b[c].push(o);}});return b;};var g=function(c,d){var e=[],o=["measure","dimension"],f=1,h=1;var i=c.map(function(a){return{id:a.id(),name:a.name(),type:a.type(),min:a.min(),max:a.max(),mndMode:a.mndMode(),bvrPriority:a.bvrPriority(),bvrMNDPriority:a.bvrMNDPriority()};}).sort(function(a,b){if(a.type!==b.type){return o.indexOf(a.type)-o.indexOf(b.type);}else{return a.bvrPriority-b.bvrPriority;}});i.filter(function(a){if(a.type!="measure"){return true;}var b=d[a.id];if(!b){return false;}e.push({feed:a.id,source:[{"type":"measureValuesGroup","index":f++}]});return false;}).filter(function(a){if(a.type!="dimension"){return true;}var b=d[a.id];if(!b){return false;}e.push({feed:a.id,source:[{"type":"analysisAxis","index":h++}]});if(b.indexOf(":mnd")>-1){if(b[0]===":mnd"){e[e.length-1].source.unshift({"type":"measureNamesDimension"});}else{e[e.length-1].source.push({"type":"measureNamesDimension"});}}return false;});return e;};return X;});define('sap/viz/controls/common/utils/binding/BindingGeneratorFactory',['sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/utils/binding/generators/VizFeedingGenerator','sap/viz/controls/common/utils/binding/generators/FTBindingGenerator','sap/viz/controls/common/utils/binding/generators/XTBindingGenerator'],function(I,V,F,X,a){var B={'create':function(v,d){var g;var s={'visualizationType':v};if(I.isInfoChart(v)){if("FlatTableDataset"===d){g=new F(s);}else if("CrossTableDataset"===d){g=new X(s);}}else{g=new V(s);}return g;}};return B;});define('sap/viz/controls/common/migrate/migrator/FeedMigrator',['sap/viz/controls/common/migrate/migrator/MigratorHelper','sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/migrate/migrator/TypeMigrator','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/utils/binding/BindingGeneratorFactory','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/bindingdef/BindingDefUtils'],function(M,F,T,I,a,U,b,C,B,c,D,d){var e={};e.migrateV1toV2=function(j){var t=j.type?j.type:j.chart.type;var f=j.contextMenu?j.contextMenu.isMNDVisible:j.mndVisible;if(f===false){var g=e._getFeedsFromInnerControl(j);if(C.isGeo(t)){for(var i=0;i<g.length;i++){g=b.removeMND(g[i]);}}else{g=b.removeMND(g);}e._updateFeedsToInnerControl(j,g);}return j;};e.migrateV2toV3=function(j){var f=U.clone(j);var g=null;var h=M.getValue(f,M.FEED_PATH);var i=true;if(h){g=h;var k=M.getValue(f,['contextMenu']);if(k){i=k.isMNDVisible;}}if(g==null){return j;}var t=M.getValue(f,M.TYPE_PATH);g=e._feedingToBinding(t,g);var l=a.fromJSON(g);if(i===false){l=b.removeMND(l);}if(f.chart.vizInstance&&f.chart.vizInstance.data&&f.chart.vizInstance.data.type){var m=c.create(t,D.FLAT_TABLE);f.chart.vizInstance.bindings=m.generate(B.suggestMND(t,l));}if(f.chart.vizInstance&&f.chart.vizInstance.feeding){delete f.chart.vizInstance.feeding;}g=a.toJSON(l);if(h){f=M.setValue(f,M.FEED_PATH,g);}return f;};e.migrate=function(f,t){t=T.migrate(t);if(I.isInfoChart(t)){var m=[e.migrateV1toV2,e.migrateV2toV3];var j=a.toJSON(f);var g={};g=M.setValue(g,M.TYPE_PATH,t);g=M.setValue(g,M.FEED_PATH,j);m.forEach(function(h){g=h(g);});j=M.getValue(g,M.FEED_PATH);f=a.fromJSON(j);}return f;};e._feedsIdToBindingId=function(t,i){return sap.viz.api.serialization.feedsIdToBindingId(t,i);};e._feedingToBinding=function(f,g){if((!I.isInfoChart(f)&&!C.isMultipleChart(f))||!g||g.length===0){return g;}var h=U.clone(g);if(C.supportMultiChart(f)){if(b.hasRowOrColumn(a.fromJSON(g))){f=C.toMultiChartType(f);}}for(var i=0;i<h.length;i++){var j=h[i].id;if(j){var n=e._feedsIdToBindingId(f,j);if(n){h[i].id=n;}}}return h.filter(function(k){if(k.id==='multiplier.row'){k.id=F.ID_TRELLIS_ROW;}else if(k.id==='multiplier.column'){k.id=F.ID_TRELLIS_COLUMN;}return d.has(f,k.id)||(C.supportTimeChart(f)&&d.has(C.toTimeChartType(f),k.id));});};e._updateFeedsToInnerControl=function(v,f){var g=a.toJSON(f);M.setValue(v,M.FEED_PATH,g);return v;};e._getFeedsFromInnerControl=function(v){var f=null;var g=M.getValue(v,M.FEED_PATH);if(g){f=g;}if(f==null){return[];}var h=a.fromJSON(f);return h;};return e;});define('sap/viz/controls/common/migrate/migrator/DataMigrator',['sap/viz/controls/common/migrate/migrator/MigratorHelper','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/migrate/migrator/TypeMigrator','sap/viz/controls/common/migrate/migrator/FeedMigrator','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/FlatTableFakeDataUtil','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/utils/DatasetUtil'],function(M,C,U,I,T,F,A,a,b,c,D,d){var e={};e.migrateV1toV2=function(j){return j;};e.migrateV2toV3=function(j){var f=U.clone(j);var t=M.getValue(f,M.TYPE_PATH);var g=M.getValue(f,M.FEED_PATH);var h=M.getValue(f,M.DATA_PATH);if(!h||!t||!C.isInfoChart(t)){return j;}var i=a.fromJSON(g);var k=h["val"];if(h["type"]==="Crosstable"){var l;if(h.chart&&h.chart.vizInstance&&h.chart.vizInstance.feeding){l=h.chart.vizInstance.feeding;}k=e._migrateCrossToFlatten(t,l,i,k);k.data(e._updateFlatTableDataset(i,k.data()));h["val"]=k.data();}h["type"]="FlatTable";j=M.setValue(j,M.DATA_PATH,h);if(j.chart.vizInstance&&j.chart.vizInstance.data&&j.chart.vizInstance.data.val&&i){var m=c.buildFakeData(t,i,j.chart.vizInstance.data.val);var n=new sap.viz.api.data.FlatTableDataset(m);if(n.hasFakeData()){j.chart.vizInstance.data.val=m;j.chart.vizInstance.bindings=c.buildFakeBinding(t,i,true);}}return j;};e.migrate=function(f,t,g){t=T.migrate(t);if(!f||!t||!(I.isInfoChart(t)&&d.getType(f)===D.CROSS_TABLE)){return f;}g=F.migrate(g,t);var j=a.toJSON(g);var h={};h=M.setValue(h,M.TYPE_PATH,t);h=M.setValue(h,M.FEED_PATH,j);f=f.toJSON().data;var i={};i.val=f;i.type="Crosstable";h=M.setValue(h,M.DATA_PATH,i);var m=[e.migrateV1toV2,e.migrateV2toV3];m.forEach(function(k){h=k(h);});i=M.getValue(h,M.DATA_PATH);i=new sap.viz.api.data.FlatTableDataset(i.val);return i;};e._migrateCrossToFlatten=function(t,f,g,h){if(f){h=e._updateCrossTabDataSet(t,f,g,h);}var i=new sap.viz.api.data.CrosstableDataset();i.data(h);i=I.buildInfoDataset(i);return i;};e._updateFlatTableDataset=function(f,r){if(!f||f.length===0){return;}if(!r||!r.metadata||!r.metadata.fields||r.metadata.fields.length===0){return;}var n={};var h={};for(var i=0;i<f.length;i++){var v=f[i].values();if(!v||v.length===0){continue;}for(var g=0;g<v.length;g++){var j=v[g];if(j.type()===A.MND){continue;}else if(j.type()===A.HIERARCHY){var l=j.hierarchyLevels();for(var k=0;k<l.length;k++){var m=l[k];if(!h.hasOwnProperty(m.name())){h[m.name()]=m.id();}if(m.selected()){break;}}}else{if(!n.hasOwnProperty(j.name())){n[j.name()]=j.id();}}}}var o=r.metadata.fields;for(var p=0;p<o.length;p++){var q=o[p];if(h.hasOwnProperty(q.name)){q.id=h[q.name];}else if(q.name===q.id&&n.hasOwnProperty(q.name)){q.id=n[q.name];}}return r;};e._updateCrossTabDataSet=function(t,f,g,r){if(!r){return;}if(!f||f.length===0){return;}for(var i=0;i<f.length;i++){var h=f[i],j=F._feedsIdToBindingId(t,h.feedId);var k=b.getFeed(g,j);var l=h.binding;if(!k||!l||l.length===0){continue;}var m=k.values();if(!m||m.length===0){continue;}var o=null;for(var n=0;n<l.length;n++){var p=l[n];var q=p.index;if(!p||!r[p.type]){continue;}o=r[p.type][q-1];if(o&&o.data){o=o.data;break;}}if(!o){continue;}e._updateDataID(o,m);}return r;};e._updateDataID=function(f,g){var h=0;for(var i=0;i<g.length;i++){var v=g[i];if(v.type()===A.MND){continue;}else if(v.type()===A.HIERARCHY){var j=v.hierarchyLevels();for(var k=0;k<j.length;k++){var l=j[k];if(f[h]&&f[h].name===l.name()){f[h].id=l.id();h++;}if(l.selected()){break;}}}else{if(f[h]&&f[h].name===v.name()){f[h].id=v.id();h++;}}}};return e;});define('sap/viz/controls/common/migrate/migrator/PropertyMigrator',['sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/utils/binding/BindingGeneratorFactory','sap/viz/controls/common/services/BVRService'],function(D,I,B,a){var P={};P.migrateV2toV3=function(j){if(sap.viz.api.serialization){return sap.viz.api.serialization.migrate(j);}};P.migrate=function(p,t,f){if(I.isInfoChart(t)){var j={'type':t,'properties':p};if(f){var g=B.create(t,t==="FlatTable"?D.FLAT_TABLE:D.CROSS_TABLE);j.bindings=g.generate(a.suggestMND(t,f));}var b=this.migrateV2toV3(j);return b;}else{return{'type':t,'properties':p};}};return P;});define('sap/viz/controls/common/migrate/migrator/PlayControlMigrator',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/migrate/migrator/DataMigrator'],function(C,u,A,F,D){var P={};P.migrateV2toV3=function(j){var r=u.clone(j);var t;if(j&&j.chart&&j.chart.type){t=j.chart.type;}if(t==C.TYPE_GEO_BUBBLE){return r;}var p=j.playControl;if(!(p&&p.slicedData&&p.slicedData.slices&&p.sliceDimension)){return r;}var d=new sap.viz.api.data.CrosstableDataset(),n=[],k;var m,a=0;var i;for(k in p.slicedData.slices){d.data(p.slicedData.slices[k].data.data);var b=sap.viz.data.utils.CTB2TBConvertUtil.crossTable2FlatTableData(d);for(i in b.data){b.data[i].unshift(p.slicedData.slices[k].dimensionMember);b.data[i].push(a++);n.push(b.data[i]);}if(!m){m=b.metadata;}}var c={'dataType':p.sliceDimension['dataType'],'id':p.sliceDimension['id'],'name':p.sliceDimension['name'],'customData':p.sliceDimension['customData'],'semanticType':'Dimension'};if(m){m.fields.unshift(c);var e={'data':n,'metadata':m};r.chart.vizInstance.data.val=e;}var f=c;f.actions=null;f.aggregationTarget=undefined;f.aggregationType=undefined;f.hierarchyLevels=null;f.type=A.DIMENSION;r.chart.feedingItems.unshift({id:'dataFrame',type:'Dimension',values:[f]});r.chart.vizInstance.bindings.unshift({feed:'dataFrame',source:[f.id]});if(m){r.chart.vizInstance.data.val=D._updateFlatTableDataset(F.fromJSON(r.chart.feedingItems),r.chart.vizInstance.data.val);}var g=[];var s=p.slicedData.slices;for(k in s){g.push(s[k].dimensionMember);}r.playControl.slicedData=g;return r;};P.migrate=function(j){return this.migrateV2toV3(j);};return P;});define('sap/viz/controls/common/migrate/migrationchain/V3toV4Chain',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/migrate/migrationchain/VersionChain','sap/viz/controls/common/utils/InfoChartUtil'],function($,O,u,V,I){var a=function(){a.superclass.constructor.apply(this,arguments);this.fromVersion="5.5.0";this.toVersion="5.8.0";this.setSuccessor(null);};O.extend(a,V);a.prototype.migrateChart=function(j){if(c(j)){this._migrateCombinationRendererInfo(j.chart.vizInstance.bindings,j.chart.vizInstance.properties,j.chart.vizView.pAdapter.rendererInfo);}return j;};a.prototype.migrateFeedingPanel=function(j){return j;};a.prototype.migrateVizFrame=function(j){var f=u.clone(j);if(j.chart){f=this.migrateChart(f);}return f;};a.prototype.migrateVizBuilder=function(j){return j;};a.prototype._migrateCombinationRendererInfo=function(b,d,r){function f(l,m){if(!r[m]){return;}var n=r[m].parameters;if(n){var o=n.length;for(var p=o-1;p>=0;p--){var q=n[p];if(!q.ctx&&q.paras){for(var i=l.length-1;i>=0;i--){if(!n.some(function(t){if(t.ctx&&(Object.keys(t.ctx).length===1)&&t.ctx.measureNames&&(t.ctx.measureNames===l[i].ctx.measureNames)){return true;}return false;})){n.push({ctx:l[i].ctx,paras:q.paras});}}n.splice(n.indexOf(q),1);break;}}}}var g=[],h=[];var k;try{k=sap.viz.api.metadata.Viz.get("info/combination").properties.plotArea.children.dataShape.children.primaryAxis.defaultValue;}catch(e){k=["bar","line","line"];}if(d.plotArea&&d.plotArea.dataShape&&d.plotArea.dataShape.primaryAxis){k=d.plotArea.dataShape.primaryAxis;}for(var i=b.length-1;i>=0;i--){if(b[i].feed&&b[i].feed==="valueAxis"){var s=b[i].source;for(var j=s.length-1;j>=0;j--){if(k[j]&&k[j]==="bar"){g.push({ctx:{"measureNames":s[j]}});}if(j>=k.length||(k[j]&&k[j]==="line")){h.push({ctx:{"measureNames":s[j]}});}}break;}}if(g.length>0){f(g.concat(h),"plotArea.markerRenderer.dataPointRenderer");}if(h.length>0){f(h,"plotArea.line.lineRenderer");}};function c(j){if(j.chart){var t=j.chart.type,i=I.isInfoChart(t);if(i&&t==="info/combination"&&j.chart.vizView&&j.chart.vizView.pAdapter&&j.chart.vizView.pAdapter.rendererInfo){var r=j.chart.vizView.pAdapter.rendererInfo;if(j.chart.vizInstance&&j.chart.vizInstance.bindings&&j.chart.vizInstance.properties&&(r["plotArea.markerRenderer.dataPointRenderer"]||r["plotArea.line.lineRenderer"])){return true;}}}return false;}return a;});define('sap/viz/controls/common/migrate/migrationchain/V2toV3Chain',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/migrate/migrationchain/VersionChain','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/migrate/migrator/TypeMigrator','sap/viz/controls/common/migrate/migrator/FeedMigrator','sap/viz/controls/common/migrate/migrator/DataMigrator','sap/viz/controls/common/migrate/migrator/PropertyMigrator','sap/viz/controls/common/migrate/migrator/PlayControlMigrator','sap/viz/controls/common/utils/FlatTableFakeDataUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/migrate/migrator/MigratorHelper','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/migrate/migrationchain/V3toV4Chain'],function(O,u,V,I,T,F,D,P,a,b,C,M,c,d){var e=function(){e.superclass.constructor.apply(this,arguments);this.fromVersion="4.0.16";this.toVersion="5.5.0";this.setSuccessor(new d());};O.extend(e,V);e.prototype.migrateChart=function(j){if(!j.chart){return j;}var t=j.chart.type,f=I.isInfoChart(t),g=I.getInfoType(t),h=!!g,k,l,r,m,n,o,p;var q=[c.TYPE_BUBBLE,c.TYPE_TRELLIS_BUBBLE,c.TYPE_GEO_BUBBLE,c.TYPE_TRELLIS_GEO_BUBBLE];for(var s in q){if(t===q[s]){var v=['chart','vizInstance','properties','plotArea'];var w=M.getValue(j,v);if(!w||!w.showNegativeValues){var x=['chart','vizInstance','properties','plotArea','showNegativeValues'];j=M.setValue(j,x,false);}break;}}if(!f&&!h){var y=j.chart.feedingItems;j.chart.feedingItems=F._feedingToBinding(t,y);if(C.isGeo(t)){sap.viz.geo.utils.Serialization.migrate(j.chart.vizInstance);}return j;}j.chart=T.migrateV2toV3(j.chart);j.chart.vizInstance=T.migrateV2toV3(j.chart.vizInstance);j=F.migrateV2toV3(j);if(j.chart.vizInstance){j=D.migrateV2toV3(j);j.chart.vizInstance=P.migrateV2toV3(j.chart.vizInstance);}if(f){if(j.chart.vizView&&j.chart.vizView.pAdapter&&j.chart.vizView.pAdapter.rendererInfo){var z=j.chart.vizView.pAdapter.rendererInfo;for(var A in z){if(z.hasOwnProperty(A)){var B=z[A];var E=B.parameters;if(E){for(var i=0;i<E.length;i++){if(E[i].ctx){for(var G in E[i].ctx){if(G==='MeasureNamesDimension'){E[i].ctx['measureNames']=E[i].ctx['MeasureNamesDimension'];delete E[i].ctx['MeasureNamesDimension'];}}}}}}}}}return j;};e.prototype.migrateFeedingPanel=function(j){j=T.migrateV2toV3(j);j.feedingItems=F._feedingToBinding(j.type,j.feedingItems);return j;};e.prototype.migrateVizFrame=function(j){var f=u.clone(j);if(j.chart){f=this.migrateChart(f);}if(j.playControl){f=a.migrateV2toV3(f);}return f;};e.prototype.migrateVizBuilder=function(j){if(j.switchBar){j.switchBar=T.migrateV2toV3(j.switchBar);}if(j.feedingPanel){j.feedingPanel=this.migrateFeedingPanel(j.feedingPanel);}return j;};return e;});define('sap/viz/controls/common/migrate/migrationchain/V1toV2Chain',['sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/migrate/migrationchain/VersionChain','sap/viz/controls/common/migrate/migrationchain/V2toV3Chain','sap/viz/controls/common/migrate/migrator/FeedMigrator'],function(u,O,V,a,F){var b=function(){b.superclass.constructor.apply(this,arguments);this.fromVersion="1.0";this.toVersion="4.0.16";this.setSuccessor(new a());};O.extend(b,V);b.prototype.migrateChart=function(j){return j;};b.prototype.migrateFeedingPanel=function(j){return j;};b.prototype.migrateVizFrame=function(j){var f=u.clone(j);if(j['chart']){var m=j['chart']['vizModel'];delete f['chart']['vizModel'];if(m){f['chart']['type']=m['vizType'];f['chart']['feedingItems']=m['feedingItems'];f['filterBar']={};f['filterBar']['filterItems']=m['filterItems'];f['contextMenu']={};f['contextMenu']['isMNDVisible']=m['isMNDVisible'];}var i=j['chart']['vizInstance'];if(i){f['chart']['vizInstance']=i;}}var c=j['comments'];if(c){delete f['comments'];f['annotation']=c;}if(f.chart){f=F.migrateV1toV2(f);}return f;};b.prototype.migrateVizBuilder=function(j){return j;};return b;});define('sap/viz/controls/common/migrate/MigrationHandler',['sap/viz/controls/common/migrate/migrationchain/V1toV2Chain','sap/viz/controls/common/migrate/migrationchain/V2toV3Chain','sap/viz/controls/common/migrate/migrationchain/V3toV4Chain','sap/viz/controls/Version','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/feeds/FeedItemType'],function(V,a,b,c,C,F,d){var m=(function init(){var m={};[V,a,b].forEach(function(e){var v=new e();m[v.fromVersion]=v;});return m;}());return{_getVersion:function(j){if(!j){return j;}var v=j.version;var e;if(v&&v.split){e=v.split('.');if(e.length===4){return e[0]+'.'+e[1]+'.'+e[2];}}return v;},_getVersionChain:function(v){if(!v){return new V();}if(m[v]===undefined){if(v.split('.').length!==3){return new V();}var f,t;for(f in m){t=m[f].toVersion;if(v>f&&v<t){return m[f];}}if(v>=t){return null;}}else{return m[v];}},migrate:function(j){var r={};if(j.vizFrame){r.vizFrame=this.migrateVizFrame(j.vizFrame);}else{r.vizFrame=this.migrateVizFrame(j);}if(j.vizBuilder){r.vizBuilder=this.migrateVizBuilder(j.vizBuilder);}return r;},migrateVizFrame:function(j){var v=this._getVersion(j);var e=this._getVersionChain(v);while(e){j=e.migrateVizFrame(j);j.version=e.toVersion;e=e.getSuccessor();}j.version=c.VERSION;return j;},migrateVizBuilder:function(j){var v=this._getVersion(j);var e=this._getVersionChain(v);while(e){j=e.migrateVizBuilder(j);j.version=e.toVersion;e=e.getSuccessor();}j.version=c.VERSION;return j;},migrateChart:function(j){var v=new V();while(v){j=v.migrateChart(j);v=v.getSuccessor();}return j;},migrateFeedingPanel:function(j){var v=new V();while(v){j=v.migrateFeedingPanel(j);v=v.getSuccessor();}return j;},migrateOldGeo:function(v){if(!v){return;}var e=v['type'];if(C.isOldGeo(e)){if(v&&v.feedingItems){var f=v.feedingItems;for(var k=f.length-1;k>=0;k--){if(f[k].id===F.ID_GEO){var g=f[k].values;for(var j=g.length-1;j>=0;j--){if(g[j].dataType!==d.GEOGRAPHY.toLowerCase()){g[j].dataType=d.GEOGRAPHY.toLowerCase();}}}}}}}};});define('sap/viz/controls/common/utils/Serialization',['sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/common/managers/LangManager','sap/viz/controls/Version','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/migrate/MigrationHandler','sap/viz/controls/common/migrate/migrator/TypeMigrator','sap/viz/controls/common/migrate/migrator/FeedMigrator','sap/viz/controls/common/migrate/migrator/PropertyMigrator','sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/feeds/FeedItemType','jquery','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/utils/DatasetUtil'],function(F,A,a,b,u,V,G,I,L,c,d,C,e,M,T,f,P,g,h,Q,D,l){var S={};S.TypeConst={FlatTableDataset:'FlatTable',CrosstableDataset:'Crosstable',RawDataset:'JSON'};var _=function(v){var i=S._getValue(v,['vizFrame']);if(i){S._setValue(v,['vizFrame'],M.migrateChart(i));}};S.migrate=function(v){return M.migrate(v);};S.migrateVizFrame=function(v,i){var r=M.migrateVizFrame(u.clone(v));if(i){M.migrateOldGeo(r["chart"]);}return r;};S.migrateFeedingPanel=function(v){return M.migrateFeedingPanel(v);};S.getFeeds=function(v){var i=S._getValue(v,['vizFrame']);if(i){i=S.migrateVizFrame(S._getValue(v,['vizFrame']));S._setValue(v,['vizFrame'],i);}var j=null;var k=S._getValue(v,['vizFrame','chart','feedingItems']);var m=S._getValue(v,['vizBuilder','feedingPanel','feedingItems']);var n,t;if(k){j=k;var o=S._getValue(v,['vizFrame','contextMenu']);if(o){n=o.isMNDVisible;}t=S._getValue(v,['vizFrame','chart','type']);}else if(m){j=m;var p=S._getValue(v,['vizBuilder','feedingPanel']);if(p){n=p.mndVisible;}t=S._getValue(v,['vizBuilder','feedingPanel','type']);}if(j==null){return[];}var q=F.fromJSON(j);q=f.migrate(q,t);if(n===false){q=d.removeMND(q);}return q;};S.updateFeeds=function(v,i){_(v);var t=S._getValue(v,['vizFrame','chart','type'])||S._getValue(v,['vizBuilder','feedingPanel','type']);t=d.adaptChartType(i,t);i=f.migrate(i,t);var j=F.toJSON(i);S._setValue(v,['vizFrame','chart','feedingItems'],j);S._setValue(v,['vizBuilder','feedingPanel','feedingItems'],j);S._setValue(v,['vizFrame','chart','type'],t);S._setValue(v,['vizFrame','chart','vizInstance','type'],t);return v;};S.getFilters=function(v){var i=S._getValue(v,['vizFrame','filterBar','filterItems']);if(i==null){return[];}var j=b.fromJSON(i);return j;};S.updateFilters=function(v,i){_(v);var j=b.toJSON(i);S._setValue(v,['vizFrame','filterBar','filterItems'],j);return v;};S.removeDataset=function(v){_(v);var i=S._getValue(v,['vizFrame','chart','vizInstance']);if(i){var t=S.getChartType(v);if(!C.isGeo(t)){delete i['data'];}else{sap.viz.geo.utils.Serialization.removeDataset(i);}}return v;};S.emptyDataset=function(v){_(v);var i=S._getValue(v,['vizFrame','chart','vizInstance','data']);if(i){S._emptyDataset(i);}var s=S._getValue(v,['vizFrame','playControl','slicedData']);if(s){s.measuresInfo=[];s.slices=[];}return v;};S._emptyDataset=function(j){if(!j){return;}if(j instanceof Array){for(var i=0;i<j.length;i++){S._emptyDataset(j[i]);}}else{var t=j['type'];var k=j['val'];var m={};var n={};if(t===S.TypeConst.CrosstableDataset){m=new sap.viz.api.data.CrosstableDataset();m.data(k);n=m.toJSON({emptyDataset:true}).data;}else if(t===S.TypeConst.FlatTableDataset){m=new sap.viz.api.data.FlatTableDataset(k);n=m.toJSON({emptyDataset:true}).data;}else if(t===S.TypeConst.RawDataset){n={};}else{throw L.get('VIZ_COMMON_SERIALIZATION_FAILED')+L.get('VIZ_COMMON_INVALID_SERIALIZATION_PACKAGE');}j['val']=n;}};S.updateDataset=function(v,i){_(v);var j=S._getValue(v,['vizFrame','chart','vizInstance']);if(j){j['data']={};if(e.isInfoChart(j.type)&&(l.getType(i)===D.CROSS_TABLE)){i=e.buildInfoDataset(i);}if(!C.isGeo(j.type)){S._updateDataset(j['data'],i);}else{sap.viz.geo.utils.Serialization.updateDataset(j,i);}}return v;};S._updateDataset=function(j,k){if(!j||!k){return;}if(k instanceof Array){for(var i=0;i<k.length;i++){var m=k[i];S._updateDataset(j[i],m);}}else if(l.getType(k)===D.CROSS_TABLE){j['type']=S.TypeConst.CrosstableDataset;j['val']=k.data();}else if(l.getType(k)===D.FLAT_TABLE){j['type']=S.TypeConst.FlatTableDataset;j['val']=k.data();}else{j['type']=S.TypeConst.RawDataset;j['val']=k;}};S.convertToVizSerialization=function(v){_(v);var i=S._getValue(v,['vizFrame','vizInstance']);if(i){return u.clone(i);}return null;};S.updateProperties=function(v,p){_(v);var t=S._getValue(v,['vizFrame','chart','vizInstance','type']),i=S._getValue(v,['vizFrame','chart','vizInstance','properties']);var j=M.migrateChart({"chart":{type:t,vizInstance:{type:t,properties:p}}});p=S._getValue(j,['chart','vizInstance','properties']);if(i){Q.extend(true,i,p);}else{S._setValue(v,['vizFrame','chart','vizInstance','properties'],p);}var s=S._getValue(j,['chart','vizInstance','scales']);S._mergeScales(v,s);return v;};S.getProperties=function(v){_(v);var p=S._getValue(v,['vizFrame','chart','vizInstance','properties']);return p||{};};S.updateScales=function(v,s){var n=false;if(v&&!v.vizFrame&&v.chart){n=true;v={vizFrame:v};}_(v);S._mergeScales(v,s);if(v){if(n){return v.vizFrame;}else{return v;}}return null;};S._mergeScales=function(v,s){var j=S._getValue(v,['vizFrame','chart','vizInstance','scales'])||[];if(u.isArray(s)){var k={},i;for(i=j.length-1;i>=0;i--){k[j[i].feed]=j[i];}var m={};for(i=s.length-1;i>=0;i--){m[s[i].feed]=s[i];}Q.extend(k,m);var n=[];for(i=0;i<j.length;i++){n.push(k[j[i].feed]);delete k[j[i].feed];}for(var o in k){n.push(k[o]);}S._setValue(v,['vizFrame','chart','vizInstance','scales'],n);}};S.getScales=function(v){if(v&&!v.vizFrame&&v.chart){v={vizFrame:v};}_(v);var s=S._getValue(v,['vizFrame','chart','vizInstance','scales']);return s||[];};S.updateAnalysisObjectLabels=function(v,i){if(!i||!v){return v;}_(v);var m=S.getFeeds(v)||[];var n=S.getFilters(v)||[];var s=S._getSliceDimension(v);function o(j){var k={};j.forEach(function(q){if(q){k[q.id()]=q;}});return k;}function p(j){var k={};var q=j.slice();while(q.length){var B=q.shift();if(B){var E=B.hierarchyLevels()||[];k[B.id()]={ao:B,hlHash:o(E)};q=q.concat(E.map(function(H){return H._analysis;}));}}return k;}var r=p(i);m.forEach(function(j){var k=j.values();if(k){var q=p(k);for(var B in q){var E=q[B];var t=r[B];if(t){E.ao.name(t.ao.name());for(var x in E.hlHash){var H=E.hlHash[x];var J=t.hlHash[x];if(J){H._name=J.name();}}}}}});n.forEach(function(q){if(q){var B=q.getType();if(B===a.NUMERIC_RANGE_TYPE||B===a.DATE_RANGE_TYPE||(B===a.VALUE_TYPE&&!q.hierarchyLevelId)){var t=r[q.getFilteredObjectId()];if(t){q.filteredObjectName=t.ao.name();}}else if(B===a.VALUE_TYPE&&q.hierarchyLevelId){for(var j=0;j<i.length;j++){var E=i[j].hierarchyLevels();if(E){for(var k=0;k<E.length;k++){var z=E[k];if(z&&z.id()===q.hierarchyLevelId){q.filteredObjectName=z.name();break;}}}}}}});if(s){var t=r[s.id()];if(t){s.name(t.ao.name());var w=o(s.hierarchyLevels()||[]);for(var x in w){var y=w[x];var z=t.hlHash[x];if(z){y._name=z.name();if(y._analysis&&z._analysis&&y._analysis.id()===z._analysis.id()){y._analysis.name(z._analysis.name());}}}}}S.updateFeeds(v,m);S.updateFilters(v,n);S._updateSliceDimension(v,s);return v;};S.defaultIncompletePackage=function(t){t=T.migrate(t);var i=G.defaultUIConfig(G.DEFAULT_UICONFIG_TYPE_CHART);var p,j;if(t){var k=C.getChartId(t);if(i&&i.hasOwnProperty('specificProperties')){p=u.updateJSON(i.defaultProperties,i.specificProperties[k]);}else{p=i?i.defaultProperties:{};}p=V.convertProperties(p,C.getVizType(t),t);}else{p={};}var m=I.getDataset(t);var n;if(C.isTable(t)){n={type:S.TypeConst.RawDataset,val:m};}else{n={type:l.getType(m)===D.FLAT_TABLE?S.TypeConst.FlatTableDataset:S.TypeConst.CrosstableDataset,val:m.data()};}return{'vizFrame':{'version':c.VERSION,'chart':{'vizInstance':{'data':n,'properties':p,'type':t},'type':t,'vizTitleMode':"auto"},'contextMenu':{}}};};S.updateCustomData=function(v,i){_(v);S._setValue(v,['customData'],i);return v;};S.getCustomData=function(v){return S._getValue(v,['customData'])||{};};S.updateControlSettings=function(v,i,s,j){_(v);var t=S._getValue(v,['vizFrame','chart','type']);if(C.supportAnimation(t)&&i==='playControl'){if(s==='slicedData'){S._updateSlicedData(v,j);}else if(s==='sliceDimension'){S._updateSliceDimension(v,j);}else if(s==='value'){S._setValue(v,['vizFrame','playControl','value'],j);}}};S.getControlSettings=function(v,i,s){if(i==='playControl'){if(s==='slicedData'){return S._getSlicedData(v);}else if(s==='sliceDimension'){return S._getSliceDimension(v);}if(s==='value'){return S._getValue(v,['vizFrame','playControl','value']);}}else{return null;}};S.getChartType=function(v){return T.migrate(S._getValue(v,['vizFrame','chart','type']));};S.updateCss=function(v,i){_(v);var t=S._getValue(v,['vizFrame','chart','vizInstance','type']);var p=S._getValue(v,['vizFrame','chart','vizInstance','properties']);var j=M.migrateChart({chart:{type:t,vizInstance:{type:t,properties:p,css:i}}});p=S._getValue(j,['chart','vizInstance','properties']);S._setValue(v,['vizFrame','chart','vizInstance','properties'],p);S._setValue(v,['vizFrame','chart','vizInstance','css'],i);return v;};S._updateSliceDimension=function(v,i){if(u.isArray(i)){return;}var j=A.toJSON(i);S._setValue(v,['vizFrame','playControl','sliceDimension'],j);};S._getSliceDimension=function(v){var i=S._getValue(v,['vizFrame','playControl','sliceDimension']);if(i){return A.fromJSON(i);}else{return;}};S._updateSlicedData=function(v,s){var r={};var t=S._getValue(v,['vizFrame','chart','type']);if(e.isInfoChart(t)){r=s;}else{r.measuresInfo=s.measuresInfo;if(u.isArray(s.slices)){r.slices=[];for(var i=0;i<s.slices.length;i++){r.slices.push({data:s.slices[i].data.toJSON(),dimensionMember:s.slices[i].dimensionMember});}}}S._setValue(v,['vizFrame','playControl','slicedData'],r);};S._getSlicedData=function(v){var s=S._getValue(v,['vizFrame','playControl','slicedData']);if(s){var t=S._getValue(v,['vizFrame','chart','type']);var r={};if(e.isInfoChart(t)){r=s;}else{r.measuresInfo=s.measuresInfo;r.slices=[];var j=s.slices;if(j){for(var i=0;i<j.length;i++){var k=j[i];r.slices.push({data:sap.viz.api.data.CrosstableDataset.fromJSON(k.data),dimensionMemeber:k.dimensionMemeber});}}}return r;}else{return;}};S._getValue=function(r,p){if(!r||!p||!p.length){return;}var n=r;for(var i=0;i<p.length-1;i++){if(!n[p[i]]){return;}n=n[p[i]];}var j=p[p.length-1];return n[j];};S._setValue=function(r,p,v){if(!r||!p||!p.length){return null;}var n=r;for(var i=0;i<p.length-1;i++){if(!n[p[i]]){return;}n=n[p[i]];}var j=p[p.length-1];n[j]=v;};S.getPictogramInfo=function(v){if(v&&!v.vizFrame&&v.chart){v={vizFrame:v};}_(v);return S._getValue(v,['vizFrame','chart','vizView']);};S.updatePictogramInfo=function(v,p){var n=false;if(v&&!v.vizFrame&&v.chart){n=true;v={vizFrame:v};}_(v);S._setValue(v,['vizFrame','chart','vizView'],p);if(v){if(n){return v.vizFrame;}else{return v;}}return null;};return S;});define('sap/viz/controls/common/utils/Feeds',['sap/viz/controls/common/feeds/FeedUtils'],function(F){var a={feedCompatible:function(f,b,d){return F.feedCompatible(f,b,d);},equal:function(f,b){return F.equal(f,b);}};return a;});define('sap/viz/controls/common/views/menu/MenuItem',['require','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/JsonUtil'],function(r,u,J){var a=r||a;var M=function(i,n,s){this.__className="sap.viz.controls.common.views.menu.MenuItem";this._id=i;this._name=n;this._enabled=true;this._selected=false;this._subMenuGroups=s;};M.prototype.id=function(){return this._id;};M.prototype.name=function(){return this._name;};M.prototype.icon=function(){return this._icon;};M.prototype.subMenuGroups=function(){return this._subMenuGroups;};M.prototype.enabled=function(v){if(arguments.length>0){this._enabled=v;return this;}else{return this._enabled;}};M.prototype.selected=function(v){if(arguments.length>0){this._selected=v;return this;}else{return this._selected;}};M.prototype.equal=function(m){if(m==null){return false;}if(this.id()!==m.id()){return false;}if(this.name()!==m.name()){return false;}if(this.enabled()!==m.enabled()){return false;}if(this.selected()!==m.selected()){return false;}var s=this.subMenuGroups()||[];var b=m.subMenuGroups()||[];if(s.length!==b.length){return false;}for(var i=0;i<s.length;i++){var c=s[i];var d=b[i];if(!(c==null&&d==null)){if(c==null){return false;}if(!c.equal(d)){return false;}}}return true;};M.toJSON=function(i){return u.toJSON(i,function(i){return{'id':i._id,'name':i._name,'subMenuGroups':J.toJSON(J.MenuGroupType,i._subMenuGroups),'enabled':i._enabled,'selected':i._selected};});};M.fromJSON=function(j){return u.fromJSON(j,function(j){var m=new M(j.id,j.name,J.fromJSON(J.MenuGroupType,j.subMenuGroups));m.enabled(j.enabled);m.selected(j.selected);return m;});};J.register(J.MenuItemType,M.fromJSON,M.toJSON);return M;});define('sap/viz/controls/common/events/Event',[],function(){var E=function(t,a,d){this.__className="sap.viz.controls.common.events.Event";this._type=t;this._target=a;this.data=d;};E.prototype.type=function(){return this._type;};E.prototype.target=function(){return this._target;};return E;});define('sap/viz/controls/common/views/feed/FeedListEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedListEvent";};O.extend(F,E);F.DROP_DOWN_OPENED="dropDownOpened";F.DROP_DOWN_CLOSED="dropDownClosed";F.ITEM_SELECTED="itemSelected";return F;});define('sap/viz/controls/common/events/FeedEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var F=function(t,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.events.FeedEvent";};O.extend(F,E);F.FEED_READY="feedReady";F.REQUEST_FEED="requestFeed";F.FEEDS_CHANGED="feedsChanged";return F;});define('sap/viz/controls/runtime/Runtime',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher'],function(O,E,a){var R=function(){this._models={};this._modelRefs={};};O.extend(R,a);R.prototype.registerModel=function(u,m){this._models[u]=m;this._modelRefs[u]=1;};R.prototype.addModelRef=function(u){this._modelRefs[u]++;};R.prototype.removeModelRef=function(u){this._modelRefs[u]--;if(this._modelRefs[u]===0){this._models[u]=null;}};R.prototype.getModel=function(u){return this._models[u];};return R;});define('sap/viz/controls/runtime/RuntimeManager',['sap/viz/controls/runtime/Runtime'],function(R){var a={};a.getRuntime=function(){var _=window["__viz_controls_runtime"];if(_==null){window["__viz_controls_runtime"]=_=new R();}return _;};return a;});define('sap/viz/controls/common/helpers/MapLayers',['sap/viz/controls/common/utils/Utils'],function(U){var M={};M.toJSON=function(i){return U.toJSON(i,function(i){return i;});};M.fromJSON=function(j){return U.fromJSON(j,function(j){return j;});};return M;});define('sap/viz/controls/runtime/ModelHandler',['sap/viz/controls/common/utils/ChartTypeUtil'],function(C){var M=function(v){this.__className="sap.viz.controls.runtime.ModelHandler";this._vizModel=v;this._isMNDVisibleChanged=false;this._feedingItemsChanged=false;};M.prototype._type=function(v){if(arguments.length>0){this._vizModel._type=v;return this;}else{return this._vizModel._type;}};M.prototype._feedingItems=function(v){if(arguments.length>0){this._vizModel._feedingItems=v;return this;}else{return this._vizModel._feedingItems;}};M.prototype._filterItems=function(v){if(arguments.length>0){this._vizModel._filterItems=v;return this;}else{return this._vizModel._filterItems;}};M.prototype.explicitFeedingItems=function(o){return this._vizModel.feedingItems();};M.prototype.deactive=function(){};M.prototype.postLoad=function(){};M.prototype.feedingItemsChanged=function(v,e){};M.prototype.isMNDVisibleChanged=function(v){};M.prototype._setIsMNDVisible=function(v){};M.prototype.vizModelChanged=function(o){};M.prototype._restorePlayerFieldHistory=function(n){var s=false;if(!C.supportAnimation(n)){var p=this._vizModel.playerField()?this._vizModel.playerField().clone():null;s=this.updatePlayerField(null);if(p){this._vizModel._playerFieldHistory=p;}}else{if(!this._vizModel.playerField()){s=this.updatePlayerField(this._vizModel._playerFieldHistory);}}return s;};M.prototype.propertiesChanged=function(t,a){};M.prototype.getFilterItems=function(s,i,v,f){};M.prototype.cloneFeeds=function(f){};M.prototype.clone=function(c){};M.prototype.updatePlayerField=function(v){var s=false;if(arguments.length>0){if(v){if(!this._vizModel._playerField||!this._vizModel._playerField.equal(v)){this._vizModel._playerField=v;s=true;}}else{if(this._vizModel._playerField){this._vizModel._playerFieldHistory=this._vizModel._playerField=null;s=true;}}}return s;};M.prototype._buildHistory=function(t,f){return{'type':t,'feedingItems':f};};return M;});define('sap/viz/controls/runtime/InfoModelHandler',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/helpers/MapLayers','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/runtime/ModelHandler','sap/viz/controls/common/bindingdef/BindingDefUtils','sap/viz/controls/common/services/FeedValidationService','sap/viz/controls/common/feeds/FeedItemType'],function($,O,u,E,a,C,A,b,H,F,c,M,B,d,e,f,g,h,k,l){var I=function(i){I.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.InfoModelHandler";};O.extend(I,g);I.prototype.explicitFeedingItems=function(i){i=i||{};var j=this._feedingItems();var z=this._type();if(!e.isMultipleChart(z)){j=c.removeRowAndColumnFeedItems(j);}var D=i.withMND!=null?i.withMND===true:this._vizModel.isMNDVisible();if(!D){j=c.removeMND(j);}var G=c.buildEmptyFeeds(z);j=c.merge(G,j);return j;};I.prototype.deactive=function(i){if(!this._vizModel._history){this._vizModel._history=this._buildHistory(i,c.cloneFeeds(this._feedingItems()));}var j=this._vizModel.playerField();if(j){this._vizModel._playerFieldHistory=j.clone();}};I.prototype.postLoad=function(){var i=this._feedingItems();this._vizModel._history=this._buildHistory(this._type(),c.cloneFeeds(i));var j=this._type();var z=c.hasMND(i);this._vizModel._isMNDVisible=z;};I.prototype.vizModelChanged=function(i){var j={};if(i.type!==undefined){$.extend(j,{'type':{'from':this._type(),'to':i.type}});}if(i.feedingItems!=null){$.extend(j,{'feedingItems':{'from':this._feedingItems(),'to':i.feedingItems}});}if(i.filterItems!==undefined){$.extend(j,{'filterItems':{'to':i.filterItems}});}if(i.playerField!==undefined){$.extend(j,{'playerField':{'to':i.playerField}});}this._sync(j);};I.prototype.propertiesChanged=function(i,j){this._sync({'type':{'from':i,'to':this._type()}});};I.prototype.feedingItemsChanged=function(i,j){var z=this._vizModel.extensionValues();j=z.feedingPanel?z.feedingPanel.enableTrellis:j;if(j===false){i=c.removeRowAndColumnFeedItems(i);}this._sync({'feedingItems':{'from':this._feedingItems(),'to':i}});};I.prototype.isMNDVisibleChanged=function(){this._sync({'isMNDVisible':{'from':!this._vizModel._isMNDVisible,'to':this._vizModel._isMNDVisible}});};I.prototype.getFilterItems=function(i,j,z,D){return f.getInfoFilterItems(i,j,this._filterItems(),this._feedingItems());};I.prototype.clone=function(z){var D=z;D._type=this._type();var G=this._feedingItems();if(G&&G.length>0){for(var i=0;i<G.length;i++){D._feedingItems[i]=G[i].clone();}}var J=this._filterItems();if(J&&J.length>0){for(var j=0;j<J.length;j++){D._filterItems[j]=J[j].clone();}}return D;};I.prototype._sync=function(i){var j=this._vizModel;if(i.feedingItems&&c.equal(i.feedingItems.from,i.feedingItems.to)){delete i.feedingItems;}var z=false;var D={'type':undefined,'feedingItems':undefined,'isMNDVisible':undefined};if(i.type&&!i.feedingItems){j._history=j._history||this._buildHistory(i.type.from,c.cloneFeeds(j._feedingItems));i.type.to=x(i.type.to,j._history.feedingItems,j._isMNDVisible);if(i.type.from!==i.type.to){D.type=i.type.to;D.feedingItems=B.switchFeeds(i.type.to,j._history.type,j._history.feedingItems).feeds;}}else if(i.feedingItems){z=true;if(!c.equal(i.feedingItems.from,i.feedingItems.to,{ignoreActions:true})){j._playerFieldHistory=null;}if(!k.validateMND(i.type?i.type.to:j._type,i.feedingItems.to)){D.feedingItems=c.removeMND(i.feedingItems.to);D.isMNDVisible=false;}else{D.isMNDVisible=c.hasMND(i.feedingItems.to);}}else if(i.isMNDVisible){j._history=j._playerFieldHistory=null;D.type=x(j._type,j._feedingItems,i.isMNDVisible.to);if(i.isMNDVisible.to){D.feedingItems=y(D.type,j._feedingItems).feeds;}else{D.feedingItems=c.removeMND(j._feedingItems);}}D.type=r(D.type,i.type,j._type);D.feedingItems=r(D.feedingItems,i.feedingItems,j._feedingItems);D.isMNDVisible=r(D.isMNDVisible,i.isMNDVisible,j._isMNDVisible);var G=D.type;D.type=x(D.type,D.feedingItems,D.isMNDVisible);if(D.type!==G&&!k.validateOverflow(D.type,D.feedingItems)){D.feedingItems=B.switchFeeds(D.type,G,D.feedingItems).feeds;}var J={'type':i.type?i.type.from:j._type,'feedingItems':i.feedingItems?i.feedingItems.from:j._feedingItems,'isMNDVisible':i.isMNDVisible?i.isMNDVisible.from:j._isMNDVisible};var K=D.isMNDVisible!==J.isMNDVisible;var L={'vizTypeChanged':D.type!==J.type,'feedingItemsChanged':(c.isEmptyFeeds(D.feedingItems)&&c.isEmptyFeeds(J.feedingItems))?false:(!h.equal(D.type,J.type)||!c.equal(D.feedingItems,J.feedingItems))||K,'isMNDVisibleChanged':K,'filterChanged':false,'sliceDimensionChanged':false};if(i.filterItems){j._filterItems=i.filterItems;L.filterChanged=true;}if(i.playerField){L.sliceDimensionChanged=this.updatePlayerField(i.playerField.to);}else if(L.vizTypeChanged){L.sliceDimensionChanged=this._restorePlayerFieldHistory(D.type)===true;}j._type=D.type;j._feedingItems=D.feedingItems;j._isMNDVisible=D.isMNDVisible;var N=null;if(z){if(j._history&&j._history.feedingItems){N=_(j._history.feedingItems,j._feedingItems);}j._history=this._buildHistory(j.type(),c.cloneFeeds(j._feedingItems));}j.dispatchPropertiesChangedEvent(L);if(N){j._dispatchFeedingChangedEvent({feedingItemsChanged:L.feedingItemsChanged,dimensionFeedingItemsChanged:N.dimensionFeedingItemsChanged,measureFeedingItemsChanged:N.measureFeedingItemsChanged,action:N.action});}};var _=function(i,j){var z={dimensionFeedingItemsChanged:false,measureFeedingItemsChanged:false};var D=null;var G=null;var J=null;var K=false;if(i&&j&&i.length>0&&j.length>0){i.some(function(L){D=L.id();G=L.type();if(D&&G){switch(m(D,G)){case l.MEASURE:K=q(L,j,G,D,z,true);break;case l.DIMENSION:K=q(L,j,G,D,z,false);break;case C.INVALID:break;default:}}return K;});}return z;};var v={"Measure":[C.VALUE_AXIS,C.SECOND_VALUE_AXIS,C.SIZE],"Dimension":[C.CATEGORY_AXIS,C.COLOR,C.SHAPE,C.DATA_FRAME,C.TITLE]};var m=function(i,j){var z=C.INVALID;if(v[j].indexOf(i)>-1){z=j===l.MEASURE?l.MEASURE:l.DIMENSION;}return z;};var n=function(i,j,z){var D=null;var G=false;i.some(function(J){G=J.id()===z&&J.type()===j;if(G){D=J;}return G;});return D;};var o=function(i,j,z){var D=true;var G={};var J=i.values();var K=j.values();var L=K.length;var N=J.length;if(K&&J&&L!==null&&N!==null){if(L===N){var P=true;if(z){if(N>0){P=J.every(function(Q){return K.some(function(R){return Q.id()===R.id();});});}}else{P=p(J,K);}if(P){G.action="changeOrder";}else{G.action="replace";}D=!P;}else if(L>N){G.action="add";}else{G.action="remove";}}G.changed=D;return G;};var p=function(j,z){var D=true;if(j.length>0){for(var i=0;i<j.length;i++){if(j[i].id()!==z[i].id()){D=false;break;}}}return D;};var q=function(i,j,z,D,G,J){var K=false;var L=n(j,z,D);if(L){var N=o(i,L,J);K=N.changed;G.action=N.action;if(J){G.measureFeedingItemsChanged=K;}else{G.dimensionFeedingItemsChanged=K;}}return K;};var r=function(i,j,z){if(i!==undefined){return i;}else if(j!==undefined){return j.to;}else{return z;}};var s=function(i,j){if(e.supportMultiChart(i)){if(c.hasRowOrColumn(j)){return e.toMultiChartType(i);}else{return e.toSingleChartType(i);}}else{return i;}};var t=function(i,j){if(c.hasTime(j)){return e.toTimeChartType(i);}return i;};var w=function(i){if(e.supportMultiChart(i)){var j=e.toMultiChartType(i);if(i!==j&&!h.supportMND(i)&&h.supportMND(j)){return j;}else{return i;}}else{return i;}};var x=function(i,j,z){i=s(i,j);i=t(i,j);if(z){i=w(i);}return i;};var y=function(i,j,z){if(c.isEmptyFeeds(j)){return{'vizType':i,'feeds':j};}else{return{'vizType':i,'feeds':B.suggestMND(i,j)};}};return I;});define('sap/viz/controls/runtime/MapModelHandler',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/helpers/MapLayers','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/runtime/ModelHandler'],function(O,u,E,a,C,A,b,H,F,c,M,B,d,e,f,g){var h=function(v){h.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.MapModelHandler";};O.extend(h,g);h.prototype.feedingItemsChanged=function(v,n){if(n!==false){var j=[];var k=this._feedingItems();for(var i=0;i<v.length;i++){if(k[i]!==v[i]){if(k[i]&&v[i]&&c.equal(k[i],v[i])){continue;}else{j.push(i);}}}this._feedingItems(v);if(j.length>0){this._vizModel._history=null;this._vizModel._playerFieldHistory=null;var l={'feedingItemsChanged':true,feedsChangedInfo:{items:j}};this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(l);}}else{this._feedingItems(v);}};h.prototype.isMNDVisibleChanged=function(v){this._vizModel._history=null;};h.prototype._setIsMNDVisible=function(v){if(this._vizModel.isMNDVisible()!==v){this._vizModel._isMNDVisible=v;this._isMNDVisibleChanged=true;}};h.prototype.vizModelChanged=function(o){var j=false;var s=false;var k=this._type();if(o.type){this._type(o.type);}var n=this._type();if(n!==k){s=this._restorePlayerFieldHistory(n);}else if(o&&(o.playerField!==undefined)){s=this.updatePlayerField(o.playerField);}if(o.feedingItems){var l=this._feedingItems();if(l.length!=o.feedingItems.length){j=true;}else{for(var i=0;i<l.length;i++){if(!c.equal(l[i],o.feedingItems[i])){j=true;break;}}}if(j){this._vizModel._history=null;this._feedingItems(o.feedingItems);this._vizModel.extensionValues({map:{feeding:o.feedingItems}});}}var m=false;if(o.filterItems){this._filterItems(o.filterItems);m=true;}var p={'vizTypeChanged':k!==n,'feedingItemsChanged':this._feedingItemsChanged||j,'filterChanged':m};if(s===true){p.sliceDimensionChanged=true;}this._type(n);this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(p);};h.prototype.propertiesChanged=function(t,i){var v=this._type();if(!v){return;}var n=v;var j={'vizTypeChanged':i||(v!==t)};this._type(n);this._feedingItemsChanged=false;this._isMNDVisibleChanged=false;if(j.vizTypeChanged){var s=this._restorePlayerFieldHistory(n);if(s===true){j.sliceDimensionChanged=true;}}this._vizModel.dispatchPropertiesChangedEvent(j);};h.prototype.getFilterItems=function(s,i,v,j){return f.getMapFilterItems(s,i,this._filterItems(),this._feedingItems());};h.prototype.clone=function(k){var r=k;r._type=this._type();var l=this._feedingItems();if(l&&l.length>0){for(var i=0;i<l.length;i++){r._feedingItems[i]=[];for(var n=0;n<l[i].length;n++){r._feedingItems[i][n]=l[i][n].clone();}}}var m=this._filterItems();if(m&&m.length>0){for(var j=0;j<m.length;j++){r._filterItems[j]=m[j].clone();}}return r;};return h;});define('sap/viz/controls/runtime/VizModelHandler',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/helpers/MapLayers','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/services/FeedValidationService','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/runtime/ModelHandler','sap/viz/controls/common/bindingdef/BindingDefUtils'],function(O,u,E,a,C,A,b,H,F,c,d,M,B,e,f,g,h,k,l){var V=function(v){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizModelHandler";};O.extend(V,k);V.prototype.explicitFeedingItems=function(i){i=i||{};var j=this._feedingItems();var t=this._type();if(!g.isMultipleChart(t)){j=d.removeRowAndColumnFeedItems(j);}var w=i.withMND!=null?i.withMND===true:this._vizModel.isMNDVisible();if(!w){j=d.removeMND(j);}var p=d.buildEmptyFeeds(t);j=d.merge(p,j);return j;};V.prototype.deactive=function(i){if(!this._vizModel._history){this._vizModel._history=this._buildHistory(i,d.cloneFeeds(this._feedingItems()));}var p=this._vizModel.playerField();if(p){this._vizModel._playerFieldHistory=p.clone();}};V.prototype.postLoad=function(){var i=this._feedingItems();this._vizModel._history=this._buildHistory(this._type(),d.cloneFeeds(i));this._vizModel._playerFieldHistory=this._vizModel.playerField()?this._vizModel.playerField().clone():null;var t=this._type();var j=d.hasMND(i);this._vizModel._isMNDVisible=j;if(!j){var p=_(t,i,j);this._feedingItems(p.feeds);}};V.prototype.feedingItemsChanged=function(v,i){var j=this._vizModel.extensionValues();i=j.feedingPanel?j.feedingPanel.enableTrellis:i;if(i===false){v=d.removeRowAndColumnFeedItems(v);}this._setIsMNDVisible(d.hasMND(v));this._feedingItemsChanged=!d.equal(v,this._feedingItems());if(this._feedingItemsChanged){this._feedingItems(v||[]);this._vizModel._history=null;var p=d.hasRowOrColumn(this._feedingItems());var q=this._type();var r;if(p&&!g.isMultipleChart(q)){r=g.toMultiChartType(q);this._vizModel.type(r);}else if(!p&&g.isMultipleChart(q)){r=g.toSingleChartType(q);this._vizModel.type(r);}else{this.propertiesChanged(q,false);}this._vizModel._history=null;this._vizModel._playerFieldHistory=null;}};V.prototype.isMNDVisibleChanged=function(v){this._isMNDVisibleChanged=true;this._vizModel._history=null;this._vizModel._playerFieldHistory=null;this.propertiesChanged(this._type(),false);this._vizModel._history=null;this._vizModel._playerFieldHistory=null;};V.prototype._setIsMNDVisible=function(v){var i=(v===true);if(this._vizModel.isMNDVisible()!==i){this._vizModel._isMNDVisible=i;this._isMNDVisibleChanged=true;}};V.prototype.vizModelChanged=function(i){var j=false;var s=false;if(!this._vizModel._history){this._vizModel._history=this._buildHistory(this._type(),d.cloneFeeds(this._feedingItems()));}var p=this._vizModel.isMNDVisible();var q=this._type();if(i.type){this._type(i.type);}var r=this._type();if(r!==q){s=this._restorePlayerFieldHistory(r);}else if(i&&(i.playerField!==undefined)){s=this.updatePlayerField(i.playerField);}var t;if(i.feedingItems){if(l.supportMND(r)){p=d.hasMND(i.feedingItems);this._setIsMNDVisible(p);}if(d.match(r,i.feedingItems,false)){t=_(r,i.feedingItems,p);r=t.vizType;i.feedingItems=t.feeds;}j=!d.equal(this._feedingItems(),i.feedingItems,{ignoreActions:true});if(j){this._vizModel._history=this._buildHistory(r,d.cloneFeeds(i.feedingItems));this._feedingItems(i.feedingItems);}else{j=!d.equal(this._feedingItems(),i.feedingItems);if(j){this._feedingItems(i.feedingItems);}}}var v=i.feedingItems||this._vizModel._history.feedingItems;p=this._vizModel.isMNDVisible();r=o(r,v,p);if(!j){var w;if(r!==q){w=B.switchFeeds(r,q,v).feeds;t=_(r,w,p);r=t.vizType;w=t.feeds;}if(w){this._feedingItems(w);if(d.isEmptyFeeds(this._feedingItems())&&d.isEmptyFeeds(w)){j=false;}else{j=!l.equal(q,r)||!d.equal(this._feedingItems(),w);}}}var x=false;if(i.filterItems){this._filterItems(i.filterItems);x=true;}var y={'vizTypeChanged':q!==r,'feedingItemsChanged':this._feedingItemsChanged||j,'filterChanged':x};if(s===true){y.sliceDimensionChanged=true;}this._type(r);this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(y);};V.prototype.propertiesChanged=function(t,i){var v=this._type();if(!v){return;}var j=this._feedingItems();if(!this._vizModel._history){this._vizModel._history=this._buildHistory(i?t:this._type(),d.cloneFeeds(j));}if(t!=="viz/number"){this._saveSubtotals(this._vizModel._history.feedingItems,this._vizModel);}var p=v;var q=t;var r=this._vizModel._history.feedingItems;var s=this._vizModel.isMNDVisible();p=o(p,r,s);var w;if(d.match(p,r,false)){w=_(p,r,s);p=w.vizType;r=w.feeds;}var x=B.switchFeeds(p,this._vizModel._history.type,r).feeds;w=_(p,x,s);p=w.vizType;x=w.feeds;var y=true;if(d.isEmptyFeeds(j)&&d.isEmptyFeeds(x)){y=false;}else{y=!l.equal(q,p)||!d.equal(j,x);}var z={'vizTypeChanged':i||(q!==p),'feedingItemsChanged':this._feedingItemsChanged||y||this._isMNDVisibleChanged,'isMNDVisibleChanged':this._isMNDVisibleChanged};this._type(p);this._feedingItems(x);this._feedingItemsChanged=false;this._isMNDVisibleChanged=false;if(z.vizTypeChanged){var D=this._restorePlayerFieldHistory(p);if(D===true){z.sliceDimensionChanged=true;}}this._vizModel.dispatchPropertiesChangedEvent(z);};V.prototype._saveSubtotals=function(j,p){var q=[];var r=false;var s=false;for(var i=0;i<j.length;i++){if(j[i].type()===c.CALCULATION){p.savedSubtotals(j[i]);}if(p.savedSubtotals()!==null&&j[i].type()===c.DIMENSION&&j[i].id()!==c.COLUMNS){r=true;for(var v=0;v<j[i].values().length;v++){for(var t=0;t<p.savedSubtotals().values().length;t++){if(j[i].values()[v].id()===p.savedSubtotals().values()[t].aggregationTarget()){q.push(p.savedSubtotals().values()[t]);s=true;}}}}}if((r===false||s===false)&&p.savedSubtotals()!==null){p.savedSubtotals().values([]);}if(p.savedSubtotals()!==null&&q[0]){p.savedSubtotals().values(q);var w=false;for(i=0;i<p._history.feedingItems.length;i++){if(p._history.feedingItems[i].type()===c.CALCULATION){var x=p.savedSubtotals();p._history.feedingItems[i]=x;w=true;}}if(w===false){p._history.feedingItems.push(p.savedSubtotals());}}};V.prototype.getFilterItems=function(s,i,v,j){return h.getFilterItems(s,i,this._filterItems(),this._feedingItems(),v,j);};V.prototype.clone=function(p){var r=p;r._type=this._type();var q=this._feedingItems();if(q&&q.length>0){for(var i=0;i<q.length;i++){r._feedingItems[i]=q[i].clone();}}var s=this._filterItems();if(s&&s.length>0){for(var j=0;j<s.length;j++){r._filterItems[j]=s[j].clone();}}return r;};function m(t,i){var j=g;if(j.supportMultiChart(t)){if(d.hasRowOrColumn(i)){return j.toMultiChartType(t);}else{return j.toSingleChartType(t);}}else{return t;}}function n(t){var i=g;if(i.supportMultiChart(t)){var j=i.toMultiChartType(t);if(t!==j&&!l.supportMND(t)&&l.supportMND(j)){return j;}else{return t;}}else{return t;}}function o(t,i,j){var p=m(t,i);if(j){p=n(p);}return p;}function _(t,i,j){if(j){t=n(t);if(!d.hasMND(i)){i=B.suggestMND(t,i);}}else{i=d.removeMND(i);t=m(t,i);if(!d.isEmptyFeeds(i)){if(!e.validateDimensionMin(t,i)){i=B.suggestMND(t,i);}}}if(d.countAnalyses(i,b.MEASURE)===0){i=d.removeMND(i);}t=m(t,i);return{'vizType':t,'feeds':i};}return V;});define('sap/viz/controls/runtime/VizModel',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/runtime/InfoModelHandler','sap/viz/controls/runtime/MapModelHandler','sap/viz/controls/runtime/VizModelHandler'],function(O,u,E,a,C,B,b,I,M,V){var c=function(){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizModel";this._type=null;this._isMNDVisible=false;this._feedingItems=[];this._history=null;this._savedSubtotals=null;this._filterItems=[];this._playerFieldHistory=null;this._playerField=null;this._extensionValues={};this._handler=this._vizModelHandler=new V(this);};O.extend(c,a);c.PropertiesChangedEvent='propertiesChangedEvent';c.VizModelResetEvent='vizModelResetEvent';c.FeedingChangedEvent='feedingChangedEvent';c.prototype._updateHandler=function(t,o){var n=this._vizModelHandler;if(C.TYPE_GEO_MAP===t){if(!this._mapModelHandler){this._mapModelHandler=new M(this);}n=this._mapModelHandler;}else if(b.isInfoChart(t)){if(!this._infoModelHandler){this._infoModelHandler=new I(this);}n=this._infoModelHandler;}if(n!==this._handler){this._handler.deactive(o);if(n===this._mapModelHandler||this._handler===this._mapModelHandler){this._feedingItems=[];}this._handler=n;}};c.prototype.load=function(o){if(!o){return;}this.reset();var t=false;var f=false;var i=false;if(o.type&&o.type!==this._type){var d=this._type;this._type=o.type;this._updateHandler(this._type,d);t=true;}if(o.feedingItems){this._feedingItems=o.feedingItems;f=true;}else{this._feedingItems=[];}var e=this._isMNDVisible;this._handler.postLoad();i=(e!==this._isMNDVisible);if(t||f){var g={'vizTypeChanged':t,'isMNDVisibleChanged':i,'feedingItemsChanged':f};this.dispatchPropertiesChangedEvent(g);}};c.prototype.filterItems=function(v){if(arguments.length>0){this._filterItems=v;var d={filterChanged:true};var f=new E(c.PropertiesChangedEvent,this,d);this._dispatchEvent(f);return this;}else{return this._filterItems;}};c.prototype.explicitFeedingItems=function(o){return this._handler.explicitFeedingItems(o);};c.prototype.feedingItems=function(v,e){if(arguments.length>0){this._handler.feedingItemsChanged(v,e);return this;}else{return this._feedingItems.slice(0);}};c.prototype.savedSubtotals=function(v){if(arguments.length>0){this._savedSubtotals=v;return this;}else{return this._savedSubtotals;}};c.prototype.type=function(v){if(arguments.length>0){if(this._type!==v){var o=this._type;this._type=v;this._updateHandler(this._type,o);this._handler.propertiesChanged(o,true);}return this;}else{return this._type;}};c.prototype.restorePlayerField=function(v){return this._handler.updatePlayerField(v);};c.prototype.playerField=function(v){if(arguments.length>0){var d;var s=this._handler.updatePlayerField(v);if(s===true){d={'sliceDimensionChanged':true};this.dispatchPropertiesChangedEvent(d);}return this;}else{return this._playerField;}};c.prototype.isMNDVisible=function(v){if(arguments.length>0){var d=(v===true);if(this._isMNDVisible!==d){this._isMNDVisible=d;this._handler.isMNDVisibleChanged();}return this;}else{return this._isMNDVisible;}};c.prototype.vizModelChanged=function(o){if(o.type){this._updateHandler(o.type,this._type);}this._handler.vizModelChanged(o);};c.prototype.updateFilterItems=function(s,i,v,f){var n=this._handler.getFilterItems(s,i,v,f);this.filterItems(n);};c.prototype.clone=function(){var r=new c();this._handler.clone(r);return r;};c.prototype.extensionValues=function(e){if(arguments.length>0){var d={};if(e){if(this._extensionValues!==e){this._extensionValues=e;d={'extensionValuesChanged':true};}}var f=new E(c.PropertiesChangedEvent,this,d);this._dispatchEvent(f);return this;}else{return this._extensionValues;}};c.prototype.dispatchPropertiesChangedEvent=function(d){var p=new E(c.PropertiesChangedEvent,this,d);this._dispatchEvent(p);};c.prototype._dispatchFeedingChangedEvent=function(d){var f=new E(c.FeedingChangedEvent,this,d);this._dispatchEvent(f);};c.prototype.reset=function(){var d={'vizModelReset':true};var v=new E(c.VizModelResetEvent,this,d);this._dispatchEvent(v);};c.prototype.dispatchEvent=function(e){this._dispatchEvent(e);};return c;});define('sap/viz/controls/common/ProxyBase',[],function(){var P=function P(c){this.__className="sap.viz.controls.runtime.ProxyBase";this.__client=c;};P.prototype._client=function(){return this.__client;};P.prototype.updateClient=function(c){this.__client=c;};return P;});define('sap/viz/controls/runtime/VizProxy',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/ProxyBase','sap/viz/controls/common/events/Event'],function($,O,P,E){var V=function V(v){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizProxy";};O.extend(V,P);V.VizProxyEvent='VizProxy.VizProxyEvent';V.GetTitleZoneOperation='getTitleZoneOperation';V.GetTitleTextOperation='getTitleTextOperation';V.SetTitleTextOperation='setTitleTextOperation';V.GetTitleTextByFeedingOperation='getTitleTextByFeedingOperation';V.RestoreTitleTextOperation='restoreTitleTextOperation';V.IsFakeChartOperation='isFakeChartOperation';V.IsTitleCustomizedOperation='isTitleCustomizedOperation';V.GetPropertiesOperation='getPropertiesOperation';V.SetPropertiesOperation='setPropertiesOperation';V.SetDatasetOperation='SetDatasetOperation';V.GetSelectionOperation='getSelectionOperation';V.SetTitleModeOperation='setTitleModeOperation';V.GetPropertyZonesOperation='getPropertyZonesOperation';V.SetPropertyZonesOperation='setPropertyZonesOperation';V.GetDatasetOperation='GetDatasetOperation';V.QueryPropertiesOperation='queryPropertiesOperation';V.UpdatePropertiesOperation='updatePropertiesOperation';V.AddEventListenerOperation='addEventListenerOperation';V.RemoveEventListenerOperation='removeEventListenerOperation';V.DispatchEventOperation='dispatchEventOperation';V.SetAxisScaleOperation='setAxisScaleOperation';V.GetTypeOperation='getTypeOperation';V.GetDataPointsPosition='getDataPointsPosition';V.OnOperation='onOperation';V.OffOperation='offOperation';V.GetSizeOperation='getSizeOperation';V.SetSizeOperation='setSizeOperation';V.GetVizFeedingOperation='getVizFeedingOperation';V.GetScalesOperation='getScalesOperation';V.SetScalesOperation='setScalesOperation';V.SetAnimationLayerOperation='setAnimationLayerOperation';V.prototype._model=function(){return this._client();};V.prototype._doOperation=function(o,d){d=d||{};d.operation=o;var e=new E(V.VizProxyEvent,this._model(),d);this._model().dispatchEvent(e);return e.data.result;};V.prototype.getTitleZone=function(){return this._doOperation(V.GetTitleZoneOperation);};V.prototype.getTitleText=function(){return this._doOperation(V.GetTitleTextOperation);};V.prototype.setTitleText=function(t){var d={args:arguments};this._doOperation(V.SetTitleTextOperation,d);};V.prototype.getTitleTextByFeeding=function(){return this._doOperation(V.GetTitleTextByFeedingOperation);};V.prototype.restoreTitleText=function(){this._doOperation(V.RestoreTitleTextOperation);};V.prototype.SetDataset=function(d){var a={args:arguments};this._doOperation(V.SetDatasetOperation,a);};V.prototype.setTitleMode=function(m){var d={args:arguments};this._doOperation(V.SetTitleModeOperation,d);};V.prototype.isFakeChart=function(){return this._doOperation(V.IsFakeChartOperation);};V.prototype.isTitleCustomized=function(){return this._doOperation(V.IsTitleCustomizedOperation);};V.prototype.getProperties=function(){return this._doOperation(V.GetPropertiesOperation);};V.prototype.setProperties=function(n){var d={args:arguments};this._doOperation(V.SetPropertiesOperation,d);};V.prototype.getSelection=function(){return this._doOperation(V.GetSelectionOperation);};V.prototype.getType=function(){return this._doOperation(V.GetTypeOperation);};V.prototype.getPropertyZones=function(){return this._doOperation(V.GetPropertyZonesOperation);};V.prototype.setPropertyZones=function(p){var d={args:arguments};this._doOperation(V.SetPropertyZonesOperation,d);};V.prototype.queryProperties=function(o){var d={args:arguments};return this._doOperation(V.QueryPropertiesOperation,d);};V.prototype.updateProperties=function(o){var d={args:arguments};this._doOperation(V.UpdatePropertiesOperation,d);};V.prototype.getDataset=function(){return this._doOperation(V.GetDatasetOperation);};V.prototype.setAxisScale=function(a){var d={args:arguments};return this._doOperation(V.SetAxisScaleOperation,d);};V.prototype.addEventListener=function(t,l,s,p){var d={args:arguments};this._doOperation(V.AddEventListenerOperation,d);};V.prototype.removeEventListener=function(t,l,s){var d={args:arguments};this._doOperation(V.RemoveEventListenerOperation,d);};V.prototype.dispatchEvent=function(t,l,s){var d={args:arguments};this._doOperation(V.DispatchEventOperation,d);};V.prototype.getDataPointsPosition=function(d){var a={args:arguments};return this._doOperation(V.GetDataPointsPosition,a);};V.prototype.on=function(e,c){this._doOperation(V.OnOperation,{'args':arguments});};V.prototype.off=function(e){this._doOperation(V.OffOperation,{'args':arguments});};V.prototype.getSize=function(){return this._doOperation(V.GetSizeOperation);};V.prototype.setSize=function(s){var d={args:arguments};this._doOperation(V.SetSizeOperation,d);};V.prototype.getVizFeeding=function(){return this._doOperation(V.GetVizFeedingOperation);};V.prototype.getScales=function(){return this._doOperation(V.GetScalesOperation);};V.prototype.setScales=function(s){var d={args:arguments};return this._doOperation(V.SetScalesOperation,d);};V.prototype.setAnimationLayer=function(){return this._doOperation(V.SetAnimationLayerOperation);};return V;});define('sap/viz/controls/common/VizControlBase',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/UIControl','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/runtime/VizModel','sap/viz/controls/runtime/VizProxy'],function(O,E,U,R,V,a){var b=function b(d,u,p){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.VizControlBase";this._vizUid=null;if(p){this._parent=p;this.__vizModel=p._vizModel();}else{this.__vizModel=this._createModel();}this._addModelEventListener(this.__vizModel);this._updatingProperty=0;this.__vizProxy=new a(this.__vizModel);};O.extend(b,U);b.prototype.connect=function(v){if(this._vizUid===v){return;}this._vizUid=v;var r=R.getRuntime();var m=r.getModel(v);var c=false;if(!m){r.registerModel(v,this.__vizModel);}else{if(this.__vizModel!==m){c=true;this._removeModelEventListener(this.__vizModel);this.__vizModel=m;this._addModelEventListener(this.__vizModel);}r.addModelRef(v);}this._onConnect(v,c);};b.prototype._vizModel=function(){return this.__vizModel;};b.prototype._vizProxy=function(){return this.__vizProxy;};b.prototype._onVizModelChanged=function(e){};b.prototype._onVizModelReset=function(e){};b.prototype._createModel=function(){return new V();};b.prototype._onConnect=function(v,m){this._vizProxy().updateClient(this.__vizModel);};b.prototype._onDisconnect=function(){};b.prototype._onAfterDisconnect=function(){};b.prototype.disconnect=function(){this._removeSharedModel(true);};b.prototype._removeSharedModel=function(n){var v=this._vizUid;if(v){var m=R.getRuntime().getModel(v);if(m){if(n){this._onDisconnect();}this._removeModelEventListener(m);this.__vizModel=m.clone();this._addModelEventListener(this.__vizModel);R.getRuntime().removeModelRef(v);}if(n){this._onAfterDisconnect();}this._vizUid=null;}};b.prototype.destroy=function(){this._removeSharedModel(false);b.superclass.destroy.apply(this,arguments);};b.prototype._beginUpdateProperty=function(){this._updatingProperty++;};b.prototype._inUpdatingProperty=function(){return this._updatingProperty>0;};b.prototype._addModelEventListener=function(m){m.addEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);m.addEventListener(V.VizModelResetEvent,this._onVizModelReset,this);};b.prototype._removeModelEventListener=function(m){m.removeEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this);m.removeEventListener(V.VizModelResetEvent,this._onVizModelReset,this);};b.prototype._endUpdateProperty=function(){this._updatingProperty--;};b.prototype._dispatchPropertyEvent=function(e){if(!this._updatingProperty){b.superclass._dispatchEvent.apply(this,arguments);}};b.prototype._dispatchEvent=function(e){if(!e.data){e.data={};}e.data.token=this._vizUid;b.superclass._dispatchEvent.apply(this,arguments);};b.prototype.save=function(){return{};};b.prototype.load=function(v){};return b;});define('sap/viz/controls/common/constants/EventTypeConst',[],function(){var E={};E.VC_CHANGE_VIZ_TYPE="vc-changeVizType";E.PRESS_FILTER_BUTTON="vc-filter";E.PRESS_EXCLUDE_BUTTON="vc-exclude";E.PRESS_DRILLDOWN_BUTTON="vc-drillDown";E.SELECT_SHOW_LEGEND="vc-showLegend";E.SELECT_SHOW_DATALABELS="vc-showDataLabels";E.SELECT_CHANGE_DIRECTION="vc-changeDirection";E.SELECT_CHANGE_STACKING="vc-changeStacking";E.SELECT_INSERT_COMMENT="vc-insertComment";E.SELECT_CHART_EDITOR="vc-chartEditor";E.SHOW_MESSAGE="vc-showMessage";E.CLEAR_MESSAGE="vc-clearMessage";E.VIZ_DEFINITION_CHANGED='vizDefinitionChanged';E.REQUEST_FILTER_VALUES='requestFilterValues';return E;});define('sap/viz/controls/annotation/AnnotationConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var A={};A.instance=function(){return{};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_ANNOTATION,A);return A;});define('sap/viz/controls/annotation/AnnotationEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var A=function(t,a,d){A.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.AnnotationEvent";};O.extend(A,E);A.COMMENT_CHANGED_EVENT="commentChanged";return A;});define('sap/viz/controls/annotation/views/DialogEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var D=function(t,a,d){D.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.DialogEvent";};O.extend(D,E);D.OK="OK";D.Cancel="Cancel";return D;});define('sap/viz/controls/annotation/views/ConfirmDialog',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/annotation/views/DialogEvent','jquery'],function(O,U,C,L,D,$){var a=function(){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.ConfirmDialog";this._confirmDialog$=null;this._needConfirm=true;this._visible=false;this._createChildren();};O.extend(a,U);a.prototype._createChildren=function(){var _=this;this._confirmDialog$=$(document.createElement('div'));this._confirmDialog$.addClass(C.ANNOTATION_PREFIX+'confirmdialog');var d=$(document.createElement('div'));d.addClass(C.ANNOTATION_PREFIX+'confirmdialog-header');this._confirmDialog$.append(d);var b=$(document.createElement('span'));b.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerleft');d.append(b);var c=$(document.createElement('span'));c.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerleft-label');b.append(c);var e=$(document.createElement('span'));e.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerright');d.append(e);var f=$(document.createElement('a'));f.addClass(C.ANNOTATION_PREFIX+'confirmdialog-headerright-close');e.append(f);f.click(function(){_.hide();});var g=$(document.createElement('div'));g.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content');this._confirmDialog$.append(g);var h=$(document.createElement('div'));h.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-up');h.appendTo(g);var i=$(document.createElement('div'));i.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-icon');i.appendTo(h);var j=$(document.createElement('div'));j.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-info');j.text(L.get("VIZ_COMMON_DELETE_COMMENT_MESSAGE"));j.appendTo(h);var k=$(document.createElement('div'));k.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-down');k.appendTo(g);this._checkBoxNeedConfirm$=$(document.createElement("input"));this._checkBoxNeedConfirm$.attr("type","checkbox");this._checkBoxNeedConfirm$.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-checkbox');this._checkBoxNeedConfirm$.appendTo(k);var l=$(document.createElement('div'));l.addClass(C.ANNOTATION_PREFIX+'confirmdialog-content-checkboxlabel');l.text(L.get("VIZ_COMMON_DONT_SHOW_MESSAGE"));l.appendTo(k);var m=$(document.createElement('div'));m.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer');this._confirmDialog$.append(m);var n=$(document.createElement('div'));n.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer-buttons');m.append(n);var o=$(document.createElement('button'));o.text(L.get("VIZ_COMMON_OK"));o.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer-button');o.addClass(C.COMMON_PREFIX+'button');n.append(o);o.click(function(){_.hide();_._needConfirm=!(_._checkBoxNeedConfirm$.prop("checked"));_._dispatchEvent(new D(D.OK,_,_._needConfirm));});var p=$(document.createElement('button'));p.text(L.get("VIZ_COMMON_CANCEL"));p.addClass(C.ANNOTATION_PREFIX+'confirmdialog-footer-button');p.addClass(C.COMMON_PREFIX+'button');n.append(p);p.click(function(){_.hide();});this._blockLayout$=$(document.createElement('div'));this._blockLayout$.addClass(C.ANNOTATION_PREFIX+'block-layer');};a.prototype.show=function(p){this._visible=true;$(document.body).append(this._blockLayout$);$(document.body).append(this._confirmDialog$);if(p){this.setPos(p);}};a.prototype.hide=function(){this._visible=false;this._blockLayout$.detach();this._confirmDialog$.detach();};a.prototype.setPos=function(p){this._confirmDialog$.css({position:"absolute",left:p.pageX-this._confirmDialog$.width()/2,top:p.pageY-this._confirmDialog$.height()/2});};a.prototype.isVisible=function(){return this._visible;};return a;});define('sap/viz/controls/annotation/models/Comment',['sap/viz/controls/common/managers/LangManager'],function(L){var C=function(d,a,s){this._dimension=d;this._dimension2=a;this._series=s;this._text='';this._createTime=L.get("VIZ_ANNOTATION_COMMENT");};C.prototype.dimension=function(v){if(arguments.length>0){this._dimension=v;return this;}else{return this._dimension;}};C.prototype.dimension2=function(v){if(arguments.length>0){this._dimension2=v;return this;}else{return this._dimension2;}};C.prototype.series=function(v){if(arguments.length>0){this._series=v;return this;}else{return this._series;}};C.prototype.createTime=function(v){if(arguments.length>0){this._createTime=v;return this;}else{return this._createTime;}};C.prototype.text=function(v){if(arguments.length>0){this._text=v;return this;}else{return this._text;}};return C;});define('sap/viz/controls/annotation/views/Comments',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/annotation/views/DialogEvent','sap/viz/controls/annotation/views/ConfirmDialog','sap/viz/controls/annotation/models/Comment'],function($,C,a,O,b,U,V,E,c,D,d,f){var F='#F1AB00';var T=12;var L=4;var M=200;var I=8;var g={width:14,height:16};var h="font-family:Arial;font-size:12px;font-weight:bold;fill:#000000;";var k="font-family:Arial;font-size:12px;font-weight:normal;fill:#000000;";var l=function(){this._commentsMap={};this._commentsPositionMap={};this._vizData=null;this._vizType=null;this._eventHandlers={};this._needConfirm=true;this._currentComment=null;};O.extend(l,c);l.Event_EditComment='Event_EditComment';l.Event_RemoveComment='Event_RemoveComment';l.Event_DragComment='Event_DragComment';l.prototype._showConfirmDialog=function(){this._getConfirmDialog().show({pageX:$(this._parent).offset().left+$(this._parent).width()/2,pageY:$(this._parent).offset().top+$(this._parent).height()/2});};l.prototype._getConfirmDialog=function(){if(!this._confirmDialog){this._confirmDialog=new d();this._confirmDialog.addEventListener(D.OK,this._confirmChangedHandler,this);}return this._confirmDialog;};l.prototype._confirmChangedHandler=function(e){this._needConfirm=e.data;this._onRemoveComment(this._currentComment);};l.prototype.assetFolder=function(e){if(arguments.length>0){this._assetFolder=e;return this;}else{return this._assetFolder;}};l.prototype.setChartInfo=function(e){if(arguments.length>0){this._vizData=e.vizData;this._vizType=e.vizType;return this;}else{return this._vizData;}};l.prototype.feedsChanged=function(){this._commentsPositionMap={};};l.prototype._initDIV=function(){if(this._parent){this._parent.empty();}else{var e=document.createElement("DIV");this._parent=$(e);this._chartHolderDiv=$('div.'+C.PREFIX+'chart-holder')[0];this._parent.appendTo(this._chartHolderDiv).attr('id',"comments-parent");this._parent.attr('style','overflow:hidden;position:absolute;pointer-events:none;left:0px;top:0px;');}this._triangleHolder=null;this._lineHolder=null;};l.prototype.redraw=function(){this._initDIV();var e=b.getVizType(this._vizType);if(!A.supportType[e]||V.hasFakeData(this._vizData)){return;}for(var i in this._commentsMap){if(this._commentsMap.hasOwnProperty(i)){this._drawComment(i);}}};l.prototype.clean=function(){this._initDIV();};l.prototype._getPathInfo=function(e,j){var x=e.dii_a1;var y=e.mi;var z=j._crosstableDataset;var B=z.getAnalysisAxisByIdx(0);var G=null;if(B){G='';B=B.getDimensionLabels();for(var i=0;i<B.length;i++){G+=B[i].getValues()[x];}}else{G=z.getMeasureValuesGroupByIdx(0).getMeasureValues()[x].getId();}var H=z.getAnalysisAxisByIdx(1);var J=null;if(H){J='';H=H.getDimensionLabels();for(var n=0;n<H.length;n++){J+=H[n].getValues()[e.dii_a2];}}var K={dimensionIndex:x,seriesIndex:y,dimension:G,dimension2:J};K.series=z.getMeasureValuesGroupByIdx(e.mg).getMeasureValues()[y].getId();return K;};l.prototype._findDataPoint=function(e){var n=d3.selectAll('.v-datapoint')[0];var x=e.dimension();var y=e.dimension2();var z=e.series();for(var i=0;i<n.length;i++){var B=n[i].__data__;if(B){var G;if(U.isArray(B.ctx)){G=this._getPathInfo(B.ctx[0].path,this._vizData);if(G.dimension===x&&G.dimension2===y&&G.series==z){return n[i];}}else if(b.getVizType(this._vizType)===a.TYPE_BOXPLOT){for(var j=0;j<B.length;j++){G=this._getPathInfo(B[j].ctx.path,this._vizData);if(G.dimension===x&&G.dimension2===y&&G.series==z){return n[i];}}}else if(B.ctx){G=this._getPathInfo(B.ctx.path,this._vizData);if(G.dimension===x&&G.dimension2===y&&G.series==z){return n[i];}}}}};function m(e){var i=e.__data__;if(i&&i.r&&i.midAngle){var j=i.midAngle();var x=i.r*Math.sin(j);var y=i.r-i.r*Math.cos(j);var n=$(e).parentsUntil('.v-m-plot');if(n.length>0){var z=$(n[n.length-1]).parent()[0];var B=z.getElementsByTagName('rect');var G=B[0].getAttribute('height');var H=B[0].getAttribute('width');var J=z.getBoundingClientRect();var K=J.left+H/2;var N=J.top+6+i.r;var P={width:1,height:1,top:N-i.r+y,left:K+x};return P;}else{return e.getBoundingClientRect();}}else{return e.getBoundingClientRect();}}function o(e){var i=e.dimension()+"-"+e.dimension2()+"-"+e.series();i=i.replace(/[^(0-9|A-z)]/g,"_");return i;}function p(e){return e+'-line';}function q(e){return e+'-triangle';}function r(e){var i=e.currentTarget.parentNode.__data;if(e.data&&i){if(e.data._needConfirm){e.data._currentComment=i;e.data._showConfirmDialog();}else{e.data._onRemoveComment(i);}}e.stopPropagation();}function s(e){var i=e.currentTarget.parentNode.__data;if(e.data&&i){e.data._onEditComment(i);}e.stopPropagation();}function t(e){var i=e.target;if(i&&i.className!=='ui-draggable'){var j=$(i).parentsUntil(e.data._parent);if(j&&j.length>0){i=j[j.length-1];}}if(e.data&&i&&i.className==='ui-draggable'){$(i).detach();$(i).appendTo(e.data._parent);}e.stopPropagation();}function u(e,i,j,n,x){var y={x:e.left,y:e.top+e.height/2};var z={x:i.left+i.width/2,y:i.top};var B=y.x-z.x;var G=y.y-z.y;var H=Math.sqrt(B*B+G*G);var J=Math.asin(G/H)*180/Math.PI;if(y.x<z.x){J=180-J;}var K='rotate('+J+'deg)';var N="0 0";n.css({'transform':K,'transform-origin':N,'-webkit-transform':K,'-webkit-transform-origin':N,'-ms-transform':K,'-ms-transform-origin':N,'-moz-transform':K,'-moz-transform-origin':N,width:Math.floor(H)-L+'px',left:(z.x-j.left)+'px',top:z.y-j.top+'px'});K='rotate('+(J+90)+'deg)';N="50% 100%";x.css({'transform':K,'transform-origin':N,'-webkit-transform':K,'-webkit-transform-origin':N,'-ms-transform':K,'-ms-transform-origin':N,'-moz-transform':K,'-moz-transform-origin':N,left:(z.x-j.left-T/2)+'px',top:(z.y-j.top-T)+'px'});}function v(e,i){var j='height:0px;width:0px;margin:0px;padding:0px;';j+='border-top-width:'+e+'px;border-left-width: '+i/2+'px;border-right-width: '+i/2+'px;';j+='border-bottom-width: 0px;border-style: solid;border-color: '+F+' transparent transparent transparent;';return j;}l.prototype._initCommentUI=function(i,j,n){var x=m(i);var y=this._parent[0].getBoundingClientRect();var z=0;var B=0;var G=j.attr('id');if(this._commentsPositionMap.hasOwnProperty(G)&&this._commentsPositionMap[G].hasOwnProperty(this._vizType)){z=this._commentsPositionMap[G][this._vizType].left;B=this._commentsPositionMap[G][this._vizType].top;}else{z=0;B=x.top-y.top-80;var H=i.__data__;if(H&&H.r&&H.midAngle&&Math.sin(H.midAngle())<0){z=x.left-Math.max(x.width,40)-y.left-150;}else{z=x.left+Math.max(x.width,40)-y.left;}}var J="pointer-events:auto;";J+="padding:4px;background-color:#FFFFCC;";J+='border-radius:4px;border-width:2px; border-color:'+F+'; border-style:solid;';J+="position:absolute;left: "+z+"px; top:"+B+"px;";J+="width:"+M+"px;";j.attr('style',J);j.bind('mouseenter',function(e){var G=$(e.currentTarget).attr('id');var K=$('div#'+G+' img');K.css('visibility','');var N=$('div#'+G+' div#'+'createTime');if(N){N.css('right','68px');}});j.bind('mouseleave',function(e){var G=$(e.currentTarget).attr('id');var K=$('div#'+G+' img');K.css('visibility','hidden');var N=$('div#'+G+' div#'+'createTime');if(N){N.css('right','18px');}});j.bind('contextmenu',function(e){e.stopPropagation();});if(z+j.outerWidth()>this._parent.innerWidth()){z=this._parent.innerWidth()-j.outerWidth();}if(B+j.outerHeight()>this._parent.innerHeight()){z=this._parent.innerHeight()-j.outerHeight();}j.css({left:z+'px',top:B+'px'});};l.prototype._addCommentUI=function(e,j,n){var x=I;for(var i=0;i<n.length;i++){var y=$(document.createElement("DIV")).appendTo(j).attr('style','position:absolute;padding:'+I+'px;left:0px;right:0px;top:'+x+'px;width:'+M+'px;height:auto;');var z=this._appendItem(y,n[i]);y.css('height',z+'px');x+=z+I;y[0].__data=n[i];}x-=I;j.css('height',x+'px');var B=m(e);var G=this._parent[0].getBoundingClientRect();var H=Number(j.css("left").replace('px',''));var J=Number(j.css("top").replace('px',''));H=Math.min(Math.max(H,0),G.width-M);J=Math.min(Math.max(J,0),G.height-x);j.css({left:H,top:J});var K=j[0].getBoundingClientRect();j[0].__dataPoint=e;j[0].__parent=this._parent[0];var N=j.attr('id');var P=q(N);var Q=$('#'+P);if(Q.length===0){Q=$(document.createElement("DIV"));if(this._triangleHolder){Q.insertAfter(this._triangleHolder);}else{Q.insertBefore(j);}this._triangleHolder=Q;Q.attr('id',P).attr('style','position:absolute;'+v(T,T));}var R=p(N);var S=$('#'+R);if(S.length===0){S=$(document.createElement("DIV"));if(this._lineHolder){S.insertAfter(this._lineHolder);}else{S.insertBefore(j);}this._lineHolder=S;S.attr('id',R).attr('style','position:absolute;border-left-width:'+L+'px; border-top-width:2px;border-bottom-width:0px;border-right-width:0px;border-color:'+F+' transparent; border-style:solid;width:1px;height:0px;');}u(K,B,G,S,Q);};l.prototype._appendItem=function(e,i){var _=this;var j=null;var n=false;var x=0;var y=$(document.createElement("IMG")).appendTo(e);y.attr('src',this._assetFolder+'/edit.png').attr('style','position:absolute;pointer-events:auto;cursor:pointer;top:0px; right:'+(I*3+g.width)+'px;width:'+g.width+'px;height:'+g.height+'px;visibility:hidden;');y.bind('mousedown',this,s);var z=y[0].getBoundingClientRect();var B=$(document.createElement("IMG")).appendTo(e);B.attr('src',this._assetFolder+'/delete.png').attr('style','position:absolute;pointer-events:auto;cursor:pointer;top:0px; right:'+(I*2)+'px;width:'+g.width+'px;height:'+g.height+'px;visibility:hidden;');B.bind('mousedown',this,r);var G=B[0].getBoundingClientRect();var H=this._creatorDiv=$(document.createElement("DIV")).appendTo(e);H.attr('id','createTime');H.text(i.createTime()).attr('style','position:absolute;cursor:default;line-height:normal;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;left:5px;right:18px;top:0px;'+h);H.mouseover(function(N){if(H[0].scrollWidth>H[0].clientWidth){n=true;var P=setTimeout(function(){if(n){if(!j){j=$(document.createElement('div')).appendTo(e);j.attr('style','position:absolute;border-radius:4px;z-index:100;display:block;background-color:#F2F2F2;border:1px solid #7F7F7F;box-shadow:5px 5px 10px rgba(0,0,0,0.5);-webkit-box-shadow:5px 5px 10px rgba(0,0,0,0.5);-moz-box-shadow:5px 5px 10px rgba(0,0,0,0.5);');var Q=$(document.createElement('span')).appendTo(j);Q.attr('style','border-radius:4px;padding-left:4px;padding-right:4px;display:block;font-size:10px;white-space:nowrap;top:0px;overflow:hidden;');Q.text(i.createTime());}var R=$(H).offset();j.offset({'left':R.left-5,'top':R.top-10});}},500);}});H.mouseout(function(N){if(H[0].scrollWidth>H[0].clientWidth){n=false;if(j){j.remove();j=null;}}});var J=H[0].getBoundingClientRect();x+=Math.max(z.height,J.height);var K=$(document.createElement("DIV"));K[0].innerHTML=i.text();K.attr('style','position:absolute;pointer-events:none;line-height:normal;word-wrap:break-word;overflow:hidden;top:'+x+'px;width:'+M+'px;'+k).appendTo(e);x+=K[0].getBoundingClientRect().height;return x;};l.prototype._removeCommentUI=function(i){var e=p(i);var j=q(i);if(this._triangleHolder&&this._triangleHolder.attr('id')===j){this._triangleHolder=null;}if(this._lineHolder&&this._lineHolder.attr('id')===e){this._lineHolder=null;}$('div#'+i).remove();$('div#'+e).remove();$('div#'+j).remove();var n=this._parent.children();if(this._triangleHolder===null&&n.length>=3){this._triangleHolder=$(n[n.length/3-1]);}if(this._lineHolder===null&&n.length>=3){this._lineHolder=$(n[n.length/3]);}};function w(e){var i=$(e.target);var _=e.data;if(e.target.__dataPoint&&e.target.__parent){var j=i[0].getBoundingClientRect();var n=m(i[0].__dataPoint);var x=i[0].__parent.getBoundingClientRect();var y=i.attr('id');var z=$('#'+p(y));var B=$('#'+q(y));u(j,n,x,z,B);if(!_._commentsPositionMap.hasOwnProperty(y)){_._commentsPositionMap[y]={};}_._commentsPositionMap[y][_._vizType]={left:Number(i.css("left").replace('px','')),top:Number(i.css("top").replace('px',''))};e.stopPropagation();_._dispatchEvent(new E(l.Event_DragComment,_,_._commentsMap[y]));}}l.prototype._drawComment=function(i){var _=this;var j=this._commentsMap[i];if(!j||j.length===0){this._removeCommentUI(i);return;}var n=this._findDataPoint(j[0]);if(!n){return;}var x=$('div#'+i);if(x.length===0){x=$(document.createElement("DIV"));x.appendTo(this._parent).attr('id',i);this._initCommentUI(n,x);}else{x.empty();}this._addCommentUI(n,x,j);x.draggable({containment:"parent",start:function(e,y){e.target.__lastPosition={x:e.clientX,y:e.clientY};},stop:function(e,y){e.data=_;w(e);},drag:function(e,y){e.data=_;w(e);}});x.bind('click',this,t);};l.prototype._onEditComment=function(e){if(e==null){return;}var i=o(e);var j=this._commentsMap[i];if(j==null){return;}this._dispatchEvent(new E(l.Event_EditComment,this,e));};l.prototype._onRemoveComment=function(e){if(e==null){return;}var j=o(e);var n=this._commentsMap[j];if(n==null){return;}for(var i=0;i<n.length;i++){if(n[i]===e){n.splice(i,1);break;}}this._drawComment(j);this._dispatchEvent(new E(l.Event_RemoveComment,this,e));};l.prototype.createComment=function(e){if(e.length===0){return;}var i=e[e.length-1].ctx[0];var j=this._getPathInfo(i,this._vizData);var n=new f(j.dimension,j.dimension2,j.series);n.text('');return n;};l.prototype.addComment=function(e){if(e==null){return;}var i=o(e);if(this._commentsMap[i]==null){this._commentsMap[i]=[];}this._commentsMap[i].push(e);this._drawComment(i);};l.prototype.updateComment=function(e){if(e==null){return;}var i=o(e);if(!this._commentsMap[i]){return;}this._drawComment(i);};l.prototype.size=function(e){if(e){$('div#comments-parent').css(e);if(this._getConfirmDialog().isVisible()){this._getConfirmDialog().setPos({pageX:$(this._parent).offset().left+$(this._parent).width()/2,pageY:$(this._parent).offset().top+$(this._parent).height()/2});}}};l.prototype.json2CommentsMap=function(e){for(var j in e){if(e.hasOwnProperty(j)){if(this._commentsMap[j]==null){this._commentsMap[j]=[];}var n=e[j];for(var i=0;i<n.length;i++){var x=n[i];var y=new f(x.dimension,x.dimension2,x.series);y.createTime(x.createTime);y.text(x.text);this._commentsMap[j].push(y);}}}this._needConfirm=e["needConfirm"];this._commentsPositionMap=e["commentsPositionMap"];};l.prototype.commentsMap2Json=function(){var e={};for(var j in this._commentsMap){if(this._commentsMap.hasOwnProperty(j)){var n=this._commentsMap[j];e[j]=[];for(var i=0;i<n.length;i++){var x=n[i];e[j].push({"dimension":x.dimension(),"dimension2":x.dimension2(),"series":x.series(),"createTime":x.createTime(),"text":x.text()});}}}e["needConfirm"]=this._needConfirm;e["commentsPositionMap"]=this._commentsPositionMap;return e;};var A={"name":"comment","text":"VIZ_CONTEXTMENU_INSERT_COMMENT","icon":{"show":"/contextmenu/annotation.png"},"supportType":{"viz/bar":true,"viz/column":true,"viz/stacked_column":true,"viz/stacked_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_bar":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true}};return l;});define('sap/viz/controls/annotation/views/CommentEditorView',['sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/annotation/views/DialogEvent','jquery'],function(L,O,U,a,C,D,$){var M=140;var l="";var t=false;var b=function(d){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.CommentEditorView";this._div=d;this._comment="";this._visible=false;this._oRichTextDialog=null;this._createChildren();};O.extend(b,a);b.WIDTH=497;b.HEIGHT=213;b.prototype._createChildren=function(){var _=this;this._oRichTextDialog=document.createElement('div');this._oRichTextDialog.id="divRichTextDialog";$(this._oRichTextDialog).addClass(C.ANNOTATION_PREFIX+'richtextdialog');$(document.body).append(this._oRichTextDialog);this.hide();var d=document.createElement('div');d.id="RichTextDialogHeader";$(d).addClass(C.ANNOTATION_PREFIX+'richtextdialog-header');$(this._oRichTextDialog).append(d);var c=document.createElement('span');$(c).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerleft');$(d).append(c);var f=document.createElement('span');f.id="RichTextDialogHeaderLabel";$(f).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerleft-label');$(f).text(L.get("VIZ_ANNOTATION_COMMENT"));$(c).append(f);var g=document.createElement('span');$(g).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerright');$(d).append(g);var h=document.createElement('a');h.id="RichTextDialogHeaderClose";$(h).addClass(C.ANNOTATION_PREFIX+'richtextdialog-headerright-close');$(g).append(h);$(h).click(function(){_.hide();});var i=document.createElement('div');i.id="RichTextDialogContent";$(i).addClass(C.ANNOTATION_PREFIX+'richtextdialog-content');$(this._oRichTextDialog).append(i);var j=document.createElement('textarea');j.id="RichTextDialogContentTextArea";$(j).addClass('mceEditor');$(i).append(j);var k=document.createElement('div');k.id="RichTextDialogFooter";$(k).addClass(C.ANNOTATION_PREFIX+'richtextdialog-footer');$(this._oRichTextDialog).append(k);var m=document.createElement('div');$(m).addClass(C.ANNOTATION_PREFIX+'richtextdialog-footer-buttons');$(k).append(m);var n=document.createElement('button');n.id="RichTextDialogOKButton";$(n).text(L.get("VIZ_COMMON_OK"));$(n).addClass(C.ANNOTATION_PREFIX+'button');$(n).addClass(C.COMMON_PREFIX+'button');$(m).append(n);$(n).click(function(){_.hide();_._comment=tinymce.activeEditor.getContent();_._dispatchEvent(new D(D.OK,_,{userData:_._userData,comment:_._comment}));});var o=document.createElement('button');o.id="RichTextDialogCancelButton";$(o).text(L.get("VIZ_COMMON_CANCEL"));$(o).addClass(C.ANNOTATION_PREFIX+'button');$(o).addClass(C.COMMON_PREFIX+'button');$(m).append(o);$(o).click(function(){_.hide();});if(!t){t=true;tinymce.init({theme:"advanced",mode:"textareas",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,forecolor,backcolor,|,justifyleft,justifycenter,justifyright,justifyfull,|,fontselect,fontsizeselect",theme_advanced_path:false,theme_advanced_font_sizes:"8px,9px,10px,11px,12px,14px,16px,18px,20px,22px,24px,26px,28px,36px,48px,72px",theme_advanced_statusbar_location:"none",editor_selector:"mceEditor",setup:function(p){p.onEvent.add(function(p,e){var q=p.getContent({format:'text'});if(q.length>M){p.setContent(l);p.selection.select(p.getBody(),true);p.selection.collapse(false);}else{l=p.getContent();}});}});}this._blockLayout=document.createElement('div');this._blockLayout.id="blockLayout";$(this._blockLayout).addClass(C.ANNOTATION_PREFIX+'block-layer');};b.prototype.show=function(o){if(o){if(o.hasOwnProperty("userData")){this._userData=o.userData;}if(o.hasOwnProperty("comment")&&U.isString(o.comment)){this._comment=o.comment;l=o.comment;if(tinymce.activeEditor){tinymce.activeEditor.setContent(this._comment);}}if(o.hasOwnProperty("position")){this.setPos(o.position);}}this._visible=true;$(document.body).append(this._blockLayout);$(this._oRichTextDialog).show();};b.prototype.hide=function(){this._visible=false;$(this._blockLayout).detach();$(this._oRichTextDialog).hide();};b.prototype.setPos=function(p){$(this._oRichTextDialog).css({position:"absolute",left:p.pageX-b.WIDTH/2,top:p.pageY-b.HEIGHT/2});};b.prototype.isVisible=function(){return this._visible;};return b;});define('sap/viz/controls/annotation/Annotation',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/annotation/AnnotationConfig','sap/viz/controls/annotation/AnnotationEvent','sap/viz/controls/annotation/views/Comments','sap/viz/controls/annotation/views/DialogEvent','sap/viz/controls/annotation/views/CommentEditorView'],function($,V,O,G,E,a,F,b,A,c,C,D,d){var f=function(e,u){f.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.Annotation";this._div=e;this._uiConfig=u?u:A.instance();this._popupLayer=e;this._commentEditor=null;this._createChildren();};O.extend(f,V);f.prototype._createChildren=function(){this._comments=new C();var e=this._uiConfig.commentsAssetFolderPath;this._comments.assetFolder(e?e:G.defaultAssetsRoot()+'/controls/frame/assets');this._comments.addEventListener(C.Event_EditComment,this._editCommentHandler,this);this._comments.addEventListener(C.Event_RemoveComment,this._removeCommentHandler,this);this._comments.addEventListener(C.Event_DragComment,this._dragCommentHandler,this);};f.prototype._getCommentEditor=function(){if(!this._commentEditor){var p=this._popupLayer;if(p){this._commentEditor=new d($(p));this._commentEditor.addEventListener(D.OK,this._commentChangedHandler,this);}}return this._commentEditor;};f.prototype._editCommentHandler=function(e){var g=e.data;var h=this._getCommentEditor();h.show({userData:{isNew:false,comment:g},comment:g.text(),position:{pageX:$(this._div).offset().left+$(this._div).width()/2,pageY:$(this._div).offset().top+$(this._div).height()/2}});};f.prototype._removeCommentHandler=function(e){var g=e.data;this._dispatchEvent(new a(c.COMMENT_CHANGED_EVENT,this,g));};f.prototype._dragCommentHandler=function(e){var g=e.data;this._dispatchEvent(new a(c.COMMENT_CHANGED_EVENT,this,g));};f.prototype._commentChangedHandler=function(e){var i=e.data.userData.isNew;var g=e.data.userData.comment;var t=e.data.comment;g.createTime(new Date().toLocaleString());g.text(t);if(i){this._comments.addComment(g);}else{this._comments.updateComment(g);}var h={commentChanged:true};this._dispatchEvent(new a(E.VIZ_DEFINITION_CHANGED,this,h));this._dispatchEvent(new a(c.COMMENT_CHANGED_EVENT,this,g));};f.prototype.popupLayer=function(p){if(arguments.length>0){this._popupLayer=p;return this;}else{return this._popupLayer;}};f.prototype.validateSize=function(w,h){if(this._comments){this._comments.size({width:w,height:h});}if(this._commentEditor&&this._commentEditor.isVisible()){this._commentEditor.setPos({pageX:$(this._div).offset().left+$(this._div).width()/2,pageY:$(this._div).offset().top+$(this._div).height()/2});}};f.prototype.destroy=function(){if(this._commentEditor){this._commentEditor.removeAllEventListeners();this._commentEditor=null;}if(this._popupLayer){this._popupLayer=null;}$(this._div).remove();};f.prototype.addComment=function(s){var e=this._comments.createComment(s);if(e){var g=this._getCommentEditor();g.show({userData:{isNew:true,comment:e},comment:'',position:{pageX:$(this._div).offset().left+$(this._div).width()/2,pageY:$(this._div).offset().top+$(this._div).height()/2}});}};f.prototype.setChartInfo=function(v){this._comments.setChartInfo(v);};f.prototype.redraw=function(){this._comments.redraw();};f.prototype.clean=function(){this._comments.clean();};f.prototype.feedsChanged=function(){this._comments.feedsChanged();};f.prototype.save=function(){return this._comments.commentsMap2Json();};f.prototype.load=function(v){this._comments.json2CommentsMap(v);};return f;});define('sap/viz/controls/annotationcontrol/AnnotationItem',[],function(){var A=function(i,t,d,s,c){this.__className="sap.viz.controls.annotationcontrol.AnnotationItem";this._id=i;this._type=t;this._dataContext=d;this._style=s;this._contents=c;};A.prototype.id=function(v){if(arguments.length>0){this._id=v;}else{return this._id;}};A.prototype.type=function(v){if(arguments.length>0){this._type=v;}else{return this._type;}};A.prototype.dataContext=function(v){if(arguments.length>0){this._dataContext=v;}else{return this._dataContext;}};A.prototype.style=function(v){if(arguments.length>0){this._style=v;}else{return this._style;}};A.prototype.contents=function(v){if(arguments.length>0){this._contents=v;}else{return this._contents;}};return A;});define('sap/viz/controls/annotationcontrol/AnnotationControlConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var A={};A.instance=function(){return{"allowDataPointValueChange":false,"visualStrategies":{"indicator":{"count":{"disabledRules":["SAME_ORIGINAL_VALUE"]}}}};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_ANNOTATIONCONTROL,A);return A;});define('sap/viz/controls/annotationcontrol/AnnotationControlEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var A=function(t,a,d){A.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotationcontrol.AnnotationControlEvent";};O.extend(A,E);A.ANNOTATION_SELECTED_EVENT="annotationSelected";A.ANNOTATION_LAYOUTED_EVENT="annotationLayouted";return A;});define('sap/viz/controls/annotationcontrol/Layouter',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event'],function(O,U,E){var L=function(){this.__className="sap.viz.controls.annotationcontrol.Layouter";};return L;});define('sap/viz/controls/annotationcontrol/AnnotationControl',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/annotationcontrol/AnnotationControlConfig','sap/viz/controls/annotationcontrol/AnnotationControlEvent','sap/viz/controls/annotationcontrol/AnnotationItem','sap/viz/controls/annotationcontrol/Layouter'],function($,V,O,A,a,b,L){var c=function(d,u){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotationcontrol.AnnotationControl";this._div=d;this._uiConfig=u?u:A.instance();this._annotationItems=[];this._createChildren();};O.extend(c,V);c.prototype._createChildren=function(){this._layouter=new L();};c.prototype.annotationItems=function(v){if(arguments.length>0){this._annotationItems=v;}else{return this._annotationItems;}};c.prototype.showAnnotations=function(){};c.prototype.hideAnnotations=function(){};c.prototype.invalidAnnotations=function(){return[];};c.prototype.getAnnotationPosition=function(d){if(!d||d.length===0){return[];}var e=[];for(var i=0;i<d.length;++i){e[i]=d[i].dataContext().context;}return this._vizProxy().getDataPointsPosition(e);};c.prototype.save=function(){return{};};c.prototype.load=function(v){};return c;});define('sap/viz/controls/chart/ChartConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var C={};var b={"border":{"left":{"visible":false},"right":{"visible":false},"top":{"visible":false},"bottom":{"visible":false}}};var x={"background":b,"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}};var a={"background":b,"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true}},"zAxis":{"title":{"visible":true}}};var c={"plotArea":{"gridline":{"visible":false},"background":b},"categoryAxis":{"title":{"visible":true}},"valueAxis":{"title":{"visible":true}}};var d={"plotArea":{"gridline":{"visible":false},"background":b},"categoryAxis":{"title":{"visible":true}},"valueAxis":{"title":{"visible":true}},"valueAxis2":{"title":{"visible":true}}};var l={"plotArea":{"marker":{"shape":"circle","size":6,"visible":true},"gridline":{"visible":false},"background":b},"categoryAxis":{"title":{"visible":true}},"valueAxis":{"title":{"visible":true}}};var e={"plotArea":{"marker":{"shape":"circle","size":6,"visible":true},"gridline":{"visible":false},"background":b},"categoryAxis":{"title":{"visible":true}},"valueAxis":{"title":{"visible":true}},"valueAxis2":{"title":{"visible":true}}};var f={"plotArea":{"line":{"marker":{"shape":"circle","size":6,"visible":true}},"gridline":{"visible":false},"background":b},"categoryAxis":{"title":{"visible":true}},"valueAxis":{"title":{"visible":true}}};var g={"plotArea":{"line":{"marker":{"shape":"circle","size":6,"visible":true}}},"background":b,"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis2":{"title":{"visible":true},"gridline":{"visible":false}}};var t={"plotArea":{"line":{"marker":{"shape":"circle","size":6,"visible":true}}},"background":b,"rowAxis":{"title":{"visible":true}},"columnAxis":{"title":{"visible":true}},"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis2":{"title":{"visible":true},"gridline":{"visible":false}}};var h={"plotArea":{"showNegativeValues":true,"gridline":{"visible":false},"background":b},"sizeLegend":{"visible":true},"valueAxis":{"title":{"visible":true}},"valueAxis2":{"title":{"visible":true}}};var s={"plotArea":{"gridline":{"visible":false},"background":b},"valueAxis":{"title":{"visible":true}},"valueAxis2":{"title":{"visible":true}}};var i={"background":b,"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}};var j={"plotArea":{"gridline":{"visible":false},"background":b},"rowAxis":{"title":{"visible":true}},"columnAxis":{"title":{"visible":true}},"valueAxis":{"title":{"visible":true}},"categoryAxis":{"title":{"visible":true}}};var k={"plotArea":{"gridline":{"visible":false},"background":b},"rowAxis":{"title":{"visible":true}},"columnAxis":{"title":{"visible":true}},"valueAxis":{"title":{"visible":true}},"valueAxis2":{"title":{"visible":true}},"categoryAxis":{"title":{"visible":true}}};var m={"plotArea":{"background":b},"rowAxis":{"title":{"visible":true}},"columnAxis":{"title":{"visible":true}}};var n={"plotArea":{"gridline":{"visible":false},"background":b},"valueAxis":{"title":{"visible":true}},"valueAxis2":{"title":{"visible":true}},"rowAxis":{"title":{"visible":true}},"columnAxis":{"title":{"visible":true}}};var o={"plotArea":{"showNegativeValues":true,"gridline":{"visible":false},"background":b},"sizeLegend":{"visible":true},"valueAxis":{"title":{"visible":true}},"valueAxis2":{"title":{"visible":true}},"rowAxis":{"title":{"visible":true}},"columnAxis":{"title":{"visible":true}}};var p={"background":b,"rowAxis":{"title":{"visible":true}},"columnAxis":{"title":{"visible":true}},"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true},"gridline":{"visible":false}}};var q={"background":b,"rowAxis":{"title":{"visible":true}},"columnAxis":{"title":{"visible":true}},"xAxis":{"title":{"visible":true},"gridline":{"visible":false}},"yAxis":{"title":{"visible":true}}};C.instance=function(){return{'enableTrellis':true,'enableMorphing':true,'enableAxisSplitter':true,"useBuiltInPropertyZoneInteraction":false,"useDefaultChartSizeForTrellis":false,"defaultLabelFormatString":[['u']],"defaultProperties":{"title":{"visible":true},"tooltip":{"visible":true},"dataLabel":{"visible":false},"plotArea":{"animation":{"dataLoading":false,"dataUpdating":false,"resizing":false}},"legend":{"visible":true}},"specificProperties":{"bar":c,"column":c,"stacked_bar":c,"stacked_column":c,"100_stacked_bar":c,"100_stacked_column":c,"dual_bar":d,"dual_column":d,"mekko":d,"100_mekko":d,"horizontal_mekko":d,"100_horizontal_mekko":d,"line":l,"horizontal_line":l,"combination":f,"horizontal_combination":f,"dual_line":e,"dual_horizontal_line":e,"dual_combination":g,"dual_horizontal_combination":g,"pie":{},"donut":{},"scatter":s,"bubble":h,"trellis_bar":j,"trellis_column":j,"trellis_stacked_bar":j,"trellis_stacked_column":j,"trellis_100_stacked_bar":j,"trellis_100_stacked_column":j,"trellis_dual_bar":k,"trellis_dual_column":k,"trellis_line":j,"trellis_horizontal_line":j,"trellis_dual_line":k,"trellis_dual_horizontal_line":k,"trellis_pie":m,"trellis_donut":m,"trellis_scatter":n,"trellis_bubble":o,"area":x,"horizontal_area":x,"100_area":x,"100_horizontal_area":x,"multi_area":p,"multi_100_area":p,"multi_horizontal_area":q,"multi_100_horizontal_area":q,"3d_column":a,"3d_bar":a,"pie_with_depth":{},"geobubble":{"plotArea":{"showNegativeValues":true},"sizeLegend":{"visible":true},"geoContainer":{"isFixedScale":false,"scale":null,"center":[]}},"choropleth":{"geoContainer":{"isFixedScale":false,"scale":null,"center":[]}},"geopie":{"sizeLegend":{"visible":true},"geoContainer":{"isFixedScale":false,"scale":null,"center":[]}},"geomap":{"provider":"ESRI"},"scatter_matrix":i,"heatmap":{"xAxis":{"title":{"visible":true}},"yAxis":{"title":{"visible":true}}},"treemap":{},"number":{},"boxplot":x,"horizontal_boxplot":x,"network":{},"radar":{"plotArea":{"marker":{"size":6},"valueAxis":{"title":{"visible":true}},"polarAxis":{"title":{"visible":true}}}},"multi_radar":{"rowAxis":{"title":{"visible":true}},"columnAxis":{"title":{"visible":true}},"plotArea":{"marker":{"size":6},"valueAxis":{"title":{"visible":true}},"polarAxis":{"title":{"visible":true}}}},"tagcloud":{},"tree":{},"waterfall":x,"horizontal_waterfall":x}};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_CHART,C);return C;});define('sap/viz/controls/chart/ChartPreHandler',['sap/viz/controls/common/managers/LangManager'],function(L){var C=function(){};C.prototype.preCreateViz=function(o){return o;};C.prototype.preVizUpdate=function(o){return o;};C.prototype.preLoadChart=function(c){return c;};return C;});define('sap/viz/controls/chart/ChartProxy',['jquery','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/Utils'],function($,C,a,U){var b=function b(c){this.__className="sap.viz.controls.chart.ChartProxy";this._chart=c;this._enabled=true;this._typeBeforePaused=null;};b.prototype.pauseRender=function(){this._enabled=false;this._typeBeforePaused=U.clone(this._chart.vizType());};b.prototype.resumeRender=function(){if(this._enabled){return;}this._enabled=true;var c=this._chart._chartView();var o=c._options;var d=this._chart.vizType();var p;if(d==C.TYPE_GEO_MAP){if(c._chart){c.doUpdate.apply(c,[c._chart,{data:o.data,feeding:o.feeding,properties:o.properties,css:o.css}]);c.doProperties.apply(c,[o.properties]);}return;}else if(this._typeBeforePaused&&this._typeBeforePaused==d&&c.hasChartInstance()){p={data:o.data,properties:o.properties,css:o.css};if(a.isInfoChart(d)){p.bindings=o.feeding;p.scales=o.scales;}else{p.feeding=o.feeding;}c._chart['update'].apply(c._chart,[p]);}else{p={type:d,data:o.data,properties:o.properties,css:o.css,events:o.events,container:c._chartLayer$.get(0)};if(a.isInfoChart(d)){p.bindings=o.feeding;p.scales=o.scales;}else{p.feeding=o.feeding;}c._chart=sap.viz.api.core.createViz(p);c._postVizProcess(o);}c._updateChartSize(true);this._typeBeforePaused=null;};b.prototype.execute=function(f){if(!this._enabled){return null;}var c=this._chart._chartView();var d;if(arguments.length>1){d=Array.prototype.slice.call(arguments,1)[0];}if(d){if(f==='update'){c.addChangedProperties(d.properties);}else if(f==='properties'){c.addChangedProperties(d);}else if(f==='sap.viz.api.core.createViz'){c.resetChangedProperties();c.addChangedProperties(d.properties);}}if(f.indexOf('map_')===0){return c[f.slice(4)].apply(c,Array.prototype.slice.call(arguments,1));}else if(f=='sap.viz.api.core.createViz'){return sap.viz.api.core.createViz(Array.prototype.slice.call(arguments,1)[0]);}else{if(c._chart){return c._chart[f].apply(c._chart,Array.prototype.slice.call(arguments,1));}}};b.prototype.get=function(f,d){var c=this._chart._chartView();if(!this._enabled&&d!==undefined){return d;}else{if(f=='type'){return c._chart[f];}else{return c._chart?this.execute(f):d;}}};b.prototype.set=function(f,v){this.execute(f,v)};return b;});define('sap/viz/controls/common/constants/MapProviderConst',[],function(){var M={};M.ESRI="ESRI";M.CVOM="CVOM";M.NAVTEQ="NAVTEQ";return M;});define('sap/viz/controls/chart/views/AxisSizeAdjustHelper',[],function(){var M="v-m-main";function i(n){return["xAxis","xAsix2","yAxis","yAxis2","categoryAxis","categoryAxis2"].indexOf(n)>-1;}var a=function(v,f,m,d,o){if(!i(m)||!v){return null;}var b;f.forEach(function(e){if(e.name===m){b=e.bound[0];}});var c=((v.app.container&&v.app.container())||v._usrOptions.container).querySelector("."+M).getBoundingClientRect();var g,h;switch(d){case"horizontal":g=c.height;h=b[0][1]-b[2][1];break;case"vertical":g=c.width;h=b[0][0]-b[2][0];break;}g=Math.abs(g);h=Math.abs(h);if(g!==0){o=parseFloat(o);if(!isNaN(o)){h+=o;}var p={};switch(m){case"xAxis":case"xAxis2":case"yAxis":case"yAxis2":p[m]={maxSizeRatio:Math.max(0,h/g)};break;case"categoryAxis":case"categoryAxis2":p[m]={layout:{}};if(d==="horizontal"){p[m]["layout"]["maxHeight"]=Math.max(0,h/g);}else{p[m]["layout"]["maxWidth"]=Math.max(0,h/g);}break;}return p;}return null;};return a;});define('sap/viz/controls/chart/views/AxisSplitter',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher'],function($,O,V,C,E,a){var A=function(c,p,b){A.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.AxisSplitter";this._container=c;this._propertiesProvider=p;this._propertyZoneProvider=b;this._createChildren();};O.extend(A,a);A.AxisSplitChanged="AxisSplitChanged";A.prototype._createChildren=function(){this._div$=$(document.createElement("DIV"));this._resizeHelper$=$(document.createElement("DIV")).addClass(C.CHART_PREFIX+'axissplitter-resizehelper');this._mask$=$(document.createElement("DIV")).addClass(C.CHART_PREFIX+'axissplitter-resizehelper-mask');this._axis$=this._createAxis();this._axis2$=this._createAxis();this._div$.append(this._axis$).append(this._axis2$);this._div$.appendTo(this._container);};A.prototype._updateResizeHelperBound=function(b){var w=b[1][0]-b[0][0];var h=b[2][1]-b[0][1];this._resizeHelper$.css({left:b[0][0],top:b[0][1],width:w,height:h});this._resizeHelper$.appendTo(this._container);};A.prototype._resizeHelper=function(o,i){var p=this._resizeHelper$.position();if(i){this._resizeHelper$.css({top:p.top+o,height:this._resizeHelper$.height()-o});}else{this._resizeHelper$.css({width:this._resizeHelper$.width()+o});}};A.prototype._createAxis=function(){var b=$(document.createElement("DIV")).addClass(C.CHART_PREFIX+'axissplitter-axis');var i=false;var s,c;var _=this;var m=function(e){var o=i?(e.clientY-c):(e.clientX-c);var p=b.position();if(i){o=Math.max(-p.top,o);o=Math.min(b.data("bottom")-p.top,o);var t=p.top+o;b.css({top:t});}else{o=Math.max(-(p.left-b.data("left")),o);o=Math.min($(_._container).width()-p.left-6,o);var l=p.left+o;b.css({left:l});}c+=o;_._resizeHelper$.css("cursor",b.css("cursor"));_._resizeHelper(o,i);e.stopPropagation();};var d=function(e){_._mask$.unbind("mousemove",m);_._mask$.unbind("mouseup",d);_._mask$.unbind("mouseout",d);_._mask$.detach();_._resizeHelper$.detach();var f=i?e.clientY:e.clientX;var g=b.data("axis").name;var o=s-f;o=i?o:-o;_._axisMoved(g,b.data("direction"),o);};b.mousedown(function(e){_._mask$.css("cursor",b.css("cursor"));_._mask$.appendTo(document.body);i=b.data("isHorizontal");s=c=i?e.clientY:e.clientX;_._updateResizeHelperBound(b.data("axis").bound[0]);_._mask$.mousemove(m);_._mask$.mouseup(d);_._mask$.mouseout(d);});return b;};A.prototype._axisMoved=function(b,d,o){var c={axisName:b,direction:d,offset:o};this._dispatchEvent(new E(A.AxisSplitChanged,this,c));};A.prototype._getAxis=function(){var z=this._propertyZoneProvider();var r=[],b;if(!z||z.length===0){return r;}for(var i=0;i<z.length;++i){b=z[i];for(var n=0;n<this._categoryAxis.length;++n){if(b.name===this._categoryAxis[n]){switch(b.name){case"categoryAxis":case"categoryAxis2":b.direction=this._categoryAxis[0]==="xAxis"?"horizontal":"vertical";break;case"xAxis":case"xAxis2":b.direction="horizontal";break;case"yAxis":case"yAxis2":b.direction="vertical";break;}r.push(b);}}}return r;};A.prototype._layoutAxis=function(b,c){var i=c.direction==="horizontal";b.data("direction",c.direction);b.data("isHorizontal",i);b.data("axis",c);if(i){var w=c.bound[0][1][0]-c.bound[0][0][0];b.data("bottom",c.bound[0][2][1]);b.css({left:c.bound[0][0][0],top:c.bound[0][1][1],width:w,height:6,"margin-top":-3,"margin-left":0,cursor:"n-resize"});}else{var h=c.bound[0][2][1]-c.bound[0][0][1];b.data("left",c.bound[0][0][0]);b.css({left:c.bound[0][1][0],top:c.bound[0][0][1],height:h,width:6,"margin-top":0,"margin-left":-3,cursor:"e-resize"});}};A.prototype._layout=function(b){if(!b||b.length===0){return;}this._layoutAxis(this._axis$,b[0]);if(b[1]){this._axis2$.css({'visibility':""});this._layoutAxis(this._axis2$,b[1]);}else{this._axis2$.css({'visibility':"hidden"});}this._div$.css({'visibility':"visible"});};A.prototype.reset=function(){this._div$.css({'visibility':'hidden'});};A.prototype.init=function(t){this._categoryAxis=V.getCategoryAxis(t);if(!this._categoryAxis||this._categoryAxis.length===0){this.reset();return;}this._categoryAxis=this._categoryAxis.concat("categoryAxis","categoryAxis2");var b=this._getAxis();if(!b||b.length===0){this.reset();}else{this._layout(b);}};A.prototype.deactive=function(){this._div$.css({'display':"none"});};A.prototype.active=function(){this._div$.css({'display':"block"});};return A;});define('sap/viz/controls/chart/views/ChartEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var C=function(t,a,d){C.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ChartEvent";};O.extend(C,E);C.CHANGED_SELECTED_DATA="changeSelectedData";C.TRIGGER_CVOM_EVENT="triggerCVOMEvent";C.CHART_CHANGING="ChartChanging";C.CHART_CHANGED="ChartChanged";C.CVOM_INITIALIZED="CVOMChartInitialized";C.CLICK_FILTER_BUTTON="clickFilterButton";C.CLICK_EXCLUDE_BUTTON="clickExcludeButton";C.CLICK_DRILLDOWN_BUTTON="clickDrillDownButton";C.CHANGE_FEEDING="changeFeeding";C.ANALYSIS_DROPPED="analysisDropped";C.TITLE_CHANGED="TitleChanged";C.VIZTYPE_CHANGED="vizTypeChanged";C.VIZ_VIEW_CHANGED='vizViewChanged';C.SELECT_PROPERTY_ZONE="selectPropertyZone";C.PROPERTY_ZONES_CHANGED='propertyZonesChanged';C.ESRI_CUSTOMIZED_SERVICE_CHANGED='esriCustomizedServiceChanged';C.CONTEXT_MENU_TRIGGERED='contextMenuTriggered';C.USER_INTERACTION_COMPLETE='userInteractionComplete';C.VIZ_PROPERTIES_CHANGED='vizPropertiesChanged';C.VIZ_SCALES_CHANGED='vizScalesChanged';C.BEHAVIOR_TYPE_CHANGED='behaviorTypeChanged';C.RENDER_COMPLETE='renderComplete';return C;});define('sap/viz/controls/chart/views/DataPointFinder',['jquery','sap/viz/controls/common/utils/Utils'],function($,U){var D={};D.findDataPointsPosition=function(d){var r=[];if(!d||d.length===0){return r;}for(var i=0;i<d.length;i++){var a=D._findDataPointUI(d[i]);if(a){r[i]=a.getBoundingClientRect();}}return r;};D._findDataPointUI=function(d){var a=d3.selectAll('.v-datapoint')[0];for(var i=0;i<a.length;i++){var b=a[i].__data__;if(!b){continue;}var c;if(U.isArray(b.ctx)){c=b.ctx[0];}else{c=b.ctx;}if(c.path==d.ctx[0]){return a[i];}}return null;};return D;});define('sap/viz/controls/common/helpers/Rectangle',[],function(){var R=function(l,t,w,h){this._left=l;this._top=t;this._width=w;this._height=h;};R.parseDOM=function(d){var o=d.offset();return new R(o.left,o.top,d.outerWidth(),d.outerHeight());};R.prototype.left=function(v){if(arguments.length>0){this._left=v;}else{return this._left;}};R.prototype.top=function(v){if(arguments.length>0){this._top=v;}else{return this._top;}};R.prototype.right=function(v){if(arguments.length>0){this.left(v-this.width());}else{return this.left()+this.width();}};R.prototype.bottom=function(v){if(arguments.length>0){this.top(v-this.height());}else{return this.top()+this.height();}};R.prototype.width=function(){return this._width;};R.prototype.height=function(){return this._height;};R.prototype.hCenter=function(){return this.left()+this.width()/2;};R.prototype.vCenter=function(){return this.top()+this.height()/2;};R.prototype.hContains=function(t){return this.left()<=t.left()&&this.right()>=t.right();};R.prototype.vContains=function(t){return this.top()<=t.top()&&this.bottom()>=t.bottom();};R.prototype.contains=function(t){return this.hContains(t)&&this.vContains(t);};R.toJSON=function(i){return{'left':i.left(),'top':i.top(),'width':i.width(),'height':i.height()};};return R;});define('sap/viz/controls/chart/views/DropZone',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/helpers/Rectangle'],function($,C,F,a,O,u,E,b,c,d,D,f,A,R){var g=function(t,z,h){g.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.DropZone";this._targetDiv=t;this._zoneProvider=z;this._feedValidator=h;this._enterDrop=false;this._dragActionArray=[];var s="position:absolute;visibility:hidden;left:0px;top:0px;width:0px;height:0px;";this._dom=$(document.createElement("DIV")).appendTo(this._targetDiv.parentNode).attr('style',s);var i=this;this._dom.droppable({accept:$.proxy(function(e){return this._isTriggerAllowed(e)===true;},this),activate:function(e,j){i.enterDrop.apply(i,[e,j]);},deactivate:function(e,j){u.defer(function(){i.exitDrop.apply(i,[e,j]);});}});};O.extend(g,b);g.DROP_ITEM_EVENT='DROP_ITEM_EVENT';var _=8;g.prototype._match=function(z,e){var t=e.type();if(t){t=t.toLowerCase();}var h=e.dataType();if(h){h=h.toLowerCase();}var j=z.feedDef;var k=j[0].id===F.ID_GEO?d.GEOGRAPHY:j[0].type;if(j.length===1&&a.feedCompatible(k,t,h)){return true;}for(var i=0;i<j.length;i++){k=j[i].id===F.ID_GEO?d.GEOGRAPHY:j[i].type;if(a.feedCompatible(k,t,h)&&j[i].id!=='multiplier'){return true;}}return false;};g.prototype._onDragOver=function(e,h){if(!this._enterDrop){return;}var z=e.target.__zone;var i=e.target.__areaIndex;var t=D.instance().getAnalysisToken(h.helper);if(!z){t.currentAction(f.DENY);return;}this._hightlight(z,i);if(this._acceptable(z,t.analysisObject)){t.dropTarget(e.target);t.currentAction(f.ACCEPT);}else{t.currentAction(f.DENY);}for(var j in this._dragActionArray){if(this._dragActionArray[j].zoneName===z.name){this._dragActionArray.splice(j,1);break;}}this._dragActionArray.push({"zoneName":z.name,"action":t.currentAction()});};g.prototype._acceptable=function(z,e){var m=this._match(z,e);if(!m){return false;}var h=z.feedDef;for(var i=0;i<h.length;i++){if(h[i].id!=="r_subtotals"){if(h[i].id==='multiplier'){if(z.name===F.ID_TRELLIS_ROW||z.name===F.ID_TRELLIS_COLUMN){if(this._feedValidator(z.name,e)){return true;}}else{if(this._feedValidator(F.ID_TRELLIS_ROW,e)||this._feedValidator(F.ID_TRELLIS_COLUMN,e)){return true;}}}else{if(this._feedValidator(h[i].id,e)){return true;}}}}return false;};g.prototype._onDragOut=function(e,h){if(!this._enterDrop){return;}var z=e.target.__zone;var i=e.target.__areaIndex;if(z){this._unHightlight(z,i);}var t=D.instance().getAnalysisToken(h.helper);if(t.currentAction()===f.ACCEPT&&t.dropTarget()===e.target){t.currentAction(f.DENY);t.dropTarget(null);}for(var j in this._dragActionArray){if(this._dragActionArray[j].zoneName===z.name){this._dragActionArray.splice(j,1);break;}}var l=this._dragActionArray.length;if(l>0){t.currentAction(this._dragActionArray[l-1].action);}};g.prototype._onDragDrop=function(e,h){var z=e.target.__zone;var t=D.instance().getAnalysisToken(h.helper);if(!z||!t){return;}var l=this._dragActionArray.length;if(l>0){var i=this._dragActionArray[l-1];if(i.zoneName!==z.name){return;}}var j=R.parseDOM($(this._targetDiv));var p=new R(e.pageX,e.pageY,0,0);if(!j.contains(p)){return;}var k=t.analysisObject;if(this._acceptable(z,k)){t.currentAction(f.ACCEPT);this._dispatchEvent(new E(g.DROP_ITEM_EVENT,this,{'zone':z,'analysisObject':k}));}else{t.currentAction(f.DENY);}t.dropTarget(this._dom);};g.prototype._isTriggerAllowed=function(e){var h=e.hasClass(D.DRAGGABLE_CLASS_ANALYSIS);h=h&&!e.hasClass(C.FEEDINGSHELF_PREFIX+'card');return h;};g.prototype._createDiv=function(p,h,t,r){var i=$(document.createElement("DIV"));var l=h[0][0],j=h[0][1],w=h[2][0]-h[0][0],k=h[2][1]-h[0][1];if(w>0){w-=2;}if(k>0){k-=2;}var s="visibility:hidden;left:"+l+"px;top:"+j+"px;width:"+w+"px;height:"+k+"px;";var m=this;i.attr('style',s).droppable({tolerance:'pointer',accept:$.proxy(function(e){return this._isTriggerAllowed(e)===true;},this),drop:function(e,v){m._onDragDrop.apply(m,[e,v]);},over:function(e,v){m._onDragOver.apply(m,[e,v]);},out:function(e,v){m._onDragOut.apply(m,[e,v]);}});i.addClass(C.CHART_PREFIX+'drop-zone').appendTo(p);if(t&&t.length>0){s="position:absolute;left:0px;top:0px;white-space:nowrap;";var n=$(document.createElement("DIV")).attr('style',s).text(t).appendTo(i);var o=n[0].getBoundingClientRect();var q=null;if(r){q="translate("+(w-o.width)/2+"px,"+((o.width-o.height)/2+_)+"px) rotate(-90deg);";}else{q="translate("+_+"px, "+(k-o.height)/2+"px);";}s+="transform: "+q;s+="-webkit-transform: "+q;s+="-ms-transform: "+q;s+="-moz-transform: "+q;n.attr('style',s);}return i;};g.prototype.enterDrop=function(e,h){var t=D.instance().getAnalysisToken(h.helper);if(!t){return;}if(this._enterDrop){return;}this._enterDrop=true;this._targetRect=this._targetDiv.getBoundingClientRect();var s="position:absolute;left:0px;top:0px;width:"+this._targetRect.width+"px;height:"+this._targetRect.height+"px;";this._dom.empty().attr('style',s);var z=this._zoneProvider();if(!z){return;}this._dragActionArray=[];for(var i=0;i<z.length;i++){var j=z[i].bound;for(var n=0;n<j.length;n++){var k=this._createDiv(this._dom[0],j[n],z[i].text,z[i].rotate);k[0].__zone=z[i];k[0].__areaIndex=n;}}};g.prototype.exitDrop=function(){if(!this._enterDrop){return;}this._dom.empty();this._dom.css('visibility','hidden');this._enterDrop=false;};g.prototype.size=function(s){if(s){this._dom.css({width:s.width+"px",height:s.height+"px"});}};g.prototype._getDom=function(z,e){var h=this._dom.children();for(var i=0;i<h.length;i++){if(h[i].__zone===z&&h[i].__areaIndex===e){return h[i];}}return null;};g.prototype._hightlight=function(z,e){var h=this._getDom(z,e);if(h){$(h).css('visibility','');}};g.prototype._unHightlight=function(z,e){var h=this._getDom(z,e);if(h){$(h).css('visibility','hidden');}};return g;});define('sap/viz/controls/chart/views/EditAxisView',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/managers/LangManager'],function($,O,V,C,U,a,b,E,L){var c=function(e,u){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.EditAxisView";this._type=null;this._properties=null;};var d;O.extend(c,U);c.AxisScaleChanged="AxisScaleChanged";c.prototype._createDialog=function(t,f,p,s){this._type=t;if(f){this._valueAxis=[f];}else{this._valueAxis=V.getValueAxis(t);if(C.isInfoChart(t)){this._valueAxis=this._valueAxis.map(function(e){return C.map2semanticAxis(e,t);});}}if(C.isInfoChart(t)){this._getInfoChartAxisScale(p,s);}this._properties=p;var v=this._valueAxis;if(!v||v.length===0){return;}this._axisContainer=[];var g;var i;for(i=0;i<v.length;i++){g=p[v[i]];if(this._supportScale(g)){this._axisContainer[i]=this._createAxisItem(v[i],g);}}var B=new sap.ui.commons.Button({text:L.get("VIZ_COMMON_OK"),enabled:true,press:function(){this._applyChange();}.bind(this)});var o=new sap.ui.commons.Button({text:L.get("VIZ_COMMON_CANCEL"),enabled:true,press:function(){this._close();}.bind(this)});d=new sap.ui.commons.Dialog({modal:true});d.addStyleClass("sap-lumira-axisscale-dialog");d.setShowCloseButton(false);d.setTitle(L.get("VIZ_CONTEXTMENU_SET_AXIS_SCALE"));sap.ui.jsview("axis.top",{height:'24px',createContent:function(){var e=new sap.ui.commons.layout.MatrixLayout({layoutFixed:true,columns:1,width:'332px'});return e;}});var h=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"axis.top"});sap.ui.jsview("axis.bottom",{height:'16px',createContent:function(){var e=new sap.ui.commons.layout.MatrixLayout({layoutFixed:true,columns:1,width:'332px'});return e;}});var j=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"axis.bottom"});d.addContent(h);for(i=0;i<this._axisContainer.length;i++){d.addContent(this._axisContainer[i]);}d.addContent(j);d.addButton(B);d.addButton(o);};c.prototype._createAxisItem=function(e,p){var s=p.scale.fixedRange?1:0;var m=p.scale.minValue;var f=p.scale.maxValue;sap.ui.jsview("axis.content",{height:'110px',createContent:function(){var h=new sap.ui.commons.RadioButtonGroup({select:function(){if(h.getSelectedItem().getKey()==="fixed"){k.setEditable(true);n.setEditable(true);s=1;}else if(h.getSelectedItem().getKey()==="automatic"){k.setEditable(false);n.setEditable(false);s=0;}},selectedIndex:s});var i=new sap.ui.core.Item({text:L.get("VIZ_CHART_AUTO_RANGE"),tooltip:L.get("VIZ_CHART_AUTO_RANGE"),key:"automatic"});h.addItem(i);i=new sap.ui.core.Item({text:L.get("VIZ_CHART_FIXED_RANGE"),tooltip:L.get("VIZ_CHART_FIXED_RANGE"),key:"fixed"});h.addItem(i);var j=new sap.ui.commons.layout.MatrixLayout({layoutFixed:true,width:'300px',columns:3});j.setWidths('140px','20px','140px');var l=new sap.ui.commons.Label({text:'-',width:"100%",textAlign:"Center"});var k=new sap.ui.commons.TextField({width:'100%',editable:p.scale.fixedRange?true:false,value:m,change:function(){m=this.mProperties.value;}});var n=new sap.ui.commons.TextField({width:'100%',editable:p.scale.fixedRange?true:false,value:f,change:function(){f=this.mProperties.value;}});j.createRow(k,l,n);var o=new sap.ui.commons.layout.MatrixLayout({layoutFixed:true,width:'332px',columns:3});o.setWidths('16px','300px','16px');var t,q,r;t=new sap.ui.commons.Label({text:this._getAxisName(this._type,e)});q=new sap.ui.layout.VerticalLayout();q.addContent(t);q.addContent(h);q.addContent(j);o.createRow(null,q,null);return o;}.bind(this)});var g=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"axis.content"});g.save=function(h,e){if(s===1){h[e].scale.fixedRange=true;}h[e].scale.minValue=m;h[e].scale.maxValue=f;};return g;};c.prototype._supportScale=function(p){if(p&&p.scale){return true;}return false;};c.prototype._propertiesChanged=function(p){for(var i=0;i<this._valueAxis.length;++i){var e=this._valueAxis[i];var f=p[e];var g=this._properties[e];if(this._supportScale(g)){if(f.scale.fixedRange!==g.scale.fixedRange){return true;}if(f.scale.fixedRange){if(f.scale.minValue!==g.scale.minValue||f.scale.maxValue!==g.scale.maxValue){return true;}}}}return false;};c.prototype._applyChange=function(){var p={};for(var i=0;i<this._valueAxis.length;++i){var e=this._valueAxis[i];p[e]={scale:{fixedRange:false}};var f=this._axisContainer[i];if(!f){continue;}f.save(p,e);}if(this._propertiesChanged(p)){if(C.isInfoChart(this._type)){var s=this._convertToInfoChartAxisScales(p);this._dispatchEvent(new E(c.AxisScaleChanged,this,s));}else{this._dispatchEvent(new E(c.AxisScaleChanged,this,p));}}this._close();};c.prototype._close=function(){d.close();d.$().remove();};c.prototype._convertToInfoChartAxisScales=function(p){var s=this._scales||[];var r=[];for(var i in s){var e=s[i];var f;if(e.feed==='valueAxis'&&"valueAxis"in p){f=p["valueAxis"].scale||{};e.min=f.fixedRange?f.minValue:'auto';e.max=f.fixedRange?f.maxValue:'auto';r.push(e);}if(e.feed==='valueAxis2'&&"valueAxis2"in p){f=p["valueAxis2"].scale||{};e.min=f.fixedRange?f.minValue:'auto';e.max=f.fixedRange?f.maxValue:'auto';r.push(e);}}return r;};c.prototype._getAxisName=function(t,e){var v=V.getValueAxis(t);var f=v?v.length:1;e=C.map2directionAxis(e,t);if(f===1||t===a.TYPE_SCATTER||t===a.TYPE_BUBBLE||C.isMekkoChart(t)){if(e===a.AXIS_XAXIS){return L.get("VIZ_CHART_XAXIS_RANGE");}else if(e===a.AXIS_YAXIS){return L.get("VIZ_CHART_YAXIS_RANGE");}}else{if(e===a.AXIS_XAXIS){return L.get("VIZ_CHART_XAXIS1_RANGE");}else if(e===a.AXIS_YAXIS){return L.get("VIZ_CHART_YAXIS1_RANGE");}}if(e===a.AXIS_XAXIS2){return L.get("VIZ_CHART_XAXIS2_RANGE");}else if(e===a.AXIS_YAXIS2){return L.get("VIZ_CHART_YAXIS2_RANGE");}return"";};c.prototype._getInfoChartAxisScale=function(p,s){this._scales=s;var m=function(e,f){var u=e['min']==='auto'?true:false;var g=e['max']==='auto'?true:false;return{fixedRange:!(u&&g),minValue:u?f['autoMinValue']:e['min'],maxValue:g?f['autoMaxValue']:e['max']};};for(var i in s){var e=s[i];if(e.feed==='valueAxis'){p["valueAxis"]={scale:m(e,p.plotArea.primaryScale)};}if(e.feed==='valueAxis2'){p["valueAxis2"]={scale:m(e,p.plotArea.secondaryScale)};}}};c.prototype.show=function(t,e,p,s){this._createDialog(t,e,p,s);d.open();d.$().removeClass("sapUiDlgFlexHeight sapUiDlgFlexWidth sapUiDlg sapUiDlgContentBorderDesignNone sapUiShd");d.$().addClass("prefMainDial sapUiDlg sapUiDlgContentBorderDesignNone sapUiDlgModal sapUiDlgNoPad sapUiShd");var h=$(".sapUiDlgHdr").height()+115*this._axisContainer.length+$(".sapUiDlgFooter").height()+45;var l=this._dom$.offset().left+this._dom$.width()/2;var f=this._dom$.offset().top+this._dom$.height()/2;l=l-h/2;f=f-350/2;d.$().css({"width":"350px","height":h+"px","position":"absolute","visibility":"visible","display":"block","top":f,"left":l});$(".sapUiDlgHdrBtns").attr("data-sap-ui-area",$(".sapUiDlgHdrBtns").id);$(".sapUiDlgHdrBtns").empty();$(".sapUiDlgHdrBtns").addClass("viz-controls-chart-axis-dialog-close").addClass(b.ICON_PREFIX+'error');$(".sapUiDlgHdrBtns").click(function(g){this._close();}.bind(this));};return c;});define('sap/viz/controls/chart/views/PropertyZone',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/EventDispatcher'],function($,C,O,E,a){var P=function(t,z){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.DropZone";this._targetDiv=t;this._zoneProvider=z;this._selectedZone$=null;var s="position:absolute;visibility:hidden;left:0px;top:0px;width:0px;height:0px;";this._dom=$(document.createElement("DIV")).appendTo(this._targetDiv.parentNode).attr('style',s);};O.extend(P,a);P.SELECT_ZONE='SELECT_ZONE_EVENT';P.prototype._createZones=function(){this._targetRect=this._targetDiv.getBoundingClientRect();var s="position:absolute;left:0px;top:0px;width:"+this._targetRect.width+"px;height:"+this._targetRect.height+"px;";this._dom.empty().attr('style',s);var z=this._zoneProvider();for(var i=0;i<z.length;i++){var b=z[i].bound;for(var n=0;n<b.length;n++){this._createZone(this._dom[0],b[n],z[i].name);}}};P.prototype._createZone=function(p,b,z){var d=$(document.createElement("DIV"));var l=b[0][0],t=b[0][1],w=b[2][0]-b[0][0],h=b[2][1]-b[0][1];var s="left:"+l+"px;top:"+t+"px;width:"+w+"px;height:"+h+"px;";d.attr('style',s).addClass(C.CHART_PREFIX+'property-zone').appendTo(p);d.get(0).__name=z;d.click($.proxy(this._selectZone,this));};P.prototype._selectZone=function(e){var c=$(e.target);if(this._selectedZone$!==c){if(this._selectedZone$){this._selectedZone$.removeClass(C.CHART_PREFIX+'property-zone-selected');}this._selectedZone$=c;this._selectedZone$.addClass(C.CHART_PREFIX+'property-zone-selected');var b={'propertyZoneName':this._selectedZone$.get(0).__name};this._dispatchEvent(new E(P.SELECT_ZONE,this,b));}};P.prototype.updateZone=function(e){if(e){this._createZones();this._dom.css('visibility','');}else{this._dom.css('visibility','hidden');}};P.prototype.size=function(s){if(s){this._dom.css({width:s.width+"px",height:s.height+"px"});}};return P;});define("sap/viz/controls/LanguageLoader",[],function(){sap.viz.extapi.env.Language.register({id:'language',value:{VIZ_COMMON_YAXIS:"Y Axis",VIZ_COMMON_DONT_SHOW_MESSAGE:"Don't show this again",VIZ_COMMON_ADD_ICON:"Add",VIZ_COMMON_SHOW_BY_DIMENSION:"Show by {0}",VIZ_COMMON_PIE_TEXT:"Pie Chart",VIZ_COMMON_ITEM:"Item",VIZ_COMMON_BOXPLOT_TEXT:"Box Plot",VIZ_COMMON_DIMENSION_LIMITATION_WARN:"You have reached the maximum number of dimension feeds for this visualization.",VIZ_COMMON_MIN:"Min",VIZ_COMMON_FEATUREANALYSIS:"Overlay Data",VIZ_COMMON_TABLE_MEASURE:"Primary Values",VIZ_COMMON_PIE_DEPTH:"Pie Depth",VIZ_COMMON_MAX_SHORT:"(Max)",VIZ_COMMON_SERIALIZATION_FAILED:"Serialization error",VIZ_COMMON_STACKED_COLUMN_TEXT:"Stacked Column Chart",VIZ_COMMON_PRIMARY_YAXIS:"Y Axis1",VIZ_COMMON_TAGFAMILY:"Word Color",VIZ_COMMON_ADD_MEASURES:"Add Measures",VIZ_COMMON_XAXIS:"X Axis",VIZ_COMMON_DIMENSIONS_TIPS:"Show value affected by measure",VIZ_COMMON_DELETE_COMMENT_MESSAGE:"Are you sure to delete the comment?",VIZ_COMMON_CHANGE_CALCULATION:"Change Calculation",VIZ_COMMON_DELETE:"Delete",VIZ_COMMON_TABLE_COLUMNS_AXIS:"Columns Axis",VIZ_COMMON_BETWEEN:"BETWEEN",VIZ_COMMON_SETTINGS_ICON:"Settings",VIZ_COMMON_OK:"OK",VIZ_COMMON_COUNT_ALL_SHORT:"(Cnt-All)",VIZ_COMMON_SUM_SHORT:"(Sum)",VIZ_COMMON_SCATTER_MATRIX_TEXT:"Scatter Matrix Chart",VIZ_COMMON_GEOMAP_TEXT:"Geo Map",VIZ_COMMON_SCATTER_TEXT:"Scatter Plot",VIZ_COMMON_MAX:"Max",VIZ_COMMON_LEGEND:"Legend",VIZ_COMMON_PRIMARY_XAXIS:"X Axis1",VIZ_COMMON_TOTAL_OF:"Total of",VIZ_COMMON_COUNT_OF:"Count of",VIZ_COMMON_CANCEL:"Cancel",VIZ_COMMON_GEO_FEATURES:"Geography",VIZ_COMMON_TAGCLOUD_TEXT:"Tag Cloud",VIZ_COMMON_NONE_SHORT:"(None)",VIZ_COMMON_CHOROPLETH_TEXT:"Geo Choropleth Chart",VIZ_COMMON_RADAR_AXES:"Radar Branches",VIZ_COMMON_COLUMNS:"Columns",VIZ_COMMON_ADD_ONE_MEASURE:"Add one Measure",VIZ_COMMON_RADAR_TEXT:"Radar Chart",VIZ_COMMON_COUNT_DISTINCT:"Count-Distinct",VIZ_COMMON_FAKE_DIMENSION:"Dimension",VIZ_COMMON_DUAL_LINE_TEXT:"Line Chart With 2 Y-Axes",VIZ_COMMON_TABLE_COLUMNS_SUBTOTALS:"Columns Subtotals",VIZ_COMMON_FEATUREVALUES:"Value",VIZ_COMMON_LINE_TEXT:"Line Chart",VIZ_COMMON_TABLE_TEXT:"Table",VIZ_COMMON_MEASURE_TIPS:"Sort, rank, add calculations",VIZ_COMMON_ROWS:"Rows",VIZ_COMMON_SUBTOTALS_TIPS:"Show value of subtotal",VIZ_COMMON_DUAL_BAR_TEXT:"Bar Chart With 2 Y-Axes",VIZ_COMMON_FAKE_MEASURE:"Measure",VIZ_COMMON_BUBBLE_HEIGHT:"Bubble Height",VIZ_COMMON_AVERAGE_SHORT:"(Avg)",VIZ_COMMON_REMOVE_ICON:"Remove",VIZ_COMMON_HEATMAP_TEXT:"Heat Map",VIZ_COMMON_TAGNAME:"Word",VIZ_COMMON_DUAL_COLUMN_TEXT:"Column Chart With 2 Y-Axes",VIZ_COMMON_COLUMN_WIDTH:"Column Width",VIZ_COMMON_RECTANGLEWEIGHT:"Area Weight",VIZ_COMMON_SUM_OF:"Sum of",VIZ_COMMON_AVERAGE:"Average",VIZ_COMMON_AREA_TEXT:"Area Chart",VIZ_COMMON_COUNT_DISTINCT_SHORT:"(Cnt-Dis)",VIZ_COMMON_3D_BAR_TEXT:"3D Bar Chart",VIZ_COMMON_GEO_COLOR:"Color",VIZ_COMMON_SEARCH:"Search",VIZ_COMMON_REGIONCOLOR:"Legend Color",VIZ_COMMON_ADD_DIMENSIONS:"Add Dimensions",VIZ_COMMON_TREEMAP_TEXT:"Tree Map",VIZ_COMMON_WATERFALL_TEXT:"Waterfall Chart",VIZ_COMMON_GEOPIE_TEXT:"Geo Pie Chart",VIZ_COMMON_TRELLIS:"TRELLIS",VIZ_COMMON_MIN_SHORT:"(Min)",VIZ_COMMON_BUBBLE_WIDTH:"Bubble Width",VIZ_COMMON_REGIONSHAPE:"Legend Shape",VIZ_COMMON_MEASURES:"MEASURES",VIZ_COMMON_SECONDARY_YAXIS:"Y Axis2",VIZ_COMMON_MAX_OF:"Maximum of",VIZ_COMMON_TAGWEIGHT:"Word Weight",VIZ_COMMON_3D_COLUMN_TEXT:"3D Column Chart",VIZ_COMMON_BAR_HEIGHT:"Bar Height",VIZ_COMMON_COUNT_ALL:"Count-All",VIZ_COMMON_TRELLIS_TIPS:"Add as rows and columns",VIZ_COMMON_CHOOSE_MEASURE:"Choose value",VIZ_COMMON_PIE_SECTORS:"Pie Sectors",VIZ_COMMON_EDIT:"Edit",VIZ_COMMON_TABLE_ROWS_SUBTOTALS:"Rows Subtotals",VIZ_COMMON_AVERAGE_OF:"Average of",VIZ_COMMON_DIMENSIONS:"DIMENSIONS",VIZ_COMMON_DEPENDENCY_ERROR:"Include {0} when using {1}.",VIZ_COMMON_DEPENDENCY_ERROR_WITH_UI_CONFIG:"Include {0} when using {1} with {2}.",VIZ_COMMON_ANIMATION:"Animation",VIZ_COMMON_GEOBUBBLE_TEXT:"Geographic Bubble Chart",VIZ_COMMON_RECTANGLECOLOR:"Area Color",VIZ_COMMON_AREANAME:"Area Name",VIZ_COMMON_SECONDARY_XAXIS:"X Axis2",VIZ_COMMON_CROSSTAB_TEXT:"Crosstab",VIZ_COMMON_BAR_TEXT:"Bar Chart",VIZ_COMMON_STACKED_BAR_TEXT:"Stacked Bar Chart",VIZ_COMMON_BUBBLE_TEXT:"Bubble Chart",VIZ_COMMON_ADD_ONE_DIMENSION:"Add one Dimension",VIZ_COMMON_DUAL_COMBINATION_TEXT:"Combined Column Line Chart With 2 Y-Axes",VIZ_COMMON_NONE:"None",VIZ_COMMON_MIN_OF:"Minimum of",VIZ_COMMON_REGION:"Region",VIZ_COMMON_TABLE_DIMENSION:"Rows Axis",VIZ_COMMON_SUBTOTALS:"SUBTOTALS",VIZ_COMMON_COMBINATION_TEXT:"Combined Column Line Chart",VIZ_COMMON_COLUMN_TEXT:"Column Chart",VIZ_COMMON_SUM:"Sum",VIZ_COMMON_PIE_WITH_DEPTH_TEXT:"Pie With Variable Slice Depth",VIZ_COMMON_DONUT_TEXT:"Donut Chart",VIZ_COMMON_INVALID_SERIALIZATION_PACKAGE:"Invalid serialization package",VIZ_COMMON_SECONDARY_AREANAME:"Area Name2",}});sap.viz.extapi.env.Language.register({id:'language',value:{VIZ_ANNOTATION_COMMENT:"Comment",}});sap.viz.extapi.env.Language.register({id:'language',value:{INVALID_DATA_BINDING:"Invalid data binding",VIZ_CHART_BACK:"Back",VIZ_CHART_ADD_EVENT_FAILED:"Failed to add chart event callback:",VIZ_CHART_UPDATE_CSS_FAILED:"Failed to update chart css:",VIZ_CHART_XAXIS_RANGE:"X Axis Range",VIZ_CHART_EXPORTSVG_FAILED:"Failed to export to svg string.",VIZ_CHART_TITLE_CONTEXT_MENU_EDIT:"Rename",VIZ_CHART_INCOMPLETE_DESCRIPTION:"Add more measures or dimensions",VIZ_CHART_END:"End",VIZ_CHART_UPDATE_PROPERTIES_FAILED:"Failed to update chart properties:",VIZ_CHART_GRADIENT:"Gradient",VIZ_CHART_TRIGGER_ACTION_FAILED:"Failed to trigger chart action:",VIZ_CHART_UPDATE_CHART_FAILED:"Failed to update chart:",VIZ_CHART_ESRI_MAP_AUTHENTICATION_FAIL:"Esri Authentication Fail",VIZ_CHART_START:"Start",VIZ_CHART_XAXIS2_RANGE:"X Axis2 Range",VIZ_CHART_AXIS_ZOOM:"Zoom",VIZ_CHART_XAXIS1_RANGE:"X Axis1 Range",VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER:"No data matches your filter(s)",VIZ_CHART_ESRI_SERVICES_UNACCESSIBLE:"An unknown error has occurred while accessing ESRI online services. Check your internet connection.",VIZ_CHART_UPDATE_FEEDING_FAILED:"Failed to update chart feeding:",VIZ_CHART_SEGMENTED:"Segmented",VIZ_CHART_SET_AXIS_RANGE:"Set axis range",VIZ_CHART_TRELLIS_DISABLED_WARN:"The trellis is disabled in either the Viz Frame or Feeding Panel",VIZ_CHART_SELECTION_FAILED:"Failed to get/set chart selection:",VIZ_CHART_IMPORT_ESRI_CUSTOM_SERVICE:"Import Esri Custom Service",VIZ_CHART_NEGATIVE_VALUES_INFO:"To display negative values, click the Settings button and select Show Negative Values from the contextual menu.",VIZ_CHART_ESRI_MAP_LOG_ON:"Logging in to Esri now",VIZ_CHART_CREATE_CHART_FAILED:"Failed to create chart:",VIZ_CHART_MEASURE_INCOMPLETE_DESCRIPTION:"Add more measures",VIZ_CHART_FIXED_RANGE:"Fixed",VIZ_CHART_NEXT:"Next",VIZ_CHART_YAXIS_RANGE:"Y Axis Range",VIZ_CHART_RESET:"Reset",VIZ_CHART_GEO_INCOMPLETE_DESCRIPTION:"Add more geography dimensions",VIZ_CHART_UPDATE_DATA_FAILED:"Failed to update chart data:",VIZ_CHART_NO_ESRI_SERVICE:"No feature service was found for your account.",VIZ_CHART_VIZINSTANCE_NOT_CREATED:"VizInstance is not created",VIZ_CHART_TITLE_TEXT_JOIN_BY:"{0} by {1}",VIZ_CHART_INVALID_VIZ_TYPE:"Cannot display this chart: {0}.",VIZ_CHART_ESRI_MAP_LOADING:"Loading Esri Map",VIZ_CHART_REMOVE_EVENT_FAILED:"Failed to remove chart event callback:",VIZ_CHART_AUTO_RANGE:"Automatic",VIZ_CHART_NEGATIVE_VALUES_WARN:"Negative values are not shown in this Bubble chart",VIZ_CHART_FEEDINGZONE_FAILED:"Failed to get chart feeding zone:",VIZ_CONTROLS_API_PARAMETER_ERROR:"API parameter error",VIZ_CHART_YAXIS2_RANGE:"Y Axis2 Range",VIZ_CHART_YAXIS1_RANGE:"Y Axis1 Range",VIZ_CHART_TITLE_CONTEXT_MENU_RESTORE:"Restore Default Title",VIZ_CHART_SET_COLOR_LAYER:"Set color to feature layer",VIZ_CHART_DESCRIPTION_FAILED:"Failed to get/set chart description:",VIZ_CHART_TITLE_TEXT_JOIN_AND:"and",VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION:"Add more dimensions",VIZ_CHART_SELECT_DATASET:"Select data set",VIZ_CHART_CONFIRM:"Confirm",VIZ_CHART_SERIALIZE_FAILED:"Failed to serialize chart:",}});sap.viz.extapi.env.Language.register({id:'language',value:{VIZ_CONTEXTMENU_SHOW_TITLE:"Show Title",VIZ_CONTEXTMENU_SHOW_NEGATIVE_VALUES:"Show Negative Values",VIZ_CONTEXTMENU_VERTICAL:"Vertical",VIZ_CONTEXTMENU_CHANGE_MBCLEGEND_COLOR:"Choose Legend Item Colors...",VIZ_CONTEXTMENU_NO_MENU_ITEMS:"No available items",VIZ_CONTEXTMENU_SHOW_ABOVE_ROWS:"Show Subtotals Above Rows",VIZ_CONTEXTMENU_SHOW_LEGEND:"Show Legend",VIZ_CONTEXTMENU_SHOW_MND_TOOLTIP:"Creates a new dimension with all the measures in the chart. The values are spread on a single axis, or separate charts for a trellis chart.",VIZ_CONTEXTMENU_HORIZONTAL:"Horizontal",VIZ_CONTEXTMENU_FULL_STACKING:"100% Stacking",VIZ_CONTEXTMENU_SET_AXIS_SCALE:"Set Axis Scale",VIZ_CONTEXTMENU_NORMAL_STACKING:"Normal Stacking",VIZ_CONTEXTMENU_INSERT_COMMENT:"Insert Comment...",VIZ_CONTEXTMENU_SHOW_DATALABELS:"Show Data Labels",VIZ_CONTEXTMENU_SHOW_GRIDLINES:"Show Gridlines",VIZ_CONTEXTMENU_SHOW_BEFORE_ROWS:"Show Subtotals Below Rows",VIZ_CONTEXTMENU_SHOW_MND:"Use Measures as a Dimension",VIZ_CONTEXTMENU_MENU_CHART_EDITOR:"Chart Editor...",VIZ_CONTEXTMENU_CREATE_SUBTOTALS:"Create Subtotals",VIZ_CONTEXTMENU_CALCULATE_ROWS_TOTALS_FIRST:"Calculate Rows Totals First",}});sap.viz.extapi.env.Language.register({id:'language',value:{VIZ_CUSTOMBUTTON_RESTORE_DOWN:"Restore Down",VIZ_CUSTOMBUTTON_SETTINGS:"Settings",VIZ_CUSTOMBUTTON_MAXIMIZE:"Maximize",}});sap.viz.extapi.env.Language.register({id:'language',value:{VIZ_FRAME_FILTERBAR_DESCRIPTION:"Select fields from the dataset to filter",VIZ_FRAME_FILTERMENU_FILTER:"Filter",VIZ_FRAME_CHART_EDITOR:"Chart Editor",VIZ_FRAME_FILTERMENU_EXCLUDE:"Exclude",}});sap.viz.extapi.env.Language.register({id:'language',value:{VIZ_FILTERBAR_DESCRIPTION:"Add filters",VIZ_FILTERBAR_ITEMS_INCLUDED:"items included",VIZ_FILTERBAR_GLOBAL_FILTER:"Global Filter:",VIZ_FILTERBAR_ITEMS_EXCLUDED:"items excluded",}});});define("sap/viz/controls/TemplateLoader",[],function(){(function(){var t=Object.prototype.toString;function h(i){return t.call(i)==='[object Array]';}function j(i){return t.call(i)==='[object Object]';}function _(a,b){for(var i in b){if(h(b[i])){a[i]=b[i].slice();}else if(j(b[i])){a[i]=a[i]||{};_(a[i],b[i]);}else{a[i]=b[i];}}return a;}function m(){var a={};for(var i=0;i<arguments.length;++i){_(a,arguments[i]);}return a;}var c="#333333";var k={background:{border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}}};var l={title:{visible:false}};var n={tooltip:{visible:false}};var o={legend:{visible:false}};var p={interaction:{selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false}};var q={plotArea:{animation:{dataLoading:false,dataUpdating:false,resizing:false}}};var r={color:c,label:{visible:true},axisline:{visible:true},enableLabelSelection:false};var s={xAxis:r,yAxis:r,xAxis2:r};var v={yAxis:r,xAxis:r,yAxis2:r};var x={xAxis:r,yAxis:r};var z={zAxis:r};var u={color:c,gridline:{color:c},enableLabelSelection:false};var w={rowAxis:u,columnAxis:u};var y={rotate:{enableRotate:false}};var A=m(k,l,n,o,p,q,w);var B=m(A,v);var C=m(A,s);var D=m(A,x,z,y);var E=m(A,x,z,y);var F=m(A,s);var G=m(A,v);var H=m(A,s,{plotArea:{marker:{visible:false},tooltipVisble:false}});var I=m(A,v,{plotArea:{marker:{visible:false}}});var J=m(A,s,{plotArea:{line:{marker:{visible:false}},tooltipVisble:false}});var K=m(A,v,{plotArea:{line:{marker:{visible:false}}}});var L=m(A,x,{sizeLegend:{visible:false}});var M=m(A,x);var N=m(A,x,{xAxis:{gridline:{visible:false}},multiLayout:{plotTitle:{visible:false}}});var O=m(A,x);var P=m(A);var Q=m(A);var R=m(A);var S=m(A);var T=m(A,y);var U=m(A,y);var V=m(A,{plotArea:{polarAxis:{title:{visible:false}},valueAxis:{visible:true}}});var W=m(A,v);var X=m(A,s);var Y=m(A,v);var Z=m(A,s);var $=m(A,s);var a1=m(A,v);var b1=m(A,{plotArea:{draggable:false,label:{visible:false}}});var c1=m(A,{plotArea:{clickAble:false,label:{visible:false}}});var d1=m(A,{});var e1=m(d1,{plotArea:{gridline:{visible:false}}});sap.viz.extapi.env.Template.register({id:"incomplete_ghost",name:"Incomplete Ghost",version:"4.0.0",isGhost:true,isBuiltIn:true,properties:{'viz/bar':C,'viz/image_bar':C,'viz/multi_bar':C,'viz/dual_bar':C,'viz/multi_dual_bar':C,'viz/column':B,'viz/multi_column':B,'viz/dual_column':B,'viz/multi_dual_column':B,'viz/stacked_bar':F,'viz/multi_stacked_bar':F,'viz/dual_stacked_bar':F,'viz/multi_dual_stacked_bar':F,'viz/100_stacked_bar':F,'viz/multi_100_stacked_bar':F,'viz/100_dual_stacked_bar':F,'viz/multi_100_dual_stacked_bar':F,'viz/stacked_column':G,'viz/multi_stacked_column':G,'viz/dual_stacked_column':G,'viz/multi_dual_stacked_column':G,'viz/100_stacked_column':G,'viz/multi_100_stacked_column':G,'viz/100_dual_stacked_column':G,'viz/multi_100_dual_stacked_column':G,'riv/cbar':B,'viz/3d_bar':D,'viz/3d_column':E,'viz/combination':K,'viz/horizontal_combination':J,'viz/dual_combination':K,'viz/dual_horizontal_combination':J,'viz/boxplot':W,'viz/horizontal_boxplot':X,'viz/waterfall':Y,'viz/horizontal_waterfall':Z,'viz/stacked_waterfall':Y,'viz/horizontal_stacked_waterfall':Z,'viz/line':I,'viz/multi_line':I,'viz/dual_line':I,'viz/multi_dual_line':I,'viz/horizontal_line':H,'viz/multi_horizontal_line':H,'viz/dual_horizontal_line':H,'viz/multi_dual_horizontal_line':H,'viz/area':I,'viz/multi_area':I,'viz/100_area':I,'viz/multi_100_area':I,'viz/horizontal_area':H,'viz/multi_horizontal_area':H,'viz/100_horizontal_area':H,'viz/multi_100_horizontal_area':H,'viz/pie':R,'viz/multi_pie':R,'viz/donut':S,'viz/multi_donut':S,'viz/pie_with_depth':T,'viz/donut_with_depth':U,'viz/bubble':L,'viz/multi_bubble':L,'viz/scatter':M,'viz/multi_scatter':M,'viz/scatter_matrix':N,'viz/radar':V,'viz/multi_radar':V,'viz/tagcloud':Q,'viz/heatmap':O,'viz/treemap':P,'viz/mekko':$,'viz/100_mekko':$,'viz/horizontal_mekko':a1,'viz/100_horizontal_mekko':a1,'viz/network':b1,'viz/tree':c1,'viz/number':{plotArea:{valuePoint:{label:{fontColor:'#000000'}}}},'info/column':f1(B),'info/bar':f1(C),'info/line':f1(I),'info/time_line':g1(I),'info/pie':j1(R),'info/donut':j1(S),'info/scatter':i1(M),'info/bubble':i1(L),'info/stacked_column':f1(G),'info/stacked_bar':f1(F),'info/mekko':h1(G),'info/100_mekko':h1(G),'info/horizontal_mekko':h1(F),'info/100_horizontal_mekko':h1(F),'info/combination':f1(K),'info/stacked_combination':f1(K),'info/dual_stacked_combination':h1(K),'info/dual_column':h1(B),'info/dual_line':h1(I),'info/dual_bar':h1(C),'info/100_stacked_column':f1(G),'info/100_stacked_bar':f1(F),'info/horizontal_line':f1(H),'info/dual_horizontal_line':h1(H),'info/horizontal_combination':f1(J),'info/horizontal_stacked_combination':f1(J),'info/dual_horizontal_stacked_combination':h1(J),'info/treemap':l1(P),'info/trellis_column':f1(B),'info/trellis_bar':f1(C),'info/trellis_line':f1(I),'info/trellis_pie':j1(R),'info/trellis_donut':j1(S),'info/trellis_scatter':i1(M),'info/trellis_bubble':i1(L),'info/trellis_stacked_column':f1(G),'info/trellis_stacked_bar':f1(F),'info/trellis_combination':f1(K),'info/trellis_dual_column':h1(B),'info/trellis_dual_line':h1(I),'info/trellis_dual_bar':h1(C),'info/trellis_100_stacked_column':f1(G),'info/trellis_100_stacked_bar':f1(F),'info/trellis_horizontal_line':f1(H),'info/trellis_dual_horizontal_line':h1(H),'info/trellis_horizontal_combination':f1(J),'info/trellis_dual_stacked_bar':h1(F),'info/trellis_dual_stacked_column':h1(G),'info/trellis_100_dual_stacked_column':h1(F),'info/trellis_100_dual_stacked_bar':h1(G),'info/dual_stacked_bar':h1(F),'info/100_dual_stacked_bar':h1(F),'info/dual_stacked_column':h1(G),'info/100_dual_stacked_column':h1(G),'info/time_bubble':i1(L),'info/bullet':f1(d1),'info/vertical_bullet':f1(d1),'info/trellis_bullet':f1(e1),'info/trellis_vertical_bullet':f1(e1)}});function f1(a){var b={};for(var i in a){if(a.hasOwnProperty(i)){b[i]=a[i];}}b.interaction={selectability:{mode:"none",axisLabelSelection:false,legendSelection:false,plotLassoSelection:false,plotStdSelection:false}};b.valueAxis={color:c,label:{visible:true},axisline:{visible:true}};b.categoryAxis={color:c,label:{visible:true},axisline:{visible:true}};b.plotArea=b.plotArea||{};b.plotArea.gridline={color:"#efefef"};k1(b);return b;}function g1(a){var b=f1(a);b.timeAxis=b.categoryAxis;delete b.categoryAxis;return b;}function h1(a){var b=f1(a);b.valueAxis2={color:c,label:{visible:true},axisline:{visible:true}};k1(b);return b;}function i1(a){var b=f1(a);delete b.categoryAxis;b.valueAxis2={color:c,label:{visible:true},axisline:{visible:true}};k1(b);return b;}function j1(a){var b={};for(var i in a){if(a.hasOwnProperty(i)){b[i]=a[i];}}b.interaction={selectability:{mode:"none",axisLabelSelection:false,legendSelection:false,plotLassoSelection:false,plotStdSelection:false}};k1(b);return b;}function k1(a){a.plotArea=a.plotArea||{};a.plotArea.background=a.background||k;delete a.background;delete a.xAxis;delete a.xAxis2;delete a.yAxis;delete a.yAxis2;delete a.rowAxis;delete a.columnAxis;}function l1(a){a=m(k,a);return f1(a);}})();(function(){var c="#333333";var d={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var e={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false};var a={dataLoading:false,dataUpdating:false};var m={color:c,gridline:{color:c},label:{visible:false}};var b={plotArea:{animation:a},title:{visible:false},legend:{visible:false},sizeLegend:{visible:false},background:d,interaction:e,rowAxis:m,columnAxis:m,geoController:{disableInteraction:true}};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{'viz/geobubble':b,'viz/geopie':b,'viz/choropleth':b,'viz/multi_geobubble':b,'viz/multi_choropleth':b}});})();var c="#333333";var d={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var e={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var f={title:{visible:false},legend:{visible:false},plotArea:{tooltip:{visible:false}},background:d,interaction:e};var g={title:{visible:false},legend:{visible:false},background:d};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{'viz/ext/pa/funnel':f,'viz/ext/pa/pc':g},css:"\
		.v-m-main .v-background-body{fill:;}\
		 svg {font-family:Tahoma,Arial,Helvetica,sans-serif;font-size:12px;}\
		.axis line{fill: none;stroke: #333333;shape-rendering: crispEdges;}\
	    .axis path{fill: none;stroke: #333333;shape-rendering: crispEdges;}\
	   .axistext{fill: #333333; cursor : move;}\
	",isBuiltIn:true});var c="#333333";var d={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var e={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var f={title:{visible:false},legend:{visible:false},background:d,interaction:e};var g={title:{visible:false},legend:{visible:false},plotArea:{tooltip:{visible:false},measureAxis:{color:'#333333',label:{style:{fontFamily:"Tahoma,Arial,Helvetica,sans-serif",}}}},background:d};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{'viz/ext/pa/funnel':f,'viz/ext/pa/pc':g},css:"\
		.v-m-main .v-background-body{fill:;}\
		.axis line{shape-rendering: crispEdges;}\
	    .axis path{shape-rendering: crispEdges;}\
	    .axistext{cursor : move;}\
    ",isBuiltIn:true});});define('sap/viz/controls/chart/morph/constant/MorphConst',[],function(){var M={};M.SHAPE_DATA="data";M.MORPHING_DATA="morph-data";M.SHAPE_GLOBAL_TRANSLATE_X="translateX";M.SHAPE_GLOBAL_TRANSLATE_Y="translateY";M.MORPHER_DISABLE_COLOR="MORPHER_DISABLE_COLOR";M.MORPHER_DISABLE_LINE="MORPHER_DISABLE_LINE";M.MORPHER_DISABLE_PATH="MORPHER_DISABLE_PATH";M.MORPHER_DISABLE_RECT="MORPHER_DISABLE_RECT";M.MORPHER_DISABLE_TEXT="MORPHER_DISABLE_TEXT";M.MORPHER_DISABLE_TRANSFORM="MORPHER_DISABLE_TRANSFORM";M.CHART_TYPE_COLUMN="viz/column";M.CHART_TYPE_STACKED_COLUMN="viz/stacked_column";M.CHART_TYPE_100_STACKED_COLUMN="viz/100_stacked_column";M.CHART_TYPE_DUAL_COLUMN="viz/dual_column";M.CHART_TYPE_3D_COLUMN="viz/3d_column";M.CHART_TYPE_BAR="viz/bar";M.CHART_TYPE_STACKED_BAR="viz/stacked_bar";M.CHART_TYPE_100_STACKED_BAR="viz/100_stacked_bar";M.CHART_TYPE_DUAL_BAR="viz/dual_bar";M.CHART_TYPE_3D_BAR="viz/3d_bar";M.CHART_TYPE_LINE="viz/line";M.CHART_TYPE_HORIZONTAL_LINE="viz/horizontal_line";M.CHART_TYPE_DUAL_LINE="viz/dual_line";M.CHART_TYPE_DUAL_HORIZONTAL_LINE="viz/dual_horizontal_line";M.CHART_TYPE_AREA="viz/area";M.CHART_TYPE_HORIZONTAL_AREA="viz/horizontal_area";M.CHART_TYPE_100_AREA="viz/100_area";M.CHART_TYPE_100_HORIZONTAL_AREA="viz/100_horizontal_area";M.CHART_TYPE_COMBINATION="viz/combination";M.CHART_TYPE_HORIZONTAL_COMBINATION="viz/horizontal_combination";M.CHART_TYPE_DUAL_COMBINATION="viz/dual_combination";M.CHART_TYPE_DUAL_HORIZONTAL_COMBINATION="viz/dual_horizontal_combination";M.CHART_TYPE_BOXPLOT="viz/boxplot";M.CHART_TYPE_HORIZONTAL_BOXPLOT="viz/horizontal_boxplot";M.CHART_TYPE_WATERFALL="viz/waterfall";M.CHART_TYPE_HORIZONTAL_WATERFALL="viz/horizontal_waterfall";M.CHART_TYPE_PIE="viz/pie";M.CHART_TYPE_DONUT="viz/donut";M.CHART_TYPE_PIE_WITH_DEPTH="viz/pie_with_depth";M.CHART_TYPE_SCATTER="viz/scatter";M.CHART_TYPE_BUBBLE="viz/bubble";M.CHART_TYPE_SCATTER_MATRIX="viz/scatter_matrix";M.CHART_TYPE_GEO_BUBBLE="viz/geobubble";M.CHART_TYPE_GEO_CHOROPLETH="viz/choropleth";M.CHART_TYPE_GEO_PIE="viz/geopie";M.CHART_TYPE_HEATMAP="viz/heatmap";M.CHART_TYPE_TREEMAP="viz/treemap";M.CHART_TYPE_TABLE="viz/ext/table";M.CHART_TYPE_CROSSTAB="viz/ext/crosstab";M.CHART_TYPE_RADAR="viz/radar";M.CHART_TYPE_TAG_CLOUD="viz/tagcloud";M.CHART_TYPE_INFO_BAR="info/bar";M.CHART_TYPE_INFO_COLUMN="info/column";M.CHART_TYPE_INFO_LINE="info/line";M.CHART_TYPE_INFO_HORIZONTAL_LINE="info/horizontal_line";M.CHART_TYPE_INFO_DONUT="info/donut";var _={};var m=function(t,h){_[t]=h;};m(M.CHART_TYPE_COLUMN,M.CHART_TYPE_BAR);m(M.CHART_TYPE_STACKED_COLUMN,M.CHART_TYPE_STACKED_BAR);m(M.CHART_TYPE_100_STACKED_COLUMN,M.CHART_TYPE_100_STACKED_BAR);m(M.CHART_TYPE_DUAL_COLUMN,M.CHART_TYPE_DUAL_BAR);m(M.CHART_TYPE_3D_COLUMN,M.CHART_TYPE_3D_BAR);m(M.CHART_TYPE_LINE,M.CHART_TYPE_HORIZONTAL_LINE);m(M.CHART_TYPE_DUAL_LINE,M.CHART_TYPE_DUAL_HORIZONTAL_LINE);m(M.CHART_TYPE_AREA,M.CHART_TYPE_HORIZONTAL_AREA);m(M.CHART_TYPE_100_AREA,M.CHART_TYPE_100_HORIZONTAL_AREA);m(M.CHART_TYPE_COMBINATION,M.CHART_TYPE_HORIZONTAL_COMBINATION);m(M.CHART_TYPE_DUAL_COMBINATION,M.CHART_TYPE_DUAL_HORIZONTAL_COMBINATION);m(M.CHART_TYPE_BOXPLOT,M.CHART_TYPE_HORIZONTAL_BOXPLOT);m(M.CHART_TYPE_WATERFALL,M.CHART_TYPE_HORIZONTAL_WATERFALL);m(M.CHART_TYPE_INFO_COLUMN,M.CHART_TYPE_INFO_BAR);m(M.CHART_TYPE_INFO_LINE,M.CHART_TYPE_INFO_HORIZONTAL_LINE);M.IS_V_H_MAP=function(t,a){if(_[t]&&_[t]===a){return true;}if(_[a]&&_[a]===t){return true;}return false;};return M;});define('sap/viz/controls/chart/morph/utils/Utils',[],function(){var u={};var _=0;u.genUID=function(){if(!_){_=0;}return"mgen_"+(_++);};var c={'[object Boolean]':'boolean','[object Number]':'number','[object String]':'string','[object Function]':'function','[object Array]':'array','[object Date]':'date','[object RegExp]':'regexp','[object Object]':'object'};u.type=function(o){return!o?String(o):c[Object.prototype.toString.call(o)]||"object";};u.isFunction=function(o){return u.type(o)==="function";};u.isBoolean=function(o){return u.type(o)==="boolean";};u.isString=function(o){return u.type(o)==="string";};u.isArray=function(o){return u.type(o)==="array";};u.isNumber=function(o){return u.type(o)==="number";};u.isRegExp=function(o){return u.type(o)==="regexp";};u.sortArrayOn=function(d,p,e){if(u.isArray(d)&&u.isString(p)){d.sort(function(a,b){return e?(a[p]<b[p])-(a[p]>b[p]):(a[p]>b[p])-(a[p]<b[p]);});}};u.noop=function(){};return u;});define('sap/viz/controls/chart/morph/utils/SVGShapeMetadata',[],function(){var S={};var a="__vizmp__";S.set=function(s,n,v){if(!s[a]){s[a]={};}s[a][n]=v;};S.get=function(s,n){if(s&&s[a]!==null&&s[a]!==undefined){return s[a][n];}return undefined;};S.clone=function(n,o){n[a]=o[a];return n;};return S;});define('sap/viz/controls/chart/morph/vo/VizShape',[],function(){var V=function(f,t,d){this.from=f;this.to=t;this.display=d;};return V;});define('sap/viz/controls/chart/morph/vo/VizShapesHolder',[],function(){var V=function(){this.plotShapes=[];this.plotLines=[];this.xAxisLabels=[];this.xAxis2Labels=[];this.yAxisLabels=[];this.yAxis2Labels=[];this.backgrounds=[];};V.prototype.empty=function(){this.plotShapes=[];this.plotLines=[];this.xAxisLabels=[];this.xAxis2Labels=[];this.yAxisLabels=[];this.yAxis2Labels=[];this.backgrounds=[];};V.prototype.allByOrder=function(){return[].concat(this.backgrounds,this.xAxis2Labels,this.xAxisLabels,this.yAxis2Labels,this.yAxisLabels,this.plotLines,this.plotShapes);};V.prototype.toShapesBySvgType=function(){var a={};var b=[];a["all"]=b;var c=this.allByOrder();for(var i=0;i<c.length;i++){var v=c[i];if(v.to){var t=v.to.localName;var d=a[t];if(!d){a[t]=d=[];}d.push(v);b.push(v);}}return a;};return V;});define('sap/viz/controls/chart/morph/viz/MpShapesCapturer',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/vo/VizShape','sap/viz/controls/chart/morph/vo/VizShapesHolder','sap/viz/controls/common/utils/ChartTypeUtil'],function(M,S,V,a,C){var b={};b.getShapes=function(v,d){var g=new a();var h=d3.select(v).select(".v-m-root");var j=d3.select(v).select(".v-m-main");var r=h.node();if(r&&r.clientHeight>0&&r.clientWidth>0&&r.getScreenCTM!==undefined){var k=p(h);var l=r.getScreenCTM();g.plotShapes=c(h,".v-m-root .v-morphable-datapoint",l,k,d);g.plotLines=c(h,".v-m-root .v-morphable-line, "+".v-m-root .v-morphable-areabg",l,k);g.xAxisLabels=c(j,".v-m-xAxis .v-morphable-label",l);g.xAxis2Labels=c(j,".v-m-xAxis2 .v-morphable-label",l);g.yAxisLabels=c(j,".v-m-yAxis .v-morphable-label",l);g.yAxis2Labels=c(j,".v-m-yAxis2 .v-morphable-label",l);g.backgrounds=c(h,".v-m-root .v-morphable-background",l);for(var i=0;i<g.backgrounds.length;i++){var m=g.backgrounds[i];S.set(m.to,M.MORPHER_DISABLE_RECT,true);}}return g;};var c=function(g,s,o,v,h){var j=g.selectAll(s);var k=[];j.each(function(d,i){if(this.localName==="path"&&String(this.getAttribute("class")).indexOf("v-geo-choropleth-feature")>=0){return;}var l=this.cloneNode(true);if(String(this.getAttribute("class")).indexOf("v-morphable-datapoint")>=0){if(h){if(C.isInfoChart(h)){l=this.firstChild?this.firstChild.cloneNode(true):l;}}}S.set(l,M.SHAPE_DATA,this.__data__);f(l,this,v);e(this,o,l);k.push(new V(null,l,null));});return k;};var p=function(v){var g={};var h=false;var d=v.selectAll("defs");d.each(function(){var j=this;if(j.firstChild){var k=j.childNodes;for(var i=0;i<k.length;i++){var l=k[i];if(l){var m="";var s=[];var n="#000000";if(l.localName==="linearGradient"){m=l.getAttribute("id");s=l.childNodes;if(s.length===2){n=s[1].getAttribute("stop-color");}else if(s.length===4){n=s[3].getAttribute("stop-color");}else{n=s[s.length-1].getAttribute("stop-color");}g[m]=n;h=true;}else if(l.localName==="radialGradient"){m=l.getAttribute("id");s=l.childNodes;if(s.length===3){n=s[1].getAttribute("stop-color");}else if(s.length===4){n=s[3].getAttribute("stop-color");}else{n=s[s.length-1].getAttribute("stop-color");}g[m]=n;h=true;}}}}});if(h){g["__hasGradientColor"]=true;}return g;};var e=function(o,d,n){var g=o.getScreenCTM();var l=g.e-d.e;var t=g.f-d.f;n.setAttribute("transform","translate("+l+","+t+")");S.set(n,M.SHAPE_GLOBAL_TRANSLATE_X,l);S.set(n,M.SHAPE_GLOBAL_TRANSLATE_Y,t);return n;};var f=function(s,o,v){if(s.localName==="path"&&o.getAttribute("class")&&o.getAttribute("class").indexOf("v-morphable-line")>=0){s.setAttribute("fill-opacity",0);}if(s.localName==="path"&&o.getAttribute("class")&&o.getAttribute("class").indexOf("v-morphable-datapoint")>=0&&o.getAttribute("visibility")==="hidden"){s.setAttribute("visibility","");s.setAttribute("d","M0,0L0,0Z");}if(s.localName==="rect"&&o.getAttribute("opacity")==="0"&&o.parentNode&&o.parentNode.parentNode&&o.parentNode.parentNode.getAttribute("class")&&o.parentNode.parentNode.getAttribute("class").indexOf("v-heatmap")>=0){s.setAttribute("opacity",1);}if(v&&v["__hasGradientColor"]===true&&s.getAttribute("fill")&&s.getAttribute("fill").indexOf("url(#")===0){var g=s.getAttribute("fill");g=g.substring(5,g.length-1);var d=v[g];d=d?d:"#000000";s.setAttribute("fill",d);}};return b;});define('sap/viz/controls/chart/morph/utils/SVGShapeReplacer',['sap/viz/controls/chart/morph/utils/SVGShapeMetadata'],function(S){var a={};var b="http://www.w3.org/2000/svg";var c=["x","y","width","height","rx","ry","x1","x2","y1","y2"];var g=function(s,d){var r=parseFloat(s.getAttribute(d));return isNaN(r)?0:r;};a.replace=function(s,n,d,k){if(s&&n){var e=document.createElementNS(b,n);if(k){var o=s.attributes;for(var i=0;i<o.length;i++){var f=o[i];if(c.indexOf(f.localName)===-1){e.setAttribute(f.localName,f.value);}}}for(var h in d){if(d.hasOwnProperty(h)){e.setAttribute(h,d[h]);}}S.clone(e,s);if(s.parentNode){s.parentNode.replaceChild(e,s);}return e;}return null;};a.replaceToPath=function(s){if(s){var p=null;switch(s.localName){case"rect":var x=g(s,"x");var y=g(s,"y");var w=g(s,"width");var h=g(s,"height");var r=g(s,"rx");var d=g(s,"ry");p="M"+x+","+y+"L"+(w+x)+","+y+"L"+(w+x)+","+(h+y)+"L"+x+","+(h+y)+"L"+x+","+y+"Z";break;case"line":var e=g(s,"x1");var f=g(s,"y1");var i=g(s,"x2");var j=g(s,"y2");p="M"+e+","+f+"L"+i+","+j;break;default:}if(p){var k={d:p};return a.replace(s,"path",k,true);}}return null;};return a;});define('sap/viz/controls/chart/morph/utils/DeepEqual',[],function(){var p=Array.prototype.slice;var O=typeof Object.keys==='function'?Object.keys:function(a){var k=[];for(var b in a){if(a.hasOwnProperty(b)){k.push(b);}}return k;};var d=function(a,e){if(a===e){return true;}else if(a instanceof Date&&e instanceof Date){return a.getTime()===e.getTime();}else if(typeof a!='object'&&typeof e!='object'){return a==e;}else{return o(a,e);}};function c(v){return v===null||v===undefined;}function f(a){return Object.prototype.toString.call(a)=='[object Arguments]';}function o(a,b){if(c(a)||c(b)){return false;}if(a.prototype!==b.prototype){return false;}if(f(a)){if(!f(b)){return false;}a=p.call(a);b=p.call(b);return d(a,b);}var k,g,h,i;try{k=O(a);g=O(b);}catch(e){return false;}if(k.length!=g.length){return false;}k.sort();g.sort();for(i=k.length-1;i>=0;i--){if(k[i]!=g[i]){return false;}}for(i=k.length-1;i>=0;i--){h=k[i];if(!d(a[h],b[h])){return false;}}return true;}return d;});define('sap/viz/controls/chart/morph/viz/MpShapesMapper',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/utils/SVGShapeReplacer','sap/viz/controls/chart/morph/utils/DeepEqual','sap/viz/controls/chart/morph/vo/VizShape','sap/viz/controls/common/utils/ChartTypeUtil'],function(M,u,S,a,D,V,C){var b={};b.map=function(e,i,j,x,y){c(j,e,y);v(e.plotShapes,i.plotShapes,s);d(j,e,y);v(e.plotLines,i.plotLines,s);f(j,e);if(M.IS_V_H_MAP(j,x)){v(e.xAxisLabels,i.yAxisLabels,s);v(e.xAxis2Labels,i.yAxis2Labels,s);v(e.yAxisLabels,i.xAxisLabels,s);v(e.yAxis2Labels,i.xAxis2Labels,s);}else{v(e.xAxisLabels,i.xAxisLabels,s);v(e.xAxis2Labels,i.xAxis2Labels,s);v(e.yAxisLabels,i.yAxisLabels,s);v(e.yAxis2Labels,i.yAxis2Labels,s);}v(e.backgrounds,i.backgrounds,t);return e;};var c=function(e,i,j){if(C.isInfoChart(e)){g(i,j);}else{h(i,j);}};var d=function(e,i,j){if(C.isInfoChart(e)){k(i);}else{l(i,j);}};var f=function(e,i){var j=i.xAxisLabels.concat(i.xAxis2Labels).concat(i.yAxisLabels).concat(i.yAxis2Labels);if(C.isInfoChart(e)){m(j);}else{n(j);}};var g=function(e,x){var y=o(x);for(var i in e.plotShapes){var z={};var A=S.get(e.plotShapes[i].to,M.SHAPE_DATA);for(var B in y){if(A.hasOwnProperty(B)){z.measureName=y[B];}}if(e.plotShapes.length<x.data().data.length){var E=p(x);for(var F in E){if(A.hasOwnProperty(F)){z[F]=A[F];}}}else{var j=0;var G=x.data().metadata;var H=x.data().data;var I=[],J=[];for(var K in A){if(K!=="measureNames"){for(j=0;j<G.fields.length;j++){if(G.fields[j].id===K){I.push(A[K]);J.push(j);break;}}}}for(var L=0;L<H.length;L++){var N=[],O=true,P=H[L];for(j=0;j<J.length;j++){N.push(P[J[j]]);}for(j=0;j<I.length;j++){if(N[j]!==I[j]){O=false;break;}}if(O){z.dimensionId=L;break;}}}S.set(e.plotShapes[i].to,M.MORPHING_DATA,z);}};var h=function(e,j){var x=q(j);var y=r(j);for(var i in e.plotShapes){var z={};var A=S.get(e.plotShapes[i].to,M.SHAPE_DATA);var B=u.isArray(A.ctx)?A.ctx[0]:A.ctx;z.dimensionId=B.path.dii_a1*y+B.path.dii_a2;z.measureName=x[B.path.mg][B.path.mi];S.set(e.plotShapes[i].to,M.MORPHING_DATA,z);}};var k=function(e){for(var i in e.plotLines){var x=[];var y=S.get(e.plotLines[i].to,M.SHAPE_DATA);for(var j in e.plotShapes){var z=S.get(e.plotShapes[j].to,M.SHAPE_DATA);var A=true;for(var B in y){if(B!=='measureNames'){if(!z.hasOwnProperty(B)||z[B]!==y[B]){A=false;}}else if(u.isArray(y[B])){continue;}else if(!z.hasOwnProperty(y[B])){A=false;}}if(A){x.push(S.get(e.plotShapes[j].to,M.MORPHING_DATA));}}S.set(e.plotLines[i].to,M.MORPHING_DATA,x);}};var l=function(j,x){var y=q(x);var z=r(x);for(var i in j.plotLines){var A=[];var B=S.get(j.plotLines[i].to,M.SHAPE_DATA);if(u.isArray(B)){B.forEach(function(e,i){var E=u.isArray(e.ctx)?e.ctx[0]:e.ctx;var F={};F.dimensionId=E.path.dii_a1*z+E.path.dii_a2;F.measureName=y[E.path.mg][E.path.mi];A.push(F);});}S.set(j.plotLines[i].to,M.MORPHING_DATA,A);}};var m=function(e){for(var i in e){var j={};j.labelText="";if(e[i].to.firstChild.localName==="text"){j.labelText=e[i].to.firstChild.textContent;}else{var x=e[i].to.lastChild.cloneNode(true);if(x&&x.firstChild&&x.firstChild.localName==="text"){j.labelText=x.firstChild.textContent;}}S.set(e[i].to,M.MORPHING_DATA,j);}};var n=function(e){for(var i in e){var j={};j.labelText=e[i].to.firstChild.textContent;S.set(e[i].to,M.MORPHING_DATA,j);}};var o=function(j){var x={};var y=j?j._FlatTableD._dataset.metadata:{};if(y.fields){y.fields.forEach(function(e,i){if(e.semanticType==="Measure"){x[e.id]=e.name;}});}return x;};var p=function(j){var x={};var y=j?j._FlatTableD._dataset.metadata:{};if(y.fields){y.fields.forEach(function(e,i){if(e.semanticType==="Dimension"){x[e.id]=e.name;}});}return x;};var q=function(x){var y=[];var z=x?x._crosstableDataset._dataSet.measureValuesGroup:[];z.forEach(function(e,i){y[e.index-1]=[];for(var j in e.data){y[e.index-1][j]=e.data[j].name;}});return y;};var r=function(j){var x=0,y=0,z=1;var A=j?j._crosstableDataset._dataSet.analysisAxis:[];A.forEach(function(e,i){if(e.index===1){x=e.data.length;}if(e.index===2){y=e.data.length;z=e.data[0].values.length;}});return z;};var s=function(e,i){var j=S.get(i,M.MORPHING_DATA);var x=S.get(e,M.MORPHING_DATA);if(D(j,x)){return true;}return false;};var t=function(e,i){if(i&&e&&i.localName==e.localName&&i.hasAttribute("class","v-background-body v-morphable-background")&&e.hasAttribute("class","v-background-body v-morphable-background")){return true;}return false;};var v=function(e,x,y,z){var A=[];for(var i=0;i<e.length;i++){var B=e[i];for(var j=0;j<x.length;j++){var E=x[j];if(z||A.indexOf(E)===-1){if(y(B.to,E.display)){var F=w(B.to,E.display);B.to=F.newShape;B.from=F.currentShape;A.push(E);break;}}}}};var w=function(e,i){var j={newShape:e,currentShape:i};var x;if(e.localName==="path"&&i.localName!=="path"){x=a.replaceToPath(i);if(x){j.currentShape=x;}}if(e.localName!=="path"&&i.localName==="path"){x=a.replaceToPath(e);if(x){j.newShape=x;}}return j;};return b;});define('sap/viz/controls/chart/morph/utils/Cache',[],function(){var C={};var r=function(a,b){for(var i=0,c=a.length;i<c;i++){if(a[i]===b){return a.push(a.splice(i,1)[0]);}}};C.func=function(f,s,p){function n(){var a=Array.prototype.slice.call(arguments,0),b=a.join("\u2400"),c=n.cache=n.cache||{},d=n.count=n.count||[];if(c.hasOwnProperty(b)){r(d,b);return p?p(c[b]):c[b];}d.length>=1e3&&delete c[d.shift()];d.push(b);c[b]=f.apply(s,a);return p?p(c[b]):c[b];}return n;};return C;});define('sap/viz/controls/chart/morph/utils/ColorUtil',['sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/Cache'],function(u,C){var a={};var _=null;a.parse=function(c){if(!_){_=C.func(RGBColorStatic.parse);}return _(c);};a.numberToHexString=function(c){var r=((c&0xff0000)>>16).toString(16),g=((c&0x00ff00)>>8).toString(16),b=(c&0x0000ff).toString(16);var h="#"+((r.length===1)?"0"+r:r)+((g.length===1)?"0"+g:g)+((b.length===1)?"0"+b:b);return h;};a.hexStringToNumber=function(h){if(!h){return 0;}if(h.charAt(0)==='#'){h=h.substr(1);}var r=parseInt(h.substr(0,2),16),g=parseInt(h.substr(2,2),16),b=parseInt(h.substr(4,2),16);var c=(Math.max(0,Math.min(255,r))*65536)+(Math.max(0,Math.min(255,g))*256)+Math.max(0,Math.min(255,b));return c;};a.numberToRGB=function(c){var r=(c&0xff0000)>>16,g=(c&0x00ff00)>>8,b=c&0x0000ff;return'rgb('+r+','+g+','+b+')';};a.numberToRGBA=function(c,d){var r=(c&0xff0000)>>16,g=(c&0x00ff00)>>8,b=c&0x0000ff;if(d===undefined||d<=0||d>1){d=1;}return'rgba('+r+','+g+','+b+','+d+')';};a.RGBToNumber=function(r,g,b){var h=(Math.max(0,Math.min(255,r))*65536)+(Math.max(0,Math.min(255,g))*256)+Math.max(0,Math.min(255,b));return h;};a.getColorMix=function(c,b,p){return a.getPercentageOfColor(c,1-p)+a.getPercentageOfColor(b,p);};a.getPercentageOfColor=function(b,p){p=Math.min(1,Math.max(0,p));var r=(b&0xff0000)>>16;var g=(b&0x00ff00)>>8;var c=b&0x0000ff;return(r*p)<<16|(g*p)<<8|(c*p);};a.adjustBrightness=function(c,d){var r=Math.min(((c>>16)&0xFF)+d,255);r=Math.max(r,0);var g=Math.min(((c>>8)&0xFF)+d,255);g=Math.max(g,0);var b=Math.min((c&0xFF)+d,255);b=Math.max(b,0);return(r<<16)|(g<<8)|b;};a.adjustBrightness2=function(c,d){var r=NaN,g=NaN,b=NaN;if(d===0){return c;}else if(d>0){d/=100;r=((c>>16)&0xFF);g=((c>>8)&0xFF);b=(c&0xFF);r+=((0xFF-r)*d);g+=((0xFF-g)*d);b+=((0xFF-b)*d);r=Math.min(r,255);g=Math.min(g,255);b=Math.min(b,255);}else{d=(100+d)/100;r=((c>>16)&0xFF)*d;g=((c>>8)&0xFF)*d;b=(c&0xFF)*d;}return(r<<16)|(g<<8)|b;};a.rgbMultiply=function(c,b){var r=(c>>16)&0xFF,g=(c>>8)&0xFF,d=c&0xFF;var e=(b>>16)&0xFF,f=(b>>8)&0xFF,h=b&0xFF;return((r*e/255)<<16)|((g*f/255)<<8)|(d*h/255);};return a;});define('sap/viz/controls/chart/morph/morphers/ColorMorpher',['sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/ColorUtil'],function(u,C){var a={};var g=function(s,b){var r=parseFloat(s.getAttribute(b));return isNaN(r)?1:r;};a.getPercentage=function(f,t,p){p=p>100?100:p<0?0:p;var b=C.parse(f);var c=C.parse(t);if(b.length===0&&c.length===0){return"";}if(b.length===0&&c.length===3){return"rgb("+c[0]+","+c[1]+","+c[2]+")";}if(b.length===3&&c.length===0){return"";}return"rgb("+Math.round(b[0]+(c[0]-b[0])*p/100)+","+Math.round(b[1]+(c[1]-b[1])*p/100)+","+Math.round(b[2]+(c[2]-b[2])*p/100)+")";};a.svg=function(f,t,d,p){if(d&&t){var b=f?f.getAttribute("stroke"):"";var c=t.getAttribute("stroke");var e=f?f.getAttribute("fill"):"";var h=t.getAttribute("fill");if(b===c){d.setAttribute("stroke",c);}else{d.setAttribute("stroke",a.getPercentage(b,c,p));}var i="";if(e===h){i=h;d.setAttribute("fill",i);}else{if(h){i=a.getPercentage(e,h,p);d.setAttribute("fill",i);}else{i=null;}}var j;var k;if(f){if(i===""){d.setAttribute("fill-opacity",0);}else{var l=g(f,"fill-opacity");j=g(t,"fill-opacity");if(l!=j){d.setAttribute("fill-opacity",l+(j-l)*p/100);}}var m=g(f,"stroke-opacity");k=g(t,"stroke-opacity");if(m!=k){d.setAttribute("stroke-opacity",m+(k-m)*p/100);}}else{if(t.getAttribute("fill-opacity")!==""){if(i===""){j=0;}else{j=g(t,"fill-opacity");}d.setAttribute("fill-opacity",0+(j-0)*p/100);}else{d.setAttribute("fill-opacity","");}if(t.getAttribute("stroke-opacity")!==""){k=g(t,"stroke-opacity");d.setAttribute("stroke-opacity",0+(k-0)*p/100);}else{d.setAttribute("stroke-opacity","");}}}};return a;});define('sap/viz/controls/chart/morph/morphers/RectMorpher',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata'],function(M,S){var R={};R.NO_DEFAULT_DIRECTION=0;R.DEFAULT_DIRECTION_TO_NORTH=1;R.DEFAULT_DIRECTION_TO_SOUTH=2;R.DEFAULT_DIRECTION_TO_EAST=4;R.DEFAULT_DIRECTION_TO_WEST=8;R.getPercentageRect=function(f,t,p){return{w:f.w+(t.w-f.w)*p/100,h:f.h+(t.h-f.h)*p/100,x:f.x+(t.x-f.x)*p/100,y:f.y+(t.y-f.y)*p/100,r:f.r+(t.r-f.r)*p/100};};var g=function(s,b){var r=parseInt(s.getAttribute(b),10);return isNaN(r)?0:r;};var a=function(s,b){var r=parseFloat(s.getAttribute(b));return isNaN(r)?0:r;};R.svg=function(f,t,d,p,b){if(d&&t&&t.localName==="rect"){var c;var e;var h;var i;var j;var k;if(S.get(t,M.MORPHER_DISABLE_RECT)===true){c=a(t,"x");e=a(t,"rx");h=a(t,"y");i=a(t,"ry");j=a(t,"width");k=a(t,"height");var l=a(d,"x");var m=a(d,"rx");var n=a(d,"y");var o=a(d,"ry");var q=a(d,"width");var r=a(d,"height");if(c!==l){d.setAttribute("x",c);}if(e!==m){d.setAttribute("rx",e);}if(h!==n){d.setAttribute("y",h);}if(i!==o){d.setAttribute("ry",i);}if(j!==q){d.setAttribute("width",j);}if(k!==r){d.setAttribute("height",k);}}else if(f&&f.localName==="rect"){var s=a(f,"x");c=a(t,"x");var u=a(f,"rx");e=a(t,"rx");var v=a(f,"y");h=a(t,"y");var w=a(f,"ry");i=a(t,"ry");var x=a(f,"width");j=a(t,"width");var y=a(f,"height");k=a(t,"height");var z=(x>=1&&y>=1);var A=(j>=1&&k>=1);if(!z&&!A){p=100;}d.setAttribute("x",s+(c-s)*p/100);d.setAttribute("y",v+(h-v)*p/100);d.setAttribute("rx",u+(e-u)*p/100);d.setAttribute("ry",w+(i-w)*p/100);d.setAttribute("width",x+(j-x)*p/100);d.setAttribute("height",y+(k-y)*p/100);}else if(!f){c=a(t,"x");e=a(t,"rx");h=a(t,"y");i=a(t,"ry");j=a(t,"width");k=a(t,"height");if(b==null||b<0){b=R.DEFAULT_DIRECTION_TO_NORTH|R.DEFAULT_DIRECTION_TO_WEST;}if((b&R.DEFAULT_DIRECTION_TO_NORTH)&&(b&R.DEFAULT_DIRECTION_TO_SOUTH)){d.setAttribute("y",h+(k-0)*(100-p)/100/2);d.setAttribute("height",0+(k-0)*p/100);}else if(b&R.DEFAULT_DIRECTION_TO_NORTH){d.setAttribute("y",h+(k-0)*(100-p)/100);d.setAttribute("height",0+(k-0)*p/100);}else if(b&R.DEFAULT_DIRECTION_TO_SOUTH){d.setAttribute("y",h);d.setAttribute("height",0+(k-0)*p/100);}else{d.setAttribute("y",h);d.setAttribute("height",k);}if((b&R.DEFAULT_DIRECTION_TO_EAST)&&(b&R.DEFAULT_DIRECTION_TO_WEST)){d.setAttribute("x",c+(j-0)*(100-p)/100/2);d.setAttribute("width",0+(j-0)*p/100);}else if(b&R.DEFAULT_DIRECTION_TO_EAST){d.setAttribute("x",c+(j-0)*(100-p)/100);d.setAttribute("width",0+(j-0)*p/100);}else if(b&R.DEFAULT_DIRECTION_TO_WEST){d.setAttribute("x",c);d.setAttribute("width",0+(j-0)*p/100);}else{d.setAttribute("x",c);d.setAttribute("width",j);}}}};return R;});define('sap/viz/controls/chart/morph/morphers/LineMorpher',[],function(){var L={};L.getPercentageLine=function(f,t,p){return{x:f.x+(t.x-f.x)*p/100,y:f.y+(t.y-f.y)*p/100,x2:f.x2+(t.x2-f.x2)*p/100,y2:f.y2+(t.y2-f.y2)*p/100};};var g=function(s,b){var r=parseInt(s.getAttribute(b),10);return isNaN(r)?0:r;};var a=function(s,b){var r=parseFloat(s.getAttribute(b));return isNaN(r)?0:r;};L.svg=function(f,t,d,p){if(d&&t&&t.localName==="line"){var b;var c;var e;var h;if(f&&f.localName==="rect"){var i=a(f,"x1");b=a(t,"x1");var j=a(f,"x2");c=a(t,"x2");var k=a(f,"y1");e=a(t,"y1");var l=a(f,"y2");h=a(t,"y2");d.setAttribute("x1",i+(b-i)*p/100);d.setAttribute("y1",k+(e-k)*p/100);d.setAttribute("x2",j+(c-j)*p/100);d.setAttribute("y2",l+(h-l)*p/100);}else if(!f){b=a(t,"x1");c=a(t,"x2");e=a(t,"y1");h=a(t,"y2");d.setAttribute("x1",b);d.setAttribute("y1",e);d.setAttribute("x2",0+(c-0)*p/100);d.setAttribute("y2",0+(h-0)*p/100);}}};return L;});define('sap/viz/controls/chart/morph/morphers/PathMorpher',['sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/Cache','sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata'],function(u,C,M,S){var e="concat",f="apply",g="hasOwnProperty",s="split",l=String.prototype.toLowerCase,m=String.prototype.toUpperCase,n=parseFloat,o=parseInt,q=Math,v=q.max,w=q.min,A=q.abs,B=q.pow,P=q.PI,D="number",E="string",F="array",G="toString";var H=/,?([achlmqrstvxz]),?/gi,I=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,J=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig;var _=function(i){return i?i.join(",").replace(H,"$1"):this.join(",").replace(H,"$1");};var K=function(c,z){var d=[];for(var i=0,a=c.length;a-2*!z>i;i+=2){var p=[{x:+c[i-2],y:+c[i-1]},{x:+c[i],y:+c[i+1]},{x:+c[i+2],y:+c[i+3]},{x:+c[i+4],y:+c[i+5]}];if(z){if(!i){p[0]={x:+c[a-2],y:+c[a-1]};}else if(a-4===i){p[3]={x:+c[0],y:+c[1]};}else if(a-2===i){p[2]={x:+c[0],y:+c[1]};p[3]={x:+c[2],y:+c[3]};}}else{if(a-4===i){p[3]=p[2];}else if(!i){p[0]={x:+c[i],y:+c[i+1]};}}d.push(["C",(-p[0].x+6*p[1].x+p[2].x)/6,(-p[0].y+6*p[1].y+p[2].y)/6,(p[1].x+6*p[2].x-p[3].x)/6,(p[1].y+6*p[2].y-p[3].y)/6,p[2].x,p[2].y]);}return d;};var L=function(p){if(!p){return null;}var d={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},h=[];if(!h.length){String(p).replace(I,function(a,b,c){var i=[],j=b.toLowerCase();c.replace(J,function(a,b){b&&i.push(+b);});if(j==="m"&&i.length>2){h.push([b][e](i.splice(0,2)));j="l";b=b==="m"?"l":"L";}if(j==="r"){h.push([b][e](i));}else{while(i.length>=d[j]){h.push([b][e](i.splice(0,d[j])));if(!d[j]){break;}}}});}h.toString=_;return h;};var N=function(p){if(!u.isArray(p)||!u.isArray(p&&p[0])){p=L(p);}if(!p||!p.length){return[["M",0,0]];}var a=[],x=0,y=0,b=0,c=0,d=0;if(p[0][0]==="M"){x=+p[0][1];y=+p[0][2];b=x;c=y;d++;a[0]=["M",x,y];}var h=p.length===3&&p[0][0]==="M"&&p[1][0].toUpperCase()==="R"&&p[2][0].toUpperCase()==="Z";for(var r,t,i=d,z=p.length;i<z;i++){a.push(r=[]);t=p[i];var X;if(t[0]!=m.call(t[0])){r[0]=m.call(t[0]);switch(r[0]){case"A":r[1]=t[1];r[2]=t[2];r[3]=t[3];r[4]=t[4];r[5]=t[5];r[6]=+(t[6]+x);r[7]=+(t[7]+y);break;case"V":r[1]=+t[1]+y;break;case"H":r[1]=+t[1]+x;break;case"R":X=[x,y][e](t.slice(1));for(var j=2,Y=X.length;j<Y;j++){X[j]=+X[j]+x;X[++j]=+X[j]+y;}a.pop();a=a[e](K(X,h));break;case"M":b=+t[1]+x;c=+t[2]+y;break;default:for(j=1,Y=t.length;j<Y;j++){r[j]=+t[j]+((j%2)?x:y);}}}else if(t[0]==="R"){X=[x,y][e](t.slice(1));a.pop();a=a[e](K(X,h));r=["R"][e](t.slice(-2));}else{for(var k=0,Z=t.length;k<Z;k++){r[k]=t[k];}}switch(r[0]){case"Z":x=b;y=c;break;case"H":x=r[1];break;case"V":y=r[1];break;case"M":b=r[r.length-2];c=r[r.length-1];break;default:x=r[r.length-2];y=r[r.length-1];}}a.toString=_;return a;};var O=function(x,y,a,b){return[x,y,a,b,a,b];};var Q=function(x,y,a,b,c,d){var h=1/3,i=2/3;return[h*x+i*a,h*y+i*b,h*c+i*a,h*d+i*b,c,d];};var R=function(a,b,r,c,d,j,p,z,Z,$){var f1,f2,cx,cy;var e1=P*120/180,g1=P/180*(+d||0),h1=[],xy,j1=C.func(function(x,y,g1){var X=x*q.cos(g1)-y*q.sin(g1),Y=x*q.sin(g1)+y*q.cos(g1);return{x:X,y:Y};});if(!$){xy=j1(a,b,-g1);a=xy.x;b=xy.y;xy=j1(z,Z,-g1);z=xy.x;Z=xy.y;var k1=q.cos(P/180*d),l1=q.sin(P/180*d),x=(a-z)/2,y=(b-Z)/2;var h=(x*x)/(r*r)+(y*y)/(c*c);if(h>1){h=q.sqrt(h);r=h*r;c=h*c;}var n1=r*r,o1=c*c,k=(j==p?-1:1)*q.sqrt(A((n1*o1-n1*y*y-o1*x*x)/(n1*y*y+o1*x*x)));cx=k*r*y/c+(a+z)/2;cy=k*-c*x/r+(b+Z)/2;f1=q.asin(((b-cy)/c).toFixed(9));f2=q.asin(((Z-cy)/c).toFixed(9));f1=a<cx?P-f1:f1;f2=z<cx?P-f2:f2;f1<0&&(f1=P*2+f1);f2<0&&(f2=P*2+f2);if(p&&f1>f2){f1=f1-P*2;}if(!p&&f2>f1){f2=f2-P*2;}}else{f1=$[0];f2=$[1];cx=$[2];cy=$[3];}var df=f2-f1;if(A(df)>e1){var q1=f2,r1=z,t1=Z;f2=f1+e1*(p&&f2>f1?1:-1);z=cx+r*q.cos(f2);Z=cy+c*q.sin(f2);h1=R(z,Z,r,c,d,0,p,r1,t1,[f2,q1,cx,cy]);}df=f2-f1;var c1=q.cos(f1),s1=q.sin(f1),c2=q.cos(f2),s2=q.sin(f2),t=q.tan(df/4),hx=4/3*r*t,hy=4/3*c*t,m1=[a,b],m2=[a+hx*s1,b-hy*c1],m3=[z+hx*s2,Z-hy*c2],m4=[z,Z];m2[0]=2*m1[0]-m2[0];m2[1]=2*m1[1]-m2[1];if($){return[m2,m3,m4][e](h1);}else{h1=[m2,m3,m4][e](h1).join()[s](",");var E1=[];for(var i=0,ii=h1.length;i<ii;i++){E1[i]=i%2?j1(h1[i-1],h1[i],g1).y:j1(h1[i],h1[i+1],g1).x;}return E1;}};var T=function(a,b){var p=N(a),c=b&&N(b),h={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},j={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},k=function(a,d){var Z,$;if(!a){return["C",d.x,d.y,d.x,d.y,d.x,d.y];}!(a[0]in{T:1,Q:1})&&(d.qx=d.qy=null);switch(a[0]){case"M":d.X=a[1];d.Y=a[2];break;case"A":a=["C"][e](R[f](0,[d.x,d.y][e](a.slice(1))));break;case"S":Z=d.x+(d.x-(d.bx||d.x));$=d.y+(d.y-(d.by||d.y));a=["C",Z,$][e](a.slice(1));break;case"T":d.qx=d.x+(d.x-(d.qx||d.x));d.qy=d.y+(d.y-(d.qy||d.y));a=["C"][e](Q(d.x,d.y,d.qx,d.qy,a[1],a[2]));break;case"Q":d.qx=a[1];d.qy=a[2];a=["C"][e](Q(d.x,d.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"][e](O(d.x,d.y,a[1],a[2]));break;case"H":a=["C"][e](O(d.x,d.y,a[1],d.y));break;case"V":a=["C"][e](O(d.x,d.y,d.x,a[1]));break;case"Z":a=["C"][e](O(d.x,d.y,d.X,d.Y));break;}return a;},r=function(d,i){if(d[i].length>7){d[i].shift();var Z=d[i];while(Z.length){d.splice(i++,0,["C"][e](Z.splice(0,6)));}d.splice(i,1);x=v(p.length,c&&c.length||0);}},t=function(d,b,Z,$,i){if(d&&b&&d[i][0]==="M"&&b[i][0]!=="M"){b.splice(i,0,["M",$.x,$.y]);Z.bx=0;Z.by=0;Z.x=d[i][1];Z.y=d[i][2];x=v(p.length,c&&c.length||0);}};for(var i=0,x=v(p.length,c&&c.length||0);i<x;i++){p[i]=k(p[i],h);r(p,i);c&&(c[i]=k(c[i],j));c&&r(c,i);t(p,c,h,j,i);t(c,p,j,h,i);var y=p[i],z=c&&c[i],X=y.length,Y=c&&z.length;h.x=y[X-2];h.y=y[X-1];h.bx=n(y[X-4])||h.x;h.by=n(y[X-3])||h.y;j.bx=c&&(n(z[Y-4])||j.x);j.by=c&&(n(z[Y-3])||j.y);j.x=c&&z[Y-2];j.y=c&&z[Y-1];}return c?[p,c]:p;};var U=null;var V=function(p,a){if(!U){U=C.func(T);}return U(p,a);};var W={};W.getPercentagePath=function(a,t,p){if(!a||!t){return"";}var c=V(String(a),String(t));var b=c[0];var d=c[1];var h=[];for(var i=0,k=b.length;i<k;i++){h[i]=[b[i][0]];for(var j=1,r=b[i].length;j<r;j++){h[i][j]=b[i][j]+(d[i][j]-b[i][j])*p/100;}}return _(h);};W.svg=function(a,t,d,p){if(d&&t&&t.localName=="path"&&(!a||a.localName=="path")){var b=t.getAttribute("d");if(b&&b.length>1){var c;if(S.get(t,M.MORPHER_DISABLE_PATH)===true){c=d.getAttribute("d");if(b!==c){d.setAttribute("d",b);}}else{var h="";if(a){h=a.getAttribute("d");}if(!h){var i=b.match(I);if(i.length>0){h=i[0];}else{h="M0,0";}}c=W.getPercentagePath(h,b,p);d.setAttribute("d",c);}}}};return W;});define('sap/viz/controls/chart/morph/utils/TransformParser',[],function(){var T={};var t=function(s){return s.replace(/^\s*/,"").replace(/\s*$/,"");};T.parse=function(a){var r=[];var b=[];var s=[];if(a){var c;if(a.indexOf("rotate(")>=0){var d=a.substring(a.indexOf("rotate("));d=d.substring("rotate(".length,d.indexOf(")"));d=t(d);var e=[];if(d.indexOf(",")>0){e=d.split(",");}else{e=d.split(" ");}for(var i=0;i<e.length&&r.length<3;i++){c=t(e[i]);if(c!==""){c=parseFloat(c);if(isNaN(c)){c=0;}r.push(c);}}if(r.length<3){r[1]=0;r[2]=0;}}if(a.indexOf("translate(")>=0){var f=a.substring(a.indexOf("translate("));f=f.substring("translate(".length,f.indexOf(")"));f=t(f);var g=[];if(f.indexOf(",")>0){g=f.split(",");}else{g=f.split(" ");}for(var j=0;j<g.length&&b.length<2;j++){c=t(g[j]);if(c!==""){c=parseFloat(c);if(isNaN(c)){c=0;}b.push(c);}}if(b.length<2){b[1]=0;}}if(a.indexOf("scale(")>=0){var h=a.substring(a.indexOf("scale("));h=h.substring("scale(".length,h.indexOf(")"));h=t(h);var l=[];if(h.indexOf(",")>0){l=h.split(",");}else{l=h.split(" ");}for(var k=0;k<l.length&&s.length<2;k++){c=t(l[k]);if(c!==""){c=parseFloat(c);if(isNaN(c)){c=0;}s.push(c);}}if(s.length<2){s[1]=0;}}}return{rotate:r.length>0?r:null,translate:b.length>0?b:null,scale:s.length>0?s:null};};return T;});define('sap/viz/controls/chart/morph/morphers/TransformMorpher',['sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/utils/TransformParser'],function(M,S,T){var a={};a.applyTransform=function(f,b,t,c,p){var x=f+(t-f)*p/100;var y=b+(c-b)*p/100;return"translate("+x+","+y+")";};a.svg=function(f,t,d,p,u){if(d&&t){var c="";if(f){var b=T.parse(f.getAttribute("transform"));var e=T.parse(t.getAttribute("transform"));if(u){if(b.translate||e.translate){if(!b.translate){b.translate=[0,0];}if(!e.translate){e.translate=[0,0];}c+=(c?" ":"")+"translate("+(b.translate[0]+(e.translate[0]-b.translate[0])*p/100)+","+(b.translate[1]+(e.translate[1]-b.translate[1])*p/100)+")";}}else{var g=S.get(f,M.SHAPE_GLOBAL_TRANSLATE_X)||0;var h=S.get(f,M.SHAPE_GLOBAL_TRANSLATE_Y)||0;var i=S.get(t,M.SHAPE_GLOBAL_TRANSLATE_X)||0;var j=S.get(t,M.SHAPE_GLOBAL_TRANSLATE_Y)||0;var k=g+(i-g)*p/100;var l=h+(j-h)*p/100;c+=(c?" ":"")+"translate("+k+","+l+")";}if(b.rotate||e.rotate){if(!b.rotate){b.rotate=[0,0,0];}if(!e.rotate){e.rotate=[0,0,0];}c+=(c?" ":"")+"rotate("+(b.rotate[0]+(e.rotate[0]-b.rotate[0])*p/100)+","+(b.rotate[1]+(e.rotate[1]-b.rotate[1])*p/100)+","+(b.rotate[2]+(e.rotate[2]-b.rotate[2])*p/100)+")";}if(b.scale||e.scale){if(!b.scale){b.scale=[0,0];}if(!e.scale){e.scale=[0,0];}c+=(c?" ":"")+"scale("+(b.scale[0]+(e.scale[0]-b.scale[0])*p/100)+","+(b.scale[1]+(e.scale[1]-b.scale[1])*p/100)+")";}d.setAttribute("transform",c);}}};return a;});define('sap/viz/controls/chart/morph/morphers/TextMorpher',['sap/viz/controls/chart/morph/morphers/TransformMorpher'],function(T){var a={};var g=function(s,d){var e=parseInt(s.getAttribute(d),10);return isNaN(e)?0:e;};var b=function(s,d){var e=parseFloat(s.getAttribute(d));return isNaN(e)?0:e;};var r=/(\d+)(in|cm|mm|pt|pc|em|ex|px)/i;var c=function(f,t,p){var d=r.exec(f);if(!d){d=[f,f,""];}var e=parseInt(d[1],10);var h=d[2];var i=r.exec(t);if(!i){i=[t,t,""];}var j=parseInt(i[1],10);var k=i[2];var l=e;switch(h){case"pt":l=l*1.33;break;case"px":l=l;break;default:l=l;}switch(k){case"pt":l=l/1.33;break;case"px":l=l;break;default:l=l;}return String(Math.round(l+(j-l)*p/100))+k;};a.svg=function(f,t,d,p){if(d&&t.localName==="g"&&t.firstChild&&t.firstChild.localName==="text"){if(f&&f.localName==="g"&&f.firstChild&&f.firstChild.localName==="text"){var e=b(f.firstChild,"x");var h=b(t.firstChild,"x");var i=b(f.firstChild,"y");var j=b(t.firstChild,"y");d.firstChild.setAttribute("x",e+(h-e)*p/100);d.firstChild.setAttribute("y",i+(j-i)*p/100);var k=f.getAttribute("font-size");var l=t.getAttribute("font-size");if(k&&l&&k!=l){var m=c(k,l,p);d.setAttribute("font-size",m);}T.svg(f.firstChild,t.firstChild,d.firstChild,p,true);}else if(!f){d.setAttribute("opacity",p/100);}}};return a;});define('sap/viz/controls/chart/morph/VizMorpher',['jquery','sap/viz/controls/chart/morph/constant/MorphConst','sap/viz/controls/chart/morph/utils/Utils','sap/viz/controls/chart/morph/utils/SVGShapeMetadata','sap/viz/controls/chart/morph/vo/VizShape','sap/viz/controls/chart/morph/vo/VizShapesHolder','sap/viz/controls/chart/morph/viz/MpShapesCapturer','sap/viz/controls/chart/morph/viz/MpShapesMapper','sap/viz/controls/chart/morph/morphers/ColorMorpher','sap/viz/controls/chart/morph/morphers/RectMorpher','sap/viz/controls/chart/morph/morphers/LineMorpher','sap/viz/controls/chart/morph/morphers/PathMorpher','sap/viz/controls/chart/morph/morphers/TextMorpher','sap/viz/controls/chart/morph/morphers/TransformMorpher','sap/viz/controls/common/constants/CSSConst'],function($,M,u,S,V,a,b,c,C,R,L,P,T,d,e){var f=function(i){this._morphDiv=i;this._currentVizType="";this._currentVizShapesHolder=new a();this._tween=null;};f.prototype.bindViewLayer=function(v){this._vizDiv=v;};f.prototype.getMorphingLayer=function(){return this._morphDiv;};f.prototype.resetMorphSvg=function(){var v=h(this._vizDiv);var i=v.width();var l=v.height();var n=h(this._morphDiv);n.empty();var o=h(document.createElement("DIV"));o.css("overflow","hidden").appendTo(n).width(i).height(l);var q=v.find("svg");if(q.length>0){o.attr("class","vc-morph-svg-host "+q.parent().attr("class"));}return d3.select(o.get(0)).append("svg").attr("width",i).attr("height",l).node();};f.prototype.resetMorphCache=function(){this.resetMorphSvg();this._currentVizShapesHolder=new a();};f.prototype.getCurrentVizType=function(){return this._currentVizType;};f.prototype.isPlaying=function(){return(this._tween!==null);};f.prototype.showMorphing=function(i,v){var l=h(this._morphDiv);var n=h(this._vizDiv);if(i){l.css("display","");}else{l.css("display","none");}if(v){n.css("visibility","visible");}else{n.css("visibility","hidden");}};f.prototype.showAnimationLayer=function(){this.removeAnimationLayer();var i=h(this._morphDiv);var v=h(this._vizDiv);var l=v.clone().get(0);i.css("display","");v.css("visibility","hidden");l.className=e.PREFIX+'animation-layer';l.style.position="absolute";v.parent().append(l);$(l).find(".v-morphable-datapoint").css("visibility","hidden");$(l).find(".v-morphable-line").css("visibility","hidden");$(l).find(".v-morphable-areabg").css("visibility","hidden");$(l).find(".v-morphable-label").css("visibility","hidden");$(l).find(".v-morphable-background").css("visibility","hidden");k(l);$(l).css("visibility","visible");};f.prototype.removeAnimationLayer=function(){d3.select(".viz-controls-animation-layer").remove();};f.prototype.morphVizType=function(n,i,l,o){i=u.isNumber(i)?i:1000;n=u.isString(n)?n:this.getCurrentVizType();var v=h(this._vizDiv);var q=h(this._morphDiv);if(v){q.css({'opacity':v.css('opacity')?v.css('opacity'):1});}if(this._tween){this.removeAnimationLayer();this._tween.stop(true,false);this._tween=null;v.css("visibility","visible");q.css("display","none");}var r=b.getShapes(v.get(0),n);var s=g(r);var t=(s&&i>0);if(s){c.map(r,this._currentVizShapesHolder,n,this._currentVizType,l);var w=r.allByOrder();var x=this.resetMorphSvg();if(t){v.css("visibility","hidden");q.css("display","");p(x,w,0);var y=this;this._startMorphShapes(w,i,function(){y.removeAnimationLayer();v.css("visibility","visible");q.css("display","none");if(y._tween){y._tween.stop(true,false);}y._tween=null;if(u.isFunction(o)){o.call(null);}});}else{p(x,w,100);this._tween=null;v.css("visibility","visible");q.css("display","none");if(u.isFunction(o)){o.call(null);}}}else{this.removeAnimationLayer();r.empty();this.resetMorphSvg();this._tween=null;v.css("visibility","visible");q.css("display","none");if(u.isFunction(o)){o.call(null);}}$('*',q).removeAttr('id');this._currentVizType=n;this._currentVizShapesHolder=r;};var g=function(n){var t=n.toShapesBySvgType();if(t["all"].length>n.backgrounds.length){if(t["path"]&&t["path"].length>200){return false;}if(t["rect"]&&t["rect"].length>300){return false;}if(t["all"].length>400){return false;}return true;}return false;};f.prototype._startMorphShapes=function(v,i,l){this._tween=$({percentage:1});this._tween.animate({percentage:100},{duration:i,easing:"swing",step:function(){var n=this.percentage;m(v,n);},complete:function(){l();}});};var h=function(i){if(u.isString(i)){if(i.indexOf("#")!==0){return $("#"+i);}}return $(i);};var p=function(s,v,l){l=l?l:0;for(var i=0;i<v.length;i++){var n=v[i];var o=n.from;var t=n.to;if(t){var q=n.display=t.cloneNode(true);S.clone(q,t);if(l!==100){j(o,t,q,l);}s.appendChild(q);}}};var m=function(v,l){for(var i=0;i<v.length;i++){var n=v[i];var o=n.from;var t=n.to;var q=n.display;j(o,t,q,l);}};var j=function(i,t,l,n){R.svg(i,t,l,n);L.svg(i,t,l,n);P.svg(i,t,l,n);C.svg(i,t,l,n);T.svg(i,t,l,n);d.svg(i,t,l,n);};f.prototype.testDrawShapes=function(n,i){var v=h(this._vizDiv);var l=h(this._morphDiv);var o=b.getShapes(v.get(0),n);c.map(o,this._currentVizShapesHolder,n,this._currentVizType);var q=o.allByOrder();var r=this.resetMorphSvg();p(r,q,i);this._currentVizType=n;this._currentVizShapesHolder=o;};var k=function(l){var n=$(l).find('clipPath');if(n&&n.length){n.each(function(i,o){var q=$(o).attr('id');l.innerHTML=l.innerHTML.replace(new RegExp(q,'g'),q+'_morphing');});}};return f;});define('sap/viz/controls/chart/views/View',['jquery','sap/viz/controls/LanguageLoader','sap/viz/controls/TemplateLoader','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/UIControl','sap/viz/controls/chart/morph/VizMorpher','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/DropZone','sap/viz/controls/chart/ChartConfig','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/events/Event','sap/viz/controls/common/services/FeedValidationService','sap/viz/controls/common/metadata/MetadataFactory'],function($,L,T,G,C,M,F,b,c,O,u,d,D,f,V,g,U,h,k,l,m,I,n,A,E,o,p){var q=function(a,e,i,j,t,v){q.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.View";this._div=a;this._chartHolder$=null;this._chartLayer$=null;this._descriptionLayer$=null;this._loadingIcon$=null;this._chartModelProvider=j;this._helper=v;this._options=e;this._cssCache=null;this._libFolderPath=i;var w=sap.viz.api.env.Resource.path("sap.viz.geo.geographicInfo.localStorage.resourcePath");this._geoResourcePath=w?w:this._libFolderPath+"/sap.viz.geo/geocharts/resources/data/geo/";this._enableTrellis=true;this._enablePropertyZone=false;this._hasChartInstance=false;this._changedProperties=null;this._size={width:q.DEFAULT_VIZ_WIDTH,height:q.DEFAULT_VIZ_HEIGHT};this._padding=24;this._chart=null;this._chartProxy=t;this._onEventMap={};this._isFeedsValid=false;this._templateId=q.TEMPLATE_DEFAULT;this._requestMorphing=false;this._mouseDownHandler=$.proxy(function(x){if(document.activeElement&&document.activeElement.blur&&document.activeElement.tagName&&document.activeElement.tagName.toLowerCase()!="body"&&!$.contains(this._dom$[0],document.activeElement)&&$.contains(this._dom$.parent()[0],x.target)){document.activeElement.blur();}},this);$(document).on('mousedown',this._mouseDownHandler);this._changeTemplateFunc=$.proxy(this.changeTemplate,this);sap.viz.api.env.Template.addListener(this._changeTemplateFunc);};O.extend(q,U);q.DEFAULT_VIZ_WIDTH=380;q.DEFAULT_VIZ_HEIGHT=280;q.TEMPLATE_DEFAULT=C.TEMPLATE_DEFAULT;q.TEMPLATE_INCOMPLETE=C.TEMPLATE_INCOMPLETE;q.TEMPLATE_EMPTY=C.TEMPLATE_EMPTY;q.prototype.requestMorphing=function(){return this._requestMorphing;};q.prototype._createChildren=function(){this._createChartHolder();this._createChartLayer();this._createDescriptionLayer();this._createLoadingIcon();};q.prototype._createChartHolder=function(){this._chartHolder$=$(document.createElement('div')).addClass([g.PREFIX+'chart-holder',g.COMMON_PREFIX+'scrollable'].join(' '));this._chartHolder$.appendTo($(this._div));this._chartHolder$.css({position:'relative'});};q.prototype._createChartLayer=function(){this._chartLayer$=$(document.createElement('div')).addClass(g.PREFIX+'chart-layer');this._chartLayer$.appendTo(this._chartHolder$);this._chartLayer$.css({position:'absolute'});};q.prototype._createDescriptionLayer=function(){this._descriptionLayer$=$(document.createElement('div')).addClass(g.PREFIX+"chart-description");this._descriptionLayer$.css({position:'absolute'});this._descriptionLayer$.appendTo(this._chartHolder$);};q.prototype._createLoadingIcon=function(){this._loadingIcon$=$(document.createElement('div')).addClass(g.CHART_PREFIX+"loading-icon");this._loadingIcon$.appendTo(this._chartHolder$);this._loadingIcon$.css({width:this._chartHolder$.width()+"px",height:this._chartHolder$.height()+"px"});};q.prototype._createDropZone=function(){var a=this._chartLayer$;this._dropZone=new l(a.get(0),$.proxy(this._getFeedingZone,this),$.proxy(this._dropZoneFeedValidator,this));this._dropZone.addEventListener(l.DROP_ITEM_EVENT,this._dropItemHandler,this);};q.prototype._getFeedingZone=function(){if(!this._chart){return[];}try{return this._chartProxy.get('feedingZone',[]);}catch(e){return[];}};q.prototype._dropZoneFeedValidator=function(a,e){var v=this._chartModelProvider();var i=b.cloneFeeds(v.feedingItems());if(!v.isMNDVisible()){i=b.removeMND(i);}var j=o.replaceable(v.type(),i,a,e);return j;};q.prototype._dropItemHandler=function(e){this._dispatchEvent(new k(k.ANALYSIS_DROPPED,this,e.data));};q.DISPATCH_PROPERTY_EVENT='dispatchPropertyEvent';q.prototype.modelChanged=function(a,e){};q.prototype.feedingItemChanged=function(a){};q.prototype._getMinSize=function(){return this._size;};q.prototype._setChartSize=function(w,a){if(this._chart){this._chartProxy.set('size',{width:w,height:a});}};q.prototype._updateChartSize=function(a){var e=this._getMinSize();var w=e.width;var i=e.height;var j={width:this._size.width+"px",height:this._size.height+"px",'overflow-x':e['overflow-x']||'hidden','overflow-y':e['overflow-y']||'hidden'};if(a){this._setChartSize(w,i);}this._chartLayer$.css({width:w+"px",height:i+"px"});this._chartHolder$.css(j);return e;};q.prototype.updateDescription=function(a){this._destroyChartInstance();this._updateDescription(a);};q.prototype._updateDescription=function(a){if(a){if(this._descriptionLayer$){this._descriptionLayer$.show();this._descriptionLayer$.text(a);}this._showDescription();}else{if(this._descriptionLayer$){this._descriptionLayer$.hide();this._descriptionLayer$.text("");}var e=this._chartHolder$.children();for(var i=0;i<e.length;i++){var j=$(e[i]);j.css({'opacity':""});}}this.hideLoadingIcon();};function r(a,e,t,v){for(var i=0;i<e.length;i++){if(e[i].type()===t){for(var j=0;j<a.length;j++){if(e[i].id()===a[j].id()){if((e[i].id()!=="geoFeatures"&&!v)||(e[i].id()==="geoFeatures"&&v)){if(e[i].values().length<a[j].min()){return false;}}}}}}return true;}function s(t,a,e){var j=c.get("VIZ_CHART_INCOMPLETE_DESCRIPTION");var v=p.get(t).getBindingDefs();var w=true;var x=true;var i;for(i=0;i<v.length;i++){if(!x&&!w){break;}var y=v[i];if(x&&y.type()==='dimension'){x=false;continue;}if(w&&y.type()==='measure'){w=false;}}if(w){j=c.get("VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION");return j;}if(x){j=c.get("VIZ_CHART_MEASURE_INCOMPLETE_DESCRIPTION");return j;}if(!a){return j;}var z=r(v,e,F.MEASURE,false);var B=r(v,e,F.DIMENSION,false);var H=r(v,e,F.DIMENSION,true);if(H){if(!z&&B){j=c.get("VIZ_CHART_MEASURE_INCOMPLETE_DESCRIPTION");}if(z&&!B){j=c.get("VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION");}}else{if(z&&B){j=c.get("VIZ_CHART_GEO_INCOMPLETE_DESCRIPTION");}if(z&&!B){j=c.get("VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION");}}return j;}q.prototype._showDescription=function(){var a=this._chartHolder$.children();for(var i=0;i<a.length;i++){var e=$(a[i]);e.css({'opacity':".3"});}if(this._descriptionLayer$){this._descriptionLayer$.css({width:this._size.width+"px",height:this._size.height/2+50+"px",color:"black",'font-size':"28px",'text-align':"center",'top':this._size.height/2-50+"px",'word-wrap':"break-word"});}};q.prototype._destroyChartInstance=function(){if(this._chart){this._offEvent();this._chart.destroy();this._chart=null;this._hasChartInstance=false;}};q.prototype._updateChartOpacity=function(a){if(arguments.length===0){this._chartLayer$.css('opacity','0');}else{if(V.hasFakeData(a)){this._chartLayer$.css('opacity','.3');}else{this._chartLayer$.css('opacity','');}}};q.prototype._updateDescriptionByOptions=function(a){var e=false,i;var j=d.isEmptyData(a.type,a.data);if(j){i=c.get('VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER');e=true;}else{var v=a.type;var t=a.feeding;if(!this._enableTrellis&&d.isMultipleChart(v)){i=c.get('VIZ_CHART_TRELLIS_DISABLED_WARN');e=true;}else if(!this._isFeedsValid){i=s(v,t,this._chartModelProvider().feedingItems());}this._updateChartOpacity(a.data);}this._dispatchEvent(new E("DescriptionChanged",this,{isDataEmpty:j}));this._updateChartSize(false);this._updateDescription(i);if(e){this._updateChartOpacity();}return e;};q.prototype._createChartInstance=function(){};q.prototype.getTemplateId=function(a){if(arguments.length>0){return this._templateId;}else{return sap.viz.api.env.Template.get();}};q.prototype._getTemplateId=function(a){var t=sap.viz.api.env.Template.get();if(t!==q.TEMPLATE_INCOMPLETE&&t!==q.TEMPLATE_EMPTY){this._templateId=t;}this._isFeedsValid=!V.hasFakeData(a)&&!d.isEmptyData(this._options.type,a);t=this._isFeedsValid?this._templateId:q.TEMPLATE_INCOMPLETE;return t;};q.prototype.showLoadingIcon=function(){};q.prototype.hideLoadingIcon=function(){this._loadingIcon$.css({display:""});};q.prototype.hasChartInstance=function(){return this._hasChartInstance;};q.prototype.exportable=function(){return false;};q.prototype.size=function(a){if(arguments.length>0){this._size={width:a.width,height:a.height};this._updateChartSize(true);var e=this._descriptionLayer$;if(e!==null&&e.size()>0){e.css({width:this._size.width+"px",height:this._size.height/2+50+"px",'top':this._size.height/2-50+"px"});}this._loadingIcon$.css({width:this._size.width+"px",height:this._size.height+"px"});return this;}return{width:this._size.width,height:this._size.height};};q.prototype.changeTemplate=function(){var t=sap.viz.api.env.Template.get();if(t!==q.TEMPLATE_INCOMPLETE&&t!==q.TEMPLATE_EMPTY&&t!==this._templateId){var a=this._getTemplateId(this._options.data);if(a===t){this._requestMorphing=true;this._createChartInstance();this._dispatchEvent(new k(k.CHANGED_SELECTED_DATA,this));}}};q.prototype.create=function(a){if(a){this._options=a;this._requestMorphing=true;var t=this._getTemplateId(a.data);this.__templateId=t;var _=this;sap.viz.api.env.Template.set(t,function(){if(_.__templateId===t){_._createChartInstance();}});this._dispatchEvent(new k(k.CHANGED_SELECTED_DATA,this));}};q.prototype.destroy=function(){$(document).off('mousedown',this._mouseDownHandler);this.removeAllEventListeners();this._onEventMap={};if(this._chart){this._chart.destroy();this._chart=null;}this._chartHolder$.remove();sap.viz.api.env.Template.removeListener(this._changeTemplateFunc);};q.prototype.data=function(a){var e,i;try{if(arguments.length>0){this._options.data=a;if(this._chart){e=this._updateDescriptionByOptions(this._options);if(e){this.selection([],{"selectionMode":"exclusive"});this._dispatchEvent(new k(k.CHART_CHANGING,this));this._dispatchEvent(new k(k.CHANGED_SELECTED_DATA,this));this._requestMorphing=false;}else{this._chartProxy.set('data',this._options.data);return this;}}else{i=c.get('VIZ_CHART_UPDATE_CHART_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');this._updateDescription(i);throw i;}}else{return this._chartProxy.get('data',this._options.data);}}catch(j){i=c.get('VIZ_CHART_UPDATE_CHART_FAILED')+j;this._updateDescription(i);throw i;}};q.prototype.feeding=function(a){if(arguments.length>0){this._options.feeding=a;return this;}else{return this._options.feeding;}};q.prototype.css=function(a){if(arguments.length>0){this._options.css=a;return this;}else{return this._options.css;}};q.prototype.getValidProperties=function(a,e){return V.getValidProperties(a,e);};q.prototype.getValidScales=function(a,e){return a;};q.prototype.properties=function(a){if(arguments.length>0){this._options.properties=a;return this;}else{return this._options.properties;}};q.prototype.scales=function(a){};q.prototype.update=function(a,e){if(!a){return;}if(!e){this._requestMorphing=true;}if(a.css){this._updateCssCacheByNewCss(a.css);this._options.css=a.css;}if(a.feeding){this._options.feeding=a.feeding;}else if(a.bindings){this._options.feeding=a.bindings;}if(a.data){this._options.data=a.data;}if(a.properties){this._options.properties=u.updateJSON(this._options.properties||{},a.properties);this._checkBehaviorType(a.properties);}if(a.scales){this._options.scales=a.scales;}var i,j;try{if(this._chart){j=this._updateDescriptionByOptions(this._options);if(j){this.selection([],{"selectionMode":"exclusive"});this._dispatchEvent(new k(k.CHART_CHANGING,this));this._dispatchEvent(new k(k.CHANGED_SELECTED_DATA,this));this._requestMorphing=false;}else{this._updateChartSize(true);this._chartProxy.execute('update',a);}return this;}else{i=c.get('VIZ_CHART_UPDATE_CHART_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');this._updateDescription(i);throw i;}}catch(t){i=c.get('VIZ_CHART_UPDATE_CHART_FAILED')+t;this._updateDescription(i);throw i;}};q.prototype.on=function(e,a){try{if(this._chart){if(arguments.length>0){this._chart.on(e,a);}}this._onEventMap[e]=a;return this;}catch(i){throw c.get('VIZ_CHART_ADD_EVENT_FAILED')+i;}};q.prototype.off=function(e){try{if(this._chart){if(arguments.length>0){this._chart.off(e);}}delete this._onEventMap[e];return this;}catch(a){throw c.get('VIZ_CHART_REMOVE_EVENT_FAILED')+a;}};q.prototype.selection=function(a,e){try{if(this._chart){if(this._options.type===C.TYPE_TREE||this._options.type===C.TYPE_TABLE||this._options.type===C.TYPE_CROSSTAB){return null;}if(arguments.length>=2){this._chart.selection(a,e);return this;}else if(arguments.length===1){if(u.isArray(arguments[0])){this._chart.selection(arguments[0]);return this;}else{return this._chart.selection(arguments[0]);}}else{return this._chart.selection();}}else{if(arguments.length>=2){throw c.get('VIZ_CHART_SELECTION_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}else if(arguments.length===1){if(u.isArray(arguments[0])){throw c.get('VIZ_CHART_SELECTION_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}else{return null;}}else{return null;}}}catch(i){throw c.get('VIZ_CHART_SELECTION_FAILED')+i;}};q.prototype.feedingZone=function(){return[];};q.prototype.description=function(a){try{if(arguments.length>0){if(this._chart){this._chart.description(a);return this;}else{throw c.get('VIZ_CHART_DESCRIPTION_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{if(this._chart){return this._chart.description();}else{return null;}}}catch(e){throw c.get('VIZ_CHART_DESCRIPTION_FAILED')+e;}};q.prototype.action=function(a,e){try{if(this._chart){if(arguments.length>0){return this._chartProxy.execute('action',a,e);}}else{throw c.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(i){throw c.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+i;}};q.prototype.exportViz=function(a){if(this._chart){var e=this._chartProxy.execute('toJSON',a);if(e){e.properties=this._options.properties;this._updateCssOfOptions();e.css=this._options.css;}return e;}else{throw c.get('VIZ_CHART_SERIALIZE_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};q.prototype.loadViz=function(v){this.create(v);};q.prototype.enableTrellis=function(v){if(arguments.length>0){this._enableTrellis=(v!==false);return this;}else{return this._enableTrellis;}};q.prototype.enablePropertyZone=function(v){if(arguments.length>0){if(this._enablePropertyZone!==v){this._enablePropertyZone=(v===true);}return this;}else{return this._enablePropertyZone;}};q.prototype.getTitleByFeeding=function(){var a="";var e=[];var t=[];var v=this._chartModelProvider().feedingItems();var w=this._chartModelProvider().type();var x=p.get(w).getBindingDefsWithBVRSorting();for(var i=0;i<x.length;i++){var y=x[i];var z=b.getFeed(v,y.id());if(!z||z._id===F.ROW_SUBTOTALS||z._id===F.COLUMNS_SUBTOTALS){continue;}var B=z.values();var H=(z.type()===F.MEASURE)?e:t;for(var j=0;j<B.length;j++){var J=B[j];if(J.id()===A.MND){continue;}var K=J.selectedHierarchyLevel();var N=K?K.name():J.name();H.push(N);}}var P=q._getNames(e);var Q=q._getNames(t);if(P!==""&&Q!==""){a=u.substitute(c.get('VIZ_CHART_TITLE_TEXT_JOIN_BY'),P,Q);}else if(P!==""){a=P;}else if(Q!==""){a=Q;}if(a===""){a=null;}return a;};q._getNames=function(a){var e="";for(var i=0;i<a.length;i++){var j=a[i];e+=j;if(i+2===a.length){e+=" "+c.get('VIZ_CHART_TITLE_TEXT_JOIN_AND')+" ";}else if(i+2<a.length){e+=", ";}}return e;};q.prototype.resetProperties=function(a,v){return a;};q.prototype.copyData=function(t,a){return u.clone(a);};q.prototype.buildFeedings=function(t,a,e){return null;};q.prototype.supportUpdate=function(t){return true;};q.prototype.setPropertyZones=function(a){};q.prototype.FeedsToJSON=function(a){return n.toJSON(a);};q.prototype.save=function(){};q.prototype.load=function(j,v){};q.prototype.FeedsFromJSON=function(v){var a=n.fromJSON(v);return a;};q.prototype.exportToSVGString=function(a){if(this._chart){return this._chartProxy.execute('exportToSVGString',a);}else{throw c.get('VIZ_CHART_EXPORTSVG_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};q.prototype.supportExportToSVG=function(){if(this._chart){return this._chartProxy.execute('supportExportToSVG');}else{throw c.get('VIZ_CHART_EXPORTSVG_FAILED')+c.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};q.prototype.getPropertyZones=function(){return[];};q.prototype.getZoneName=function(a){};q.prototype.setAxisScale=function(a){};q.prototype.getDataPointsPosition=function(a){return[];};q.prototype.updateProperties=function(a){};q.prototype.getChangedProperties=function(){return this._changedProperties;};q.prototype.addChangedProperties=function(a){this._changedProperties=u.updateJSON(this._changedProperties,a);return this._changedProperties;};q.prototype.resetChangedProperties=function(){this._changedProperties=null;};q.prototype._updateCssCache=function(a,e,i){if(!this._cssCache){this._updateCssCacheByOptions();}this._cssCache=this._cssCache||{};this._cssCache[a]=this._cssCache[a]||{};this._cssCache[a][e]=i;};q.prototype._updateCssCacheByOptions=function(){if(this._options&&this._options.css){this._updateCssCacheByCssString(this._options.css);}};q.prototype._updateCssCacheByNewCss=function(a){if(!this._cssCache){this._updateCssCacheByOptions();}this._updateCssCacheByCssString(a);};q.prototype._updateCssCacheByCssString=function(a){if(!a){return;}this._cssCache=this._cssCache||{};var e=a.split('}');var i,j,t,v=[],w,x,y,P,z,B,H;for(i=0;i<e.length;i++){t=e[i];v=t.split('{');if(v.length===2){w=v[0].trim();x=v[1];y=x.split(';');this._cssCache[w]=this._cssCache[w]||{};for(j=0;j<y.length;j++){P=y[j];z=P.split(':');if(z.length===2){B=z[0].trim();H=z[1];this._cssCache[w][B]=H;}}}}};q.prototype._updateCssOfOptions=function(){if(!this._cssCache){return;}var a="",e,i,v;for(e in this._cssCache){if(this._cssCache.hasOwnProperty(e)){a+=' '+e+'{';for(i in this._cssCache[e]){if(this._cssCache[e].hasOwnProperty(i)){a+=i+':'+this._cssCache[e][i]+';';}}a+='}';}}if(a!==""){this._options.css=this._options.css?this._options.css+a:a;}};q.prototype.cssProperty=function(a,e,i){if(this._chart){if(arguments.length>2){this._updateCssCache(a,e,i);return this._chart.cssProperty(a,e,i);}else if(arguments.length===2){return this._chart.cssProperty(a,e);}}return this;};q.prototype.selectedPropertyZone=function(a){if(arguments.length>0){if(this._chart){return this._chartProxy.set('selectedPropertyZone',a);}}else{if(this._chart){return this._chartProxy.get('selectedPropertyZone');}else{return null;}}return this;};q.prototype.onEventMap=function(a){if(arguments.length>0){this._onEventMap=a;return this;}else{return this._onEventMap;}};q.prototype.showChartLayer=function(){this._chartLayer$.css("visibility","");};q.prototype.hideChartLayer=function(){this._chartLayer$.css("visibility","hidden");};q.prototype._postVizProcess=function(a){this._chart.on("initialized.view",$.proxy(function(){this._dispatchEvent(new E("ChartInstance_Initialized",this,{chartLayer:this._chartLayer$[0],requestMorphing:this._requestMorphing}));var e=this.data();this._requestMorphing=false;},this));if(!!this._chart.on){Object.keys(this._onEventMap).forEach($.proxy(function(e){var i=this._onEventMap[e];this._chart.on(e,i);},this));}};q.prototype._offEvent=function(){if(!!this._chart.off){Object.keys(this._onEventMap).forEach($.proxy(function(a){var e=this._onEventMap[a];this._chart.off(a,e);},this));}};q.prototype._getCssProperties=function(a,e){var j=null;for(var i=0;i<e.length;++i){var v=this._chart.cssProperty(a,e[i]);if(v!=null){j=j||{};j[e[i]]=v;}}return j;};q.prototype.queryProperties=function(a){if(!a||!a.css){return this.properties();}var e=a.css.properties;var j=a.css.selector;var t=null;if(u.isArray(j)){for(var i=0;i<j.length;++i){t=this._getCssProperties(j[i],e);if(t){break;}}}else{t=this._getCssProperties(j,e);}return t;};q.prototype.updateProperties=function(e){if(!e){return;}if(e.css&&e.css.selector){var j;var t=e.css.selector;var v=e.css.value;var a=v.split('font-size');if(a.length===2){a[1]=a[1].replace(/;/,'!important;');v=a.join('font-size');}if(u.isArray(t)){j="";for(var i=0;i<t.length;++i){j+=t[i]+v;}}else{j=t+v;}this._helper.vizCss(j);}else if(e.hasOwnProperty("properties")){if(e.hasOwnProperty("disableDispatchInteractionCompleteEvent")&&e.disableDispatchInteractionCompleteEvent){this._helper.vizProperties(e.properties);}else{this._helper.propertiesWithEvents(e.properties);}}};q.prototype._needMorphing=function(a){var e=this._chartProxy.get('properties',this._options.properties);if(a.title&&a.title.visible!==undefined&&e.hasOwnProperty("title")&&e.title.visible!==a.title.visible){return true;}if(a.legend&&a.legend.visible!==undefined&&e.hasOwnProperty("legend")&&e.legend.visible!==a.legend.visible){return true;}return false;};q.prototype.store=function(){};q.prototype.restore=function(){};q.prototype.reset=function(){};q.prototype._checkBehaviorType=function(a){};q.prototype.runtimeScales=function(){return[];};q.prototype.sharedRuntimeScales=function(v){if(arguments.length<1){return[];}else{return this;}};q.prototype.updatePropertyForPropertyZoneInteraction=function(a,e){return a;};q.prototype.getPictogramInfo=function(){return null;};q.prototype.zoom=function(a){if(arguments.length>0){return this;}else{return null;}};return q;});define('sap/viz/controls/common/property/VizPropertyZone',['sap/viz/controls/common/utils/Utils'],function(U){var V=function(t,c,e,m){this._type=t;this._context=c;this._extraContext=e;this._measureNames=m;if(U.isArray(m)){this._dimensionContext=this._filterDimensionContext(m.concat('_id'));}};V.CHART_AREA='CHART_AREA';V.CHART_TITLE='CHART_TITLE';V.PLOT_AREA='PLOT_AREA';V.GRID_LINE='GRID_LINE';V.LEGEND='LEGEND';V.CATEGORY_AXIS='CATEGORY_AXIS';V.CATEGORY_AXIS_TITLE='CATEGORY_AXIS_TITLE';V.CATEGORY_AXIS2='CATEGORY_AXIS2';V.CATEGORY_AXIS2_TITLE='CATEGORY_AXIS2_TITLE';V.VALUE_AXIS='VALUE_AXIS';V.VALUE_AXIS_TITLE='VALUE_AXIS_TITLE';V.VALUE_AXIS2='VALUE_AXIS2';V.VALUE_AXIS2_TITLE='VALUE_AXIS2_TITLE';V.DATA_POINT='DATA_POINT';V.DATA_POINT_MARKER='DATA_POINT_MARKER';V.DATA_LABEL='DATA_LABEL';V.LINE='LINE';V.COMBINATION_LINE='COMBINATION_LINE';V.ROW_AXIS='ROW_AXIS';V.ROW_AXIS_TITLE='ROW_AXIS_TITLE';V.COLUMN_AXIS='COLUMN_AXIS';V.COLUMN_AXIS_TITLE='COLUMN_AXIS_TITLE';V.ROW_AXIS2='ROW_AXIS2';V.ROW_AXIS2_TITLE='ROW_AXIS2_TITLE';V.COLUMN_AXIS2='COLUMN_AXIS2';V.COLUMN_AXIS2_TITLE='COLUMN_AXIS2_TITLE';V.TRELLIS_PLOT_AREA='TRELLIS_PLOT_AREA';V.DIMENSION_LABEL='DIMENSION_LABEL';V.prototype.type=function(v){if(arguments.length>0){this._type=v;return this;}else{return this._type;}};V.prototype.context=function(v){if(arguments.length>0){this._context=v;if(U.isArray(this._measureNames)){this._dimensionContext=this._filterDimensionContext(this._measureNames.concat('_id'));}return this;}else{return this._context;}};V.prototype.dimensionContext=function(){return this._dimensionContext;};V.prototype.getDimensionContext=function(){if(this._selectAllData){return undefined;}if(this._seriesData){for(var i in this._seriesData){if(this._seriesData.hasOwnProperty(i)){return this._seriesData;}}return undefined;}return this._dimensionContext;};V.prototype._filterDimensionContext=function(a){var r;for(var k in this._context){if(!r){r={};}var b=true;for(var i=0;i<a.length;i++){if(k===a[i]){a.splice(i,1);b=false;break;}}if(!b){continue;}r[k]=this._context[k];}return r;};V.prototype.extraContext=function(v){if(arguments.length>0){this._extraContext=v;return this;}else{return this._extraContext;}};V.prototype.stackContext=function(v){if(arguments.length>0){this._stackContext=v;return this;}else{return this._stackContext;}};V.prototype.seriesContext=function(s){if(arguments.length>0){this._seriesData=s;return this;}else{return this._seriesData;}};V.prototype.selectAllData=function(s){if(arguments.length>0){this._selectAllData=s;return this;}else{return this._selectAllData;}};return V;});define('sap/viz/controls/chart/views/ChartView',['jquery','sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/utils/FakeDataUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/chart/views/AxisSizeAdjustHelper','sap/viz/controls/chart/views/AxisSplitter','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/DataPointFinder','sap/viz/controls/chart/views/DropZone','sap/viz/controls/chart/views/EditAxisView','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/views/PropertyZone','sap/viz/controls/chart/views/View','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/common/utils/binding/BindingGeneratorFactory'],function($,F,G,C,M,a,b,L,O,u,c,D,T,V,d,f,A,g,h,l,m,E,o,P,p,I,q,r,B){var s=function(e,i,j,k){s.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.ChartView";this._morphingLayer$=null;this._supportMorphing=true;this._requestMorphing=false;this._vizMorpher=null;i=i||{};this._enablePropertyZone=false;this._useDefaultChartSizeForTrellis=i.useDefaultChartSizeForTrellis;this._createChildren(i.enableAxisSplitter);};O.extend(s,p);var S=["legend","sizeLegend"];s.prototype._createChildren=function(i){this._createChartHolder();this._createChartLayer();this._editAxisView=new E(this._chartHolder$.get(0),null);this._editAxisView.addEventListener(E.AxisScaleChanged,this._axisScalerChangedHandler,this);if(i){this._axisSplitter=new g(this._chartHolder$.get(0),$.proxy(this.properties,this),$.proxy(this._getPropertyZone,this));this._axisSplitter.addEventListener(g.AxisSplitChanged,this._axisSplitChangedHandler,this);}this._createDescriptionLayer();this._createLoadingIcon();this._createDropZone();var j=this._chartLayer$;this._propertyZone=new P(j.get(0),$.proxy(this._getPropertyZone,this));this._propertyZone.addEventListener(P.SELECT_ZONE,$.proxy(function(e){this._dispatchEvent(new h(h.SELECT_PROPERTY_ZONE,this,e.data));},this));this._uxScaleIndex=null;};s.prototype.getZoneName=function(e){if(!e||!this._chart){return null;}var z=this._getZoneName(e);if(z){if(V.isValueAxis(this._options.type,z)){return z;}else{for(var i=0;i<S.length;i++){if(S[i]===z){return z;}}}}return null;};s.prototype._getZoneName=function(e){var z=this._getPropertyZone();for(var i=0;i<z.length;i++){var j=z[i].bound;var k=z[i].name;for(var n=0;n<j.length;n++){if(j[n][0][0]<e.x&&j[n][1][0]>e.x&&j[n][1][1]<e.y&&j[n][2][1]>e.y){return k;}}}return null;};s.prototype.setAxisScale=function(e){if(this._chart){var i=this._options.type;this._editAxisView.show(i,e,this._chartProxy.get('properties',this._options.properties));}};s.prototype._axisScalerChangedHandler=function(e){if(!this._chart){return;}this._requestMorphing=true;this._helper.propertiesWithEvents(e.data);};s.prototype._axisSplitChangedHandler=function(e){var i=A(this._chart,this._getFeedingZone(),e.data.axisName,e.data.direction,e.data.offset);if(i){this._helper.propertiesWithEvents(i);}};s.prototype._titleText=function(v){try{if(this._chart){if(!this.properties().title){return this;}if(arguments.length>0){if(v!=this.properties().title.text){this._dispatchEvent(new h(h.TITLE_CHANGED,this,{text:v}));}return this;}else{var e=this.properties().title.text;return e;}}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(i){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+i;}};s._ZoneMap={xAxis:{text:"VIZ_COMMON_XAXIS"},xAxis2:{text:"VIZ_COMMON_XAXIS"},yAxis:{text:"VIZ_COMMON_YAXIS",rotate:true},yAxis2:{text:"VIZ_COMMON_YAXIS",rotate:true}};s._ZoneMap[F.ID_TRELLIS_COLUMN]={text:"VIZ_COMMON_COLUMNS"};s._ZoneMap[F.ID_TRELLIS_ROW]={text:"VIZ_COMMON_ROWS",rotate:true};s.prototype._isEmptyZone=function(z){if(!z||!z.bound){return true;}var e=z.bound[0];if(!e){return true;}var w=e[2][0]-e[0][0];var i=e[2][1]-e[0][1];if(w<1||i<1){return true;}return false;};s.prototype._updateTextInfo=function(z){if(!z){return;}for(var n=0;n<z.length;n++){var i=s._ZoneMap[z[n].name];if(i){z[n].text=L.get(i.text);z[n].rotate=i.rotate;}}};s.prototype.getTitleZone=function(){if(!this._chart){return[];}var e=this._options.type;var z;try{z=this._chartProxy.get('propertyZone',[]);}catch(j){return[];}var k=[];for(var i=0;i<z.length;i++){if(z[i].name=='title'){k=z[i].bound[0];break;}}return k;};s.prototype._getFeedingZone=function(){if(!this._chart){return[];}var e=this._options.type;var z;try{z=this._chartProxy.get('feedingZone',[]);}catch(j){return[];}if(!c.supportMultiChart(e)){this._updateTextInfo(z);return z;}var k=c.isMultipleChart(e);var n=null;var v=null;if(k){for(var i=z.length-1;i>=0;i--){var w=z[i].name;if(w==='multiplier'){n={name:F.ID_TRELLIS_COLUMN,bound:[z[i].bound[0]],feedDef:z[i].feedDef};v={name:F.ID_TRELLIS_ROW,bound:[z[i].bound[1]],feedDef:z[i].feedDef};z.splice(i,1);}else if(w!=="mainPlot"&&w!=="legend"){if(T.providerName(e)===T.MULTIPLE){z.splice(i,1);}}}}if(!this._enableTrellis){this._updateTextInfo(z);return z;}if(this._isEmptyZone(n)){n=null;}if(this._isEmptyZone(v)){v=null;}var x=this._padding;var y={"id":'multiplier',"name":"ChartView Multiplier","type":a.DIMENSION,"min":1,"max":1,"aaIndex":1,"acceptMND":0};var H;if(!n){H=[[[x,0],[this._size.width-x,0],[this._size.width-x,x],[0,x]]];n={"name":F.ID_TRELLIS_COLUMN,"feedDef":[y],"bound":H};}if(!v){H=[[[0,x],[x,x],[x,this._size.height-x],[0,this._size.height-x]]];v={"name":F.ID_TRELLIS_ROW,"feedDef":[y],"bound":H};}z.push(n,v);this._updateTextInfo(z);return z;};s.prototype._updateMorphingSnapshot=function(){if(this._canMorphing()&&this._hasChartInstance&&this._vizMorpher&&!this._vizMorpher.isPlaying()){this._vizMorpher.morphVizType(null,-1);}};s.prototype._setDefaultValue=function(e,j,k,v){var n=j.split('.');var w=e;for(var i=0;i<n.length;i++){w[n[i]]=w[n[i]]||{};w=w[n[i]];}if(!w.hasOwnProperty(k)){w[k]=v;}};s.prototype._applyDefaultProperties=function(e){e=e||{};e.properties=e.properties||{};this._setDefaultValue(e.properties,'background.border.left','visible',false);this._setDefaultValue(e.properties,'background.border.top','visible',false);this._setDefaultValue(e.properties,'background.border.right','visible',false);this._setDefaultValue(e.properties,'background.border.bottom','visible',false);return e;};function t(e,k,v){if(k==null||k.length===0){return 1;}var w=[];var x=1;var y=0;var z=false;for(var n=0;n<k.length;n++){if(k[n].type()===q.HIERARCHY){var H=k[n].hierarchyLevels();for(var j=0;j<H.length;j++){if(H[j].selected()){break;}y++;}}else if(k[n].type()===q.MND){z=true;continue;}if(y<e.length){var J=e[y].values;w[n]={};var K=0;for(var i=0;i<J.length;i++){if(!w[n].hasOwnProperty(J[i])){w[n][J[i]]=true;K++;}}x*=K;y++;}}if(z){x*=v;}return x;}s.prototype._getRowColumn=function(e,n){var v={row:1,column:1};if(!e||e.length===0){return v;}var w=e[0].data;if(!w||w.length===0){return v;}var x=0;var y=null;var z=null;var H=this._chartModelProvider().feedingItems();for(var i=0;i<H.length;i++){if(H[i].id()===F.ID_TRELLIS_ROW){y=H[i].values();for(var j=0;j<y.length;j++){if(y[j].type()===q.HIERARCHY){var J=y[j].hierarchyLevels();for(var k=0;k<J.length;k++){x++;if(J[k].selected()){break;}}}else if(y[j].type()!==q.MND){x++;}}}else if(H[i].id()===F.ID_TRELLIS_COLUMN){z=H[i].values();}}v.row=t(w.slice(0,x),y,n);v.column=t(w.slice(x),z,n);return v;};s.prototype._getMinSize=function(){var w=this._size.width;var e=this._size.height;var j=this._options;var k={width:w,height:e};if(!this._useDefaultChartSizeForTrellis&&c.isMultipleChart(j.type)&&T.providerName(j.type)===T.MULTIPLE){if(!j.data||!j.data.data()){return k;}var n=j.data.data().measureValuesGroup;var v=0;for(var i=0;i<n.length;i++){v+=n[i].data.length;}var x=this._getRowColumn(j.data.data().analysisAxis,v);var y=x.column*200;var z=x.row*200;if(w<y){w=y;k['overflow-x']='auto';}if(e<z){e=z;k['overflow-y']='auto';}}k.width=w;k.height=e;return k;};s.prototype._updateChartSize=function(e){var i=s.superclass._updateChartSize.apply(this,arguments);return i;};s.prototype._destroyChartInstance=function(){s.superclass._destroyChartInstance.apply(this,arguments);if(this._axisSplitter){this._axisSplitter.reset();}};s.prototype._createChartInstance=function(){this._hasChartInstance=false;var e=this._options;e=this._applyDefaultProperties(e);var i=this._chartLayer$;var j=this._descriptionLayer$;var k=this._chartHolder$;var v=e.type;this._destroyChartInstance();if(e.data===null||e.data===undefined){return;}if(!e.properties){e.properties={};}try{if(!this._enableTrellis&&c.isMultipleChart(v)){this._propertyZone.updateZone(false);return;}if(c.supportAnimation(v)){if(!e.properties.plotArea){e.properties.plotArea={};}if(!e.properties.plotArea.animation){e.properties.plotArea.animation={};}e.properties.plotArea.animation.dataLoading=e.properties.plotArea.animation.dataLoading===false?false:true;e.properties.plotArea.animation.dataUpdating=e.properties.plotArea.animation.dataUpdating===false?false:true;e.properties.plotArea.animation.resizing=e.properties.plotArea.animation.resizing===false?false:true;if(!e.properties.geoContainer){e.properties.geoContainer={};}}this._dispatchEvent(new h(h.CHART_CHANGING,this,v));var n=this._updateDescriptionByOptions(e);var w=e.properties;if(!n){var x=this._chartLayer$.css("visibility");this._chartLayer$.css("visibility","visible");this._chart=this._chartProxy.execute('sap.viz.api.core.createViz',{type:v,data:e.data,feeding:e.feeding,properties:w,css:e.css,events:e.events,container:i.get(0)});this._chartLayer$.css("visibility",x);if(this._chart){this._postVizProcess(e);}}}catch(y){var z=L.get('VIZ_CHART_CREATE_CHART_FAILED')+y;this._propertyZone.updateZone(false);if(c.isValid(v)){this._updateDescription(u.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),v));}else{this._updateDescription(z);}i.html("");this._chart=null;this._hasChartInstance=false;throw z;}};s.prototype.setCloseAnimation=function(e){$.extend(true,e,{properties:{plotArea:{animation:{dataLoading:false,dataUpdating:false,resizing:false}}}});};s.prototype._postVizProcess=function(e){var i=$.proxy(function(j,k){this._dispatchEvent(new h(h.TRIGGER_CVOM_EVENT,this,{type:j,data:k}));},this);this._chart.on("lassoStart.chartview",$.proxy(function(){if(this._axisSplitter){this._axisSplitter.deactive();}},this));this._chart.on("lassoEnd.chartview",$.proxy(function(){if(this._axisSplitter){this._axisSplitter.active();}},this));this._chart.on("initialized.chartview",$.proxy(function(j){if(this._isFeedsValid){if(this._axisSplitter){this._axisSplitter.init(e.type);}}var k=this._enablePropertyZone&&this._isFeedsValid;this._propertyZone.updateZone(k);i("initialized",j);},this));var _=this;this._chart.on("selectData.chartview",function(j){if(_._options.type!==C.TYPE_NETWORK){_._dispatchEvent(new h(h.CHANGED_SELECTED_DATA,this));i("selectData",j);}});this._chart.on("deselectData.chartview",function(j){if(_._options.type!==C.TYPE_NETWORK&&_._options.type!==C.TYPE_TREE){_._dispatchEvent(new h(h.CHANGED_SELECTED_DATA,this));i("deselectData",j);}});this._chart.on("showTooltip.chartview",function(j){i("showTooltip",j);});this._chart.on("hideTooltip.chartview",function(j){i("hideTooltip",j);});this._chart.on('contextualData.chartview',$.proxy(function(j){this._dispatchEvent(new h(h.CONTEXT_MENU_TRIGGERED,this,j));},this));this._hasChartInstance=true;this._dispatchEvent(new h(h.CHART_CHANGED,this,this._chart));s.superclass._postVizProcess.apply(this,arguments);};s.prototype.getTemplateId=function(e){var i=e||this.data();if(V.hasFakeData(i)){return p.TEMPLATE_INCOMPLETE;}else{return this._templateId;}};s.prototype.size=function(e){if(arguments.length>0){s.superclass.size.apply(this,arguments);if(this._dropZone){this._dropZone.size(this._size);}this._propertyZone.size(this._size);return this;}else{return s.superclass.size.apply(this,arguments);}};s.prototype.data=function(e,i){if(arguments.length>0){if(!i){this._requestMorphing=true;}}return s.superclass.data.apply(this,arguments);};s.prototype.feeding=function(e,i){try{if(this._chart){if(arguments.length>0){if(!i){this._requestMorphing=true;}this._options.feeding=e;this._chartProxy.set('feeding',e);return this;}else{return this._chartProxy.get('feeding',this._options.feeding);}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(j){throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+j;}};s.prototype.css=function(e,i){try{if(arguments.length>0){if(!i){this._requestMorphing=false;}this._updateCssCacheByNewCss(e);this._options.css=e;if(this._chart){this._chartProxy.set('css',e);return this;}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{return this._chartProxy.get('css',this._options.css);}}catch(j){throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+j;}};s.prototype.properties=function(e,i){try{if(arguments.length>0){if(!i&&this._needMorphing(e)){this._requestMorphing=true;}this._options.properties=e;if(this._chart){this._chartProxy.set('properties',e);return this;}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{return this._chartProxy.get('properties',this._options.properties);}}catch(j){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+j;}};s.prototype.update=function(e,i){if(!i){this._requestMorphing=true;}return s.superclass.update.apply(this,arguments);};s.prototype.feedingZone=function(){try{if(this._chart){return this._chartProxy.get('feedingZone',[]);}else{throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(e){throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+e;}};s.prototype._getPropertyZone=function(){if(!this._chart){return[];}var z;try{z=this._chartProxy.get('propertyZone',[]);}catch(e){return[];}return z;};s.prototype.enablePropertyZone=function(v){if(arguments.length>0){if(this._enablePropertyZone!==v){this._enablePropertyZone=(v===true);var e=this._enablePropertyZone&&this._isFeedsValid;this._propertyZone.updateZone(e);}return this;}else{return this._enablePropertyZone;}};s.prototype._getCategoryAxisScale=function(e){var j=null;var k=V.getCategoryAxis(e);if(k){j=[];for(var i=0;i<k.length;i++){j.push(k[i]+".maxSizeRatio");}}return j;};s.prototype.resetProperties=function(e,v){if(this._options&&this._options.type){var i=this._options.type;V.convertValueAxisScale(e,i,v);var j=this._getCategoryAxisScale(i);if(j&&j.length>0){V.removeProperties(e,j);}}return e;};s.prototype.copyData=function(e,i){var j=new sap.viz.api.data.CrosstableDataset();j.data(u.clone(i.data()));j.info(u.clone(i.info('additionalData')));return j;};s.prototype.buildFeedings=function(e,i,j){if(i&&!c.isEmptyData(e,i)){var k=B.create(e);var n=k.generate(j);if(V.hasFakeData(i)||b.isEmptyFeeds(j)){n=d.buildFakeFeeding(e,n,$.extend(true,{},i.data()));}return n;}};s.prototype.getDataPointsPosition=function(e){return l.findDataPointsPosition(e);};s.prototype.getPropertyZones=function(){return[new r(r.CHART_AREA)];};s.prototype.updateCss=function(e,i){var j;if(e.directionChanged&&i){j=i.replace(new RegExp('xAxis','gm'),'0Axis');j=j.replace(new RegExp('yAxis','gm'),'xAxis');j=j.replace(new RegExp('0Axis','gm'),'yAxis');}return j;};s.prototype.updatePropertyForPropertyZoneInteraction=function(e,i){if(i){e=e||{};e.interaction=e.interaction||{};e.interaction.selectability=e.interaction.selectability||{};e.interaction.selectability.plotLassoSelection=false;e.interaction.selectability.mode="none";e.tooltip=e.tooltip||{};e.tooltip.visible=false;}return e;};s.prototype.getValidProperties=function(e,i){var v=V.getValidProperties(e,i);if(v&&c.isMultipleChart(i)){if(v.xAxis&&v.xAxis.gridline&&v.xAxis.gridline.visible){v.xAxis.gridline.visible=false;}if(v.yAxis&&v.yAxis.gridline&&v.yAxis.gridline.visible){v.yAxis.gridline.visible=false;}}return v;};return s;});define('sap/viz/controls/chart/adapters/InteractionAdapter',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/chart/views/ChartEvent'],function($,O,u,E,V,C){var I=function(h){I.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.chart.adapters.InteractionAdapter';this._helper=h;var s=true;this._helper.vizOn('selectPropertyZone',$.proxy(function(e){s=true;this._selectPropertyZoneHandler(e);},this));this._helper.vizOn('deselectPropertyZone',$.proxy(function(e){s=false;u.defer($.proxy(function(){if(!s){this._selectPropertyZoneHandler(e);}},this));},this));this._propertyZones=null;};O.extend(I,E);var _={'dataPoint':V.DATA_POINT,'dataPointMarker':V.DATA_POINT_MARKER,'title':V.CHART_TITLE,'plotArea':V.PLOT_AREA,'legend':V.LEGEND,'axis.category':V.CATEGORY_AXIS,'axisTitle.category':V.CATEGORY_AXIS_TITLE,'axis.category2':V.CATEGORY_AXIS2,'axisTitle.category2':V.CATEGORY_AXIS2_TITLE,'axis.value':V.VALUE_AXIS,'axisTitle.value':V.VALUE_AXIS_TITLE,'axis.value2':V.VALUE_AXIS2,'axisTitle.value2':V.VALUE_AXIS2_TITLE,'chart':V.CHART_AREA,'dataLabel':V.DATA_LABEL,'dataLine':V.LINE,'combinationDataLine':V.COMBINATION_LINE,'gridline':V.GRID_LINE,'trellisPlotArea':V.TRELLIS_PLOT_AREA,'trellisRowAxis':V.ROW_AXIS,'trellisRowAxisTitle':V.ROW_AXIS_TITLE,'trellisColumnAxis':V.COLUMN_AXIS,'trellisColumnAxisTitle':V.COLUMN_AXIS_TITLE,'trellisRowAxis2':V.ROW_AXIS2,'trellisRowAxisTitle2':V.ROW_AXIS2_TITLE,'trellisColumnAxis2':V.COLUMN_AXIS2,'trellisColumnAxisTitle2':V.COLUMN_AXIS2_TITLE,'dimensionLabel':V.DIMENSION_LABEL};var a=u.invert(_);I.prototype._getPropertyZones=function(){var s=this._helper.selectedPropertyZone();if(!s){return[];}var t=s.type;if(t==='axisItem'){t='axis';}var p=null;var f=t+(s.subType?'.'+s.subType:'');if(_[f]){p=_[f];}else{}var z=[];var m=this._helper.vizData().measures();if(s.data&&s.data.length>0){s.data.forEach(function(c,i){var b=new V(p,c,s.extraData?s.extraData[i]:undefined,m);var d=s.stackData?s.stackData[i]:null;if(d){b.stackContext(d);}var e=s.seriesData?s.seriesData:null;if(e){b.seriesContext(e);}if(s.selectAllData){b.selectAllData(s.selectAllData);}z.push(b);});}else{z.push(new V(p));}return z;};I.prototype._selectPropertyZoneHandler=function(e){this._propertyZones=this._getPropertyZones();u.defer(function(){this._dispatchEvent(new C(C.PROPERTY_ZONES_CHANGED,this,{'propertyZones':this._propertyZones}));}.bind(this));};I.prototype.propertyZones=function(v){if(arguments.length>0){this._propertyZones=v;var t=null;v=v||[];v.forEach(function(b){var c=a[b.type()];if(!c){return;}t=t||{};t.data=t.data||[];var d=c.split('.');t.type=d[0];if(d.length>1){t.subType=d[1];}if(b.context()){t.data.push(b.context());}});if(t){this._helper.selectedPropertyZone(t);}else{this._helper.selectedPropertyZone(null);}return this;}else{var z=this._getPropertyZones();if((this._helper.vizType()==='info/donut'||this._helper.vizType()==='info/pie')&&this._propertyZones&&this._propertyZones[0]&&this._propertyZones[0].type()===V.DATA_POINT){if(this._propertyZones[0].extraContext()===undefined&&this._propertyZones[0].context()){return z;}else{return this._propertyZones;}}else{if(!z||z.length===0){return this._propertyZones;}else{return z;}}}};return I;});define('sap/viz/controls/plugins/infochart/interaction/DesignTimeUtils',['sap/viz/controls/common/utils/Utils'],function(U){var _={};var C='v-stack';function h(n,c){if(!n||!n.getAttribute){return false;}var d=n.getAttribute('class')||"";return(' '+d+' ').indexOf(' '+c+' ')>=0;}function f(c,s,E){var n=s;while(n!==E&&!h(n,c)&&n.parentNode){n=n.parentNode;}return n===E?null:n;}function a(n,c){if(!n.childNodes||!n.childNodes[0]){return false;}for(var d in n.childNodes){if(h(n.childNodes[d],c)){return true;}}return false;}function b(n){return h(n,"v-m-root")?n:n.parentNode;}_.hasClass=h;_.findAncestor=f;_.hasChild=a;_.findParent=b;_.getAxisModules=function(m){var c=["xAxis","xAxis2","yAxis","yAxis2"];var d=[];c.forEach(function(n,i){n="main."+n;if(m[n]){d.push(m[n]);}});return d;};if(sap.viz.framework&&sap.viz.framework.common&&sap.viz.framework.common.util&&sap.viz.framework.common.util.RuleUtil){_.RuleUtil=sap.viz.framework.common.util.RuleUtil;delete sap.viz.framework;}_.matchCtx=function(c,t){if(_.RuleUtil&&_.RuleUtil.matchCondition){var d=U.clone(c);var g=U.clone(t);if(g&&g.or){return g.or.every(function(e){return _.RuleUtil.matchCondition(e,d);});}else{return _.RuleUtil.matchCondition(g,d);}}else{var i=true;for(var k in c){if(c.hasOwnProperty(k)){if(!t.hasOwnProperty(k)||t[k]!==c[k]){i=false;break;}}}return i;}};_.featureClassesMap={'plotArea':'v-plot-bound','dataPoint':'v-datapoint','dataPointMarker':'v-datapoint-marker','stack':'v-stack','dataLine':'v-lines','legend':'v-m-legendGroup','title':'v-m-title','axis':'v-m-axisBody','axisItem':'v-axis-item','axisTitle':'v-m-axisTitle','chart':'v-m-root','gridline':'v-gridline-group','dataLabel':'v-datalabel','trellisPlotArea':'v-trellis-plot-bound','trellisRowAxis':'v-m-axis-position-bound v-gridcontainer-left','trellisRowAxis2':'v-m-axis-position-bound v-gridcontainer-right','trellisRowAxisTitle':"v-title viz-axis-title v-trellistitle-left",'trellisRowAxisTitle2':"v-title viz-axis-title v-trellistitle-right",'trellisColumnAxis':'v-m-axis-position-bound v-gridcontainer-bottom','trellisColumnAxis2':'v-m-axis-position-bound v-gridcontainer-top','trellisColumnAxisTitle':"v-title viz-axis-title v-trellistitle-bottom",'trellisColumnAxisTitle2':"v-title viz-axis-title v-trellistitle-top",'dimensionLabel':'v-treemapdimensionlabel',_unselectables:['v-gridline-group'],_clz2NameMap:undefined,_allClzs:undefined,_init:function(){var v;if(!this._name2ClzMap){this._clz2NameMap={};this._allClzs=[];for(var k in this){if(this.hasOwnProperty(k)&&typeof(v=this[k])==='string'){this._allClzs.push(v);this._clz2NameMap[v]=k;}}}},clz2Name:function(c){this._init();return this._clz2NameMap[c];},allClzs:function(){this._init();return this._allClzs;},featureClass:function(n){n=n[0]||n;var c=this.allClzs();for(var i=-1;++i<c.length;){if(h(n,c[i])){return c[i];}}},isSelectable:function(n){n=n[0]||n;var c=this.featureClass(n);return this._unselectables.indexOf(c)===-1;},isMultiselectable:function(n){n=n[0]||n;var c=this.featureClass(n);return[this.dataLabel,this.dataPoint,this.axisItem,this.dimensionLabel].indexOf(c)>-1;},targetPattern:function(n){if(!this[n]){throw"Can't find class for "+n;}return"(\\s+|^)"+this[n]+"(\\s+|$)";},allSelectableTargetsPattern:function(){var c=this.allClzs(),d=[];for(var i=-1;++i<c.length;){if(c[i]!==this.chart&&this._unselectables.indexOf(c[i])<0){d.push(c[i]);}}return"(\\s+|^)("+d.join('|')+")(\\s+|$)";}};_.axisSubType=function(n){var c=f('v-axis',n).parentNode,d=c.getAttribute('class'),g=/\sv-m-(\S\S+)Axis(\d*)\s/.exec(' '+d+' ');return g&&g.length>0?g.slice(1,3).join(""):null;};_.typesOfUnit=function(c,u){var t,s;t=this.featureClassesMap.clz2Name(c);if(!t){throw'unknow class: '+c;}if(t==='axis'||t==='axisItem'||t==='axisTitle'){s=this.axisSubType(u);}return[t,s];};_.getStackData=function(u){var s=[];var p,c,d,k;for(var i=0;i<u.length;i++){p=u[i].parentNode;if(_.featureClassesMap.featureClass(p)===C){c=this.getExtraData(p);if(!c){continue;}s[i]=c;}}return s;};_.getData=function(n){return n["__data__"];};_.getExtraData=function(n){return n["__extra_data__"];};_.getCorrectCombinationType=function(d,t){var r=t;if(d&&d.getAttribute("combination-marker")==="true"){r="dataPointMarker";}else if(d&&d.getAttribute("combination-line")==="true"){r="combinationDataLine";}else{}return r;};_.constructEventData=function(u,c,s){if(!u||u.length===0){return null;}var t,d,e,g=[],k,l,m=[],n,o,p=this.featureClassesMap.featureClass(u[0]),q;t=this.typesOfUnit(p,u[0]);d=t[0];if(u&&u.length>0){d=_.getCorrectCombinationType(u[0],d);}e=t[1];for(var i=-1;++i<u.length;){k=d3.select(u[i]).datum();if(!k){break;}if(p==='v-axis-item'){k=k.ctx;}l={};for(q in k){if(k.hasOwnProperty(q)){l[q]=k[q];}}g.push(l);o={};n=_.getExtraData(u[i]);if(n){for(q in n){if(n.hasOwnProperty(q)){o[q]=n[q];}}}m.push(o);}var r={type:d,subType:e,data:g,extraData:m};if(p==='v-datapoint'||p==="v-datapoint-marker"){var v=_.getStackData(u);if(v.length>0){r.stackData=v;}}if(c&&c.isBySeries){var w={};for(var j=0;j<c.seriesBindings.length;j++){w[c.seriesBindings[j]]=g[0][c.seriesBindings[j]];}r.seriesData=w;}if(s&&r.data.length){r.selectAllData=true;}return r;};return _;});define('sap/viz/controls/chart/adapters/renderer/RendererInfoBase',['jquery','require','sap/viz/controls/common/utils/Utils',"sap/viz/controls/plugins/infochart/interaction/DesignTimeUtils","sap/viz/controls/common/constants/ChartConst"],function($,r,U,D,C){var R=function(i,v){this.implClassPath='sap/viz/controls/chart/adapters/renderer/RendererInfoBase';this.id=i;this.vizPath=v;this.generator=null;this._parameters=[];this._fallbackParas=null;};R.prototype.parameters=function(v){if(arguments.length>0){this._parameters=v;return this;}else{return this._parameters;}};R.prototype.updateParameters=function(m,k){if(m&&m.length>0&&this._parameters&&this._parameters.length>0){var t=[];this._parameters.forEach(function(p){if(p){if(p.hasOwnProperty("ctx")){if(p.ctx){var a=p.ctx.measureNames;if(a){var f=m.some(function(b){return b===a;});if(f){t.push(p);}}else{if(k){t.push(p);}}}else{t.push(p);}}else{t.push(p);}}});this.parameters(t);}};R.prototype.fallbackParas=function(){return this._fallbackParas;};R.prototype.simplify=function(){var a=[];var b=false;this._iterate('general',$.proxy(function(p){if(this._renderGeneral(p.paras)){b=true;a.push(p);}else{this._fallbackParas=p.paras;}},this));this._iterate('specified',$.proxy(function(p){if(b||this._renderSpecified(p.paras)){a.push(p);}},this));return a;};R.prototype._updatePropsAll=function(c,k,v){var p=this._parameters,a;for(var i=0;i<p.length;i++){if(U.deepEqual(p[i].ctx,c)){p[i].paras[k]=v;a=true;}}return a;};R.prototype._updatePropsGeneral=function(c,k,v){var a,b;if(c){var p=this._parameters,d;p.some(function(f){if(R._compareCtx(f.ctx,c)){d=f.paras;return true;}});if(d){a=U.clone(d);}else{var e;for(var i=0,l=p.length;i<l;i++){var f=p[i];if(!f.ctx){e=f.paras;}}if(e){a=U.clone(e);}}}a=a||{};a[k]=v;this._parameters.push({'ctx':c,'paras':a});b=true;};R.prototype._updatePropsSpecified=function(c,k,v){var p=this._parameters;for(var i=0;i<p.length;i++){if(!U.deepEqual(p[i].ctx,c)&&R._compareCtx(c,p[i].ctx)){p[i].paras[k]=v;}}if(!c){for(var j=0;j<p.length;j++){p[j].paras[k]=v;}}};R.prototype._mergeAndAddSeriesProps=function(c,k,v){var p=this._parameters,a,b;for(var i=0;i<p.length;i++){if(!R._compareCtx(c,p[i].ctx)&&!R._compareCtx(p[i].ctx,c)&&U.hasCommonKeyValue(c,p[i].ctx)){a=U.updateJSON(p[i].ctx,c);var d=R._contextLength(a);if(d>R._contextLength(c)&&d>R._contextLength(p[i].ctx)){var o={};o[k]=v;b=U.updateJSON(p[i].paras,o);this._parameters.push({'ctx':a,'paras':b});}}}};R._contextLength=function(c){var l=0;if(c){for(var i in c){if(c.hasOwnProperty(i)){l++;}}}return l;};R.prototype.setProperty=function(c,k,v){var i=false;i=this._updatePropsAll(c,k,v);if(!i){this._updatePropsGeneral(c,k,v);}this._updatePropsSpecified(c,k,v);this._mergeAndAddSeriesProps(c,k,v);};function g(o,c){if(o==null){return 0;}if(o[C.KEY_COUNT]){return o[C.KEY_COUNT];}var l;if(o.or){l=Object.keys(o.or[0]).length/o.or.length;}else{l=Object.keys(o).length;}if(c&&Object.defineProperty){Object.defineProperty(o,C.KEY_COUNT,{value:l});}return l;}R.prototype._sortParameters=function(){this._parameters.sort(function(p,a){return g(a.ctx,true)-g(p.ctx,true);});};R.prototype.getProperty=function(c,k){this._sortParameters();var p=this._parameters,f=[];p.some(function(a){if(R._compareCtx(a.ctx,c)){f.push(a.paras[k]);return true;}});if(f.length){return f[0];}if(p[p.length-1].ctx===undefined){return p[p.length-1].paras[k];}return undefined;};R.prototype.getMergedProperties=function(k,d){return R._getMergedProperties(this._parameters.slice(0),k,d);};R._getMergedProperties=function(p,k,d){if(!k){return{};}return p.reduce(function(m,a){if(k.length===0){return m;}var b=a.paras;k=k.filter(function(c){if(b[c]===undefined){b[c]=d[c];}if(m[c]===undefined){m[c]=b[c];}else if(!U.deepEqual(m[c],b[c])){m[c]=null;return false;}return true;});return m;},{});};R.prototype.getProperties=function(c,k,s){var p=this._parameters,f;if(!k){return{};}if(s!==true){this._sortParameters();p=this._parameters;}p.some(function(a){if(R._compareCtx(a.ctx,c)){f=k.reduce(function(o,b){o[b]=a.paras[b];return o;},{});return true;}});if(f){return f;}if(p&&p.length>0&&p[p.length-1].ctx===undefined){var a=p[p.length-1];f=k.reduce(function(o,b){o[b]=a.paras[b];return o;},{});}if(f){return f;}return{};};R.prototype.toJSON=function(){return{'id':this.id,'vizPath':this.vizPath,'generator':this.generator,'parameters':this._parameters,'implClassPath':this.implClassPath};};R.fromJSON=function(j){var c=r(j.implClassPath);return new c(j.id,j.vizPath).parameters(j.parameters);};R.prototype._renderGeneral=function(p){return true;};R.prototype._renderSpecified=function(p){return true;};R.prototype._iterate=function(t,c,a){this._parameters.forEach(function(p,i,b){if(t==='all'){c(p);}else if(t==='general'){if(!p.ctx||R._compareCtx(p.ctx,a)){c(p);}}else if(t==='specified'&&p.ctx){c(p);}});};R._compareCtx=function(c,a){return D.matchCtx(c,a);};R.prototype.isConflict=function(p,a,b){var i=false;var _=this;this._iterate('all',function(c){if(_._ignoreKey(a,c.paras,p)){return;}else{if(c.paras[b]!==p[a]){i=true;}}});return i;};R.prototype._ignoreKey=function(p,a,b){return false;};return R;});define('sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var D=function(i,v){D.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo';this.generator='dataLabelRenderer';};O.extend(D,R);function c(p){return p.iconVisible===true||(p.textVisible===false&&p.legendVisible===false);}D.prototype._renderGeneral=function(p){if(c(p)){return true;}else{return false;}};D.prototype._renderSpecified=function(p){if(c(p)){return true;}else{return p.fontFamily!==undefined||p.fontSize!==undefined||p.fontWeight!==undefined||p.fontColor!==undefined||p.fontStyle!==undefined;}};D.prototype._ignoreKey=function(p,a,b){switch(p){case'textVisible':if(b.textVisible===undefined){if(a.textVisible===b.dataLabelVisible){return true;}}break;case'legendVisible':if(b.legendVisible===undefined){return true;}break;case'iconVisible':if(b.iconVisible===undefined){return true;}break;case'type':if(b.type===undefined){return true;}break;case'fontFamily':if(a.fontFamily===undefined){return true;}break;case'fontSize':if(a.fontSize===undefined){return true;}break;case'fontWeight':if(a.fontWeight===undefined){return true;}break;case'fontColor':if(a.fontColor===undefined){return true;}break;case'fontStyle':if(a.fontStyle===undefined){return true;}break;}return false;};return D;});define('sap/viz/controls/chart/adapters/config/DataLabelPropConfig',['sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo'],function(D){var a={};var _=function(p){return{'id':'plotArea.dataLabel.renderer','infoClass':D,'vizPath':'plotArea.dataLabel.renderer','paraName':p};};a.instance=function(){return{'dataLabelVisible':{'vizPath':'plotArea.dataLabel.visible'},'textVisible':{'renderer':_('textVisible')},'fontFamily':{'renderer':_('fontFamily'),'vizPath':'plotArea.dataLabel.style.fontFamily'},'fontSize':{'renderer':_('fontSize'),'vizPath':'plotArea.dataLabel.style.fontSize'},'fontWeight':{'renderer':_('fontWeight'),'vizPath':'plotArea.dataLabel.style.fontWeight'},'fontColor':{'renderer':_('fontColor'),'vizPath':'plotArea.dataLabel.style.color'},'fontStyle':{'renderer':_('fontStyle'),'vizPath':'plotArea.dataLabel.style.fontStyle'},'iconVisible':{'renderer':_('iconVisible')},'iconSVG':{'renderer':_('iconSVG')},'iconColor':{'renderer':_('iconColor')},'iconFillColor':{'renderer':_('iconFillColor')},'iconSize':{'renderer':_('iconSize')},'iconRotateAngle':{'renderer':_('iconRotateAngle')},'legendVisible':{'renderer':_('legendVisible')},'type':{'vizPath':'plotArea.dataLabel.type'},};};return a;});define('sap/viz/controls/chart/adapters/renderer/StackDecoratorInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var S=function(i,v){S.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/StackDecoratorInfo';this.generator='stackDecorator';};O.extend(S,R);S.prototype._renderSpecified=function(p){if(p.stackShape){return true;}else{return false;}};return S;});define('sap/viz/controls/chart/adapters/renderer/BarShapeRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var B=function(i,v){B.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/BarShapeRendererInfo';this.generator='barShapeRenderer';};O.extend(B,R);B.prototype._renderGeneral=function(p){if(p.dataPointShape||p.dataPointShapeFill||p.dataPointShapeRenderer){return true;}else{return false;}};B.prototype._renderSpecified=function(p){if(p.dataPointShape||p.dataPointShapeFill||p.dataPointShapeRenderer){return true;}else{return false;}};return B;});define('sap/viz/controls/chart/adapters/renderer/StackedBarShapeRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var S=function(i,v){S.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/StackedBarShapeRendererInfo';this.generator='stackedBarShapeRenderer';};O.extend(S,R);S.prototype._renderGeneral=function(p){if(p.dataPointShape||p.dataPointShapeFill||p.dataPointShapeRenderer){return true;}else{return false;}};S.prototype._renderSpecified=function(p){if(p.dataPointShape||p.dataPointShapeFill||p.dataPointShapeRenderer){return true;}else{return false;}};return S;});define('sap/viz/controls/chart/adapters/renderer/PieDataPointRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var P=function(i,v){P.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/PieDataPointRendererInfo';this.generator='pieSliceRenderer';};O.extend(P,R);P.prototype._renderGeneral=function(p){if(p.sliceShape){return true;}else{return false;}};P.prototype._renderSpecified=function(p){if(p.sliceShape){return true;}else{return false;}};return P;});define('sap/viz/controls/chart/adapters/renderer/LineDataPointRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var L=function(i,v){L.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/LineDataPointRendererInfo';this.generator='lineMarkerRenderer';};O.extend(L,R);L.prototype._renderGeneral=function(p){if(p.iconSVG||p.iconColor||p.iconSize){return true;}else{return false;}};L.prototype._renderSpecified=function(p){if(p.iconSVG||p.iconColor||p.iconSize){return true;}else{return false;}};return L;});define('sap/viz/controls/chart/adapters/renderer/ScatterDataPointRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var S=function(i,v){S.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/ScatterDataPointRendererInfo';this.generator='scatterMarkerRenderer';};O.extend(S,R);S.prototype._renderGeneral=function(p){if(p.iconSVG||p.iconColor||p.iconSize){return true;}else{return false;}};S.prototype._renderSpecified=function(p){if(p.iconSVG||p.iconColor||p.iconSize){return true;}else{return false;}};return S;});define('sap/viz/controls/chart/adapters/renderer/BubbleDataPointRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var B=function(i,v){B.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/BubbleDataPointRendererInfo';this.generator='bubbleMarkerRenderer';};O.extend(B,R);B.prototype._renderGeneral=function(p){if(p.iconSVG||p.iconColor||p.iconSize){return true;}else{return false;}};B.prototype._renderSpecified=function(p){if(p.iconSVG||p.iconColor||p.iconSize){return true;}else{return false;}};return B;});define('sap/viz/controls/chart/adapters/renderer/CombinationDataPointRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var C=function(i,v){C.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/CombinationDataPointRendererInfo';this.generator='combinationDataPointRenderer';};O.extend(C,R);C.prototype._renderGeneral=function(p){if(p.dataPointShape||p.dataPointShapeFill||p.dataPointShapeRenderer||p.iconSVG||p.iconColor||p.iconSize){return true;}else{return false;}};C.prototype._renderSpecified=function(p){if(p.dataPointShape||p.dataPointShapeFill||p.dataPointShapeRenderer||p.iconSVG||p.iconColor||p.iconSize){return true;}else{return false;}};return C;});define('sap/viz/controls/chart/adapters/renderer/LegendPostRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var L=function(i,v){L.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/LegendPostRendererInfo';this.generator='legendPostRenderer';};O.extend(L,R);L.prototype._renderGeneral=function(p){if(p.legendItemColorFill||p.legendItemShape){return true;}return false;};L.prototype._renderSpecified=function(p){if(p.legendItemColorFill||p.legendItemShape){return true;}return false;};return L;});define('sap/viz/controls/chart/adapters/config/DataPointPropConfig',['sap/viz/controls/chart/adapters/renderer/StackDecoratorInfo','sap/viz/controls/chart/adapters/renderer/BarShapeRendererInfo','sap/viz/controls/chart/adapters/renderer/StackedBarShapeRendererInfo','sap/viz/controls/chart/adapters/renderer/PieDataPointRendererInfo','sap/viz/controls/chart/adapters/renderer/LineDataPointRendererInfo','sap/viz/controls/chart/adapters/renderer/ScatterDataPointRendererInfo','sap/viz/controls/chart/adapters/renderer/BubbleDataPointRendererInfo','sap/viz/controls/chart/adapters/renderer/CombinationDataPointRendererInfo','sap/viz/controls/chart/adapters/renderer/LegendPostRendererInfo'],function(S,B,a,P,L,b,c,C,d){var D={};var _=function(p){return{'id':'plotArea.markerRenderer.barShapeRenderer','infoClass':B,'vizPath':'plotArea.markerRenderer','paraName':p};};var e=function(p){return{'id':'plotArea.markerRenderer.stackedBarShapeRenderer','infoClass':a,'vizPath':'plotArea.markerRenderer','paraName':p};};var f=function(p){return{'id':'plotArea.stackDecorator.stackDecorator','infoClass':S,'vizPath':'plotArea.stackDecorator','useStackContext':true,'paraName':p};};var g=function(p){return{'id':'plotArea.sliceRenderer.pieSliceRenderer','infoClass':P,'vizPath':'plotArea.sliceRenderer','paraName':p};};var h=function(p){return{'id':'plotArea.markerRenderer.lineMarkerRenderer','infoClass':L,'vizPath':'plotArea.markerRenderer','paraName':p};};var i=function(p){return{'id':'plotArea.markerRenderer.scatterMarkerRenderer','infoClass':b,'vizPath':'plotArea.markerRenderer','paraName':p};};var j=function(p){return{'id':'plotArea.markerRenderer.bubbleMarkerRenderer','infoClass':c,'vizPath':'plotArea.markerRenderer','paraName':p};};var k=function(p){return{'id':'plotArea.markerRenderer.dataPointRenderer','infoClass':C,'vizPath':'plotArea.markerRenderer','paraName':p};};var l=function(p){return{'id':'legend.postRenderer.syncSeriesRenderer','infoClass':d,'vizPath':'legend.postRenderer','paraName':p};};D.instance=function(m,n){return{'line.iconSVG':{'renderer':n?k('iconSVG'):h('iconSVG')},'line.iconColor':{'renderer':n?k('iconColor'):h('iconColor')},'line.iconFillColor':{'renderer':n?k('iconFillColor'):h('iconFillColor')},'line.iconSize':{'renderer':n?k('iconSize'):h('iconSize')},'line.iconRotateAngle':{'renderer':n?k('iconRotateAngle'):h('iconRotateAngle')},'dataPointShape':{'renderer':(function(){if(m){return e("dataPointShape");}else if(n){return k("dataPointShape");}else{return _('dataPointShape');}}())},'dataPointRotateAngle':{'renderer':(function(){if(m){return e("dataPointRotateAngle");}else if(n){return k("dataPointRotateAngle");}else{return _('dataPointRotateAngle');}}())},'stackShape':{'renderer':f('stackShape')},'dataPointShapeFill':{'renderer':(function(){if(m){return e("dataPointShapeFill");}else if(n){return k("dataPointShapeFill");}else{return _('dataPointShapeFill');}}())},'dataPointShapeFillColor':{'renderer':(function(){if(m){return e("dataPointShapeFillColor");}else if(n){return k("dataPointShapeFillColor");}else{return _('dataPointShapeFillColor');}}())},'legendItemColorFill':{'renderer':(function(){return l('legendItemColorFill');}())},'legendItemShape':{'renderer':(function(){return l('legendItemShape');}())},'dataPointShapeRenderer':{'renderer':(function(){if(m){return e("dataPointShapeRenderer");}else if(n){return k("dataPointShapeRenderer");}else{return _('dataPointShapeRenderer');}}())},'sliceShape':{'renderer':g('sliceShape')},'sliceShapeFill':{'renderer':g('sliceShapeFill')},'scatter.iconSVG':{'renderer':i('iconSVG')},'scatter.iconColor':{'renderer':i('iconColor')},'scatter.iconSize':{'renderer':i('iconSize')},'bubble.iconSVG':{'renderer':j('iconSVG')},'bubble.iconColor':{'renderer':j('iconColor')},'bubble.iconSize':{'renderer':j('iconSize')},'centerName.fontFamily':{'vizPath':'plotArea.highlight.centerName.style.fontFamily'},'centerName.fontSize':{'vizPath':'plotArea.highlight.centerName.style.fontSize'},'centerName.fontWeight':{'vizPath':'plotArea.highlight.centerName.style.fontWeight'},'centerName.fontColor':{'vizPath':'plotArea.highlight.centerName.style.color'},'centerName.fontStyle':{'vizPath':'plotArea.highlight.centerName.style.fontStyle'},'centerValue.fontFamily':{'vizPath':'plotArea.highlight.centerValue.style.fontFamily'},'centerValue.fontSize':{'vizPath':'plotArea.highlight.centerValue.style.fontSize'},'centerValue.fontWeight':{'vizPath':'plotArea.highlight.centerValue.style.fontWeight'},'centerValue.fontColor':{'vizPath':'plotArea.highlight.centerValue.style.color'},'centerValue.fontStyle':{'vizPath':'plotArea.highlight.centerValue.style.fontStyle'}};};return D;});define('sap/viz/controls/chart/adapters/config/ChartTitlePropConfig',[],function(){var C={};C.instance=function(){return{'fontFamily':{'vizPath':'title.style.fontFamily'},'fontSize':{'vizPath':'title.style.fontSize'},'fontWeight':{'vizPath':'title.style.fontWeight'},'fontColor':{'vizPath':'title.style.color'},'fontStyle':{'vizPath':'title.style.fontStyle'}};};return C;});define('sap/viz/controls/chart/adapters/config/ChartAreaPropConfig',[],function(){var C={};C.instance=function(){return{'fill':{'vizPath':'general.background.color'}};};return C;});define('sap/viz/controls/chart/adapters/config/PlotAreaPropConfig',[],function(){var P={};P.instance=function(){return{'fill':{'vizPath':'plotArea.background.color'}};};return P;});define('sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var C=function(i,v){C.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo';this.generator='categoryAxisLabelRenderer';};O.extend(C,R);C.prototype._renderGeneral=function(p){if(p.iconVisible===true||p.textVisible===false){return true;}else{return false;}};C.prototype._renderSpecified=function(p){if(p.iconVisible===true||p.textVisible===false){return true;}else{return p.fontFamily!==undefined||p.fontSize!==undefined||p.fontWeight!==undefined||p.fontColor!==undefined||p.fontStyle!==undefined;}};C.prototype._ignoreKey=function(p,a,b){switch(p){case'fontFamily':if(a.fontFamily===undefined){return true;}break;case'fontSize':if(a.fontSize===undefined){return true;}break;case'fontWeight':if(a.fontWeight===undefined){return true;}break;case'fontColor':if(a.fontColor===undefined){return true;}break;case'fontStyle':if(a.fontStyle===undefined){return true;}break;}return false;};return C;});define('sap/viz/controls/chart/adapters/config/CategoryAxisPropConfig',['sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo'],function(C){var a={};var _=function(p){return{'id':'categoryAxis.labelRenderer.categoryAxisLabelRenderer','infoClass':C,'vizPath':'categoryAxis.labelRenderer','paraName':p};};a.instance=function(){return{'textVisible':{'renderer':_('textVisible')},'iconSVG':{'renderer':_('iconSVG')},'iconColor':{'renderer':_('iconColor')},'iconFillColor':{'renderer':_('iconFillColor')},'iconSize':{'renderer':_('iconSize')},'iconVisible':{'renderer':_('iconVisible')},'iconRotateAngle':{'renderer':_('iconRotateAngle')},'fontFamily':{'renderer':_('fontFamily'),'vizPath':'categoryAxis.label.style.fontFamily'},'fontSize':{'renderer':_('fontSize'),'vizPath':'categoryAxis.label.style.fontSize'},'fontWeight':{'renderer':_('fontWeight'),'vizPath':'categoryAxis.label.style.fontWeight'},'fontColor':{'renderer':_('fontColor'),'vizPath':'categoryAxis.label.style.color'},'fontStyle':{'renderer':_('fontStyle'),'vizPath':'categoryAxis.label.style.fontStyle'}};};return a;});define('sap/viz/controls/chart/adapters/config/CategoryAxis2PropConfig',['sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo'],function(C){var a={};var _=function(p){return{'id':'categoryAxis.labelRenderer.categoryAxisLabelRenderer','infoClass':C,'vizPath':'categoryAxis.labelRenderer','paraName':p};};a.instance=function(){return{'textVisible':{'renderer':_('textVisible')},'iconSVG':{'renderer':_('iconSVG')},'iconColor':{'renderer':_('iconColor')},'iconFillColor':{'renderer':_('iconFillColor')},'iconSize':{'renderer':_('iconSize')},'iconVisible':{'renderer':_('iconVisible')},'iconRotateAngle':{'renderer':_('iconRotateAngle')},'fontFamily':{'renderer':_('fontFamily'),'vizPath':'categoryAxis.label.style.fontFamily'},'fontSize':{'renderer':_('fontSize'),'vizPath':'categoryAxis.label.style.fontSize'},'fontWeight':{'renderer':_('fontWeight'),'vizPath':'categoryAxis.label.style.fontWeight'},'fontColor':{'renderer':_('fontColor'),'vizPath':'categoryAxis.label.style.color'},'fontStyle':{'renderer':_('fontStyle'),'vizPath':'categoryAxis.label.style.fontStyle'}};};return a;});define('sap/viz/controls/chart/adapters/config/CategoryAxisTitlePropConfig',[],function(C){var a={};a.instance=function(){return{'fontFamily':{'vizPath':'categoryAxis.title.style.fontFamily'},'fontSize':{'vizPath':'categoryAxis.title.style.fontSize'},'fontWeight':{'vizPath':'categoryAxis.title.style.fontWeight'},'fontColor':{'vizPath':'categoryAxis.title.style.color'},'fontStyle':{'vizPath':'categoryAxis.title.style.fontStyle'}};};return a;});define('sap/viz/controls/chart/adapters/config/CategoryAxis2TitlePropConfig',[],function(C){var a={};a.instance=function(){return{'fontFamily':{'vizPath':'categoryAxis.title.style.fontFamily'},'fontSize':{'vizPath':'categoryAxis.title.style.fontSize'},'fontWeight':{'vizPath':'categoryAxis.title.style.fontWeight'},'fontColor':{'vizPath':'categoryAxis.title.style.color'},'fontStyle':{'vizPath':'categoryAxis.title.style.fontStyle'}};};return a;});define('sap/viz/controls/chart/adapters/config/ValueAxisPropConfig',[],function(){var V={};V.instance=function(){return{'fontFamily':{'vizPath':'valueAxis.label.style.fontFamily'},'fontSize':{'vizPath':'valueAxis.label.style.fontSize'},'fontWeight':{'vizPath':'valueAxis.label.style.fontWeight'},'fontColor':{'vizPath':'valueAxis.label.style.color'},'fontStyle':{'vizPath':'valueAxis.label.style.fontStyle'}};};return V;});define('sap/viz/controls/chart/adapters/config/ValueAxis2PropConfig',[],function(){var V={};V.instance=function(){return{'fontFamily':{'vizPath':'valueAxis.label.style.fontFamily'},'fontSize':{'vizPath':'valueAxis.label.style.fontSize'},'fontWeight':{'vizPath':'valueAxis.label.style.fontWeight'},'fontColor':{'vizPath':'valueAxis.label.style.color'},'fontStyle':{'vizPath':'valueAxis.label.style.fontStyle'}};};return V;});define('sap/viz/controls/chart/adapters/config/ValueAxisTitlePropConfig',[],function(){var V={};V.instance=function(){return{'fontFamily':{'vizPath':'valueAxis.title.style.fontFamily'},'fontSize':{'vizPath':'valueAxis.title.style.fontSize'},'fontWeight':{'vizPath':'valueAxis.title.style.fontWeight'},'fontColor':{'vizPath':'valueAxis.title.style.color'},'fontStyle':{'vizPath':'valueAxis.title.style.fontStyle'}};};return V;});define('sap/viz/controls/chart/adapters/config/ValueAxis2TitlePropConfig',[],function(C){var V={};V.instance=function(){return{'fontFamily':{'vizPath':'valueAxis.title.style.fontFamily'},'fontSize':{'vizPath':'valueAxis.title.style.fontSize'},'fontWeight':{'vizPath':'valueAxis.title.style.fontWeight'},'fontColor':{'vizPath':'valueAxis.title.style.color'},'fontStyle':{'vizPath':'valueAxis.title.style.fontStyle'}};};return V;});define('sap/viz/controls/chart/adapters/config/LegendPropConfig',[],function(){var L={};L.instance=function(){return{'fontFamily':{'vizPath':'legend.label.style.fontFamily'},'fontSize':{'vizPath':'legend.label.style.fontSize'},'fontWeight':{'vizPath':'legend.label.style.fontWeight'},'fontColor':{'vizPath':'legend.label.style.color'},'fontStyle':{'vizPath':'legend.label.style.fontStyle'},'title-fontFamily':{'vizPath':'legend.title.style.fontFamily'},'title-fontSize':{'vizPath':'legend.title.style.fontSize'},'title-fontWeight':{'vizPath':'legend.title.style.fontWeight'},'title-fontColor':{'vizPath':'legend.title.style.color'},'title-fontStyle':{'vizPath':'legend.title.style.fontStyle'}};};return L;});define('sap/viz/controls/chart/adapters/renderer/LineRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/RendererInfoBase'],function(O,R){var L=function(i,v){L.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/LineRendererInfo';this.generator='lineRenderer';};O.extend(L,R);L.prototype._renderGeneral=function(p){if(p.dash||p.color||p.width){return true;}else{return false;}};L.prototype._renderSpecified=function(p){if(p.dash||p.color||p.width){return true;}else{return false;}};return L;});define('sap/viz/controls/chart/adapters/config/LinePropConfig',['sap/viz/controls/chart/adapters/renderer/LineRendererInfo','sap/viz/controls/chart/adapters/renderer/LegendPostRendererInfo'],function(L,a){var b={};var _=function(p){return{'id':'plotArea.lineRenderer','infoClass':L,'vizPath':'plotArea.lineRenderer','paraName':p};};var c=function(p){return{'id':'legend.postRenderer.syncSeriesRenderer','infoClass':a,'vizPath':'legend.postRenderer','paraName':p};};b.instance=function(){return{'lineFill':{'renderer':_('color')},'lineStyle':{'renderer':_('dash')},'plotArea.width':{'renderer':_('width'),'vizPath':'plotArea.width'},'legendItemColorFill':{'renderer':(function(){return c('legendItemColorFill');}())}};};return b;});define('sap/viz/controls/chart/adapters/config/CombinationLinePropConfig',['sap/viz/controls/chart/adapters/renderer/LineRendererInfo','sap/viz/controls/chart/adapters/renderer/LegendPostRendererInfo'],function(L,a){var b={};var _=function(p){return{'id':'plotArea.line.lineRenderer','infoClass':L,'vizPath':'plotArea.line.lineRenderer','paraName':p};};var c=function(p){return{'id':'legend.postRenderer.syncSeriesRenderer','infoClass':a,'vizPath':'legend.postRenderer','paraName':p};};b.instance=function(){return{'lineFill':{'renderer':_('color')},'lineStyle':{'renderer':_('dash')},'plotArea.line.width':{'renderer':_('width'),'vizPath':'plotArea.line.width'},'legendItemColorFill':{'renderer':(function(){return c('legendItemColorFill');}())}};};return b;});define('sap/viz/controls/chart/adapters/config/TrellisAxisPropConfig',[],function(){var T={};T.instance=function(){return{'rowAxisLabelStyle':{'vizPath':'rowAxis.label.style'},'rowAxisLabelVisible':{'vizPath':'rowAxis.label.visible'},'columnAxisLabelStyle':{'vizPath':'columnAxis.label.style'},'columnAxisLabelVisible':{'vizPath':'columnAxis.label.visible'},'rowAxisTitleStyle':{'vizPath':'rowAxis.title.style'},'rowAxisTitleVisible':{'vizPath':'rowAxis.title.visible'},'columnAxisTitleStyle':{'vizPath':'columnAxis.title.style'},'columnAxisTitleVisible':{'vizPath':'columnAxis.title.visible'},'categoryAxisLabelStyle':{'vizPath':'categoryAxis.label.style'},'categoryAxisLabelVisible':{'vizPath':'categoryAxis.label.visible'},'valueAxisLabelStyle':{'vizPath':'valueAxis.label.style'},'valueAxisLabelVisible':{'vizPath':'valueAxis.label.visible'},'categoryAxisTitleStyle':{'vizPath':'categoryAxis.title.style'},'categoryAxisTitleVisible':{'vizPath':'categoryAxis.title.visible'},'valueAxisTitleStyle':{'vizPath':'valueAxis.title.style'},'valueAxisTitleVisible':{'vizPath':'valueAxis.title.visible'},'valueAxis2LabelStyle':{'vizPath':'valueAxis2.label.style'},'valueAxis2LabelVisible':{'vizPath':'valueAxis2.label.visible'},'valueAxis2TitleVisible':{'vizPath':'valueAxis2.title.visible'},'valueAxis2TitleStyle':{'vizPath':'valueAxis2.title.style'}};};return T;});define('sap/viz/controls/chart/adapters/renderer/DimensionLabelRendererInfo',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo'],function(O,D){var a=function(i,v){a.superclass.constructor.apply(this,arguments);this.implClassPath='sap/viz/controls/chart/adapters/renderer/DimensionLabelRendererInfo';this.generator='dimensionLabelRenderer';};O.extend(a,D);a.prototype._ignoreKey=function(p,b,c){switch(p){case'textVisible':if(c.textVisible===undefined){if(b.textVisible===c.dimensionLabelVisible){return true;}}break;case'iconVisible':if(c.iconVisible===undefined){return true;}break;case'fontFamily':if(b.fontFamily===undefined){return true;}break;case'fontSize':if(b.fontSize===undefined){return true;}break;case'fontWeight':if(b.fontWeight===undefined){return true;}break;case'fontColor':if(b.fontColor===undefined){return true;}break;case'fontStyle':if(b.fontStyle===undefined){return true;}break;}return false;};a.prototype._updatePropsGeneral=function(c,k,v){a.superclass._updatePropsGeneral.apply(this,arguments);this._sortParameters();};return a;});define('sap/viz/controls/chart/adapters/config/DimensionLabelPropConfig',['sap/viz/controls/chart/adapters/renderer/DimensionLabelRendererInfo'],function(D){var a={};var _=function(p){return{'id':'plotArea.dimensionLabel.renderer','infoClass':D,'vizPath':'plotArea.dimensionLabel.renderer','paraName':p};};a.instance=function(){return{'dimensionLabelVisible':{'vizPath':'plotArea.dimensionLabel.visible'},'textVisible':{'renderer':_('textVisible')},'fontFamily':{'renderer':_('fontFamily'),'vizPath':'plotArea.dimensionLabel.style.fontFamily'},'fontSize':{'renderer':_('fontSize'),'vizPath':'plotArea.dimensionLabel.style.fontSize'},'fontWeight':{'renderer':_('fontWeight'),'vizPath':'plotArea.dimensionLabel.style.fontWeight'},'fontColor':{'renderer':_('fontColor'),'vizPath':'plotArea.dimensionLabel.style.color'},'fontStyle':{'renderer':_('fontStyle'),'vizPath':'plotArea.dimensionLabel.style.fontStyle'}};};return a;});define('sap/viz/controls/chart/adapters/PropertyMap',['sap/viz/controls/chart/adapters/config/DataLabelPropConfig','sap/viz/controls/chart/adapters/config/DataPointPropConfig','sap/viz/controls/chart/adapters/config/ChartTitlePropConfig','sap/viz/controls/chart/adapters/config/ChartAreaPropConfig','sap/viz/controls/chart/adapters/config/PlotAreaPropConfig','sap/viz/controls/chart/adapters/config/CategoryAxisPropConfig','sap/viz/controls/chart/adapters/config/CategoryAxis2PropConfig','sap/viz/controls/chart/adapters/config/CategoryAxisTitlePropConfig','sap/viz/controls/chart/adapters/config/CategoryAxis2TitlePropConfig','sap/viz/controls/chart/adapters/config/ValueAxisPropConfig','sap/viz/controls/chart/adapters/config/ValueAxis2PropConfig','sap/viz/controls/chart/adapters/config/ValueAxisTitlePropConfig','sap/viz/controls/chart/adapters/config/ValueAxis2TitlePropConfig','sap/viz/controls/chart/adapters/config/LegendPropConfig','sap/viz/controls/chart/adapters/config/LinePropConfig','sap/viz/controls/chart/adapters/config/CombinationLinePropConfig','sap/viz/controls/chart/adapters/config/TrellisAxisPropConfig','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/chart/adapters/config/DimensionLabelPropConfig'],function(D,a,C,b,P,c,d,e,f,V,g,h,i,L,j,k,T,l,m){var n={};n.getPropConfig=function(z,o,p,q){switch(z){case l.DATA_LABEL:return D.instance();case l.DATA_POINT:return a.instance(p,q);case l.DATA_POINT_MARKER:return a.instance(p,q);case l.CATEGORY_AXIS:return c.instance();case l.CATEGORY_AXIS2:return d.instance();case l.CATEGORY_AXIS_TITLE:return e.instance();case l.CATEGORY_AXIS2_TITLE:return f.instance();case l.VALUE_AXIS:return V.instance();case l.VALUE_AXIS2:return g.instance();case l.VALUE_AXIS_TITLE:return h.instance();case l.VALUE_AXIS2_TITLE:return i.instance();case l.CHART_TITLE:return C.instance();case l.CHART_AREA:return b.instance();case l.PLOT_AREA:return P.instance();case l.LEGEND:return L.instance();case l.LINE:return j.instance();case l.COMBINATION_LINE:return k.instance();case l.ROW_AXIS:return T.instance();case l.COLUMN_AXIS:return T.instance();case l.ROW_AXIS_TITLE:return T.instance();case l.COLUMN_AXIS_TITLE:return T.instance();case l.ROW_AXIS2:return T.instance();case l.COLUMN_AXIS2:return T.instance();case l.ROW_AXIS2_TITLE:return T.instance();case l.COLUMN_AXIS2_TITLE:return T.instance();case l.DIMENSION_LABEL:return m.instance();}};return n;});define('sap/viz/controls/chart/adapters/PropFnGenerator',[],function(){var P=function(n,f){this.__className="sap.viz.controls.chart.adapters.PropFnGenerator";this._name=n;this._fn=f;};var p=P.prototype;p.generateFn=function(a){return this._fn.apply(null,[a]);};p.getName=function(){return this._name;};return P;});define('sap/viz/controls/chart/adapters/PropFnGeneratorRegistry',['sap/viz/controls/chart/adapters/PropFnGenerator'],function(P){var a={};var _={};a.register=function(n,f){var g=_;if(g.hasOwnProperty(n)){throw"PropFnGenerator '"+n+"' exists.";}g[n]=new P(n,f);};a.unregister=function(n){delete _[n];};a.get=function(n){return _[n];};return a;});define('sap/viz/controls/chart/adapters/PropertyAdapter',['require','jquery','sap/viz/controls/chart/adapters/PropertyMap','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/chart/adapters/PropFnGeneratorRegistry','sap/viz/controls/chart/adapters/renderer/RendererInfoBase','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/VizUtils'],function(r,$,P,C,E,V,O,U,b,R,c,d){var f=r||f;var g=function(a,e){g.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.chart.adapters.PropertyAdapter';this._helper=a;this._rendererInfo={};if(e){this.loadRendererInfo(e);}};g.VALID="VALID";g.INVALID="INVALID";g.MIX="MIX";O.extend(g,E);function h(a,o,p){if(a.hasOwnProperty(p)){return a[p];}var e=p.split('.'),i,n,q=o;for(i=0,n=e.length;i<n;i++){q=q[e[i]];if(q===undefined){return(a[p]=undefined);}}return(a[p]=q);}function j(z,a){switch(z.type()+":"+a){case"LINE:color":case"COMBINATION_LINE:color":case"DATA_POINT:iconColor":case"DATA_POINT_MARKER:iconColor":case"DATA_POINT:dataPointShapeFill":return(z.extraContext()||{}).color;}return undefined;}function m(z,a,p,e,n,o){var q={},s={};p=p.slice();a.forEach(function(t,i){s[p[i]]=o(n[t].vizPath||t);});if(z.length===1&&z[0].dimensionContext()===undefined){if(e){q=e.getMergedProperties(p,s);}else{q=s;}}else{q={};z.some(function(t,i){if(p.length===0){return true;}var v={};if(e){v=e.getProperties(t.dimensionContext(),p,i>0);}p=p.filter(function(u){if(v[u]===undefined){v[u]=j(t,u);}if(v[u]===undefined){v[u]=s[u];}if(!q.hasOwnProperty(u)&&q[u]===undefined){q[u]=v[u];}else if(!U.deepEqual(v[u],q[u])){q[u]=null;return false;}return true;});});}return q;}g.prototype.query=function(o){if((o&&o.propertyZones)==null){return null;}if(o.propertyZones.length===0){return{};}var z=o.propertyZones,p=o.propertyFields,a=o.chartType,e,s=this,n={},q,t,u=U.currying(h,{},s._helper.vizProperties());e=Object.keys(p).filter(function(i){return p[i];});t=P.getPropConfig(z[0].type(),c.isHorizontal(a),!!c.getStacking(a),a==="info/combination"||a==="info/horizontal_combination");if(t==null){return e.reduce(function(i,v){i[v]=u(v);return i;},{});}q=e.filter(function(i){var v=t[i];if(v==null){n[i]=u(i);return false;}if(v.renderer==null){n[i]=u(v.vizPath||i);return false;}return true;}).reduce(function(i,v){var w=t[v],x=i[w.renderer.id]||(i[w.renderer.id]=[]);x.push(v);return i;},{});Object.keys(q).forEach(function(v){var w=q[v],x=s._rendererInfo[v],y,A;y=w.map(function(i){return t[i].renderer.paraName||i;});A=m(z,w,y,x,t,u);w.forEach(function(B,i){n[B]=A[y[i]];});});e.forEach(function(i){if(n[i]===undefined){n[i]=u(t[i]?(t[i].vizPath||i):i);}});return n;};g.prototype._getCfg=function(p,a){for(var e in p){if(p&&p[e]&&p[e].renderer&&p[e].renderer.paraName===a){return p[e];}}return null;};g.prototype.update=function(o){if(!o||!o.propertyZones){return;}var p=o.propertyZones;var a=o.properties;var e=o.chartType;var n={};var q={};var s;for(var i in p){var t=p[i];var u=P.getPropConfig(t.type(),c.isHorizontal(e),!!c.getStacking(e),e==="info/combination"||e==="info/horizontal_combination");var v={};var w;for(var x in a){var y=a[x];if(u&&u[x]){w=u[x];if(w.renderer){var z=w.renderer;if(!this._rendererInfo[z.id]){this._rendererInfo[z.id]=new z.infoClass(z.id,z.vizPath);}v[z.id]=this._rendererInfo[z.id];var A=t.getDimensionContext();this._rendererInfo[z.id].setProperty(A,z.paraName,y);}else if(w.vizPath){q[w.vizPath]=y;}}else{q[x]=y;}}for(var B in v){s=v[B];if(s.simplify().length>0){n[s.vizPath]=s;}else{n[s.vizPath]=undefined;}if(s.fallbackParas()){var D=s.fallbackParas();for(var F in D){var G=D[F];w=this._getCfg(u,F);if(w&&w.vizPath){q[w.vizPath]=G;}}}}}a={};var H;for(H in n){s=n[H];if(s){g._parseVizPath(H,g._getRenderer(s.generator,s.parameters()),a);}else{g._parseVizPath(H,null,a);}}for(H in q){g._parseVizPath(H,q[H],a);}this._helper.propertiesWithEvents(a);};g.prototype._getVizProp=function(p){var v=this._helper.vizProperties();try{var a=p.split('.');for(var i in a){v=v[a[i]];}}catch(e){return undefined;}return v;};g.prototype.saveRendererInfo=function(){var a={};var t=this._helper.vizType();for(var i in this._rendererInfo){if(g._validRendererInfo(i,t,this._rendererInfo)!==g.VALID){continue;}var e=this._rendererInfo[i];var p=e.parameters();if(p&&p.length>0){a[i]=this._rendererInfo[i].toJSON();var v=this._validateParameters(i,p);a[i].parameters=v;}}return a;};g.prototype.updateRendererInfo=function(o){if(o&&!U.isEmptyObject(o)){if(this._rendererInfo&&!U.isEmptyObject(this._rendererInfo)){var t=this._helper.vizType();if(o&&o.measureFeedingItemsChanged===true){if(o.action==="remove"){this._updateParametersOfRendererInfo(t,o);}}if(o&&o.dimensionFeedingItemsChanged===true){o.cleanedParameters=true;this._updateParametersOfRendererInfo(t,o);}o.propertiesChanged=true;}else{o.propertiesChanged=false;}}};g.prototype._updateParametersOfRendererInfo=function(t,o){if(this._rendererInfo){for(var a in this._rendererInfo){if(this._rendererInfo.hasOwnProperty(a)){var e=this._rendererInfo[a];if(o.cleanedParameters===true){e.parameters([]);this._setDefaultProperty(t,o,true);}else{if(o.measures){if(c.isNotSupportMND(t)){this._setDefaultProperty(t,o,false);e.updateParameters(o.measures,false);}else{e.updateParameters(o.measures,true);}}}}}}};var _=function(p,a){var e=a.split('.'),n=p,i;for(i=0;i<e.length-1;i++){if(n[e[i]]===undefined){return;}n=n[e[i]];}delete n[e[e.length-1]];};var k=function(t,i){var o=null;if(t){var p=d._getDefaultProperties(t);if(p){o={};_(p,"plotArea.gridline");_(p,"categoryAxis.title");_(p,"plotArea.background");if(!i&&c.isNotSupportMND(t)){_(p,"plotArea.dataLabel");if(t===C.TYPE_DONUT){_(p,"plotArea.highlight");_(p,"plotArea.innerRadiusRatio");}}o.plotArea=p.plotArea;o.categoryAxis=p.categoryAxis;}}return o;};g.prototype._setDefaultProperty=function(t,a,i){var e=k(t,i);if(e){a.properties=U.updateJSON(a.properties,e);}};g.prototype.validateRenderer=function(p){var t=this._helper.vizType();p=p||{};for(var i in this._rendererInfo){var a=this._rendererInfo[i];if(g._validRendererInfo(i,t,this._rendererInfo)===g.INVALID){g._parseVizPath(a.vizPath,null,p);continue;}else if(g._validRendererInfo(i,t,this._rendererInfo)===g.MIX){continue;}var v=this._validateParameters(i,a.parameters());g._parseVizPath(a.vizPath,g._getRenderer(a.generator,v),p);}return p;};var l={"plotArea.markerRenderer.barShapeRenderer":["plotArea.markerRenderer.lineMarkerRenderer","plotArea.markerRenderer.stackedBarShapeRenderer","plotArea.markerRenderer.dataPointRenderer"],"plotArea.markerRenderer.lineMarkerRenderer":["plotArea.markerRenderer.barShapeRenderer"],"plotArea.markerRenderer.stackedBarShapeRenderer":["plotArea.markerRenderer.barShapeRenderer"],"plotArea.markerRenderer.dataPointRenderer":["plotArea.markerRenderer.barShapeRenderer"]};g._validRendererInfo=function(i,t,e){if(!c.hasCustomerRendererFor(i)){return g.VALID;}if(c.hasCustomerRendererFor(i,t)){return g.VALID;}else if(l[i]){for(var a in l[i]){if(l[i][a]in e&&c.hasCustomerRendererFor(l[i][a],t)){return g.MIX;}}}return g.INVALID;};g.prototype._validateParameters=function(a,p){var t=this._helper.vizType();if(t===C.TYPE_BAR||t===C.TYPE_COLUMN||t===C.TYPE_DUAL_BAR||t===C.TYPE_DUAL_COLUMN||t===C.TYPE_STACKED_BAR||t===C.TYPE_STACKED_COLUMN||t===C.TYPE_100_STACKED_BAR||t===C.TYPE_100_STACKED_COLUMN){return p;}var v=U.clone(p);for(var i in v){if(a==="plotArea.dataLabel.renderer"||(c.isMekkoChart(t)&&a==="categoryAxis.labelRenderer.categoryAxisLabelRenderer")){v[i].paras.iconVisible=false;}}return v;};g.parseRendererInfo=function(a,p){p=p||{};for(var i in a){var e=a[i];g._parseVizPath(e.vizPath,g._getRenderer(e.generator,e.parameters),p);}return p;};g.prototype.loadRendererInfo=function(a){var e=[];var i;for(i in a){var n=a[i];e.push(n.implClassPath);}for(i in a){this._rendererInfo[i]=R.fromJSON(a[i]);}};g.prototype.reset=function(){this._rendererInfo={};};g._getRenderer=function(n,p){var a=b.get(n);return(a)?a.generateFn(p):null;};g._parseVizPath=function(v,a,p){var e=v.split('.');if(e.length>0){var t=p;for(var i=0;i<e.length;i++){if(i===e.length-1){t[e[i]]=a;break;}t[e[i]]=t[e[i]]||{};t=t[e[i]];}}return p;};return g;});define('sap/viz/controls/chart/views/DropZoneProvider',['jquery','sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/metadata/MetadataFactory'],function($,F,L,a,C,T,M){var t={'trellisRow':"trellisRow",'trellisColumn':"trellisColumn"};var f={"trellisRow":"VIZ_COMMON_ROWS","trellisColumn":"VIZ_COMMON_COLUMNS","horizontal:valueAxis":"VIZ_COMMON_XAXIS","horizontal:valueAxis2":"VIZ_COMMON_XAXIS","horizontal:categoryAxis":"VIZ_COMMON_YAXIS","vertical:valueAxis":"VIZ_COMMON_YAXIS","vertical:valueAxis2":"VIZ_COMMON_YAXIS","vertical:categoryAxis":"VIZ_COMMON_XAXIS","scatter:valueAxis":"VIZ_COMMON_XAXIS","scatter:valueAxis2":"VIZ_COMMON_YAXIS","mekko:vertical:valueAxis":"VIZ_COMMON_YAXIS","mekko:vertical:valueAxis2":"VIZ_COMMON_COLUMN_WIDTH","mekko:vertical:categoryAxis":"VIZ_COMMON_XAXIS","mekko:horizontal:valueAxis":"VIZ_COMMON_XAXIS","mekko:horizontal:valueAxis2":"VIZ_COMMON_BAR_HEIGHT","mekko:horizontal:categoryAxis":"VIZ_COMMON_YAXIS","rotate:scatter:valueAxis2":true,"rotate:mekko:vertical:valueAxis":true,"rotate:mekko:horizontal:categoryAxis":true,"rotate:mekko:horizontal:valueAxis2":true,"rotate:horizontal:categoryAxis":true,"rotate:vertical:valueAxis":true,"rotate:vertical:valueAxis2":true,"rotate:yAxis":true,"rotate:yAxis2":true,"rotate:trellisRow":true};function u(z,v){var d=C.isHorizontal(v)?"horizontal":"vertical";if(v==="info/scatter"||v==="info/bubble"){d="scatter";}if(v.indexOf("mekko")>-1){d="mekko:"+d;}z.forEach(function(e){var n=e.name;e.text=L.get(f[d+":"+n]||f[n]);e.rotate=f["rotate:"+d+":"+n]||f["rotate:"+n]||false;});}function b(z){if(!z||!z.bound){return true;}var d=z.bound[0];if(!d){return true;}var w=d[2][0]-d[0][0];var h=d[2][1]-d[0][1];if(w<1||h<1){return true;}return false;}function p(v,d,e,g,h){var m=M.get(v),z=d;var j=m.getBindingDefs().reduce(function(o,q){o[t[q.id()]||q.id()]={id:q.id(),name:q.id(),type:q.type()};return o;},{});z.forEach(function(o){o.feedDef=o.bindDef.map(function(q){return j[q.id];});});if(!C.supportMultiChart(v)){u(z,v);return z;}var k=C.isMultipleChart(v),l,r;if(k){for(var i=z.length-1;i>=0;i--){var n=z[i].name;if(n==="trellisColumn"){l={name:F.ID_TRELLIS_COLUMN,bound:[z[i].bound[0]],feedDef:z[i].feedDef};z.splice(i,1);}else if(n==="trellisRow"){r={name:F.ID_TRELLIS_ROW,bound:[z[i].bound[0]],feedDef:z[i].feedDef};z.splice(i,1);}else if(["plot","legend","categoryAxis","categoryAxis2","valueAxis","valueAxis2"].indexOf(n)===-1&&T.providerName(v)==="trellis"){z.splice(i,1);}}if(l&&!b(l)){z.push(l);}if(r&&!b(r)){z.push(r);}}if(h){c(z,e,g,l,r);}u(z,v);return z;}function c(z,d,s,e,r){var g,h;h={"id":'multiplier',"name":"ChartView Multiplier","type":"dimension"};if(!e){g=[[[d,s.height-d],[s.width-d,0],[s.width-d,s.height],[0,d]]];e={"name":F.ID_TRELLIS_COLUMN,"feedDef":[h],"bound":g};z.push(e);}if(!r){g=[[[0,d],[d,d],[d,s.height-d],[0,s.height-d]]];r={"name":F.ID_TRELLIS_ROW,"feedDef":[h],"bound":g};z.push(r);}}return{provide:p};});define('sap/viz/controls/chart/TrellisMap',[],function(){return{'info/trellis_bar':{'categoryAxis.label':'rowAxis.label','categoryAxis.title':'rowAxis.title','valueAxis.label':'columnAxis.label','valueAxis.title':'columnAxis.title'},'info/trellis_line':{'categoryAxis.label':'columnAxis.label','categoryAxis.title':'columnAxis.title','valueAxis.label':'rowAxis.label','valueAxis.title':'rowAxis.title'},'info/trellis_horizontal_line':{'categoryAxis.label':'rowAxis.label','categoryAxis.title':'rowAxis.title','valueAxis.label':'columnAxis.label','valueAxis.title':'columnAxis.title'},'info/trellis_column':{'categoryAxis.label':'columnAxis.label','categoryAxis.title':'columnAxis.title','valueAxis.label':'rowAxis.label','valueAxis.title':'rowAxis.title'},'info/trellis_dual_column':{'categoryAxis.label':'columnAxis.label','categoryAxis.title':'columnAxis.title','valueAxis.label':'rowAxis.label','valueAxis.title':'rowAxis.title'},'info/trellis_dual_line':{'categoryAxis.label':'columnAxis.label','categoryAxis.title':'columnAxis.title','valueAxis.label':'rowAxis.label','valueAxis.title':'rowAxis.title'},'info/trellis_dual_horizontal_line':{'categoryAxis.label':'rowAxis.label','categoryAxis.title':'rowAxis.title','valueAxis2.label':'columnAxis.label','valueAxis2.title':'columnAxis.title'},'info/trellis_dual_bar':{'categoryAxis.label':'rowAxis.label','categoryAxis.title':'rowAxis.title','valueAxis2.label':'columnAxis.label','valueAxis2.title':'columnAxis.title'},'info/trellis_scatter':{'valueAxis.label':'columnAxis.label','valueAxis.title':'columnAxis.title','valueAxis2.label':'rowAxis.label','valueAxis2.title':'rowAxis.title'},'info/trellis_bubble':{'valueAxis.label':'columnAxis.label','valueAxis.title':'columnAxis.title','valueAxis2.label':'rowAxis.label','valueAxis2.title':'rowAxis.title'},'info/trellis_100_stacked_column':{'categoryAxis.label':'columnAxis.label','categoryAxis.title':'columnAxis.title','valueAxis.label':'rowAxis.label','valueAxis.title':'rowAxis.title'},'info/trellis_stacked_column':{'categoryAxis.label':'columnAxis.label','categoryAxis.title':'columnAxis.title','valueAxis.label':'rowAxis.label','valueAxis.title':'rowAxis.title'},'info/trellis_stacked_bar':{'categoryAxis.label':'rowAxis.label','categoryAxis.title':'rowAxis.title','valueAxis.label':'columnAxis.label','valueAxis.title':'columnAxis.title'},'info/trellis_100_stacked_bar':{'categoryAxis.label':'rowAxis.label','categoryAxis.title':'rowAxis.title','valueAxis.label':'columnAxis.label','valueAxis.title':'columnAxis.title'},'info/trellis_combination':{'categoryAxis.label':'columnAxis.label','categoryAxis.title':'columnAxis.title','valueAxis.label':'rowAxis.label','valueAxis.title':'rowAxis.title'},'info/trellis_horizontal_combination':{'categoryAxis.label':'rowAxis.label','categoryAxis.title':'rowAxis.title','valueAxis.label':'columnAxis.label','valueAxis.title':'columnAxis.title'}};});define('sap/viz/controls/chart/views/InfoChartView',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/chart/adapters/InteractionAdapter','sap/viz/controls/chart/adapters/PropertyAdapter','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/View','sap/viz/controls/chart/views/EditAxisView','sap/viz/controls/common/utils/binding/BindingGeneratorFactory','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/utils/FlatTableFakeDataUtil','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/chart/views/DropZoneProvider','sap/viz/controls/chart/views/PropertyZone','sap/viz/controls/chart/views/AxisSizeAdjustHelper','sap/viz/controls/chart/views/AxisSplitter','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/chart/TrellisMap','sap/viz/controls/common/constants/DatasetTypeConst'],function($,O,C,a,L,A,b,F,V,I,c,P,d,f,E,B,u,g,h,j,D,k,T,l,m,n,o,M,p,q){var r=function(e,i,s,t){r.superclass.constructor.apply(this,arguments);this.__className='sap.viz.controls.chart.views.InfoChartView';this._iAdapter=null;this._pAdapter=null;this._rendererInfo=null;this._createChildren(i.enableAxisSplitter);};O.extend(r,f);r.prototype._createChildren=function(i){r.superclass._createChildren.apply(this,arguments);this._createDropZone();if(i){this._axisSplitter=new o(this._chartHolder$.get(0),$.proxy(this.properties,this),$.proxy(this._getPropertyZone,this));this._axisSplitter.addEventListener(o.AxisSplitChanged,this._axisSplitChangedHandler,this);}this._propertyZone=new m(this._chartLayer$.get(0),this._getPropertyZone.bind(this));this._propertyZone.addEventListener(m.SELECT_ZONE,$.proxy(function(e){this._dispatchEvent(new d(d.SELECT_PROPERTY_ZONE,this,e.data));},this));this._editAxisView=new E(this._chartHolder$.get(0),null);this._editAxisView.addEventListener(E.AxisScaleChanged,this._axisScalerChangedHandler,this);};r.prototype._getFeedingZone=function(){if(!this._chart){return[];}var v=this._options.type,z;try{z=this._chartProxy.get("properties")["feedingZone"]||[];}catch(e){return[];}return l.provide(v,z,this._padding,this._size,this._enableTrellis);};r.prototype._getPropertyZone=function(){if(!this._chart){return[];}var z=[],e;e=this._chartProxy.get("properties")["propertyZone"]||[];return e;};r.prototype.getTemplateId=function(e){if(arguments.length>0){var i=e||this.data();if(k.hasFakeData(i)){return f.TEMPLATE_INCOMPLETE;}else{return this._templateId;}}else{return sap.viz.api.env.Template.get();}};r.prototype._createChartInstance=function(){if(!this._options){return;}var e=this._options;try{this._destroyChartInstance();var i=this._updateDescriptionByOptions(e);if(e.properties){this._checkBehaviorType(e.properties);}if(!i){this._chart=this._chartProxy.execute('sap.viz.api.core.createViz',{type:e.type,data:e.data,bindings:e.feeding,properties:e.properties,events:e.events,scales:e.scales,sharedRuntimeScales:e.sharedRuntimeScales,container:this._chartLayer$.get(0)});if(this._chart){this._postVizProcess(e);}}}catch(s){var v=e.type;var t=L.get('VIZ_CHART_CREATE_CHART_FAILED')+s;if(!M.get(v).getBindingDefs()){this._updateDescription(u.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),v));}else{this._updateDescription(t);}this._chartLayer$.html("");this._chart=null;this._hasChartInstance=false;throw t;}};r.prototype.feedingItemChanged=function(e){if(this._pAdapter){this._pAdapter.updateRendererInfo(e);}};r.prototype.getValidProperties=function(e,s){var v=k.getValidProperties(e,s);if(this._pAdapter){this._pAdapter.validateRenderer(v);}var t=p[s];if(t){if(v&&v.plotArea&&v.plotArea.gridline&&v.plotArea.gridline.visible){v.plotArea.gridline.visible=false;}}var w=v;for(var x in t){var y=x.split('.');var z=t[x].split('.');var G=v;for(var i=0;i<y.length-1;i++){w[z[i]]=w[z[i]]||{};G=G[y[i]];w=w[z[i]];}if(G){w[z[z.length-1]]=G[y[i]];}else{w[z[z.length-1]]=undefined;}w=v;}return v;};r.prototype.getValidScales=function(s,v){var i=M.get(v);if(i==null||s==null||s.length===0||!j.isInfoChart(v)){return s;}var t=(i.dataScale()||[]).reduce(function(w,e){w[e.feed]=true;return w;},{});return s.filter(function(e){return!!t[e.feed];});};r.prototype.setAxisScale=function(e){if(this._chart){var t=this._options.type;this._editAxisView.show(t,e,this._chartProxy.get('properties',this._options.properties),this.scales());}};r.prototype._axisScalerChangedHandler=function(e){if(!this._chart){return;}this._helper.scalesWithEvents(e.data,[d.VIZ_SCALES_CHANGED,d.USER_INTERACTION_COMPLETE]);};r.prototype._axisSplitChangedHandler=function(e){var i=n(this._chart,this._getFeedingZone(),e.data.axisName,e.data.direction,e.data.offset);if(i){this._helper.propertiesWithEvents(i);}};r.prototype._postVizProcess=function(e){this._chart.on('initialized.create',$.proxy(function(){if(!this._chart){return;}this._chart.off('initialized.create');if(!this._iAdapter){this._iAdapter=new c(this._helper);this._iAdapter.addEventListener(d.PROPERTY_ZONES_CHANGED,function(i){this._dispatchEvent(new d(d.PROPERTY_ZONES_CHANGED,this,i.data));},this);}if(!this._pAdapter){this._pAdapter=new P(this._helper,this._rendererInfo);this._pAdapter._ownerDom$=this._dom$;}this._dispatchEvent(new d(d.PROPERTY_ZONES_CHANGED,this,{'propertyZones':[new V(V.CHART_AREA)]}));},this));this._chart.on("lassoStart.chartview",(function(){if(this._axisSplitter){this._axisSplitter.deactive();}}).bind(this));this._chart.on("lassoEnd.chartview",(function(){if(this._axisSplitter){this._axisSplitter.active();}}).bind(this));this._chart.on("initialized.chartview",(function(i){if(!this._isFeedsValid||j.isMultipleChart(e.type)){if(this._axisSplitter){this._axisSplitter.reset();}}else{if(this._axisSplitter){this._axisSplitter.init(e.type);}}var s=this._enablePropertyZone&&this._isFeedsValid;this._propertyZone.updateZone(s);t("initialized",i);}).bind(this));this._chart.on('contextualData.chartview',$.proxy(function(i){this._dispatchEvent(new d(d.CONTEXT_MENU_TRIGGERED,this,i));},this));var t=$.proxy(function(i,s){this._dispatchEvent(new d(d.TRIGGER_CVOM_EVENT,this,{type:i,data:s}));},this);var _=this;this._chart.on("selectData.chartview",function(s){_._dispatchEvent(new d(d.CHANGED_SELECTED_DATA,this));t("selectData",s);});this._chart.on("deselectData.chartview",function(i){_._dispatchEvent(new d(d.CHANGED_SELECTED_DATA,this));t("deselectData",i);});this._hasChartInstance=true;this._dispatchEvent(new d(d.CHART_CHANGED,this,this._chart));r.superclass._postVizProcess.apply(this,arguments);};r.prototype.hasChartInstance=function(){return this._chart!==null;};r.prototype.properties=function(v,e){if(arguments.length>0){if(!e&&this._needMorphing(v)){this._requestMorphing=true;}this._options.properties=u.updateJSON(this._options.properties||{},v);this._checkBehaviorType(v);if(this._chart){this._chartProxy.set('properties',v);return this;}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{return this._chartProxy.get('properties',this._options.properties);}};r.prototype.copyData=function(t,e){if(D.getType(e)===q.FLAT_TABLE){return new sap.viz.api.data.FlatTableDataset(e.data());}else{return new sap.viz.api.data.CrosstableDataset(e.data());}};r.prototype.buildFeedings=function(t,e,i){if(e&&!j.isEmptyData(t,e)){var s;if(k.hasFakeData(e)||F.isEmptyFeeds(i)){s=h.buildFakeBinding(t,i);}else{var v=B.create(t,'FlatTableDataset');if(j.isSuggestMND(t)){i=g.suggestMND(t,i);}s=v.generate(i);}return s;}};r.prototype.feeding=function(e,i){try{if(this._chart){if(arguments.length>0){if(!i){this._requestMorphing=true;}this._chartProxy.set('feeding',e);return this;}else{return this._chartProxy.get('feeding',this._options.feeding);}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(s){throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+s;}};r.prototype.feedingZone=function(){try{if(this._chart){return this._chartProxy.get("properties")["feedingZone"]||[];}else{throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(e){throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+e;}};r.prototype.getPropertyZones=function(){if(this._iAdapter){return this._iAdapter.propertyZones();}else{return[];}};r.prototype.setPropertyZones=function(e){if(this._iAdapter){this._iAdapter.propertyZones(e);}};r.prototype.queryProperties=function(e){return this._pAdapter?this._pAdapter.query(e):{};};r.prototype.updateProperties=function(e){if(this._pAdapter){this._pAdapter.update(e);}};r.prototype.save=function(){return this._savePictogramInfo();};r.prototype._savePictogramInfo=function(){if(this._pAdapter){return{'pAdapter':{'rendererInfo':this._pAdapter.saveRendererInfo()}};}else{return{};}};r._migrateRenderInfo=function(e){var i="categoryAxis.labelRenderer.categoryAxisLabelRenderer";if(!e||e[i]){return;}var s;var x="xAxis.labelRenderer.categoryAxisLabelRenderer";var y="yAxis.labelRenderer.categoryAxisLabelRenderer";if(e[x]){s=e[x];delete e[x];}else if(e[y]){s=e[y];delete e[y];}if(s){e[i]=s;s.id=i;s.vizPath="categoryAxis.labelRenderer";}};r.prototype.load=function(e,v){if(e&&e.pAdapter){r._migrateRenderInfo(e.pAdapter.rendererInfo);this._rendererInfo=e.pAdapter.rendererInfo;if(this._pAdapter){this._pAdapter.loadRendererInfo(this._rendererInfo);}P.parseRendererInfo(e.pAdapter.rendererInfo,v);}};r.prototype.css=function(e,i){try{if(arguments.length>0){if(!i){this._requestMorphing=false;}this._updateCssCacheByNewCss(e);this._options.css=e;if(this._chart){this._chartProxy.set('css',e);return this;}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{return this._chartProxy.get('css',this._options.css);}}catch(s){throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+s;}};r.prototype.data=function(e,i){if(this._chart){try{if(arguments.length>0){if(!i){this._requestMorphing=true;}this._chartProxy.set('data',e);}else{return this._chartProxy.get('data',this._options.data);}}catch(s){var t=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+s;this._updateDescription(t);throw t;}}else{return r.superclass.data.apply(this,arguments);}};r.prototype.exportViz=function(e){if(this._chart){var i=this._chartProxy.execute('toJSON',e);return i;}else{throw L.get('VIZ_CHART_SERIALIZE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};r.prototype.update=function(e,i){if(!i){this._requestMorphing=true;}e.bindings=e.feeding;delete e.feeding;return r.superclass.update.apply(this,arguments);};r.prototype.scales=function(s){if(arguments.length>0){this._requestMorphing=true;this._options.scales=s;if(this._chart){this._chartProxy.set('scales',s);}else{throw L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{return this._chartProxy.get('scales',this._options.scales);}};r.prototype.getTitleZone=function(){if(!this._chart){return[];}var t=this._options.type;var z;try{z=this._chartProxy.get('propertyZone',[]);}catch(e){return[];}var s=[];for(var i=0;i<z.length;i++){if(z[i].name=='title'){s=z[i].bound[0];break;}}return s;};r.prototype.store=function(){return{iAdapter:this._iAdapter,pAdapter:this._pAdapter,rendererInfo:this._rendererInfo};};r.prototype.restore=function(v){this._iAdapter=v.iAdapter;this._pAdapter=v.pAdapter;this._rendererInfo=v.rendererInfo;if(this._iAdapter){this._iAdapter.addEventListener(d.PROPERTY_ZONES_CHANGED,function(e){this._dispatchEvent(new d(d.PROPERTY_ZONES_CHANGED,this,e.data));},this);}};r.prototype.reset=function(){if(this._pAdapter){this._pAdapter.reset();}};r.prototype._checkBehaviorType=function(e){if(e&&e.interaction&&e.interaction.hasOwnProperty('behaviorType')){this._dispatchEvent(new d(d.BEHAVIOR_TYPE_CHANGED,this,{'behaviorType':e.interaction.behaviorType}));}};r.prototype.runtimeScales=function(){if(!this._chart){return[];}return this._chart.runtimeScales.apply(this._chart,arguments);};r.prototype.sharedRuntimeScales=function(v){if(!this._chart){if(arguments.length<1){return[];}else{return this;}}return this._chart.sharedRuntimeScales.apply(this._chart,arguments);};r.prototype.updatePropertyForPropertyZoneInteraction=function(e,i){if(i){e=e||{};e.interaction={behaviorType:'DesignTimeBehavior'};}return e;};r.prototype.getPictogramInfo=function(){return this._savePictogramInfo();};r.prototype.zoom=function(e){if(arguments.length>0){if(this._chart){this._chartProxy.set('internal_api_zoom',e);}else{throw L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}};return r;});define('sap/viz/controls/common/constants/MapVizTypeConst',[],function(){var M={};M.VIZ_TYPE_CHOROPLETH="choropleth";M.VIZ_TYPE_MARKER="marker";M.VIZ_TYPE_BUBBLE="bubble";M.VIZ_TYPE_PIE="pie";return M;});define('sap/viz/controls/common/utils/MapUtil',['sap/viz/controls/common/constants/MapVizTypeConst'],function(M){var a={};a.getAvailableVizTypes=function(){var v=[];if(sap.viz.geo.dataviz.Choropleth){v.push(M.VIZ_TYPE_CHOROPLETH);}if(sap.viz.geo.dataviz.Bubble){v.push(M.VIZ_TYPE_BUBBLE);}if(sap.viz.geo.dataviz.Marker){v.push(M.VIZ_TYPE_MARKER);}if(sap.viz.geo.dataviz.Pie){v.push(M.VIZ_TYPE_PIE);}return v;};a.getVizTypeByVizId=function(v){if(v==="sap.viz.geo.dataviz.Bubble"){return M.VIZ_TYPE_BUBBLE;}else if(v==="sap.viz.geo.dataviz.Marker"){return M.VIZ_TYPE_MARKER;}else if(v==="sap.viz.geo.dataviz.Pie"){return M.VIZ_TYPE_PIE;}else if(v==="sap.viz.geo.dataviz.Choropleth"){return M.VIZ_TYPE_CHOROPLETH;}else{return"";}};a.getVizTypeByVizInstance=function(v){if(sap.viz.geo.dataviz.Marker&&v instanceof sap.viz.geo.dataviz.Marker){return M.VIZ_TYPE_MARKER;}else if(sap.viz.geo.dataviz.Bubble&&v instanceof sap.viz.geo.dataviz.Bubble){return M.VIZ_TYPE_BUBBLE;}else if(sap.viz.geo.dataviz.Pie&&v instanceof sap.viz.geo.dataviz.Pie){return M.VIZ_TYPE_PIE;}else if(sap.viz.geo.dataviz.Choropleth&&v instanceof sap.viz.geo.dataviz.Choropleth){return M.VIZ_TYPE_CHOROPLETH;}else{return"";}};a.getLayerPropertiesFromOption=function(v,o){var l={bubble:{measureFeedId:"size",legendPropName:"sizeLegend"},choropleth:{measureFeedId:"color",legendPropName:"mbcLegend"}};function g(c,e){var h=c[e];if(h){h=h[f];h=h&&h[0];}return h;}var p={};if(o&&o.formats){var b=l[v];if(b){var f=b.measureFeedId;var d=g(o.formats,"viz");if(d){p.viz={};p.viz[b.legendPropName]={formatString:d};p.viz.dataLabel={format:d};}var t=g(o.formats,"tooltip")||d;if(t){p.tooltipFormat=t;}}}return p;};return a;});define('sap/viz/controls/chart/views/ESRIServicePanel',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/views/ChartEvent'],function($,C,O,V,L,a){var E=function(d,u){E.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ESRIServicePanel";this._uiconfig=u;this._div=d;this._serviceGallery$=null;this.createChildren();};O.extend(E,V);E.prototype.createChildren=function(){this._serviceGallery$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-gallery').appendTo(this._div);};E.prototype.init=function(s,b){var c=this;var d=function(){$('.'+C.CHART_PREFIX+'map-service-selector-services-item-icon').removeClass(C.CHART_PREFIX+'map-service-selector-services-item-icon-selected');$(this).addClass(C.CHART_PREFIX+"map-service-selector-services-item-icon-selected");c._dispatchEvent(new a(a.ESRI_CUSTOMIZED_SERVICE_CHANGED,this,{serviceId:$('.'+C.CHART_PREFIX+"map-service-selector-services-item-icon-selected").data("__serviceId")}));};this._serviceGallery$.empty();if(s&&s.length>0){var e,f,t,g;for(var i=0;i<s.length;i++){e=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-item').appendTo(this._serviceGallery$);f=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-item-icon').appendTo(e);f.attr("title",s[i].description);f.data("__serviceId",s[i].id);f.data("__serviceFields",s[i].featureServicesFields);f.on("click",d);t=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-item-title').appendTo(e);t.html(s[i].title);f.css({"background-image":s[i].thumbnailURL});if(b&&b===s[i].id){f.addClass(C.CHART_PREFIX+"map-service-selector-services-item-icon-selected");}}}};E.prototype.getSelectedService=function(){return{id:$('.'+C.CHART_PREFIX+"map-service-selector-services-item-icon-selected").data("__serviceId"),fields:$('.'+C.CHART_PREFIX+"map-service-selector-services-item-icon-selected").data("__serviceFields")};};E.prototype.show=function(){this._serviceGallery$.show();};E.prototype.hide=function(){this._serviceGallery$.hide();};return E;});define('sap/viz/controls/chart/views/ESRIServiceColor',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/views/ChartEvent'],function($,C,O,V,L,a){var E=function(d,u){E.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ESRIServiceColor";this._uiconfig=u;this._div=d;this._serviceColor$=null;this._fieldsSelectorTitle$=null;this._fieldsSelector$=null;this._startVal$=null;this._startColor$=null;this._endVal$=null;this._endColor$=null;this.createChildren();};O.extend(E,V);E.prototype.createChildren=function(){this._serviceColor$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-panel').appendTo(this._div);this._fieldsSelectorTitle$=$(document.createElement('div')).html(L.get('VIZ_CHART_SELECT_DATASET')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-title').appendTo(this._serviceColor$);this._fieldsSelector$=$(document.createElement('select')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-selector').appendTo(this._serviceColor$);this.createGradient();};E.prototype.showFieldsSelector=function(s){if(s){this._fieldsSelectorTitle$.show();this._fieldsSelector$.show();}else{this._fieldsSelectorTitle$.hide();this._fieldsSelector$.hide();}};E.prototype.createGradient=function(){var g=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-title-group').appendTo(this._serviceColor$);$(document.createElement('div')).html(L.get('VIZ_CHART_SET_COLOR_LAYER')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-title-label').appendTo(g);this._reset$=$(document.createElement('div')).html(L.get("VIZ_CHART_RESET")).addClass(C.CHART_PREFIX+'map-service-selector-services-color-reset').on("click",function(){this._startVal$.val(this._startVal$.prop("defaultValue"));this._endVal$.val(this._endVal$.prop("defaultValue"));}.bind(this)).appendTo(g);var b=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient').appendTo(this._serviceColor$);$(document.createElement('div')).html(L.get("VIZ_CHART_START")).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-start').appendTo(b);var s=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-value-group1').appendTo(b);this._startVal$=$(document.createElement('input')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-value').attr("value","0").appendTo(s);this._startColor$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-colorpicker').css("background-color","#c2e3a9").appendTo(s);$(document.createElement('div')).html(L.get("VIZ_CHART_END")).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-end').appendTo(b);s=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-value-group2').appendTo(b);this._endVal$=$(document.createElement('input')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-value').attr("value","100").appendTo(s);this._endColor$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-color-field-gradient-colorpicker').css("background-color","#35581C").appendTo(s);};E.prototype.init=function(s,c){this._fieldsSelector$.empty();if(s.length){this.showFieldsSelector(true);for(var i=0;i<s.length;i++){$(document.createElement('option')).attr('value',s[i].name).html(s[i].name).appendTo(this._fieldsSelector$);}}else{this.showFieldsSelector(false);}};E.prototype.show=function(){this._serviceColor$.show();};E.prototype.hide=function(){this._serviceColor$.hide();};E.prototype.getColor=function(){return{type:"gradient",bindedField:this._fieldsSelector$.val(),start:{val:this._startVal$.val(),color:this._startColor$.css("background-color")},end:{val:this._endVal$.val(),color:this._endColor$.css("background-color")}}};return E;});define('sap/viz/controls/chart/views/ESRIServiceSelector',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/ESRIServicePanel','sap/viz/controls/chart/views/ESRIServiceColor'],function($,C,O,V,L,a,E,b){var c=function(d,u){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ESRIMapServiceSelector";this._uiconfig=u;this._div=d;this._titleDiv$=null;this._footerDiv$=null;this._servicesDiv$=null;this._servicePanel=null;this._serviceColor=null;this._btnDone$=null;this._btnLayer$=null;this._btnConfirm$=null;this.createChildren();};O.extend(c,V);c.prototype.createChildren=function(){this._titleDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-title').html(L.get('VIZ_CHART_IMPORT_ESRI_CUSTOM_SERVICE')).appendTo($(this._div));this._servicesDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-panel').appendTo($(this._div));this._servicePanel=new E(this._servicesDiv$);this._serviceColor=new b(this._servicesDiv$);$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-gallery-close').on("click",function(){this.hide();}.bind(this)).appendTo($(this._div));this._servicePanel.addEventListener(a.ESRI_CUSTOMIZED_SERVICE_CHANGED,function(e){if(e.data.serviceId){this._btnConfirm$.show();this._btnDone$.hide();}else{this._btnConfirm$.hide();this._btnDone$.show();}}.bind(this));this._footerDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-footer').appendTo($(this._div));this._btnDone$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-button-done').html(L.get('VIZ_CHART_CONFIRM')).on("click",function(){this.hide();this._dispatchEvent(new a(a.ESRI_CUSTOMIZED_SERVICE_CHANGED,this,{serviceId:this._servicePanel.getSelectedService().id,color:this._serviceColor.getColor()}));}.bind(this)).appendTo(this._footerDiv$);this._btnConfirm$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-button-confirm').html(L.get('VIZ_CHART_NEXT')).on("click",function(){this._btnConfirm$.hide();this._btnDone$.show();this._btnLayer$.show();this._servicePanel.hide();this._serviceColor.init(this._servicePanel.getSelectedService().fields);this._serviceColor.show();}.bind(this)).appendTo(this._footerDiv$);this._btnLayer$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-button-layer').html(L.get('VIZ_CHART_BACK')).on("click",function(){this._servicePanel.show();this._serviceColor.hide();this._btnConfirm$.show();this._btnLayer$.hide();this._btnDone$.hide();}.bind(this)).appendTo(this._footerDiv$);this._servicePanel.show();this._serviceColor.hide();this._btnConfirm$.show();this._btnLayer$.hide();this._btnDone$.hide();};c.prototype.show=function(s,d){this._servicePanel.init(s,d);if(!d){this._btnConfirm$.hide();this._btnDone$.show();}else{this._btnLayer$.hide();this._btnDone$.hide();this._btnConfirm$.show();}this._servicePanel.show();this._serviceColor.hide();$(this._div).show();};c.prototype.hide=function(){$(this._div).hide();};return c;});define('sap/viz/controls/chart/views/EsriMessageDialog',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager'],function setup($,C,l){var E=function(d){this.__className="sap.viz.controls.chart.views.EsriNoSerive";this._div=d;this._titleDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-no-service-title').html(l.get('VIZ_CHART_IMPORT_ESRI_CUSTOM_SERVICE')).appendTo($(this._div));this._messageDiv$=$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-no-serive-message').html(l.get('VIZ_CHART_NO_ESRI_SERVICE')).appendTo($(this._div));$(document.createElement('div')).addClass(C.CHART_PREFIX+'map-service-selector-services-gallery-close').on("click",function(){this.hide();}.bind(this)).appendTo($(this._div));};E.prototype.hide=function(){$(this._div).hide();};E.prototype.show=function(m){this._messageDiv$.html(m);$(this._div).show();};return E;});define('sap/viz/controls/chart/views/MapView',['require','jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/utils/MapUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/views/View','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/chart/views/ESRIServiceSelector','sap/viz/controls/chart/views/EsriMessageDialog'],function(r,$,G,C,D,M,E,F,a,b,L,O,U,c,T,V,d,g,h,k,l,I,A,m,n,o){var p=r||p;var q=function(e,f,i){e.splice(i,0,e.splice(f,1)[0]);};function s(e,f){var i=new sap.viz.geo.Map(e,f);i.selection=function(){var j=this.getSelectionModel();return j.selection.apply(j,arguments);};return i;}function t(f,e,i){$.ajax({url:f,data:{f:"json"},dataType:"json",type:"POST",success:function(j){if(j.fields){var z=[];z=j.fields.filter(function(B){return B.type==="esriFieldTypeSmallInteger"||B.type==="esriFieldTypeInteger"||B.type==="esriFieldTypeSingle"||B.type==="esriFieldTypeDouble";});e(z);}else if(j.error){i(j.error);}else{i("Unknown Error");}},error:function(j,z,B){i(B);}});}function u(e,f){var i="https://www.arcgis.com/sharing/rest/content/users/"+e.username;$.ajax({url:i,data:{token:e.accessToken,f:"json"},dataType:"json",type:"POST",success:function(j){if(j.items){var z=j.items.filter(function(H){return H.type==="Feature Service";});if(z.length===0){f([]);return;}var B=0;z.forEach(function(H,J){t(H.url,function(K){B++;H.thumbnailURL="url(https://www.arcgis.com/sharing/rest/content/items/"+H.id+"/info/"+H.thumbnail+"?token="+e.accessToken+")";H.featureServicesFields=K;if(B===z.length){f(z.filter(function(N){return N.featureServicesFields!=null;}));}},function(){B++;if(B===z.length){f(z.filter(function(K){return K.featureServicesFields!=null;}));}});});}else if(j.error){f([]);}else{f([]);}},error:function(j,z,B){f([]);}});}var v=function(e,f,i,j){v.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.MapView";this._mapselector$=null;this._messageDialog$=null;this._messageDialog=null;this._mapServiceSelector=null;this._esriservices=null;this._selectedServiceId=undefined;this._loadedViz=null;this._mapInitialized=false;this._updateCache=null;this._createChildren();sap.viz.api.env.Template.removeListener(this._changeTemplateFunc);};O.extend(v,l);v.prototype._createChildren=function(){v.superclass._createChildren.apply(this,arguments);this._createESRIMapServiceSelector();};v.prototype._createESRIMapServiceSelector=function(){this._mapselector$=$(document.createElement('div')).addClass(g.CHART_PREFIX+'map-service-selector').appendTo($(this._div));this._messageDialog$=$(document.createElement('div')).addClass(g.CHART_PREFIX+'map-no-service').appendTo($(this._div));this._messageDialog=new o(this._messageDialog$);this._messageDialog.hide();this._mapServiceSelector=new n(this._mapselector$);this._mapServiceSelector.addEventListener(h.ESRI_CUSTOMIZED_SERVICE_CHANGED,this._esriServiceChanged.bind(this));this._mapServiceSelector.hide();};v.prototype._esriServiceChanged=function(e){var f=e.data.serviceId;this._selectedServiceColor=e.data.color;this._enableService=true;if(!this._selectedServiceId){this._chartModelProvider().extensionValues({mapBuilder:{mapservice:{showRadio:true,checked:this._enableService}}});}this._selectedServiceId=f;this._changeBaseMap({serviceId:f,color:this._selectedServiceColor});};v.prototype._changeBaseMap=function(e){var i=e.serviceId;var f=e.color;var j;if(!i){j=new sap.viz.geo.basemap.esri.Provider({basemap:this._chart.baseMap().toJSON().options.basemap});}else{var z=this._esriservices.filter(function(B){return B.id===i;});var B=[{}];B[0].type=sap.viz.geo.basemap.esri.Provider.ARCGIS_SERVICE_TYPE_FEATURE;B[0].url=z[0].url;B[0].options={outFields:["*"]};B[0].color=f;j=new sap.viz.geo.basemap.esri.Provider({extent:new esri.geometry.Extent(-115,-34,115,7),basemap:this._chart.baseMap().toJSON().options.basemap},B);}this._chart.baseMap(j);};v.prototype._showRefreshButton=function(){this._refresh$.css({left:$(this._div).width()/2-this._refresh$.width()/2});this._refresh$.css({top:$(this._div).height()/2-this._refresh$.height()/2+40});this._refresh$.show();};v.prototype.modelChanged=function(e,f){var i;if(f.vizTypeChanged){this.showLoadingIcon();}if(f.feedingItemsChanged&&f.feedsChangedInfo&&f.feedsChangedInfo.items){i=f.feedsChangedInfo.items[0];var j=e.feedingItems()[i];var z=new F(F.FEEDS_CHANGED,this,{'datasetType':D.FLAT_TABLE,'feeds':j,'layerIdx':i});this._dispatchEvent(new E(l.DISPATCH_PROPERTY_EVENT,this,z));}if(f.extensionValuesChanged&&e.extensionValues().mapBuilder&&this._chart){var B=e.extensionValues().mapBuilder,H=this._chart;if(B.layer){w.call(this,e,H);}else if(B.mapservice){if(B.mapservice.action==='choose'){this._chooseMapServiceAsBaseMap();}else if(B.mapservice.action==='enable'){this._enableService=true;this._changeBaseMap({serviceId:this._selectedServiceId,color:this._selectedServiceColor});}else if(B.mapservice.action==='disable'){this._mapServiceSelector.hide();this._enableService=false;this._changeBaseMap({});}}}};function w(e,f){var i=e.extensionValues().mapBuilder,j=i.layer.action,z=i.layer.idx,B=i.layer.from,H=i.layer.to,J,K,N=this._options.properties.legend?this._options.properties.legend.visible:true,P=this._options.properties.dataLabel?this._options.properties.dataLabel.visible:false,Q=this._options.properties.plotArea&&this._options.properties.plotArea.colorPalette?this._options.properties.plotArea.colorPalette:undefined;if(j==='add'){f.addLayer(new sap.viz.geo.dataviz.Layer({viz:new sap.viz.geo.dataviz.Choropleth({dataLabel:{visible:P}}),legendVisible:N}),true);J=e.feedingItems();J.push(i.layer.feeds);e.feedingItems(J,false);if(!this._options.data){this._options.data=[];}if(!this._options.feeding){this._options.feeding=[];}this._options.data.push(undefined);this._options.feeding.push(undefined);}else if(j==='delete'&&z>=0){f.removeLayer(f.getLayer(z));J=e.feedingItems();J.splice(z,1);e.feedingItems(J,false);this._options.data.splice(z,1);this._options.feeding.splice(z,1);}else if(j==='reorder'&&B>=0&&H>=0){f.reorderLayer(f.getLayer(B),H);var R=e.feedingItems();q(R,B,H);e.feedingItems(R,false);q(this._options.data,B,H);q(this._options.feeding,B,H);}else if(j==='show'&&z>=0){K=f.getLayer(z);K.visibility(true);}else if(j==='hide'&&z>=0){K=f.getLayer(z);K.visibility(false);}else if(j==='changeVizType'&&z>=0){K=f.getLayer(z);var S=i.layer.vizType;var W=i.layer.feeding;x(K,S,W,P,Q);}else if(j==='changeProperties'&&z>=0){K=f.getLayer(z);var X=i.layer.propKey;var Y=i.layer.propValue;if(X==='markerCluster'||X==='bubbleCluster'){K.viz().properties({cluster:{enabled:Y}});}if(X==='pieDonut'){K.viz().properties({donut:{innerRadiusRatio:0.5,isDonut:Y}});}}}function x(e,f,i,j,z){if(f==='choropleth'){e.viz(new sap.viz.geo.dataviz.Choropleth({dataLabel:{visible:j}}),i);}else if(f==='bubble'){e.viz(new sap.viz.geo.dataviz.Bubble({cluster:{enabled:false},dataLabel:{visible:j},colorPalette:z}),i);}else if(f==='pie'){e.viz(new sap.viz.geo.dataviz.Pie({donut:{isDonut:false},colorPalette:z,dataLabel:{visible:j}}),i);}else if(f==='marker'){e.viz(new sap.viz.geo.dataviz.Marker({width:12,height:20,xoffset:-6,yoffset:-20,cluster:{enabled:false},dataLabel:{visible:j}}),i);}}v.prototype.data=function(e){if(arguments.length>0){this._options.data=e;if(this._chart){this._chartProxy.set('map_doData',e);return this;}else{throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{return this._chartProxy.get('map_doData',this._options.data);}};v.prototype.doData=function(e){try{var f;if(arguments.length>0){if(this._chart){if(!e.length){return this;}f=this._chart.getLayers?this._chart.getLayers():this._chart._layers;var z=f.length>e.length?e.length:f.length;for(var i=0;i<z;++i){if(e[i]){f[i].data(e[i]);}}return this;}else{throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{var B=[];if(this._chart){f=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var j=0;j<f.length;++j){B.push(f[j].data());}}return B;}}catch(H){throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+H;}};v.prototype.action=function(e,f){if(this._chart){if(this._chart.__instance){return this._chart.__instance.action(e,f);}else{return this._chart;}}else{throw L.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};v.prototype.exportViz=function(e){if(!this._isMapInitialized()&&this._loadedViz){return this._loadedViz;}if(this._chart){var f=this._chartProxy.execute('toJSON',e);if(f){f.esriServices=[this._exportEsriService()];if(this.properties().plotArea&&this.properties().plotArea.colorPalette){f.properties=f.properties||{};f.properties.plotArea=f.properties.plotArea||{};f.properties.plotArea.colorPalette=this.properties().plotArea.colorPalette;}}return f;}else{throw L.get('VIZ_CHART_SERIALIZE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};v.prototype._exportEsriService=function(){return{serivceId:this._selectedServiceId,color:this._selectedServiceColor,enableService:!!this._enableService};};v.prototype._loadEsriService=function(e){if(e.esriServices&&e.esriServices.length>0){this._selectedServiceId=e.esriServices[0].serivceId;this._selectedServiceColor=e.esriServices[0].color;this._enableService=e.esriServices[0].enableService;}};function y(){sap.viz.geo.LocationRepository.useLocal({'resourcePath':this._geoResourcePath});}v.prototype.loadViz=function(e){this._destroyChartInstance();if(!e.baseMap){this._options=this._options||{};this._options.properties=this._options.properties||{};this._options.properties.tooltip=e.properties.tooltip;this._createChartInstance();return;}this._options=this._options||{};this._options.data=e.data;this._options.feeding=e.feeding;this._options.properties=e.properties;if(e.layers&&e.layers.length>0&&e.layers[0].options&&e.layers[0].options.legendVisible===false){if(!this._options.properties.legend){this._options.properties.legend={};}this._options.properties.legend.visible=false;}if(e.vizs&&e.vizs.length>0&&e.vizs[0].options&&e.vizs[0].options.dataLabel&&e.vizs[0].options.dataLabel.visible===true){if(!this._options.properties.dataLabel){this._options.properties.dataLabel={};}this._options.properties.dataLabel.visible=true;}this._loadedViz=U.clone(e);this._loadEsriService(this._loadedViz);this._hasChartInstance=true;this._mapInitialized=false;this._dispatchEvent(new h(h.CHART_CHANGING,this,e.type));this._updateDescription();this.showLoadingIcon();var f={};if(e.properties&&e.properties.tooltip){f.tooltip=e.properties.tooltip;}var i=this._chartLayer$;var j=this._chartLayer$.css("visibility");this._chartLayer$.css("visibility","visible");this._chart=s(i.get(0),f);this._chartLayer$.css("visibility",j);if(this._chart){this._bindExternalEventListener();y.call(this);if(e.baseMap.id.indexOf("esri")!==-1){this._logonESRI(function(){this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOADING'));this._chart.fromJSON(e);this._postVizProcess(this._options);}.bind(this),function(){this._hasChartInstance=false;this._chartModelProvider().extensionValues({map:{logOnFail:true}});if(this._chart){this._chart._fireEvent("initialized");}}.bind(this));}else if(e.baseMap.id.indexOf("cvom")!==-1){this._chart.fromJSON(e);this._postVizProcess(this._options);}else if(e.baseMap.id.indexOf("navtaq")){this._chart.fromJSON(e);this._postVizProcess(this._options);}}};v.prototype._setChartSize=function(e,f){if(this._chart&&this._chart.__instance){this._chart.__instance.size({width:e,height:f});}};v.prototype._updateDescription=function(e){if(e){this._descriptionLayer$.show();this._descriptionLayer$.text(e);this._showDescription();}else{this._descriptionLayer$.hide();var f=this._chartHolder$.children();for(var i=0;i<f.length;i++){var j=$(f[i]);j.css({'opacity':""});}}this.hideLoadingIcon();};v.prototype.getTitleByFeeding=function(){return'';};v.prototype._logonESRI=function(e,f){var i=sap.viz.geo.basemap.esri.Authentication.credential().disabled;if(i){this._updateDescription(sap.viz.geo.basemap.esri.Authentication.credential().description);f.call(this);return;}var j=sap.viz.geo.basemap.esri.Authentication.credential();if(!j.accessToken||!j.username){this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_AUTHENTICATION_FAIL'));f.call(this);}else{this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOADING'));e.call(this);}};v.prototype._createChartInstance=function(){var e=this._options;var f=this._chartLayer$;var i=this._descriptionLayer$;var j=this._chartHolder$;var z=C.TYPE_GEO_MAP;this._destroyChartInstance();try{this._dispatchEvent(new h(h.CHART_CHANGING,this,z));var B=this._chartLayer$.css("visibility");this._chartLayer$.css("visibility","visible");this._chart=s(f.get(0),{tooltip:this.properties().tooltip});this._chartLayer$.css("visibility",B);this._bindExternalEventListener();this._hasChartInstance=true;this._mapInitialized=false;var H=e.properties&&e.properties.provider?e.properties.provider:M.ESRI;if(H===M.ESRI){this._logonESRI(function(){this._updateDescription(L.get('VIZ_CHART_ESRI_MAP_LOADING'));var J=this.createBaseMap(H,{});this._chart.baseMap(J,this._afterMapInitialized.bind(this));this._postVizProcess(e);}.bind(this),function(){this._hasChartInstance=false;this._chartModelProvider().extensionValues({map:{logOnFail:true}});if(this._chart){this._chart._fireEvent("initialized");}}.bind(this));}else{var J=this.createBaseMap(H,{});this._chart.baseMap(J,this._afterMapInitialized.bind(this));this._postVizProcess(e);}}catch(K){var N=L.get('VIZ_CHART_CREATE_CHART_FAILED')+K;if(c.isValid(z)){this._updateDescription(U.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),z));}else{this._updateDescription(N);}f.html("");this._chart=null;this._hasChartInstance=false;throw N;}};v.prototype._afterMapInitialized=function(e){var f=$.proxy(function(j,e){this._dispatchEvent(new h(h.TRIGGER_CVOM_EVENT,this,{type:j,data:e}));},this);this.hideLoadingIcon();this._updateDescription();var i=this._chartModelProvider();f("initialized",e);if(!this._loadedViz&&this._isMapInitialized()===false){this._chartModelProvider().extensionValues({map:{created:true,provider:this._options.properties.provider}});}else if(this._loadedViz){this._restoreMapBuilder();}this._mapInitialized=true;if(this._updateCache){this.update(this._updateCache);this._updateCache=null;}};v.prototype._bindExternalEventListener=function(){if(this._chart){Object.keys(this._onEventMap).forEach($.proxy(function(e){var f=this._onEventMap[e];this._chart.on(e,f);},this));}};v.prototype._postVizProcess=function(e){var f=$.proxy(function(j,z){this._dispatchEvent(new h(h.TRIGGER_CVOM_EVENT,this,{type:j,data:z}));},this);this._chart.on("initialized.chartview",this._afterMapInitialized.bind(this));this._chart.on("mapChanged.chartview",function(){this._chartModelProvider().extensionValues({});}.bind(this));var _=this;var i=this._chart.getSelectionModel();i.on("selectData.chartview",function(j){_._dispatchEvent(new h(h.CHANGED_SELECTED_DATA,this));f("selectData",j);});i.on("deselectData.chartview",function(j){_._dispatchEvent(new h(h.CHANGED_SELECTED_DATA,this));f("deselectData",j);});this._chart.on("showTooltip.chartview",function(j){f("showTooltip",j);});this._chart.on("hideTooltip.chartview",function(j){f("hideTooltip",j);});this._chart.on('contextualData.chartview',function(j){this._dispatchEvent(new h(h.CONTEXT_MENU_TRIGGERED,this,j));}.bind(this));this._hasChartInstance=true;this._dispatchEvent(new h(h.CHART_CHANGED,this,this._chart));};v.prototype.getTemplateId=function(e){return this._templateId;};v.prototype._isMapInitialized=function(){return this._mapInitialized;};v.prototype.update=function(e){if(this._isMapInitialized()){var f;try{if(e.data){if(!this._options.data){this._options.data=[];}for(var i=0;i<e.data.length;i++){if(e.data[i]!==undefined){this._options.data[i]=e.data[i];}}}var j=e.properties;if(j){this._options.properties=j;}if(e.feeding){this._options.feeding=e.feeding;}if(!this._chart){f=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');this._updateDescription(f);throw f;}this._updateDescription();this._chartLayer$.css('opacity','');var z=this._chart;if(z){this._chartProxy.execute('map_doUpdate',z,e);}return this;}catch(B){f=L.get('VIZ_CHART_UPDATE_CHART_FAILED')+B;this._updateDescription(f);throw f;}}else{this._updateCache=e;}};v.prototype.doUpdate=function(e,f){if(!e||!f){return;}var i=[];var j=e.getLayers();if(f.data&&U.isArray(f.data)){f.data.forEach(function(z,B){if(j[B]&&(z||z===null)){i[B]={};i[B].adjustBounds=true;i[B].data=z;}});}if(f.feeding&&U.isArray(f.feeding)){f.feeding.forEach(function(z,B){if(j[B]&&z&&!U.deepEqual(z,j[B].feeding())){i[B]=i[B]||{};i[B].adjustBounds=true;i[B].feeding=z;}});}if(f.properties.layers&&U.isArray(f.properties.layers)){f.properties.layers.forEach(function(z,B){if(z&&j[B]){var H=d.getLayerPropertiesFromOption(d.getVizTypeByVizInstance(j[B].viz()),z);if(!U.isEmptyObject(H)){if(H.viz){i[B]=i[B]||{};i[B].viz=H.viz;}if(H.tooltipFormat){j[B].tooltipFormat(H.tooltipFormat);}}}});}j.forEach(function(z,B){if(z){if(f.properties.plotArea&&f.properties.plotArea.colorPalette&&d.getVizTypeByVizInstance(z.viz())==="bubble"){i[B]=i[B]||{};i[B].viz=i[B].viz||{};i[B].viz.colorPalette=f.properties.plotArea.colorPalette;}if(i[B]&&!U.isEmptyObject(i[B])){z.update(i[B]);}}});};v.prototype.feeding=function(f,e){if(this._chart){if(arguments.length>0&&f.length>0){this._options.feeding=f;this._chartProxy.set('map_doFeeding',f,e);return this;}else{return this._chartProxy.get('map_doFeeding',this._options.feeding);}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};v.prototype.doFeeding=function(f,e){try{if(this._chart){var z;if(arguments.length>0&&f.length>0){z=this._chart.getLayers?this._chart.getLayers():this._chart._layers;var B=z.length>f.length?f.length:z.length;for(var i=0;i<B;++i){if(f[i]){z[i].feeding(f[i]);}}return this;}else{var H=[];z=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var j=0;j<z.length;++j){var J=z[j].feeding();H.push(J);}return H;}}else{throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}catch(K){throw L.get('VIZ_CHART_UPDATE_FEEDING_FAILED')+K;}};v.prototype.getValidProperties=function(e,f){if(f===C.TYPE_GEO_MAP){return e;}return V.getValidProperties(e,f);};v.prototype.properties=function(e){if(arguments.length>0){this._options.properties=$.extend(true,this._options.properties,e);if(this._chart){this._chartProxy.set('map_doProperties',e);return this;}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{return this._options.properties;}};v.prototype.doProperties=function(e){try{if(arguments.length>0){if(this._chart){var f=this._chart;var j=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var i=0;i<j.length;i++){var z=j[i];if(z&&e.legend){z.legendVisibility(e.legend.visible);}if(z&&e.dataLabel){z.viz().properties({dataLabel:e.dataLabel});}}return this;}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}}catch(B){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+B;}};v.prototype.copyData=function(e,f){if(f&&f.length>0){var j=[];for(var i=0;i<f.length;i++){if(f[i]&&f[i].id&&(f[i].id==="sap.viz.data.FlatTableDataset")){var z=sap.viz.api.data.FlatTableDataset.fromJSON(f[i]);j.push(z);}else{j.push(f[i]);}}return j;}else{return f;}};v.prototype.buildFeedings=function(e,z,B){var H=[];for(var i=0;i<B.length;i++){H[i]={};if(!B[i]||B[i].length===0){continue;}B[i].forEach(function(f){if(f._values&&f._values.length){if(f._values[0].type()===A.HIERARCHY){for(var j=0;j<f._values[0].hierarchyLevels().length;j++){var J=f._values[0].hierarchyLevels()[j];if(J.selected()){H[i][f._id]=J._id;break;}}}else{H[i][f._id]=f._values[0]._id;}}});}return H;};v.prototype.createBaseMap=function(e,f){var i=null;var j;y.call(this);if(e===M.ESRI){j={basemap:f&&f.type};return new sap.viz.geo.basemap.esri.Provider(j);}else if(e===M.NAVTEQ){j={center:[40.72,-84],zoom:5};return new sap.viz.geo.basemap.navteq.Provider(j);}else{j={center:[-84,40.72],scale:6000};return new sap.viz.geo.basemap.cvom.Provider(f);}};v.prototype.FeedsToJSON=function(f){var e=[];for(var i=0;i<f.length;i++){e[i]=m.toJSON(f[i]);}return e;};v.prototype.FeedsFromJSON=function(e){var f=[];for(var i=0;i<e.length;i++){f[i]=m.fromJSON(e[i]);}return f;};v.prototype._queryEsriServices=function(e){var f=sap.viz.geo.basemap.esri.Authentication.credential();if(f!=null&&f.username&&f.accessToken){u.call(this,f,function(i){e.call(this,i);}.bind(this));}else{this._showMessage(L.get('VIZ_CHART_ESRI_MAP_AUTHENTICATION_FAIL'));}};v.prototype._showMessage=function(e){var f=$(this._div).height()/2-this._messageDialog$.height()/2;var i=$(this._div).width()/2-this._messageDialog$.width()/2;this._messageDialog$.css({top:f,left:i});this._messageDialog.show(e);};v.prototype._chooseMapServiceAsBaseMap=function(){this._queryEsriServices(function(e){this._messageDialog.hide();this._esriservices=e;if(this._esriservices&&this._esriservices.length>0){var f=$(this._div).height()/2-this._mapselector$.height()/2;var i=$(this._div).width()/2-this._mapselector$.width()/2;this._mapselector$.css({top:f,left:i});this._mapServiceSelector.show(this._esriservices,this._selectedServiceId);}else{this._showMessage(L.get('VIZ_CHART_NO_ESRI_SERVICE'));}}.bind(this));};v.prototype._restoreMapBuilder=function(e){if(this._loadedViz){var f=[];if(this._loadedViz.layers.length>0){var z=this._chartModelProvider().feedingItems();for(var i=0;i<this._loadedViz.layers.length;i++){var B=d.getVizTypeByVizId(this._loadedViz.vizs[this._loadedViz.layers[i].vizIndex].id);var H="";var J=false;var K=null;var N;if(z&&z[i]&&z[i].length>0){var P=null,Q=null;for(var j=0;j<z[i].length;j++){if(z[i][j].type()==="Measure"){P=z[i][j].values()[0];}else if(z[i][j].id()==="location"){Q=z[i][j].values()[0];}}if(P){H=P.name();}else{if(Q){H=Q.name();}}}if(B==="bubble"||B==="marker"){var R=this._loadedViz.vizs[this._loadedViz.layers[i].vizIndex].options.cluster;J=R&&R.enabled;}if(B==="pie"){K=this._loadedViz.vizs[this._loadedViz.layers[i].vizIndex].options.donut.isDonut;}N={checked:this._loadedViz.layers[i].options.visible,feeding:{feeding:this.FeedsToJSON(z[i]?z[i]:[])},title:H,titleText:B,vizType:B,sortable:true,clusterChecked:J,donutChecked:K};f.push(N);}}this._chartModelProvider().extensionValues({mapBuilder:{status:f,provider:this._loadedViz.properties.provider}});}if(this._loadedViz&&this._selectedServiceId){this._queryEsriServices(function(S){this._esriservices=S;if(this._esriservices&&this._esriservices.length>0){this._chartModelProvider().extensionValues({mapBuilder:{mapservice:{showRadio:true,checked:!!this._enableService}}});}}.bind(this));}this._loadedViz=null;};v.prototype.exportable=function(){return this._chart!=null;};v.prototype.exportToSVGString=function(e){return"";};v.prototype.queryProperties=function(e){return{};};v.prototype.updateProperties=function(e){};v.prototype.selectedPropertyZone=function(){if(arguments.length){return this;}return null;};return v;});define('sap/viz/controls/chart/views/TableView',['jquery','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/MapProviderConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/TrellisUtils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/views/View','sap/viz/controls/common/utils/IncompleteGhost'],function($,G,C,D,M,E,F,a,L,O,u,b,T,V,c,d,e,f,I){var g=function(h,o,l,i){g.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.TableView";this._createChildren();};O.extend(g,f);g.prototype._createChildren=function(){g.superclass._createChildren.apply(this,arguments);this._createDropZone();};g.prototype.getTitleZone=function(){if(!this._chart){return[];}var t=this._options.type;var z;try{z=this._chartProxy.get('propertyZone',[]);}catch(h){return[];}var j=[];for(var i=0;i<z.length;i++){if(z[i].name=='title'){j=z[i].bound[0];break;}}return j;};g.prototype.properties=function(p,h){try{if(!h){this._requestMorphing=true;}if(arguments.length>0){this._options.properties=p;if(this._chart){this._chartProxy.set('properties',p);return this;}else{throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{return this._chartProxy.get('properties',this._options.properties);}}catch(i){throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+i;}};g.prototype.css=function(h){try{if(arguments.length>0){this._updateCssCacheByNewCss(h);this._options.css=h;if(this._chart){this._chartProxy.set('css',h);return this;}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{return this._chartProxy.get('css',this._options.css);}}catch(i){throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+i;}};g.prototype._createChartInstance=function(){this._hasChartInstance=false;var o=this._options;var h=this._chartLayer$;var i=this._descriptionLayer$;var j=this._chartHolder$;var v=o.type;this._destroyChartInstance();try{this._dispatchEvent(new d(d.CHART_CHANGING,this,v));var k=this._updateDescriptionByOptions(o);if(!k){var l=this._chartLayer$.css("visibility");this._chartLayer$.css("visibility","visible");this._chart=this._chartProxy.execute('sap.viz.api.core.createViz',{type:v,data:o.data,feeding:o.feeding,properties:o.properties,css:o.css,events:o.events,container:h.get(0)});this._chartLayer$.css("visibility",l);if(this._chart){this._postVizProcess(o);}}}catch(m){var n=L.get('VIZ_CHART_CREATE_CHART_FAILED')+m;if(b.isValid(v)){this._updateDescription(u.substitute(L.get("VIZ_CHART_INVALID_VIZ_TYPE"),v));}else{this._updateDescription(n);}h.html("");this._chart=null;this._hasChartInstance=false;throw n;}};g.prototype._postVizProcess=function(o){Object.keys(this._onEventMap).forEach($.proxy(function(k){var h=this._onEventMap[k];this._chart.on(k,h);},this));this._hasChartInstance=true;this._dispatchEvent(new d(d.CHART_CHANGED,this,this._chart));};g.prototype.buildFeedings=function(t,h,i){var j=null;if(!h||b.isEmptyData(t,h)){return j;}if(!V.hasFakeData(h)&&!b.isEmptyData(t,h)&&!a.isEmptyFeeds(i)){j=[];i.forEach(function(k){var l=k.id();j[l]=[];k.values().forEach(function(m){var n={"id":m.id(),"name":m.name(),"type":m.type()};j[l].push(n);});});}return j;};g.prototype.exportViz=function(o){if(this._chart){var r=this._chartProxy.execute('toJSON',o);return r;}else{throw L.get('VIZ_CHART_SERIALIZE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};return g;});define('sap/viz/controls/chart/ViewManager',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/chart/views/ChartView','sap/viz/controls/chart/views/InfoChartView','sap/viz/controls/chart/views/MapView','sap/viz/controls/chart/views/TableView'],function(C,a,b,I,M,T){var t={};var V={};V._register=function(c,v){if(c&&v){t[c]=v;}};V._getViewClass=function(c){if(t.hasOwnProperty(c)){return t[c];}else if(a.isInfoChart(c)){return I;}else{return b;}};V.getViewClass=function(c){return V._getViewClass(c);};V._register(C.TYPE_GEO_MAP,M);V._register(C.TYPE_TABLE,T);V._register(C.TYPE_CROSSTAB,T);return V;});define('sap/viz/controls/common/services/scalesharing/ScaleMixer',["sap/viz/controls/common/utils/Utils"],function(U){var c=U.clone;function u(a){if(a==null){return undefined;}var b=[];Object.keys(a).forEach(function(k){var v=a[k];if(v){b.push(v);}});b.sort();var i=0,l=b.length,h=0,d,p;for(;i<l;i++){d=b[i];if(U.isObject(d)&&d.d){h=(h<<5)-h+d.d.length;h|=0;}else if(U.isString(d)){h=(h<<5)-h+d.length;h|=0;}}b.unshift(h);var o=''+b[0];for(i=1;i<b.length;i++){d=b[i];if(U.isObject(d)&&d.d){o+=','+d.d;}else if(U.isString(d)){o+=','+d;}}return o;}function S(){this.scalesLookup={};}S.prototype.mergeScale=function(s){var a=u(s.dataContext),b=this.scalesLookup[a];if(!b){b=this.scalesLookup[a]={contexts:[s.dataContext],scale:s.scaleResult};}};S.prototype.getMergedScales=function(){var l=this.scalesLookup;return Object.keys(l).reduce(function(a,k){var v=l[k];Array.prototype.push.apply(a,v.contexts.map(function(b){return{dataContext:b,scaleResult:v.scale};}));return a;},[]);};return S;});define('sap/viz/controls/common/services/scalesharing/ScaleGroup',["sap/viz/controls/common/utils/Utils","sap/viz/controls/common/services/scalesharing/ScaleMixer"],function(U,S){var c=U.clone;function m(b,l){function g(n){var d=b[n];if(d==null){d=b[n]=new S();}return d;}l.forEach(function(e){var d=e,f=d.runtimeScales();f.forEach(function(h){var i=g(h.feed);h.results.forEach(function(e){i.mergeScale(e);});});});return b;}function a(){this._list=[];this._sharedRuntimeScales=[];}a.prototype.add=function(b,i){var d=this._list.indexOf(b);if(d>-1){return;}if(i==null){this._list.push(b);}else if(this._list[i]==null){this._list[i]=b;}else{this._list.splice(i,0,b);}};a.prototype.remove=function(b){var i=this._list.indexOf(b);if(i>-1){this._list.splice(i,1);}};a.prototype.indexOf=function(b){var i=this._list.indexOf(b);return i;};a.prototype.load=function(b,i,d){this.add(b,i);this._sharedRuntimeScales=t(m({},[{runtimeScales:(function(){return this._sharedRuntimeScales;}).bind(this)},{runtimeScales:function(){return d;}}]));};function t(b){return Object.keys(b).map(function(k){var r=b[k].getMergedScales();return{feed:k,results:r};});}a.prototype.getRuntimeScales=function(b){var d,r,l=[];if(b){this._list.some(function(e){var i=(e===b);if(!i){l.push(e);}return i;});}else{l=this._list.slice();}l=l.filter(function(e){return e!=null;});if(this._sharedRuntimeScales){l.push({runtimeScales:(function(){return this._sharedRuntimeScales;}).bind(this)});}d=m({},l);r=t(d);this._sharedRuntimeScales=r;return r;};function s(l,f){var b,d,g;if(f==null){return[[],l.slice()];}l.some(function(e,i){if(e===f){g=i;return true;}});if(g!=null){b=l.slice();d=b.splice(g);return[b,d];}else{return[[],l.slice()];}}a.prototype.syncScales=function(f){var b=s(this._list,f);var d={};m(d,b[0]);b[1].forEach(function(e){var r=t(d);e.sharedRuntimeScales(r);m(d,[e]);});};return a;});define('sap/viz/controls/common/services/ScaleSharingService',["sap/viz/controls/common/services/scalesharing/ScaleGroup"],function(S){var s={};var g={},a={};function b(n){var c=g[n];if(c==null){c=g[n]=new S();}return c;}function r(c,d){var e=b(d);e.remove(c);delete a[c.vizUid()];}s.add=function(c,d,i){var e=a[c.vizUid()],f;if(e){r(c,e);}a[c.vizUid()]=d;f=b(d);f.add(c,i);};s.load=function(c,d,i,e){var f=a[c.vizUid()],h;if(f===d){return;}if(f){r(c,f);}a[c.vizUid()]=d;h=b(d);h.load(c,i,e);};s.remove=function(c){var d=a[c.vizUid()];if(d){r(c,d);return true;}return false;};s.getSharedRuntimeScales=function(c){var d;if(typeof c==="string"){d=c;}else{d=a[c.vizUid()];}if(d==null){return undefined;}var e=b(d);if(e==null){return undefined;}return e.getRuntimeScales();};s.getGroup=function(c){var d=a[c.vizUid()];return d;};s.getIndexInGroup=function(c){var d=a[c.vizUid()];if(d==null){return undefined;}var e=b(d);if(e==null){return undefined;}return e.indexOf(c);};return s;});define('sap/viz/controls/chart/VizProxyHandler',['sap/viz/controls/runtime/VizProxy','sap/viz/controls/chart/views/ChartEvent'],function(V,C){var a=function(c){this.__className="sap.viz.controls.chart.VizProxyHandler";this._chart=c;this._init();};a.prototype._init=function(){this._operationMap={};this._operationMap[V.GetTitleZoneOperation]=this._getTitleZone;this._operationMap[V.GetTitleTextOperation]=this._getTitleText;this._operationMap[V.SetTitleTextOperation]=this._setTitleText;this._operationMap[V.GetTitleTextByFeedingOperation]=this._getTitleTextByFeeding;this._operationMap[V.RestoreTitleTextOperation]=this._restoreTitleText;this._operationMap[V.SetTitleModeOperation]=this._setTitleMode;this._operationMap[V.IsFakeChartOperation]=this._isFakeChart;this._operationMap[V.IsTitleCustomizedOperation]=this._isTitleCustomized;this._operationMap[V.GetPropertiesOperation]=this._getProperties;this._operationMap[V.SetPropertiesOperation]=this._setProperties;this._operationMap[V.GetSelectionOperation]=this._getSelection;this._operationMap[V.SetDatasetOperation]=this._setDataset;this._operationMap[V.GetPropertyZonesOperation]=this._getPropertyZones;this._operationMap[V.SetPropertyZonesOperation]=this._setPropertyZones;this._operationMap[V.QueryPropertiesOperation]=this._queryProperties;this._operationMap[V.UpdatePropertiesOperation]=this._updateProperties;this._operationMap[V.GetDatasetOperation]=this._getDataset;this._operationMap[V.AddEventListenerOperation]=this._addEventListener;this._operationMap[V.RemoveEventListenerOperation]=this._removeEventListener;this._operationMap[V.DispatchEventOperation]=this._dispatchEvent;this._operationMap[V.SetAxisScaleOperation]=this._setAxisScaleListener;this._operationMap[V.GetDataPointsPosition]=this._getDataPointsPosition;this._operationMap[V.GetTypeOperation]=this._getType;this._operationMap[V.OnOperation]=this._on;this._operationMap[V.OffOperation]=this._off;this._operationMap[V.GetSizeOperation]=this._getSize;this._operationMap[V.SetSizeOperation]=this._setSize;this._operationMap[V.GetVizFeedingOperation]=this._getVizFeeding;this._operationMap[V.GetScalesOperation]=this._getScales;this._operationMap[V.SetScalesOperation]=this._setScales;this._operationMap[V.SetAnimationLayerOperation]=this._setAnimationLayer;};a.prototype.response=function(d){var o=d.operation;var b=d.args;d.result=this._operationMap[o].apply(this,b);};a.prototype._getTitleZone=function(){return this._chart.getTitleZone();};a.prototype._getTitleText=function(){return this._chart.titleWithInteracionEvent();};a.prototype._setTitleText=function(t){this._chart.titleWithInteracionEvent(t);};a.prototype._getTitleTextByFeeding=function(){return this._chart.getTitleTextByFeeding();};a.prototype._restoreTitleText=function(){this._chart.restoreTitleText();};a.prototype._setTitleMode=function(m){this._chart.vizTitleMode(m);};a.prototype._isFakeChart=function(){return this._chart.isFake();};a.prototype._isTitleCustomized=function(){return this._chart.isTitleCustomized();};a.prototype._getProperties=function(){return this._chart.propertiesWithEvents();};a.prototype._setProperties=function(n,t){this._chart.propertiesWithEvents(n,[C.USER_INTERACTION_COMPLETE,C.VIZ_PROPERTIES_CHANGED],t);};a.prototype._setDataset=function(o){this._chart.vizUpdate({data:o});};a.prototype._getSelection=function(){return this._chart.vizSelection();};a.prototype._getType=function(){return this._chart.vizType();};a.prototype._getPropertyZones=function(){return this._chart.getPropertyZones();};a.prototype._setPropertyZones=function(v){this._chart.setPropertyZones(v);};a.prototype._queryProperties=function(o){return this._chart.queryProperties(o);};a.prototype._updateProperties=function(o,t){this._chart.updateProperties(o,t);};a.prototype._getDataset=function(){return this._chart.vizData();};a.prototype._addEventListener=function(t,l,s,p){this._chart.addEventListener(t,l,s,p);};a.prototype._removeEventListener=function(t,l,s){this._chart.removeEventListener(t,l,s);};a.prototype._dispatchEvent=function(t,l,s){this._chart._dispatchEvent(t,l,s);};a.prototype._setAxisScaleListener=function(z){return this._chart.setAxisScale.apply(this._chart,arguments);};a.prototype._getDataPointsPosition=function(d){return this._chart.getDataPointsPosition.apply(this._chart,arguments);};a.prototype._on=function(e,c){return this._chart.vizOn.apply(this._chart,arguments);};a.prototype._off=function(e){return this._chart.vizOff.apply(this._chart,arguments);};a.prototype._getSize=function(){return this._chart.size();};a.prototype._setSize=function(s){if(s){this._chart.size(s);this._chart._dom$.parent().width(s.width);this._chart._dom$.parent().height(s.height);}};a.prototype._getVizFeeding=function(){return this._chart.getFeeding();};a.prototype._getScales=function(){return this._chart.vizScales();};a.prototype._setScales=function(s){return this._chart.scalesWithEvents(s,[C.USER_INTERACTION_COMPLETE]);};a.prototype._setAnimationLayer=function(){return this._chart.setAnimationLayer();};return a;});define('sap/viz/controls/chart/Chart',['jquery','sap/viz/controls/common/constants/FeedConst','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/migrate/migrator/TypeMigrator','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/managers/LangManager','sap/viz/controls/chart/ChartConfig','sap/viz/controls/chart/ChartPreHandler','sap/viz/controls/chart/ChartProxy','sap/viz/controls/common/utils/IncompleteGhost','sap/viz/controls/chart/views/ChartView','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/View','sap/viz/controls/chart/views/InfoChartView','sap/viz/controls/chart/ViewManager','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/common/services/BVRService','sap/viz/controls/common/services/FeedValidationService','sap/viz/controls/common/services/ScaleSharingService','sap/viz/controls/runtime/VizProxy','sap/viz/controls/chart/VizProxyHandler','sap/viz/controls/chart/morph/VizMorpher','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/migrate/migrator/DataMigrator','sap/viz/controls/common/migrate/migrator/PropertyMigrator','sap/viz/controls/common/migrate/migrator/FeedMigrator','sap/viz/controls/runtime/VizModel'],function($,F,V,G,C,D,E,a,b,c,d,f,g,O,u,k,I,T,M,L,l,m,n,o,q,r,s,t,v,R,B,y,S,z,A,H,J,K,P,N,Q){var U=function U(e,h){if(e==null){throw new Error("div param is required in constructor of Chart.");}U.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.Chart";this._div=e;this._uiConfig=h?h:l.instance();this._uiConfig.libFolderPath=G.defaultAssetsRoot()+'/common/libs';this._layout=null;this._chartViewInstance=null;this._chartViewManager={};this._type=null;this._vizDirection=null;this._data=null;this._properties=null;this._scales=[];this._categoryAxis=[];this._valueAxis=[];this._labelFormats=null;this._css=null;this._description=null;this._vizCreated=false;this._enableVizDefChangedEvent=true;this._enableUserInteractionComplete=true;this._loadingModel=false;this._loadingInstance=false;this._titleMode=U.VIZ_TITLE_MODE.auto;this._titleGeneratorFunc=null;this._enableTrellis=(this._uiConfig.enableTrellis!==false);this._enableMorphing=(this._uiConfig.enableMorphing!==false);this._vizMorpher=null;R.getRuntime().registerModel(this._uid,this._vizModel());this._vizProxyHandler=new A(this);this._vizModel().addEventListener(z.VizProxyEvent,function(i){this._vizProxyHandler.response(i.data);},this);this._chartPreHandler=new m();this._chartProxy=new n(this);this._createChildren();this._onEventMap={};this._feedingItemChanged=false;this._feedingItemChangedOptions={};};O.extend(U,V);U.VIZ_TITLE_MODE={manual:"manual",auto:"auto"};U.prototype.vizType=function(e){if(arguments.length>0){if(!u.isString(e)){return;}this._beginUpdateProperty();e=T.migrate(e);this._vizType=e;this._vizModel().type(this._vizType);this._endUpdateProperty();return this;}else{return this._vizModel().type();}};U.prototype.vizTitle=function(e){if(arguments.length>0){this._setTitle(e);return this;}else{return this._getTitle();}};U.prototype.titleWithInteracionEvent=function(e){if(arguments.length>0){this._setTitle(e);this._dispatchInteractionCompleteEvent({'vizTitleChanged':true});return this;}else{return this._getTitle();}};U.prototype._setTitle=function(e){if(e===undefined){e='undefined';}else if(e!==null){e=e.toString().trim();}if(k.hasFakeData(this._data)||e===''){e=null;}var h=this.vizProperties()?this.vizProperties().title:null;if(!h||e!==h.text){if(!h){h={};}h.text=e;this._setProperties({'title':h});}};U.prototype._getTitle=function(){var e=this._getProperties()?this._getProperties().title:null;return e?e.text:null;};U.prototype.clearSelectedPropertyZone=function(){this._chartViewInstance.selectedPropertyZone(null);};U.prototype.isFake=function(){return k.hasFakeData(this._data);};U.prototype.setTitleGeneratorFunc=function(e){if(e!==null&&e!==undefined&&!u.isFunction(e)){return;}this._titleGeneratorFunc=e;};U.prototype.vizTitleMode=function(e){if(arguments.length>0){if(e==U.VIZ_TITLE_MODE.auto||e==U.VIZ_TITLE_MODE.manual){this._titleMode=e;}}else{return this._titleMode;}};U.prototype.isTitleCustomized=function(){return this._titleMode===U.VIZ_TITLE_MODE.manual;};U.prototype.getTitleZone=function(){if(this._chartView().getTitleZone){return this._chartView().getTitleZone();}else{return[];}};U.prototype.getTitleTextByFeeding=function(){if(this._titleGeneratorFunc){var e=[this.vizUid()];return this._titleGeneratorFunc.apply(null,e);}return this._chartView().getTitleByFeeding();};U.prototype.restoreTitleText=function(){this.titleWithInteracionEvent(this.getTitleTextByFeeding());};U.prototype._titleChangedHandler=function(e){var h=e.data.text;this.titleWithInteracionEvent(h);};U.prototype._addModelEventListener=function(e){e.addEventListener(Q.FeedingChangedEvent,this._onFeedingChanged,this);U.superclass._addModelEventListener.apply(this,arguments);};U.prototype._removeModelEventListener=function(e){e.removeEventListener(Q.FeedingChangedEvent,this._onFeedingChanged,this);U.superclass._removeModelEventListener.apply(this,arguments);};U.prototype.destroy=function(){this._destroyViz();S.remove(this);U.superclass.destroy.apply(this,arguments);};U.prototype.feedAnalysisObjects=function(e,h){this._beginUpdateProperty();h=h===true;var i=this._vizModel();var j=i.type();var p=i.explicitFeedingItems();var w;if(h){w=B.suggestFeeds(j,p,e);}else{w=B.suggestFeeds(j,e);}if(h&&f.equal(p,w.feeds)){e.forEach(function(x){var Z=false;var _=M.get(j).getBindingDefs();_.forEach(function(a1){if(!Z&&y.replaceable(j,p,a1.id(),x)){X(j,p,x);Z=true;}});});}else{p=w.feeds;}i.feedingItems(p);this._endUpdateProperty();return p;};U.getDefaultIncompleteOptions=function(e){if(!u.isString(e)){return;}e=T.migrate(e);var p=U._getDefaultProperties(e,l.instance());return{'type':e,'properties':p,'data':o.getDataset(e)};};U.prototype._updateColumnDimCount=function(){if(g.isMultipleChart(this._vizModel().type())){var e=f.getNumberOfDimensionsInColumn(this._vizModel().feedingItems());this._properties=this._properties||{};this._properties.multiLayout=this._properties.multiLayout||{};this._properties.multiLayout.numberOfDimensionsInColumn=e;}};U.prototype._dispatchVizDefChangedEvent=function(e){var h={vizTypeChanged:(e.vizTypeChanged===true),vizPropertiesChanged:(e.vizPropertiesChanged===true),vizCssChanged:(e.vizCssChanged===true),feedingItemsChanged:(e.feedingItemsChanged===true),filterChanged:(e.filterChanged===true),vizTitleChanged:(e.vizTitleChanged===true),vizScalesChanged:(e.vizScalesChanged===true)};if(this._vizDefChangedData){for(var p in this._vizDefChangedData){if(this._vizDefChangedData.hasOwnProperty(p)){h[p]=h[p]||this._vizDefChangedData[p];}}this._vizDefChangedData=null;}if(this._enableVizDefChangedEvent){this._dispatchEvent(new a(E.VIZ_DEFINITION_CHANGED,this,h));}else{this._vizDefChangedData=h;}};U.prototype._dispatchInteractionCompleteEvent=function(e){if(this._enableUserInteractionComplete){var h={};for(var p in e){if(e[p]===true){h[p]=e[p];}}this._dispatchEvent(new a(r.USER_INTERACTION_COMPLETE,this,h));}};U.prototype._updateView=function(e){var h=v.getViewClass(e);if(this._chartViewInstance instanceof h){return;}if(this._chartViewInstance){if(!this._chartViewManager[this._chartViewInstance.__className]){this._chartViewManager[this._chartViewInstance.__className]=this._chartViewInstance.store();}this._chartViewInstance.destroy();this._chartViewInstance=null;this._data=null;}this._createChartView(h);if(this._chartViewManager[this._chartViewInstance.__className]){this._chartViewInstance.restore(this._chartViewManager[this._chartViewInstance.__className]);}this._chartView().onEventMap(this._onEventMap);var i={width:$(this._div).width(),height:$(this._div).height()};this._chartView().size(i);if(g.isTable(e)){this._data=o.getDataset(e);}var j={type:e};this._dispatchEvent(new r(r.VIZ_VIEW_CHANGED,this,j));};U.prototype._onFeedingChanged=function(e){var h=this._vizModel().type();if(e.data.feedingItemsChanged&&!g.isGeo(h)){this._feedingItemChanged=true;this._feedingItemChangedOptions={measureFeedingItemsChanged:e.data.measureFeedingItemsChanged,dimensionFeedingItemsChanged:e.data.dimensionFeedingItemsChanged,action:e.data.action,properties:this._properties};}};U.prototype._onVizModelChanged=function(e){if(!this._inUpdatingProperty()&&(e.data.feedingItemsChanged||e.data.vizTypeChanged||e.data.isMNDVisibleChanged||e.data.sliceDimensionChanged)){this._dispatchInteractionCompleteEvent(e.data);}this._dispatchVizDefChangedEvent(e.data);var h=this._vizModel().type();if(e.data.vizTypeChanged){if(g.isSupportMorphing(h)&&this._enableMorphing){this._vizMorpher.showMorphing(true,false);}else{this._vizMorpher.resetMorphCache();}this._updateView(h);if(g.isSupportMorphing(h)&&this._enableMorphing){this._chartView().hideChartLayer();}}if(this._loadingModel){return;}if(e.data.vizTypeChanged){if(!this._inUpdatingProperty()){this._properties=this._chartView().resetProperties(this._properties,h);}this._updateAxisProperties(h);this._updateLabelFormats(h);if(g.isVizChart(h)&&g.getDirection(h)){var i=g.getDirection(h);if(this._vizDirection===null){this._vizDirection=i;}else if(this._vizDirection!==i){this._css=this._chartView().updateCss({'directionChanged':true},this._css);this._vizDirection=i;}}this._dispatchPropertyEvent(new r(r.VIZTYPE_CHANGED,this,{type:h}));}if(!this._chartView()){return;}if(e.data.feedingItemsChanged&&!g.isGeo(h)){this._updateColumnDimCount();if(!this._inUpdatingProperty()){this._updateTitle();this.showLoadingIcon();var j=g.getDatasetType(h);this._dispatchPropertyEvent(new b(b.FEEDS_CHANGED,this,{datasetType:j,feeds:this.feeds()}));return;}}this._chartView().modelChanged(this._vizModel(),e.data);if(e.data.extensionValuesChanged){var p=this._vizModel().extensionValues();if(p.feedingPanel&&this._enableTrellis!==p.feedingPanel.enableTrellis){this._enableTrellis=p.feedingPanel.enableTrellis;this._chartView().enableTrellis(this._enableTrellis);}}if(this._needCreateViz(h,false)&&(e.data.vizTypeChanged||e.data.feedingItemsChanged)){this._createVizInstance();}};function W(p,e,h){if(e&&h){var i,j,w;for(i=0;i<e.length;i++){j=e[i];if(h.length>i){w=h[i];p[j]=u.clone(h[i]);}}}}U.prototype._applyFeedingItemChanged=function(){if(this._chartView()&&this._data&&this._data.measures){this._feedingItemChangedOptions.measures=this._data.measures();this._chartView().feedingItemChanged(this._feedingItemChangedOptions);if(this._feedingItemChangedOptions&&this._feedingItemChangedOptions.propertiesChanged){this._properties=this._feedingItemChangedOptions.properties;}this._feedingItemChanged=false;this._feedingItemChangedOptions={};}};U.prototype._updateAxisProperties=function(e){if(this._properties){var h=k.getCategoryAxis(e);W(this._properties,h,this._categoryAxis);var i=k.getValueAxis(e);W(this._properties,i,this._valueAxis);}};U.prototype._updateLabelFormats=function(e){var h=['xAxis','xAxis2','yAxis','yAxis2','valueAxis','valueAxis2'];var p={'xAxis':'yAxis','xAxis2':'yAxis2','yAxis':'xAxis','yAxis2':'xAxis2'};var i,j;if(!this._labelFormats&&this._properties){for(i=0;i<h.length;i++){j=h[i];var w;if(j==='valueAxis'&&!g.isInfoChart(e)){w=this._properties.plotArea?this._properties.plotArea.valueAxis:null;}else{w=this._properties[j];}var x=(w&&w.label&&w.label.hasOwnProperty('formatString'))?true:false;if(x){this._labelFormats=this._labelFormats||{};this._labelFormats[j]=w.label.formatString;}}}var Z=M.get(e).getPropertiesDef();if(!Z){return;}var _;for(i=0;i<h.length;i++){j=h[i];var a1;if(j==='valueAxis'&&!g.isInfoChart(e)){if(Z.plotArea&&Z.plotArea.valueAxis){a1=Z.plotArea.valueAxis.supportedValues;}}else{a1=Z[j];}var b1=false;if(g.isInfoChart(e)){b1=a1&&a1.children&&a1.children.label&&a1.children.label.children&&a1.children.label.children.formatString;}else{b1=a1&&a1.label&&a1.label.supportedValues&&a1.label.supportedValues.hasOwnProperty('formatString')}if(b1){var c1;if(this._properties){var d1;if(j==='valueAxis'&&!g.isInfoChart(e)){if(this._properties.plotArea&&this._properties.plotArea.valueAxis){d1=this._properties.plotArea.valueAxis;if(d1&&d1.label&&d1.label.hasOwnProperty('formatString')){c1=d1.label.formatString;}}}else{d1=u.clone(this._properties[j]);if(d1&&d1.label&&d1.label.hasOwnProperty('formatString')){c1=d1.label.formatString;}}}if(c1===undefined&&this._labelFormats){c1=this._labelFormats[j];if(c1===undefined&&!(j==='valueAxis'&&!g.isInfoChart(e))){var e1=p[j];if(e1){c1=this._labelFormats[e1];}}}if(c1===undefined){c1=this._uiConfig.defaultLabelFormatString;}if(c1!==undefined){this._properties=this._properties||{};if(j==='valueAxis'&&!g.isInfoChart(e)){this._properties.plotArea=this._properties.plotArea||{};this._properties.plotArea.valueAxis=this._properties.plotArea.valueAxis||{};this._properties.plotArea.valueAxis.label=this._properties.plotArea.valueAxis.label||{};this._properties.plotArea.valueAxis.label.formatString=c1;}else{this._properties[j]=this._properties[j]||{};this._properties[j].label=this._properties[j].label||{};this._properties[j].label.formatString=c1;}}}else{_=_||[];_.push(j);}}if(_&&this._properties){for(i=0;i<_.length;i++){j=_[i];if(j==='valueAxis'&&!g.isInfoChart(e)){if(this._properties.plotArea&&this._properties.plotArea.valueAxis&&this._properties.plotArea.valueAxis.label){delete this._properties.plotArea.valueAxis.label.formatString;}}else{if(this._properties[j]&&this._properties[j].label){if(!g.isInfoChart(e)){delete this._properties[j].label.formatString;}}}}}};U.prototype._createChartView=function(h){var i=this._chartViewInstance=new h($(this._div),{'type':this._vizModel().type(),'useBuiltInPropertyZoneInteraction':this._uiConfig.useBuiltInPropertyZoneInteraction,'useDefaultChartSizeForTrellis':this._uiConfig.useDefaultChartSizeForTrellis,'enableAxisSplitter':this._uiConfig.enableAxisSplitter},this._uiConfig.libFolderPath,$.proxy(this._vizModel,this),this._chartProxy,{'vizProperties':$.proxy(this.vizProperties,this),'vizCss':$.proxy(this.vizCss,this),'vizCssProperty':$.proxy(this.vizCssProperty,this),'vizOn':$.proxy(this.vizOn,this),'vizType':$.proxy(this.vizType,this),'selectedPropertyZone':$.proxy(this.selectedPropertyZone,this),'vizData':$.proxy(this.vizData,this),'propertiesWithEvents':(function(e){this.propertiesWithEvents(e,[r.USER_INTERACTION_COMPLETE]);}).bind(this),'scalesWithEvents':$.proxy(this.scalesWithEvents,this)});i.enableTrellis(this._enableTrellis);i.addEventListener(r.TITLE_CHANGED,this._titleChangedHandler,this);i.addEventListener(r.ANALYSIS_DROPPED,this._analysisDroppedHandler,this);i.addEventListener(r.CHART_CHANGED,function(e){this._dispatchEvent(e);},this);i.addEventListener(r.CHART_CHANGING,function(e){this._dispatchEvent(e);},this);i.addEventListener(r.CHANGED_SELECTED_DATA,function(e){this._dispatchEvent(new r(r.CHANGED_SELECTED_DATA,this,e.data));},this);i.addEventListener(r.SELECT_PROPERTY_ZONE,function(e){this._dispatchEvent(new r(r.SELECT_PROPERTY_ZONE,this,e.data));},this);i.addEventListener(s.DISPATCH_PROPERTY_EVENT,function(e){var j=e.data;this._dispatchPropertyEvent(j);},this);i.addEventListener(r.PROPERTY_ZONES_CHANGED,function(e){this._dispatchEvent(new r(r.PROPERTY_ZONES_CHANGED,this,e.data));},this);i.addEventListener(r.CONTEXT_MENU_TRIGGERED,function(e){this._dispatchEvent(new r(r.CONTEXT_MENU_TRIGGERED,this,e.data));},this);i.addEventListener("ChartInstance_Initialized",function(e){if(!this._enableMorphing||!e.data.requestMorphing||!g.isSupportMorphing(this._vizModel().type())){this._dispatchEvent(new r(r.RENDER_COMPLETE,this));}else{this._vizMorpher.bindViewLayer(e.data.chartLayer);this._vizMorpher.morphVizType(this._vizModel().type(),800,i.data(),$.proxy(function(){this._dispatchEvent(new r(r.RENDER_COMPLETE,this));},this));}},this);i.addEventListener(r.BEHAVIOR_TYPE_CHANGED,function(e){this._dispatchEvent(new r(r.BEHAVIOR_TYPE_CHANGED,this,e.data));},this);i.addEventListener("DescriptionChanged",function(e){this._dispatchEvent(new a("DescriptionChanged",this,e.data));},this)};U.prototype._createChildren=function(){this._validateSize();var e=this._morphingLayer=document.createElement('div');e.className=J.PREFIX+'morphing-layer';e.style.position="absolute";this._div.appendChild(e);this._vizMorpher=new H(e);this._createChartView(q);};U.prototype._analysisDroppedHandler=function(e){var h=this._vizModel();var i=h.explicitFeedingItems();var j=e.data.zone;var p=j.feedDef;var w=e.data.analysisObject;var x=[];var Z=h.type();p.forEach(function(b1){if(b1.id==='multiplier'){if(j.name===F.ID_TRELLIS_ROW){x.push(F.ID_TRELLIS_ROW);}else if(j.name===F.ID_TRELLIS_COLUMN){x.push(F.ID_TRELLIS_COLUMN);}else{x.push(F.ID_TRELLIS_ROW);x.push(F.ID_TRELLIS_COLUMN);}Z=g.toMultiChartType(Z);}else{x.push(b1.id);}});var _=B.suggestFeeds(Z,i,[w],x);if(_){if(f.equal(i,_.feeds)){if(x.length===1){var a1=f.getFeed(i,x[0]);a1.values().splice(0,1);a1.values().push(w);}else{X(h.type(),i,w);}}else{i=_.feeds;}}h.feedingItems(i,this._enableTrellis);};function X(e,h,j){var p=B.suggestFeeds(e,[j]);var w,i,x;for(i=0;i<p.feeds.length;i++){x=p.feeds[i];if(x.values().length===1){w=x.id();break;}}for(i=0;i<h.length;i++){x=h[i];if(x.id()===w){var Z=false;var _=x.values();for(var a1 in _){if(_[a1].id()===j.id()){Z=true;break;}}if(!Z&&x.values().length>0){x.values().splice(0,1);x.values().push(j);}}}}var Y=(function(x){return function(e){if(x){window.clearTimeout(x);x=null;}!x&&(x=window.setTimeout(function(){e._vizMorpher.morphVizType(null,-1,e._data);},1200));};})();U.prototype._validateSize=function(){var w=$(this._div).width();var h=$(this._div).height();$(this._layout).css({width:w+"px",height:h+"px",visibility:"visible",display:''});if(this._chartView()){this._chartView().size({width:w,height:h});}Y(this);};U.prototype._updateData=function(e,h){this._data=this._chartViewInstance.copyData(e,h);};U.prototype._chartView=function(){return this._chartViewInstance;};U.prototype._needCreateViz=function(e,h){if(h===true){return true;}var i=false;if(g.isTable(e)){i=true;}else{if(e!==this._type){i=true;}}if(!this._chartView().hasChartInstance()){i=true;}return i;};U.prototype._needChangeTemplate=function(e,h){var i=this._chartViewInstance.getTemplateId();var j=this._chartViewInstance.getTemplateId(h);return(i!==j);};U.prototype.showLoadingIcon=function(){this._chartView().showLoadingIcon();};U.prototype.connect=function(e){};U.prototype.disconnect=function(){};U.prototype.chartModel=function(){return this._vizModel();};U.prototype.vizUid=function(){return this._uid;};U.prototype.scaleGroup=function(e,i){if(arguments.length>0){S.add(this,e,i);}else{return{'group':S.getGroup(this),'index':S.getIndexInGroup(this)};}};U.prototype.vizData=function(e){if(arguments.length>0){var h=this._vizModel().type();e=K.migrate(e,h,this._vizModel().feedingItems());this._updateData(h,e);if(this._vizCreated){var i=this._needChangeTemplate(h,e);if(i||g.isTable(h)){this._createVizInstance();}else{this._chartView().update({'data':this._data,'sharedRuntimeScales':S.getSharedRuntimeScales(this)});}}else{throw L.get('VIZ_CHART_UPDATE_DATA_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}return this;}else{if(this._chartView()){return this._chartView().data();}return null;}};U.prototype.vizCss=function(e){if(arguments.length>0){this._css=e;if(this._vizCreated){this._chartView().css(this._css);this._css=this._chartView().css();}else{throw L.get('VIZ_CHART_UPDATE_CSS_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}this._dispatchVizDefChangedEvent({'vizCssChanged':true});this._dispatchInteractionCompleteEvent({'vizPropertiesChanged':true});return this;}else{return this._chartView().css();}};U.prototype.vizProperties=function(p){if(arguments.length>0){var j=P.migrate(p,this._vizModel().type(),this._vizModel().feedingItems());if(j.scales&&j.scales.length){var e={vizPropertiesChanged:true};if(p.hasOwnProperty("title")){e.vizTitleChanged=true;}this._enableVizDefChangedEvent=true;this._dispatchVizDefChangedEvent(e);this.vizUpdate(j);}else{this._setProperties(j.properties);}return this;}else{return this._getProperties();}};U.prototype.propertiesWithEvents=function(p,e,h){if(arguments.length>0){var i=this;this._setProperties(p);e.forEach(function(j){if(j===r.USER_INTERACTION_COMPLETE){i._dispatchInteractionCompleteEvent({'vizPropertiesChanged':true});}else{i._dispatchEvent(new a(j,this,{properties:p,trigger:h}));}});return this;}else{return this._getProperties();}};U.prototype._getProperties=function(){return this._chartView().properties();};U.prototype._setProperties=function(p){this._enableVizDefChangedEvent=false;var e=this._vizModel().type();var h=this._initOptions({properties:p});this._labelFormats=null;if(h!==e){this._vizModel().type(h);if(this._vizCreated){this._createVizInstance();}else{this._enableVizDefChangedEvent=true;throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}else{if(this._vizCreated){if(this._chartView().hasChartInstance()){var i=this._chartView().getValidProperties(this._properties,h);if(this._enableMorphing&&g.isSupportMorphing(this._vizModel().type())){this._vizMorpher.removeAnimationLayer();if(this._chartView()._needMorphing(p)){this._vizMorpher.showMorphing(true,false);}}this._chartView().properties(i);if(this._enableMorphing){if(!this._chartView().requestMorphing()||!g.isSupportMorphing(this._vizModel().type())){var _=this;setTimeout(function(){_._vizMorpher.morphVizType(null,-1,_._chartViewInstance.data());},0);}}}}else{this._enableVizDefChangedEvent=true;throw L.get('VIZ_CHART_UPDATE_PROPERTIES_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}}var j={vizPropertiesChanged:true};if(p.hasOwnProperty("title")){j.vizTitleChanged=true;}this._enableVizDefChangedEvent=true;this._dispatchVizDefChangedEvent(j);};U.prototype.vizDescription=function(){return this._chartView().description();};U.prototype.vizUpdate=function(e){if(!e){return;}if(e.type){e.type=T.migrate(e.type);}var h=e.type||this._vizModel().type();if(e.feeds){e.feeds=e.feeds.value?e.feeds.value:e.feeds;e.feeds=N.migrate(e.feeds,h);}else if(e.feeds===null){e.feeds=[];}else{e.feeds=null;}var i=e.feeds;var j=P.migrate(e.properties,h,i||this._vizModel().feedingItems());if(e.properties){e.properties=j.properties;}if(e.data){e.data=K.migrate(e.data,h,i||this._vizModel().feedingItems());}if(j.scales){this._updateScales(j.scales);}if(!U.feedValidation(h,i||this._vizModel().feedingItems())){this.showMessage(L.get("INVALID_DATA_BINDING"));return;}if(this._enableMorphing&&g.isSupportMorphing(this._vizModel().type())){this._vizMorpher.showMorphing(true,false);}e=this._chartPreHandler.preVizUpdate(e);this._beginUpdateProperty();try{var p=false;if(e.hasOwnProperty("type")){this._updateView(e.type);}if(e.hasOwnProperty('data')){p=this._needChangeTemplate(h,e.data);}h=this._initOptions(e);var w=(h!==this._vizModel().type());if(!g.isGeo(h)&&e.data===null){p=true;this._updateData(h,o.getDataset(h));}var x;if(w){x={'type':h};if(i){x['feedingItems']=i;}this._vizModel().vizModelChanged(x);}else{if(this._feedingItemChanged){this._applyFeedingItemChanged();}if(i){x={'feedingItems':i};this._vizModel().vizModelChanged(x);}if(this._vizCreated){if(this._needCreateViz(h,p)||!this._chartView().supportUpdate(h)){this._createVizInstance();}else{this._updateVizInstance();}}else{}}}catch(Z){throw Z;}finally{this._endUpdateProperty();}if(this._enableMorphing){if(!this._chartView().requestMorphing()||!g.isSupportMorphing(this._vizModel().type())){this._vizMorpher.showMorphing(false,true);this._vizMorpher.morphVizType(null,-1,this._chartViewInstance.data());}}return this;};U.prototype.vizOn=function(e,h){if(arguments.length>0){if(!u.isString(e)||!u.isFunction(h)){return;}this._chartView().on(e,h);this._onEventMap[e]=h;return this;}};U.prototype.vizOff=function(e){if(arguments.length>0){if(!u.isString(e)){return;}this._chartView().off(e);delete this._onEventMap[e];return this;}};U.prototype.vizAction=function(e,h){if(arguments.length>0){if(this._vizCreated){return this._chartView().action(e,h);}else{throw L.get('VIZ_CHART_TRIGGER_ACTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}return this;}};U.prototype.vizSelection=function(p,e){if(this._vizCreated){var h=this._chartView().selection.apply(this._chartView(),arguments);return h;}else{throw L.get('VIZ_CHART_SELECTION_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};U.prototype.vizFeedingZone=function(){if(this._vizCreated){try{return this._chartView().feedingZone();}catch(e){return[];}}else{throw L.get('VIZ_CHART_FEEDINGZONE_FAILED')+L.get('VIZ_CHART_VIZINSTANCE_NOT_CREATED');}};U.prototype.changeTemplate=function(){return this._chartView().changeTemplate.apply(this._chartView());};U.prototype._migrateProperties=function(e){if(!$.isEmptyObject(this._properties)){if(g.isVizChart(this._type)&&g.isInfoChart(e)){this._properties=I.buildInfoProperties(this._type,this._properties,this.feeds());}else if(g.isVizChart(e)&&g.isInfoChart(this._type)){this._properties=I.buildVizProperties(e,this._properties,this.feeds());}}};U.prototype._initOptions=function(e){if(!e){return;}var h=e.type||this._vizModel().type();if(e.hasOwnProperty('css')){this._css=e.css;}this._migrateProperties(h);if(e.properties){var p=u.clone(e.properties);h=g.updateType(h,p);this._updateAxisCache(h,p);this._properties=this._properties||{};if(p.title&&p.title.text){p.title.text=p.title.text.trim();}this._properties=u.updateJSON(this._properties,p);}if(e.scales){this._updateScales(e.scales);}if(e.data){this._updateView(h);this._updateData(h,e.data);}return h;};U.prototype._updateAxis=function(p,e,h){var i,j,w,x;if(p){for(i=0;i<p.length;i++){j=p[i];if(h.hasOwnProperty(j)){x=u.clone(h[j]);if(e.length>i){w=e[i];e[i]=u.updateJSON(w,x);}else{if(this._properties.hasOwnProperty(j)){e.push(u.updateJSON(this._properties[j],x));}else{e.push(x);}}}}}};U.prototype._updateAxisCache=function(e,h){if(h){var i=k.getCategoryAxis(e);this._updateAxis(i,this._categoryAxis,h);var j=k.getValueAxis(e);this._updateAxis(j,this._valueAxis,h);}};U.prototype._clearAxisCache=function(){if(this._categoryAxis){this._categoryAxis.length=0;}if(this._valueAxis){this._valueAxis.length=0;}};U.prototype._saveAxisCache=function(){var e={};e['categoryAxis']=this._categoryAxis;e['valueAxis']=this._valueAxis;return e;};U.prototype._loadAxisCache=function(e){if(e['categoryAxis']){this._categoryAxis=e['categoryAxis'];}if(e['valueAxis']){this._valueAxis=e['valueAxis'];}};U.prototype.createViz=function(e){if(arguments.length>0){e.type=T.migrate(e.type);if(e.feeds){e.feeds=e.feeds.value?e.feeds.value:e.feeds;e.feeds=N.migrate(e.feeds,e.type);}else if(e.feeds===null){e.feeds=[];}else{e.feeds=null;}var h=e.feeds;var j={};if(e.properties){j=P.migrate(e.properties,e.type,h);e.properties=j.properties;}this._scales=[];if(j.scales){this._updateScales(j.scales);}e.data=K.migrate(e.data,e.type,h);if(h&&!U.feedValidation(e.type,h)){this.showMessage(L.get("INVALID_DATA_BINDING"));return;}e=this._chartPreHandler.preCreateViz(e);this._beginUpdateProperty();this._type=null;this._vizModel().type(null);this._data=null;this._css=null;this._categoryAxis=[];this._valueAxis=[];this._properties={};this._vizModel().reset();if(e.hasOwnProperty("type")){this._updateView(e.type);}var i=this._initOptions(e);this._vizCreated=true;try{this._vizModel().vizModelChanged({'type':i,'feedingItems':h});}finally{this._endUpdateProperty();}}};U.prototype._destroyViz=function(){this._data=null;this._vizModel().type(null);this._properties=null;this._css=null;this._onEventMap={};this._chartViewManager={};this._chartView().destroy();this._vizCreated=false;};U.prototype.exportViz=function(e){return(this._chartView().hasChartInstance()||this._chartView().exportable())?this._updateExportJSON(this._chartView().exportViz(e)):null;};U.prototype.loadViz=function(e){if(arguments.length===1){e=sap.viz.api.serialization.migrate(e);var h=e.type;if(e.data&&e.data.type){if(e.data.type==='Crosstable'){var i=new sap.viz.api.data.CrosstableDataset();i.data(e.data.val);if(e.data.val.infos){i.info([{'type':'additionalData','info':e.data.val.infos}]);}e.data=i;}else if(e.data.type==='FlatTable'){e.data=new sap.viz.api.data.FlatTableDataset(e.data.val);}else{e.data=e.data.val;}}if(h!==this._vizModel().type()){this._loadingModel=true;this._vizModel().vizModelChanged({'type':h});this._loadingModel=false;}this._properties={};e.properties=e.properties||{};this._applyLeanLayout(e);this._initOptions(e);var j=U._getDefaultProperties(h,this._uiConfig);e.properties=u.updateJSON(j,e.properties);e.properties=this._chartView().getValidProperties(e.properties,h);e.scales=this._chartView().getValidScales(e.scales||[],h);this._clearAxisCache();this._type=h;this._scales=e.scales||[];this._vizCreated=true;this._updateFeeding(e,h);this._chartViewInstance.loadViz(e);}};U.prototype._applyLeanLayout=function(e){if(this._chartViewInstance instanceof t&&this._uiConfig.forceLeanLayout===true){this._properties.title=this._properties.title||{};this._properties.title.visible=false;this._properties.legend=this._properties.legend||{};this._properties.legend.visible=false;this._properties.categoryAxis=this._properties.categoryAxis||{};this._properties.categoryAxis.title=this._properties.categoryAxis.title||{};this._properties.categoryAxis.title.visible=false;this._properties.categoryAxis2=this._properties.categoryAxis2||{};this._properties.categoryAxis2.title=this._properties.categoryAxis2.title||{};this._properties.categoryAxis2.title.visible=false;this._properties.valueAxis=this._properties.valueAxis||{};this._properties.valueAxis.title=this._properties.valueAxis.title||{};this._properties.valueAxis.title.visible=false;this._properties.valueAxis2=this._properties.valueAxis2||{};this._properties.valueAxis2.title=this._properties.valueAxis2.title||{};this._properties.valueAxis2.title.visible=false;e.properties=e.properties||{};e.properties=u.updateJSON(e.properties,this._properties);}};U.prototype._updateVizInstance=function(){var e=this._vizModel().type();var h=this.feeds({'withMND':true});var p=this._chartView().getValidProperties(this._properties,e),i=this._chartView().getValidScales(this._scales,e);var j={'properties':p,'scales':i,'css':this._css,'data':this._data,'sharedRuntimeScales':S.getSharedRuntimeScales(this)};this._updateFeeding(j,e);this._data=j.data;this._chartView().update(j);};U.prototype._createVizInstance=function(e){if(!this._vizCreated){return;}try{var h=this._vizModel().type();var i=U._getDefaultProperties(h,this._uiConfig);this._migrateProperties(h);var p=u.updateJSON(i,this._properties);var j={'type':h,'data':this._data,'css':this._css,'properties':this._chartView().getValidProperties(p,h),'scales':this._chartView().getValidScales(this._scales,h),'sharedRuntimeScales':S.getSharedRuntimeScales(this)};this._updateFeeding(j,h);this._data=j.data;this._type=j.type;if(!g.isGeo(this._type)){this._chartView().hideLoadingIcon();}if(this._enableMorphing&&g.isSupportMorphing(h)&&this._chartView().setCloseAnimation){this._chartView().setCloseAnimation(j);}this._chartView().create(j);}catch(w){this._vizMorpher.resetMorphCache();if(R.getRuntime()._modelRefs[this._uid]===1){throw w;}}};U.prototype._updateFeeding=function(e,h){var i=this.feeds({'withMND':true});if(!g.isTable(h)){if(!g.isGeo(h)&&f.isEmptyFeeds(i)){if(k.getDatasetType(e.data)!==D.CROSS_TABLE||k.hasFakeData(e.data)){e.data=o.getDataset(h);if(I.isInfoChart(h)){e.feeding=o.getFeeding(h);}}}else{var j=false;if(k.getDatasetType(e.data)===D.FLAT_TABLE){j=true;var p=e.data.data()?e.data.data().metadata:null;var w=p?p.fields:null;if(!w||w.length===0){j=false;}for(var x in w){if(!w[x].isFake){j=false;break;}}}if(I.isInfoChart(h)&&j){e.feeding=o.getFeeding(h);e.data=o.getDataset(h);}else{e.feeding=this._chartViewInstance.buildFeedings(h,e.data,i);}}}else{if(!e.data||k.hasFakeData(e.data)){e.data=o.getDataset(h);}e.feeding=this._chartViewInstance.buildFeedings(h,e.data,i);}};U.prototype.save=function(e){var j={};j["vizInstance"]=this.exportViz(e);var h=this.feeds();var i=this._chartViewInstance.FeedsToJSON(h);j["feedingItems"]=i;j["type"]=this._vizModel().type();j["vizTitleMode"]=this._titleMode;j["vizView"]=this._chartViewInstance.save();j["axis"]=this._saveAxisCache();var p=S.getGroup(this);if(p){j["runtimeScales"]={group:p,index:S.getIndexInGroup(this),runtimeScales:this._chartView().runtimeScales({merged:true})};}return j;};U.prototype.load=function(e){e=this._chartPreHandler.preLoadChart(e);this._beginUpdateProperty();try{var h=e["vizTitleMode"];if(h){this.vizTitleMode(h);}this._loadingModel=true;var i=e["type"];this._updateView(i);var j=null;var p=e['feedingItems'];if(p){j=this._chartViewInstance.FeedsFromJSON(p);}this._vizModel().load({"type":i,"feedingItems":j});this._loadingModel=false;if(j&&!U.feedValidation(i,j)){this.showMessage(L.get("INVALID_DATA_BINDING"));return;}var w=e["runtimeScales"];if(w){S.load(this,w.group,w.index,w.runtimeScales);}var x=e["vizInstance"];if(x){this._loadingInstance=true;x.properties=this._chartViewInstance.updatePropertyForPropertyZoneInteraction(x.properties,this._uiConfig.useBuiltInPropertyZoneInteraction);if(e["vizView"]){this._chartViewInstance.load(e["vizView"],x.properties);}if(w){x["sharedRuntimeScales"]=S.getSharedRuntimeScales(this);}this.loadViz(x);this._loadingInstance=false;}var Z=e["axis"];if(Z){this._loadAxisCache(Z);}}finally{this._endUpdateProperty();}};U.prototype.feeds=function(e){if(arguments.length>0&&u.isArray(e)){if(e!==null&&e!==undefined&&!k.isArrayOfFeedItem(e)){return;}this._beginUpdateProperty();var h=this._vizModel().type();e=N.migrate(e,h);if(h&&!U.feedValidation(h,e)){this.showMessage(L.get("INVALID_DATA_BINDING"));return;}var i=e.slice(0);this._vizModel().feedingItems(i,this._enableTrellis);try{if(this._needCreateViz(h,false)){this._createVizInstance();}else{this._updateVizInstance();}}catch(j){this._endUpdateProperty();throw j;}this._endUpdateProperty();return this;}else{return this._vizModel().explicitFeedingItems(e);}};U.prototype.enableMorphing=function(e){if(arguments.length>0){this._enableMorphing=!!e;}else{return this._enableMorphing;}return this;};U.prototype.enablePropertyZone=function(e){if(arguments.length>0){if(this._chartView()){return this._chartView().enablePropertyZone(!!e);}}else{if(this._chartView()){return this._chartView().enablePropertyZone();}}return this;};U.prototype._updateTitle=function(){if(this.isTitleCustomized()){return;}var e=this.getTitleTextByFeeding();this._properties.title=this._properties.title||{};if(e!==null){e=e.trim();}if(this._properties.title.text!=e){this._properties.title.text=e;}};U.prototype.feeding=function(){if(this._chartViewInstance){return this._chartViewInstance.feeding();}else{return[];}};U.prototype.showMessage=function(e){if(arguments.length==1){if(this._chartView()){return this._chartView().updateDescription(e);}}};U.prototype.exportToSVGString=function(e){return this._chartView().exportToSVGString(e);};U.prototype.supportExportToSVG=function(){return this._chartView().supportExportToSVG();};U.prototype._updateExportJSON=function(e){if(g.isPieChartType(this.vizType())){if(e&&e.properties&&e.properties.hasOwnProperty("selectedPropertyZone")){delete e.properties.selectedPropertyZone;}}if(e&&e.properties&&e.properties.tooltip&&e.properties.tooltip.preRender){e.properties=u.clone(e.properties);delete e.properties.tooltip.preRender;}return e;};U.prototype.getPropertyZones=function(){return this._chartView().getPropertyZones();};U.prototype.setPropertyZones=function(p){this._chartView().setPropertyZones(p);};U.prototype.queryProperties=function(e){var h=this._chartView().queryProperties(e);return h;};U.prototype.updateProperties=function(e,h){this._chartView().updateProperties(e);this._dispatchEvent(new a(r.VIZ_PROPERTIES_CHANGED,this,{properties:e.properties,trigger:h}));};U.prototype.selectedPropertyZone=function(e){var h=this._chartView();return h.selectedPropertyZone.apply(h,arguments);};U.prototype.getZoneName=function(p){return this._chartView().getZoneName.apply(this._chartView(),arguments);};U.prototype.getDataPointsPosition=function(e){return this._chartView().getDataPointsPosition.apply(this._chartView(),arguments);};U.prototype.setAxisScale=function(e){return this._chartView().setAxisScale.apply(this._chartView(),arguments);};U.prototype.vizCssProperty=function(e,p,h){return this._chartView().cssProperty.apply(this._chartView(),arguments);};U.prototype.getFeeding=function(){return this._chartView().feeding();};U._getDefaultProperties=function(e,h){if(!e){return{};}var p;var i=g.getChartId(e);if(h&&h.hasOwnProperty('specificProperties')){p=u.updateJSON(h.defaultProperties,h.specificProperties[i]);}else{p=h?h.defaultProperties:null;}p=k.convertProperties(p,g.getVizType(e),e);if(g.isInfoChart(e)){p=I.buildInfoProperties(e,p);}return p;};U.prototype.pauseRender=function(){this._chartProxy.pauseRender();};U.prototype.resumeRender=function(){this._chartProxy.resumeRender();};U.prototype.getChangedProperties=function(){var e=this._chartView().getChangedProperties();if(!e){e=k.getValidProperties(this._properties,this._type);}return e;};U.prototype.getChangedScales=function(){return this._scales||[];};U.prototype.vizScales=function(e){if(arguments.length>0){e=this._chartView().getValidScales(e,this._type);this._updateScales(e);return this._chartView().scales(e);}else{return this._chartView().scales();}};U.prototype.scalesWithEvents=function(e,h){if(arguments.length>0){var i=this;this._updateScales(e);this._chartView().scales(e);h.forEach(function(j){if(!(e.length===1&&e[0].feed===C.DATA_FRAME)){if(j===r.USER_INTERACTION_COMPLETE){i._dispatchInteractionCompleteEvent({'vizScalesChanged':true});}else{i._dispatchEvent(new a(j,this,{scales:e}));}}});return this;}else{return this._chartView().scales();}};U.prototype._updateScales=function(e){var h=[];var p=false;for(var i in e){p=false;for(var j in this._scales){if(this._scales[j].feed===e[i].feed){this._scales[j]=e[i];p=true;break;}}if(!p){h.push(e[i]);}}if(h.length>0){this._scales=this._scales.concat(h);}this._dispatchVizDefChangedEvent({vizScalesChanged:true});};U.prototype.setAnimationLayer=function(){if(this._enableMorphing&&g.isSupportMorphing(this._vizModel().type())){this._vizMorpher.showAnimationLayer();}};U.prototype.reset=function(){if(this._properties){this._properties={};this._clearAxisCache();this._chartView().reset();}if(this._scales){this._scales=[];}};U.prototype.runtimeScales=function(e){return this._chartView().runtimeScales.apply(this._chartView(),arguments);};U.prototype.sharedRuntimeScales=function(e){return this._chartView().sharedRuntimeScales.apply(this._chartView(),arguments);};U.prototype.getPictogramInfo=function(){return this._chartView()?this._chartView().getPictogramInfo.apply(this._chartView(),arguments):null;};U.feedValidation=function(e,h){var i=true;if(!g.isGeo(e)&&!g.isTable(e)){e=f.adaptChartType(h,e);e=f.hasTime(h)?g.toTimeChartType(e):e;var j=f.removeDataFrame(h);i=y.validateOverflow(e,j);}return i;};U.prototype.zoom=function(){return this._chartView().zoom.apply(this._chartView(),arguments);};return U;});define('sap/viz/controls/chart/Metadata',['sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/common/migrate/migrator/TypeMigrator'],function(D,M,T){var a={};a.getSupportedDatasets=function(v){var d=[];v=T.migrate(v);var m=M.get(v);if(m){var s=m.support();if(s.dataset[D.FLAT_TABLE]){d.push(D.FLAT_TABLE);}if(s.dataset[D.CROSS_TABLE]){d.push(D.CROSS_TABLE);}if(s.dataset[D.ARRAY_FLAT_TABLE]){d.push(D.ARRAY_FLAT_TABLE);}if(s.dataset[D.RAW]){d.push(D.RAW);}}return d;};return a;});define('sap/viz/controls/plugins/infochart/getPropertiesByCtx',['sap/viz/controls/common/utils/Utils',"sap/viz/controls/plugins/infochart/interaction/DesignTimeUtils"],function(U,D){function m(c,d){if(!c){return false;}if(!Array.isArray(c)){c=[c];}return c.some(function(a){if(!a){return true;}return D.matchCtx(a,d);});}function f(c,a){var r;for(var k in c){if(!r){r={};}var b=true;for(var i=0;i<a.length;i++){if(k===a[i]){a.splice(i,1);b=false;break;}}if(!b){continue;}r[k]=c[k];}return r;}return function(c,a){var b=c.ctx;if(!Array.isArray(a)){a=[a];}var d,p,i,l,e,g;for(i=0,l=a.length;i<l;i++){e=a[i];g=e.ctx;p=e.paras;if(g===undefined){d=p;}}p=this._parameters;var h,k=-1,n,o;for(i=0,l=a.length;i<l;i++){e=a[i];g=e.ctx;p=e.paras;if(m(g,b)){n=0;if(g&&g.or){for(var j in g.or[0]){n++;}n=n/g.or.length;}else{for(var t in g){n++;}}if(k<n){k=n;o=i;}}}if(a[o]){return a[o].paras;}return d;};});define('sap/viz/controls/plugins/infochart/SVG',[],function(){var s='http://www.w3.org/2000/svg';var E="...";var t;function c(b,r,i){var d=r?r.ownerDocument:window.document;var n=b.toLowerCase()==="svg"?s:(r?r.namespaceURI:s);var e=d.createElementNS(n,b);return r?(i?r.parentNode.insertBefore(e,r):r.appendChild(e)):e;}function g(b,d){if(!t){var e=c("svg",document.body);e.style.cssText="position:absolute;left:-1000px;top:-1000px;z-index:-9000;width:1px;height:1px";t=c("text",e);}t.style.cssText=a(d);t.textContent=b;return t;}function a(b){var d="";if(Object.prototype.toString.call(b)==='[object String]'){d=b;}else{for(var i in b){if(b.hasOwnProperty(i)){var v=b[i];if(v!==null&&v!==undefined&&v!==""){d+=i+":"+v+";";}}}}return d;}return{create:c,measureText:function(b,d){if(!b){return{width:0,height:0,x:0,y:0};}return g(b,d).getBBox();},toCSSText:a,createTextNode:function(b,d,m,e,f){d=a(d);var h=e!==undefined,i=f!==undefined;var j;if(m||h||i){var k=g(b,d);var l=false;if(h){var n=k.getComputedTextLength();if(n>e){k.textContent=E;n=k.getComputedTextLength();e-=n;if(e<=0){return;}k.textContent=b;var o=b.length-1;while(o>0&&(k.getSubStringLength(0,o)>e)){o--;}if(o>0){j=b;b=b.substr(0,o)+E;l=true;}else{return;}}}if(m||i){if(l){k.textContent=b;}if(m){m=k.getBBox();}if(i&&m.height>f){return;}}}var r=c("text");r.setAttribute("style",d);r.textContent=b;if(j){var p=c("title",r);p.textContent=j;}return m?{measure:m,node:r}:r;}};});define('sap/viz/controls/plugins/infochart/Icon',["./SVG"],function(S){var _={};var I=function(c){var a=document.createElement("div");a.innerHTML=c;var b=a.childNodes;var s;for(var i in b){var l=b[i].localName;if(l&&l.toLowerCase()==="svg"){s=this._svgNode=b[i];break;}}if(!_[c]){document.body.appendChild(a);var d=s.getBBox();if(d.width===0&&d.height===0){_[c]=s.getBBox();}else{_[c]=d;}}var e=_[c];this._width=e.width;this._height=e.height;this._x=e.x;this._y=e.y;};var p=I.prototype;p.render=function(a,s,f){var g=S.create("g",a);var b=this._svgNode;var n=this._svgNode.firstChild;while(n){var c=n.nextSibling;g.appendChild(n);n=c;}if(s){if(Array.isArray(s)){s=s.join(" ");}g.setAttribute("transform","scale("+s+")");}if(f){g.setAttribute("fill",f);}return g;};p.clipPath=function(a){var s=this._svgNode;var n=this._svgNode.firstChild;while(n){var b=n.nextSibling;a.appendChild(n);n=b;}};p.destroy=function(){var c=this._svgNode.parentNode;if(c&&c.parentNode){c.parentNode.removeChild(c);}delete this._svgNode;};p.getWidth=function(){return this._width;};p.getHeight=function(){return this._height;};p.getX=function(){return this._x;};p.getY=function(){return this._y;};return I;});define('sap/viz/controls/plugins/infochart/StackDecoratorGenerator',["./getPropertiesByCtx","./SVG","./Icon"],function(g,S,I){var A=50;var _=0;function t(w,h,i,n){var a;if(n){a=[[w,0]];if(i){a.push([0,h/2],[w,h]);}else{a.push([0,0],[w/2,h]);}}else{a=[[0,h]];if(i){a.push([0,0],[w,h/2]);}else{a.push([w/2,0],[w,h]);}}return a;}var p={"pike":function(w,h,i,n){var a=t(w,h,i,n);if(n){if(i){if(w>A){a.splice(1,0,[A,0]);a.splice(3,0,[A,h]);}}else{if(h>A){a.splice(2,0,[0,h-A]);a.splice(4,0,[w,h-A]);}}}else{if(i){if(w>A){a.splice(2,0,[w-A,0]);a.splice(4,0,[w-A,h]);}}else{if(h>A){a.splice(1,0,[0,A]);a.splice(3,0,[w,A]);}}}return a;},"triangle":t,"trapezoid":function(w,h,i,n){var a;if(n){a=[[w,0]];if(i){if(w>A){a.push([A,0]);}a.push([0,h]);}else{a.push([0,0]);if(h>A){a.push([0,h-A]);}}}else{a=[[0,h]];if(i){a.push([0,0]);if(w>A){a.push([w-A,0]);}a.push([w,h]);}else{if(h>A){a.push([0,A]);}a.push([w,0]);}}a.push([w,h]);return a;}};return{name:"stackDecorator",fn:function(c){return function(a){var b=g(a,c);if(!b){return;}var e=a.graphic,w=e.width,h=e.height;var s=b.stackShape||{};var f=s.value;var n=a.g;var i=S.create("clipPath",n);var j="clipPath_"+(_++);i.setAttribute("id",j);n.setAttribute("clip-path","url(#"+j+")");if(s.type==="svg"){var k=new I(f);var l=k.getWidth();var m=k.getHeight();var o=w/l;var q=h/m;k.clipPath(i);i.setAttribute("transform","translate( "+e.x+","+e.y+") scale("+o+" "+q+")");k.destroy();}else{if(!f||f==="rectangle"){var r=S.create("rect",i);r.setAttribute("width",w);r.setAttribute("height",h);}else{var u=S.create("path",i);var d="";p[f](w,h,a.horizontal,a.negative).forEach(function(v,x){d+=(x===0?"M":"L")+v[0]+" "+v[1];});d+="Z";u.setAttribute("d",d);}i.setAttribute("transform","translate( "+e.x+","+e.y+")");}};}};});define('sap/viz/controls/plugins/infochart/shapeHelper',[],function(){var A=50;function t(w,c,i,n){var j;if(n){j=[[w,0]];if(i){j.push([0,c/2],[w,c]);}else{j.push([0,0],[w/2,c]);}}else{j=[[0,c]];if(i){j.push([0,0],[w,c/2]);}else{j.push([w/2,0],[w,c]);}}return j;}var p={"pike":function(w,c,i,n){var j=t(w,c,i,n);if(n){if(i){if(w>A){j.splice(1,0,[A,0]);j.splice(3,0,[A,c]);}}else{if(c>A){j.splice(2,0,[0,c-A]);j.splice(4,0,[w,c-A]);}}}else{if(i){if(w>A){j.splice(2,0,[w-A,0]);j.splice(4,0,[w-A,c]);}}else{if(c>A){j.splice(1,0,[0,A]);j.splice(3,0,[w,A]);}}}return j;},"triangle":t,"trapezoid":function(w,c,i,n){var j;if(n){j=[[w,0]];if(i){if(w>A){j.push([A,0]);}j.push([0,c]);}else{j.push([0,0]);if(c>A){j.push([0,c-A]);}}}else{j=[[0,c]];if(i){j.push([0,0]);if(w>A){j.push([w-A,0]);}j.push([w,c]);}else{if(c>A){j.push([0,A]);}j.push([w,0]);}}j.push([w,c]);return j;}};function g(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=='x'?r:r&0x3|0x8;return v.toString(16);});}function a(r){var c=r.childNodes;for(var i=0;i<c.length;i++){if(c[i].nodeType!==1){continue;}if(c[i].getAttribute("fill")){c[i].removeAttribute("fill");}if(c[i].getAttribute("stroke")){c[i].removeAttribute("stroke");}if(c[i].getAttribute("stroke-width")){c[i].removeAttribute("stroke-width");}a(c[i]);}}function d(n,c,m,i,j){var k='v-mask';if(n.select('.'+k).node()===null){i='mask-'+i;var l;if(j){l=n.insert('mask',':first-child').attr('class',k).attr('id',i).attr('width',c.width+m.width).attr('height',c.height);l.append('rect').attr('x',m.x).attr('y',m.y).attr('width',m.width).attr('height',m.height).attr('fill','#202020').attr("fill-opacity","1").attr("stroke-width","0px");l.append('rect').attr('x',c.x).attr('y',c.y).attr('width',c.width).attr('height',c.height).attr('fill','#ffffff').attr("fill-opacity","1").attr("stroke-width","0px");}else{l=n.insert('mask',':first-child').attr('class',k).attr('id',i).attr('width',c.width).attr('height',c.height+m.height);l.append('rect').attr('x',m.x).attr('y',m.y).attr('width',m.width).attr('height',m.height).attr('fill','#202020').attr("fill-opacity","1").attr("stroke-width","0px");l.append('rect').attr('x',c.x).attr('y',c.y).attr('width',c.width).attr('height',c.height).attr('fill','#ffffff').attr("fill-opacity","1").attr("stroke-width","0px");}return i;}else{if(j){n.select('.'+k).attr('width',c.width+m.width).attr('height',c.height);n.select('.'+k).selectAll('rect')[0][0].attr('x',m.x).attr('y',m.y).attr('width',m.width).attr('height',m.height).attr('fill','#202020').attr("fill-opacity","1").attr("stroke-width","0px");n.select('.'+k).selectAll('rect')[0][1].attr('x',c.x).attr('y',c.y).attr('width',c.width).attr('height',c.height).attr('fill','#ffffff').attr("fill-opacity","1").attr("stroke-width","0px");}else{n.select('.'+k).attr('width',c.width).attr('height',c.height+m.height);n.select('.'+k).selectAll('rect')[0][0].attr('x',m.x).attr('y',m.y).attr('width',m.width).attr('height',m.height).attr('fill','#202020').attr("fill-opacity","1").attr("stroke-width","0px");n.select('.'+k).selectAll('rect')[0][1].attr('x',c.x).attr('y',c.y).attr('width',c.width).attr('height',c.height).attr('fill','#ffffff').attr("fill-opacity","1").attr("stroke-width","0px");}}return n.select('.'+k).attr('id');}function b(n,c,s,r){var i;switch(r){case 90:i="translate("+(c.y*s+c.height*s)+", "+(-c.x*s)+") rotate(90) scale("+s+","+s+") ";break;case 180:i="translate("+(c.x*s+c.width*s)+", "+(c.y*s+c.height*s)+") rotate(180) scale("+s+","+s+") ";break;case 270:i="translate("+(-c.y*s)+", "+(c.x*s+c.width*s)+") rotate(270) scale("+s+","+s+") ";break;default:i="translate("+(-c.x*s)+", "+(-c.y*s)+") scale("+s+","+s+") ";break;}n.setAttribute("transform",i);}function u(s,c,v){if(!s||!c||!v){return;}var i,j,k,l,n=s;if(c[c.length-1]!=":"){c+=":";}if(s){i=s.indexOf(c);if(i>-1){j=s.indexOf(";",i+1);if(j>i){k=s.substring(0,i);l=s.substring(j);n=k+c+v+l;}else if(j===-1){k=s.substring(0,i);n=k+c+v+";";}}}return n;}function f(n,c){if(!n||!c){return;}var j=n.querySelectorAll("[fill]");for(var i=0;i<j.length;i++){j[i].setAttribute("fill",c);}j=n.querySelectorAll("[stroke]");for(i=0;i<j.length;i++){j[i].setAttribute("stroke",c);}j=n.querySelectorAll("[style]");var s;for(i=0;i<j.length;i++){s=j[i].getAttribute("style");if(s){s=u(s,"fill",c);s=u(s,"stroke",c);if(s){j[i].setAttribute("style",s);}}}}function h(n){var c=n.querySelectorAll("[fill]");if(c.length){return true;}c=n.querySelectorAll("[stroke]");if(c.length){return true;}c=n.querySelectorAll("[style]");for(var i=0;i<c.length;i++){var s=c[i].getAttribute("style");if(s&&(s.indexOf("fill")>-1||s.indexOf("stroke")>-1)){return true;}}return false;}function e(n){if(!n){return;}var c=n.querySelectorAll("[id]");var s=n.querySelectorAll("[style]");var l=n.querySelectorAll('[*|href]');for(var i=0;i<c.length;i++){if(["linearGradient","radialGradient","filter","clipPath"].indexOf(c[i].tagName)===-1){continue;}var o=c[i].getAttribute("id");var m=g();var q=false;for(var j=0;j<l.length;j++){if(l[j].getAttribute("xlink:href")===('#'+o)){l[j].setAttribute("xlink:href","#"+m);q=true;}}for(j=0;j<s.length;j++){var r=s[j].getAttribute("style");if(r){var k=0;while(k!==-1&&k<r.length){k=r.indexOf(o,k);if(k>-1){r=r.substring(0,k)+m+r.substring(k+o.length);k+=m.length;q=true;}}s[j].setAttribute("style",r);}}if(q){c[i].setAttribute("id",m);}}}return{pathGens:p,uuid:g,removeAllColorAttributes:a,drawMask:d,transformNodeToOrigin:b,hasColorAttributes:h,fillNodeWithColor:f,fillNodeWithRandomId:e};});define('sap/viz/controls/plugins/infochart/DataUtils',[],function(){var D="__data__";var E="__extra_data__";return{DIMENSION_DISPLAYNAME:".d",setData:function(n,d){if(n){n[D]=d;return n;}},getData:function(n){var v;if(n){v=n[D];}return v;},setExtraData:function(n,d){if(n){n[E]=d;return n;}},getExtraData:function(n){var v;if(n){v=n[E];}return v;}};});define('sap/viz/controls/plugins/infochart/BarShapeRendererGenerator',["./getPropertiesByCtx","./SVG","./Icon","./shapeHelper","./DataUtils"],function(g,S,I,s,D){var p=s.pathGens,a=s.uuid,b=s.drawMask,t=s.transformNodeToOrigin,c=D.setExtraData,h=s.hasColorAttributes,f=s.fillNodeWithColor,e=s.fillNodeWithRandomId;function j(d,w,i,x,y,n,o){var q='v-clippath';if(w<0){w=0;}if(i<0){i=0;}if(d.select('.'+q).node()===null){n='clip-path-'+n;var r;if(o){r=d.append('clipPath').attr('class',q).attr('id',n);r.append('rect').attr('x',x).attr('y',y-1).attr('width',w).attr('height',i+2);}else{r=d.append('clipPath').attr('class',q).attr('id',n);r.append('rect').attr('x',x-1).attr('y',y).attr('width',w+2).attr('height',i);}r.attr("height",i).attr("width",w).attr("x",x).attr("y",y);return n;}else{if(o){d.select('.'+q).select('rect').attr('width',w).attr('height',i+2).attr('x',x).attr('y',y-1);}else{d.select('.'+q).select('rect').attr('width',w+2).attr('height',i).attr('x',x-1).attr('y',y);}return d.select('.'+q).attr('id');}}function k(i,n){var o=g(n,i);if(o){var q=n.graphic,r,u,w=q.width,v=q.height,x=o.dataPointShapeFill,y=x||q.fill,z=o.dataPointShape||{},A=z.type,B=z.value,C=n.horizontal;if(A==="svg"){var E=new I(B);r=S.create("g");u=S.create("g");var F=S.create("svg");var G=S.create("g");var H=E._svgNode.firstChild;while(H){var J=H.nextSibling;u.appendChild(H);H=J;}G.appendChild(u);F.appendChild(G);document.body.appendChild(F);var K=o.dataPointRotateAngle;if(K===undefined){K=C?90:0;}var L;if(K===0||K===180){L=C?(w/E.getWidth()):(v/E.getHeight());}else{L=C?(w/E.getHeight()):(v/E.getWidth());}t(u,F.getBBox(),L,K);c(u,{rotateAngle:K,mode:"scale"});var M=h(u);var N=u.getBoundingClientRect();if(C){G.setAttribute("transform","translate(0,"+(v/2-N.height/2)+")");}else{G.setAttribute("transform","translate("+(w/2-N.width/2)+",0)");}G.appendChild(u);r.appendChild(G);if(x){n.data.color=x;}if(M){if(o.dataPointShapeFillColor||x){f(u,o.dataPointShapeFillColor?y:null);r.setAttribute("fill",y);}else{e(u);}}else{if(y){r.setAttribute("fill",y);}}F.parentNode.removeChild(F);E.destroy();}else{if(!B||B==="rectangle"){r=S.create("rect");r.setAttribute("width",w);r.setAttribute("height",v);}else{r=S.create("path");var d="";p[B](w,v,n.horizontal,n.negative).forEach(function(O,P){d+=(P===0?"M":"L")+O[0]+" "+O[1];});d+="Z";r.setAttribute("d",d);}if(x){n.data.color=x;}r.setAttribute("fill",y);}return r;}}function l(n,o){var q=g(o,n);if(q){var r=o.graphic,u,v,w,x=r.width,y=r.height,z=q.dataPointShapeFill,A=z||r.fill,B=q.dataPointShape||{},C=B.type,E=B.value,F=o.horizontal;if(C==="svg"){var G=new I(E);u=S.create("g");v=S.create("g");w=S.create("g");var H=S.create("svg");var J=G._svgNode.firstChild;while(J){var K=J.nextSibling;v.appendChild(J);J=K;}w.appendChild(v);H.appendChild(w);document.body.appendChild(H);var L=h(v);if(L){if(q.dataPointShapeFillColor||z){f(v,q.dataPointShapeFillColor?A:null);}else{e(v);}}var M=q.dataPointRotateAngle;if(M===undefined){M=F?90:0;}var N=H.getBBox();var O;if(M===0||M===180){O=F?(y/N.height):(x/N.width);}else{O=F?(y/N.width):(x/N.height);}t(v,N,O,M);c(v,{rotateAngle:M,mode:"stack"});var P=v.getBoundingClientRect();var Q=F?P.width:P.height;var R=F?Math.ceil(x/Q):Math.ceil(y/Q);if(R===1){if(!F){w.setAttribute("transform","translate(0,"+(y-Q)+")");}var T,U,V;if(z){f(v,z);U={width:Q-x,height:y+4,x:x,y:-2};V=b(d3.select(u),T,U,a(),F);}else{T={width:x+4,height:y,x:-2,y:0};U={width:x+4,height:Q-y,x:-2,y:y-Q};V=b(d3.select(u),T,U,a(),F);}u.setAttribute("mask","url(#"+V+")");u.appendChild(w);}else{var W;for(var i=0;i<R;i++){W=v.cloneNode(true);c(W,{rotateAngle:M,mode:"stack"});w=S.create("g");if(F){w.setAttribute("transform","translate("+(Q*i)+", 0)");}else{w.setAttribute("transform","translate(0,"+(y-Q*(i+1))+")");}w.appendChild(W);u.appendChild(w);}var X=j(d3.select(u),x,y,0,0,a(),o.horizontal);u.setAttribute("clip-path","url(#"+X+")");}if(L){A=z;if(A){u.setAttribute("fill",A);}}else{if(A){u.setAttribute("fill",A);}}if(z){o.data.color=z;}H.parentNode.removeChild(H);G.destroy();}else{if(!E||E==="rectangle"||!p[E]){u=S.create("rect");u.setAttribute("width",x);u.setAttribute("height",y);}else{u=S.create("path");var d="";p[E](x,y,o.horizontal,o.negative).forEach(function(Y,Z){d+=(Z===0?"M":"L")+Y[0]+" "+Y[1];});d+="Z";u.setAttribute("d",d);}if(z){o.data.color=z;}u.setAttribute("fill",A);}return u;}}function m(i,n){var o=g(n,i);if(o){var q=n.graphic,r,u,v,w=q.width,x=q.height,y=o.dataPointShapeFill,z=y||q.fill,A=o.dataPointShape||{},B=A.type,C=A.value;if(B==="svg"){var E=new I(C);u=S.create("g");v=S.create("g");var F=E._svgNode.firstChild;while(F){var G=F.nextSibling;v.appendChild(F);F=G;}var H=E.getWidth();var J=E.getHeight();var K;K={x:w/H,y:x/J};r={x:-E.getX()*K.x,y:-E.getY()*K.y};v.setAttribute("transform","translate("+r.x+","+r.y+") scale("+K.x+","+K.y+")");c(v,{mode:"stretch"});u.appendChild(v);if(h(v)){if(o.dataPointShapeFillColor||y){f(v,o.dataPointShapeFillColor?z:null);u.setAttribute("fill",z);}else{e(v);}}else{if(z){u.setAttribute("fill",z);}}if(y){n.data.color=y;}E.destroy();}else{if(!C||C==="rectangle"){u=S.create("rect");u.setAttribute("width",w);u.setAttribute("height",x);}else{u=S.create("path");var d="";p[C](w,x,n.horizontal,n.negative).forEach(function(L,M){d+=(M===0?"M":"L")+L[0]+" "+L[1];});d+="Z";u.setAttribute("d",d);}if(y){n.data.color=y;}u.setAttribute("fill",z);}return u;}}return{name:'barShapeRenderer',fn:function(d){return function(n){var o=d[0];if(o&&o.paras&&o.paras.dataPointShape&&o.paras.dataPointShapeRenderer){return m(d,n);}else{for(var i=0;i<d.length;i++){if(d[i]&&d[i].paras&&d[i].paras.dataPointShape&&!d[i].paras.dataPointShapeRenderer){if(d[i].paras.dataPointShape.type==="svg"){d[i].paras.dataPointShapeRenderer="stretch";}else{d[i].paras.dataPointShapeRenderer=undefined;}}}return m(d,n);}};}};});define('sap/viz/controls/plugins/infochart/StackedBarShapeRendererGenerator',["./getPropertiesByCtx","./SVG","./Icon","./shapeHelper","sap/viz/controls/common/utils/Utils","./DataUtils"],function(g,S,I,s,U,D){var p=s.pathGens,a=s.uuid,b=s.drawMask,t=s.transformNodeToOrigin,c=D.setExtraData,h=s.hasColorAttributes,f=s.fillNodeWithColor,e=s.fillNodeWithRandomId;function i(n,r,d){var j='clip-path-'+d;var o=d3.select(n);var q=o.attr("clip-path","url(#"+j+")").append("clipPath").attr({id:j,"class":"v-clippath"});q.attr("height",r.height).attr("width",r.width).attr("x",r.x).attr("y",r.y);q.append("rect").attr(r);}function k(j,n){var o;o=g(n,j);if(!o&&!l(j,n)){return null;}var q=n.graphic,r=o&&o.dataPointShapeFill?o.dataPointShapeFill:q.fill,u=q.stackWidth,v=q.stackHeight,w=n.horizontal;var x=document.createElementNS('http://www.w3.org/2000/svg',"g");var y=l(j,n)||o.dataPointShape||{},z=y.type,A=y.value;var B,C;if(z==="svg"){C=new I(A);B=C._svgNode.firstChild;}else{if(!A||A==="rectangle"){B=S.create("rect");B.setAttribute("width",u);B.setAttribute("height",v);}else{B=S.create("path");var d="";p[A](u,v,w,n.negative).forEach(function(P,Q){d+=(Q===0?"M":"L")+P[0]+" "+P[1];});d+="Z";B.setAttribute("d",d);}}var E=S.create("svg");while(B){var F=B.nextSibling;x.appendChild(B);B=F;}E.appendChild(x);document.body.appendChild(E);var G=h(x);var H=o.dataPointRotateAngle;if(H===undefined){H=w?90:0;}var J=E.getBBox();var K;if(H===0||H===180){K=w?(u/J.width):(v/J.height);}else{K=w?(u/J.height):(v/J.width);}t(x,J,K,H);c(x,{rotateAngle:H,mode:"scale"});var L=x.getBoundingClientRect();var M=document.createElementNS('http://www.w3.org/2000/svg',"g");if(w){M.setAttribute("transform","translate(0,"+(n.graphic.height/2-L.height/2)+")");}else{M.setAttribute("transform","translate("+(n.graphic.width/2-L.width/2)+",0)");}M.appendChild(x);if(G){if(o.dataPointShapeFillColor||o.dataPointShapeFill){f(x,o.dataPointShapeFillColor?r:null);M.setAttribute("fill",r);}else{e(x);}}else{if(r){M.setAttribute("fill",r);}}var N=document.createElementNS('http://www.w3.org/2000/svg',"g");var O;if(w){O={x:q.x,y:-(L.height-n.graphic.height)/2,width:q.width,height:L.height};}else{O={x:-(L.width-n.graphic.width)/2,y:q.y,width:L.width,height:q.height};}i(N,O,a());N.appendChild(M);E.parentNode.removeChild(E);if(C){C.destroy();}return N;}function l(n,o){var q=U.clone(n);for(var j=0;j<q.length;j++){if(q[j].ctx!==undefined){var r=-1;for(var u in q[j].ctx){if(u==="measureNames"){delete q[j].ctx[u];}else{for(var d in o.ctx){if(d===u&&o.ctx[d]===q[j].ctx[u]){r++;}}}}if(r!==-1&&r+1===Object.keys(q[j].ctx).length&&q[j].paras.hasOwnProperty("dataPointShape")){return q[j].paras.dataPointShape;}}}return null;}function m(n,o){var q=g(o,n);if(!q&&!l(n,o)){return null;}var r=o.graphic,u=q&&q.dataPointShapeFill?q.dataPointShapeFill:r.fill,v=0,w=0,x=r.stackWidth,y=r.stackHeight,z=o.horizontal;var A=l(n,o)||q.dataPointShape||{},B=A.type,C=A.value;var E,F,G,H,J,K,L;var M,N,O,P,Q;if(B==="svg"){var R=new I(C);E=R._svgNode.firstChild;F=S.create("g");while(E){G=E.nextSibling;F.appendChild(E);E=G;}H=S.create("g");J=S.create("svg");H.appendChild(F);J.appendChild(H);document.body.appendChild(J);var T=h(F);var V=q.dataPointRotateAngle;if(V===undefined){V=z?90:0;}O=J.getBBox();if(V===0||V===180){M=z?(y/O.height):(x/O.width);}else{M=z?(y/O.width):(x/O.height);}t(F,O,M,V);c(F,{rotateAngle:V,mode:"stack"});if(T){if(q.dataPointShapeFillColor||q.dataPointShapeFill){f(F,q.dataPointShapeFillColor?u:null);}else{e(F);}}var W=F.getBoundingClientRect();var X=z?W.width:W.height;H=S.create("g");H.appendChild(F);L=S.create("g");var Y=false;if(z){Y=((r.x+r.width-v)===x)&&(x<X);}else{Y=(r.y===w)&&(y<X);}if(Y){var Z=S.create("g");var $,_,a1;if(z){H.setAttribute("transform","translate("+v+", "+r.y+' )');$={width:r.width,height:y+4,x:r.x,y:r.y-2};_={width:X-x,height:y+4,x:v+x,y:r.y-2};a1=b(d3.select(Z),$,_,a(),z);Z.setAttribute("mask","url(#"+a1+")");}else{H.setAttribute("transform","translate("+r.x+', '+(w+y-X)+")");$={width:x+4,height:r.height,x:r.x-2,y:r.y};_={width:x+4,height:X-y,x:r.x-2,y:y-X};a1=b(d3.select(Z),$,_,a(),z);Z.setAttribute("mask","url(#"+a1+")");}Z.appendChild(H);if(T){u=q.dataPointShapeFill;if(u){Z.setAttribute("fill",u);}}else{if(u){Z.setAttribute("fill",u);}}L.appendChild(Z);if(z){P={x:r.x,y:r.y,width:r.width+X-x,height:y};}else{P={x:r.x,y:y-X,width:x,height:r.height+X-y};}i(L,P,a());}else{var b1;if(z){b1=Math.floor((r.x-v)/X);if(b1<0){b1=0;}Q=Math.ceil((r.x-v+r.width)/X)-b1;}else{b1=Math.floor((w+y-r.y-r.height)/X);if(b1<0){b1=0;}Q=Math.ceil((w+y-r.y)/X)-b1;}for(var j=0;j<Q;j++){K=F.cloneNode(true);c(K,{rotateAngle:V,mode:"stack"});if(T){u=q.dataPointShapeFill;if(u){K.setAttribute("fill",u);}}else{if(u){K.setAttribute("fill",u);}}H=S.create("g");if(z){N=v+b1*X+X*j;H.setAttribute("transform","translate("+N+", "+r.y+' )');}else{N=w+y-b1*X-(j+1)*X;H.setAttribute("transform","translate("+r.x+', '+N+")");}H.appendChild(K);L.appendChild(H);}P={x:r.x,y:r.y,width:z?r.width:x,height:z?y:r.height};i(L,P,a());}J.parentNode.removeChild(J);R.destroy();}else{if(!C||C==="rectangle"){E=S.create("rect");E.setAttribute("width",x);E.setAttribute("height",y);}else{E=S.create("path");var d="";p[C](x,y,z,o.negative).forEach(function(c1,d1){d+=(d1===0?"M":"L")+c1[0]+" "+c1[1];});d+="Z";E.setAttribute("d",d);}F=S.create("g");while(E){G=E.nextSibling;F.appendChild(E);E=G;}F.setAttribute("fill",u);L=S.create("g");L.appendChild(F);P={x:r.x,y:r.y,width:r.width,height:r.height};i(L,P,a());}return L;}return{name:'stackedBarShapeRenderer',fn:function(d){var j=null;if(d&&d.length>0){j=function(n){var r=null;if(d&&d.length>0){var o=d[0];if(o&&o.paras&&o.paras.dataPointShapeRenderer==="scale"){r=k(d,n);}else{r=m(d,n);}}return r;};}return j}};});define('sap/viz/controls/plugins/infochart/TextNumberUtils',[],function(){var c={};var T=5;var L=6;var V=90;var a;var t=[],b=[];var d=["font","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","letter-spacing","word-spacing","alignment-baseline","baseline-shift","dominant-baseline"];function m(e,f,i,s){if(!s||!f||!i){return;}var w=0;if(!a){a=document.createElement("canvas");a.style.cssText="position:absolute;top:-1000px;z-index:-9000;width:0px;height:0px;visibility:hidden";document.body.appendChild(a);}if(a.getContext){var x=a.getContext("2d");var y=i+" "+f+" "+s;x.font=y;w=x.measureText(e).width;}var z=parseFloat(f)*1.2;return{width:w,height:z};}function g(e,F,f,i){var s,w,x,y,z;if(arguments.length===2){z=this.parseStyle(F);w=z.FontSize;x=z.FontWeight;y=z.FontFamily;}else if(arguments.length===4){w=F;x=f;y=i;}w=w.toString();var A=w.substring(w.length-1);if(!isNaN(parseFloat(A))){w+="px";}s=e+w+x+y;var B=t[s];if(!B){B=(t[s]=m(e,w,x,y));}return B;}var h=window.navigator.userAgent.indexOf("Firefox")>-1?function(n){try{return n.getBBox();}catch(e){}return{width:0,height:0,x:0,y:0};}:function(n){return n.getBBox();};var n;function j(){if(!n){var s=document.body.appendChild(document.createElementNS("http://www.w3.org/2000/svg","svg"));s.style.cssText="position:absolute;top:-1000px;z-index:-9000;width:1px;height:1px";n=s.appendChild(document.createElementNS("http://www.w3.org/2000/svg","text"));}return n;}function k(e,f){var n=j();if(!f){n.removeAttribute("style");}else{if(Object.prototype.toString.call(f)!=="[object String]"){var w=window.navigator.userAgent.indexOf("Explorer")>-1?f.ownerSVGElement.getComputedStyle(f):window.getComputedStyle(f);var x="";d.forEach(function(i){var s=w.getPropertyValue(i);if(s!==null){x+=i+":"+s+";";}});f=x;}n.style.cssText=f;}if(e===undefined||e===null){e="";}n.textContent=e;return n;}function l(s){var e=o("Tag",s['fontSize'],s['fontWeight'],s['fontFamily']);return e.height+e.y;}function o(e,f,i,s,w){var x=e+f+i+s;var y=b[x],z="font-size:"+f+"; font-weight:"+i+"; font-family:"+s;if(w){x=x+w;z=z+'; font-style: '+w;}if(!y){b[x]=p(e,z);y=b[x];}return y;}function p(e,s){if(e===''){return{width:0,height:0,x:0,y:0};}var f=h(k(e,s));return{width:f.width,height:f.height,x:f.x,y:f.y};}var q=function(e){var s=T+L-1;var f=e.text;var i=e.styles;var w=-1;if(e.position==="top"||e.position==="bottom"){if(e.rotated){w=e.size.height;if(e.rotationAngle!==V){var x=g(f,i['fontSize'],i['fontWeight'],i['fontFamily']).height;x=parseFloat(x.toFixed(8));var y=(x/Math.tan(e.rotationAngle*Math.PI/180));w=w/(Math.sin(e.rotationAngle*Math.PI/180));w-=y;var z=e.cellWidth/2+e.cellStart;var A=z/(Math.cos(e.rotationAngle*Math.PI/180));if(w>A){w=A;}w+=s;}}else{w=e.size.width+s;}}else{w=e.size.width;}if(w>=0){w-=s;}return w;};function r(e,s){var f=g(e,s['fontSize'],s['fontWeight'],s['fontFamily']);f=v(f);return f;}function u(f){if(!c[f]){c[f]=parseFloat(f.toFixed(8));}return c[f];}function v(e){if(Object.prototype.toString.call(e)==="[object Number]"){return u(e);}else if(e.length!=null){for(var i=0,f=e.length;i<f;++i){e[i]=v(e[i]);}}else if(e instanceof Object){for(var s in e){if(e.hasOwnProperty(s)){e[s]=v(e[s]);}}}return e;}return{calculateSizeLimit:q,getTextBaselineOffset:l,measureTextSize:r};});define('sap/viz/controls/plugins/infochart/CategoryAxisLabelRendererGenerator',['./getPropertiesByCtx','./SVG','./Icon','./shapeHelper','./TextNumberUtils'],function(g,S,I,s,T){var P=5;var a=3;var D=0.5;var h=s.hasColorAttributes;var f=s.fillNodeWithColor;var b=s.fillNodeWithRandomId;return{name:"categoryAxisLabelRenderer",fn:function(c){var d=function(i){var p=g(i,c);if(p){i.sizeLimit=T.calculateSizeLimit(i);var j=i.position;var k=j==="left";var l=i.size.width;var m=i.size.height;var r=l,n=m;if(k){r-=P;}else{n-=P;}if(r<=0||n<=0){return null;}var o=S.create("g");var t,q;var u=0;var v,w;if(p.iconVisible===true&&p.iconSVG){var x=p.iconSize;if(x===undefined){x=D;}if(x>0){var y=new I(p.iconSVG);var z=y.getWidth();var A=y.getHeight();var B=p.iconRotateAngle||0;var C=(B%180===0)?z:A;var E=(B%180===0)?A:z;if(k){v=w=Math.min(m*x,r);}else{v=w=Math.min(l*x,n);}var F=Math.min(v/C,w/E);var G=S.create("g",o);if(h(y._svgNode)){if(p.iconColor){f(y._svgNode,p.iconFillColor?p.iconColor:null);}else{b(y._svgNode);}}y.render(G,F,p.iconColor);y.destroy();var H=y.getX()*F;var J=y.getY()*F;if(k){t=r-v;q=n/2-w/2;r-=v+a;}else{t=r/2-v/2;q=P;n-=w+a;u=w+a;}switch(B){case 90:G.setAttribute("transform","translate("+(t+J+A*F)+","+(q-H)+") rotate(90)");break;case 180:G.setAttribute("transform","translate("+(t+H+z*F)+","+(q+J+A*F)+") rotate(180)");break;case 270:G.setAttribute("transform","translate("+(t-J)+","+(q+H+z*F)+") rotate(270)");break;default:G.setAttribute("transform","translate("+(t-H)+","+(q-J)+")");break;}}}if(r>0&&n>0){if(p.textVisible!==false){var K=!k&&i.rotated===true;var L,M;if(K){L=k?undefined:n;M=r;}else{L=r;M=k?undefined:n;}var N=i.styles;var O=6;var Q=T.getTextBaselineOffset({"font-family":p.fontFamily||N["fontFamily"],"font-size":p.fontSize||N["fontSize"],"font-weight":p.fontWeight||N["fontWeight"]});var R=i.sizeLimit;if(p.iconVisible===true&&p.iconSVG){if(k){R-=(v+a);}else{if(i.rotated){R-=(v+a)/Math.sin(i.rotationAngle*Math.PI/180);}}}var U=S.createTextNode(i.text,{"font-family":p.fontFamily||N["fontFamily"],"font-size":p.fontSize||N["fontSize"],"font-weight":p.fontWeight||N["fontWeight"],"font-style":p.fontStyle||N["fontStyle"],"fill":p.fontColor||N["fill"]},true,R,M);if(U){var V=U.measure,W=parseFloat(p.fontSize||N['fontSize'])*1.2;if(K){t=r/2-Q+V.height/2;q=O;}else{if(k){t=r-V.width-V.x;q=n/2-V.height/2-V.y;if(i.childCells&&i.childCells.length>1){q=i.childCells[0].cellHeight/2-V.height/2-V.y;}}else{t=r/2-V.width/2-V.x;q=m-n-V.y;}}var X=U.node;if(K){q+=u;X.setAttribute('x',t);X.setAttribute('y',q);X.setAttribute('text-anchor','end');var Y=e(W,i.rotationAngle);X.setAttribute("transform","translate(0,"+Y+") rotate(-"+i.rotationAngle+","+t+","+q+")");}else{X.setAttribute("transform","translate("+t+" "+q+")");}o.appendChild(X);}}}return o;}};var e=function(t,i){return(t*Math.cos(i*Math.PI/180)*0.7);};d.getPreferredSize=function(i){var p=g(i,c);if(!p){return;}if(p.textVisible===false&&(p.iconVisible===false||!p.iconSVG)){return{cellWidth:0,cellHeight:0};}var V=90;var L=6;var t=i.text,j=i.styles,k={};Object.keys(j).forEach(function(z){k[z]=(p[z]==null)?j[z]:p[z];});var M=T.measureTextSize("M...",k).width;var l=T.measureTextSize(t,k);var m=l.height;var n=e(m,i.rotationAngle);var o=l.height,q=l.width,r;if((i.rotated||l.width>i.size)&&(i.position==="top"||i.position==="bottom")){if(!i.rotated&&i.disableAutoRotation){r=false;q=i.size;}else{r=true;q=l.height;if(i.rotationAngle===V){o=l.width;}else{var u=i.cellWidth/2+i.cellStart;var v=u/(Math.cos(i.rotationAngle*Math.PI/180));if(l.width<v){v=l.width;}o=v*(Math.sin(i.rotationAngle*Math.PI/180));o+=n;var w=(q/Math.sin(i.rotationAngle*Math.PI/180))*0.9;if(w>q){q=w;}}if(q>i.size&&i.layer>0){o=0;}}}if(p.textVisible===false){if(i.position==="top"||i.position==="bottom"){o=0;}else{q=0;}}var x=p.iconSize===undefined?D:p.iconSize;if(p.iconVisible===true&&p.iconSVG&&x>0){if(i.position==="top"||i.position==="bottom"){o+=i.size*x+a;}else{q+=i.size*x+a;}}var y={cellWidth:q,cellHeight:o,rotated:r};if(i.position==="top"||i.position==="bottom"){if(r){y['minCellHeight']=Math.min(M,l.width);if(i.rotationAngle!==V){y['minCellHeight']=y['minCellHeight']*Math.sin(i.rotationAngle*Math.PI/180);y['minCellHeight']+=(2*n-2*L+1);}}else{y['minCellHeight']=l.height;if(y.cellWidth<Math.min(M,l.width)){y.noLabelSpace=true;}}}else{y['minCellWidth']=Math.min(M,l.width);}return y;};d._buildCssString=function(i,p){var j='';j+='fill:'+(p.fontColor||i['fill'])+';';j+='font-family:'+(p.fontFamily||i['fontFamily'])+';';j+='font-size:'+(p.fontSize||i['fontSize'])+';';j+='font-style:'+(p.fontStyle||i['fontStyle'])+';';j+='font-weight:'+(p.fontWeight||i['fontWeight'])+';';return j;};d.autoHide=function(){return true;};return d;}};});define('sap/viz/controls/plugins/infochart/PieSliceRendererGenerator',["./getPropertiesByCtx","./SVG"],function(g,S){return{name:"pieSliceRenderer",fn:function(c){return function(a,d){var p=g(a,c);if(p&&p.sliceShapeFill){a.graphic.color=p.sliceShapeFill;}return d(a);};}};});define('sap/viz/controls/plugins/infochart/DataLabelRendererGenerator',["./getPropertiesByCtx","./SVG","./Icon","./shapeHelper"],function(g,S,I,s){var a=5,b=0.8,M=100;var h=s.hasColorAttributes;var f=s.fillNodeWithColor;var c=s.fillNodeWithRandomId;var d=" / ";var E=" ";return{name:"dataLabelRenderer",fn:function(e){return function(i){var p=g(i,e);if(p){var j=S.create("g");var t,k='';if(p.legendVisible===true){if(i.info&&i.info.colorLegendData&&i.info.colorLegendData.length>0){k=i.info.colorLegendData.join(d);}}if(p.textVisible!==false){var v=(i.info&&i.info.colorLegendData&&i.info.colorLegendData.length>0&&i.info.hasOwnProperty('formattedValue'))?i.info.formattedValue:i.text;k+=k.length>0?E+v:v;}if(k.length>0){t=S.create("text",j);t.textContent=k;var l="",m;if((m=p.fontColor)){l+="fill:"+m+";";}if((m=p.fontFamily)){l+="font-family:"+m+";";}if((m=p.fontSize)){l+="font-size:"+m+";";}if((m=p.fontWeight)){l+="font-weight:"+m+";";}if((m=p.fontStyle)){l+="font-style:"+m+";";}if(l){t.setAttribute("style",l);}}if(p.iconVisible===true&&p.iconSVG){var n=p.iconSize;if(n!==0){n=n||b;var o=new I(p.iconSVG);var q=S.create("g",j);var r=o.getWidth();var u=o.getHeight();var w=i.horizontal;var x=p.iconRotateAngle||0;var y=(x%180===0)?r:u;var z=(x%180===0)?u:r;var A=i[w?"dataPointHeight":"dataPointWidth"];if(A===0){o.destroy();return j;}if(A>M){A=M;}var B=A*n/(w?z:y);if(h(o._svgNode)){if(p.iconColor){f(o._svgNode,p.iconFillColor?p.iconColor:null);}else{c(o._svgNode);}}o.render(q,B,p.iconColor);o.destroy();var C=0,D=0;if(t){var F=i.styles;var G=S.measureText(k,{"font-family":p.fontFamily||F["font-family"],"font-size":p.fontSize||F["font-size"],"font-weight":p.fontWeight||F["font-weight"],"font-style":p.fontStyle||F["font-style"]});if(w){C=G.x+G.width+a;D=G.y+G.height/2-z*B/2;}else{C=G.x+G.width/2-y*B/2;D=G.y-a-z*B;}}var H=o.getX()*B;var J=o.getY()*B;switch(x){case 90:q.setAttribute("transform","translate("+(C+J+u*B)+","+(D-H)+") rotate(90)");break;case 180:q.setAttribute("transform","translate("+(C+H+r*B)+","+(D+J+u*B)+") rotate(180)");break;case 270:q.setAttribute("transform","translate("+(C-J)+","+(D+H+r*B)+") rotate(270)");break;default:q.setAttribute("transform","translate("+(C-H)+","+(D-J)+")");break;}}}return j;}};}};});define('sap/viz/controls/plugins/infochart/LineMarkerRendererGenerator',["./getPropertiesByCtx","./SVG","./Icon","./DataUtils","./shapeHelper"],function(g,S,I,D,s){var a=D.setExtraData;var h=s.hasColorAttributes;var f=s.fillNodeWithColor;var b=s.fillNodeWithRandomId;return{name:"lineMarkerRenderer",fn:function(c){return function(d){var p=g(d,c);if(p){var e=d.graphic,i=p.iconSVG;if(i){var j=p.iconSize;if(j===0){return null;}j=p.iconSize;i=new I(i);var k=S.create("g");var l=i.getWidth();var m=i.getHeight();var x=j/l;var y=j/m;var n;if(h(i._svgNode)){if(p.iconColor){f(i._svgNode,p.iconFillColor?p.iconColor:null);}else{b(i._svgNode);}n=i.render(k,[x,y],p.iconColor);}else{n=i.render(k,[x,y],p.iconColor||e.fill);}a(n,{rotateAngle:p.iconRotateAngle});i.destroy();switch(p.iconRotateAngle){case 90:k.setAttribute("transform","translate("+(i.getY()*y+j/2)+","+(-i.getX()*x-j/2)+") rotate(90)");break;case 180:k.setAttribute("transform","translate("+(i.getX()*x+j/2)+","+(i.getY()*y+j/2)+") rotate(180)");break;case 270:k.setAttribute("transform","translate("+(-i.getY()*y-j/2)+","+(i.getX()*x+j/2)+") rotate(270)");break;default:k.setAttribute("transform","translate("+(-i.getX()*x-j/2)+","+(-i.getY()*y-j/2)+")");break;}return k;}}};}};});define('sap/viz/controls/plugins/infochart/LineRendererGenerator',["./getPropertiesByCtx"],function(g){return{name:"lineRenderer",fn:function(c){return function(a){var p=g(a,c);if(p){var b=a.graphic;b.color=p.color||b.color;b.width=p.width||b.width;b.dash=p.dash||b.dash;}};}};});define('sap/viz/controls/plugins/infochart/ScatterMarkerGenerator',["./getPropertiesByCtx","./SVG","./Icon"],function(g,S,I){return{name:"scatterMarkerRenderer",fn:function(c){return function(a){var p=g(a,c);var s=a.graphic.shape;var b=a.graphic.borderColor;if(p){var d=a.graphic,i=(p.iconSVG[s]===undefined)?p.iconSVG:p.iconSVG[s];if(i){var e=p.iconSize;if(e===0){return null;}i=new I(i);var m=S.create("g");var f=i.getWidth();var h=i.getHeight();var x=e/f;var y=e/h;i.render(m,[x,y],p.iconColor||d.fill);i.destroy();m.setAttribute("transform","translate("+(-f/2-i.getX())*x+","+(-h/2-i.getY())*y+")");m.setAttribute("stroke",b);m.setAttribute("stroke-width",1/x+"px");return m;}}};}};});define('sap/viz/controls/plugins/infochart/BubbleMarkerGenerator',["./getPropertiesByCtx","./SVG","./Icon"],function(g,S,I){return{name:"bubbleMarkerRenderer",fn:function(c){return function(a){var p=g(a,c);var s=a.graphic.shape;var b=a.graphic.borderColor;var w=a.graphic.width;var h=a.graphic.height;var f=a.graphic.fillOpacity;if(p){b=(a.data.negativeValue&&p.iconColor)?p.iconColor:b;var d=a.graphic,i=(p.iconSVG[s]===undefined)?p.iconSVG:p.iconSVG[s];if(i){i=new I(i);var m=S.create("g");var e=i.getWidth();var j=i.getHeight();var x=w/e;var y=h/j;i.render(m,[x,y],p.iconColor||d.fill);i.destroy();m.setAttribute("transform","translate("+(-e/2-i.getX())*x+","+(-j/2-i.getY())*y+")");m.setAttribute("stroke",b);m.setAttribute("stroke-width",1/x+"px");m.setAttribute("fill-opacity",f);return m;}}};}};});define('sap/viz/controls/plugins/infochart/CombinationDataPointRendererGenerator',["./getPropertiesByCtx","./SVG","./Icon","./shapeHelper","./BarShapeRendererGenerator","./LineMarkerRendererGenerator"],function(g,S,I,s,B,L){var h=s.hasColorAttributes;var f=s.fillNodeWithColor;return{name:'combinationDataPointRenderer',fn:function(c){return function(a){if(a.isLineMarker===false){return(B.fn(c))(a);}else{var p=g(a,c);if(p&&p["iconSVG"]){return(L.fn(c))(a);}else{var b=a.graphic;var n=S.create("path");if(b.d){n.setAttribute("d",b.d);}var d=a.effectManager.register({drawingEffect:b.drawingEffect,fillColor:b.fill});n.setAttribute("fill",d);var o=(b.opacity>=0&&b.opacity<=1)?b.opacity:1;n.setAttribute("stroke-opacity",o);return n;}}};}};});define('sap/viz/controls/plugins/infochart/interaction/DesignTimeLineUtils',["./DesignTimeUtils"],function(D){var _={fuzzyDistance:10,geoUtils:{distance:function(p,a){return Math.sqrt(Math.pow(p.x-a.x,2)+Math.pow(p.y-a.y,2));},distanceFromPointToLine:function(d,l){var a=this.distance(d,l.p1),b=this.distance(d,l.p2),c=this.distance(l.p1,l.p2),p=(a+b+c)/2,s=Math.sqrt(p*(p-a)*(p-b)*(p-c));return 2*s/c;},isObtuseAngle:function(a,b,c){var d=this.distance(a,b),e=this.distance(b,c),f=this.distance(c,a);return(d*d+e*e)<(f*f);}},centerOfDP:function(d){var r=d.getBoundingClientRect();return{x:r.left+r.width/2,y:r.top+r.height/2};},fuzzyDP:function(a,p){var m=this.fuzzyDistance+10,b,c,d,e;for(var i=-1;++i<a.length;){d=a[i];c=this.centerOfDP(d);e=this.geoUtils.distance(c,p);if(e<m&&e<this.fuzzyDistance){e=m;b=d;}}return b;},fuzzyLineByGeo:function(a,b,p){var l,c,d,e,f,m=this.fuzzyDistance+10,g,h,k,n,i,j;for(i=-1;++i<a.length;){l=a[i];c=d3.select(l).datum();e=[];for(j=-1;++j<b.length;){f=b[j];d=d3.select(f).datum();if(D.matchCtx(c,d)){e.push(f);}}for(j=-1;++j<e.length-1;){k=this.centerOfDP(e[j]);n=this.centerOfDP(e[j+1]);h=this.geoUtils.distanceFromPointToLine(p,{p1:k,p2:n});if(h<m&&h<this.fuzzyDistance&&!this.geoUtils.isObtuseAngle(p,k,n)&&!this.geoUtils.isObtuseAngle(p,n,k)){m=h;g=i;}}}if(m<this.fuzzyDistance){return a[g];}},fuzzyLine:function(l,a,p){var b,d,n,i,t;for(i=-1;++i<l.length;){b=l[i];d=b.getAttribute('d');n=document.createElementNS("http://www.w3.org/2000/svg",'path');n.setAttribute('d',d);n.setAttribute('stroke-width',this.fuzzyDistance*2);n.setAttribute('fill','none');n.setAttribute('stroke','transparent');b.parentNode.appendChild(n);t=document.elementFromPoint(p.x,p.y);b.parentNode.removeChild(n);if(t===n){return b;}}},fuzzilyMatch:function(r,p){var l=r.querySelectorAll('.'+D.featureClassesMap.dataLine);if(!l.length){return;}var a=r.querySelectorAll('.'+D.featureClassesMap.dataPoint),d;d=this.fuzzyDP(a,p);if(d){return d;}return this.fuzzyLine(l,a,p);}};return _;});define('sap/viz/controls/plugins/infochart/interaction/PieBehaviorHelper',["sap/viz/controls/common/utils/Utils"],function(U){var c=function(d,a,e){var f=a;var g=e;if(d3.select(d).attr('transform')){var t=d3.select(d).attr("originalTransform")||d3.select(d).attr('transform');if(t.indexOf('translate')>-1){d3.select(d).attr("originalTransform",t);var h=d3.transform(t);if(h&&h.translate&&h.translate.length===2){f=h.translate[0]+a;g=h.translate[1]+e;}}}else{d.setAttribute("transform","");}if(d){d3.select(d).transition().attr('transform',"translate("+f+","+g+")");}};var b=function(d,e){var t=d3.select(d).attr("originalTransform");if(t){d3.select(d).transition().attr('transform',t).each("end",function(){if(e){e(d);}});}};var P={calcTranslate:c,selectDataPoint:function(f){if(!U.isArray(f)){f=[f];}f.forEach(function(e){var g=d3.select(e);var d=g.node()["__extra_data__"];if(d){var h=d.decoras;var i=0,j=0;var a=d.midAngle;var r=d.r;var s;s=0.08*r;i=s*Math.sin(a);j=-s*Math.cos(a);g.attr('transform',"translate("+i+","+j+")");g.attr('translateOffsetX',i);g.attr('translateOffsetY',j);if(h&&(!g.attr('offsetDone')||g.attr('offsetDone')==="false")){c(h,i,j);h.dataset["transitionx"]=i;h.dataset["transitiony"]=j;}g.attr('offsetDone',true);}});},deselectDataPoint:function(a){if(!U.isArray(a)){a=[a];}a.forEach(function(e){var f=d3.select(e);if(f){if(f.attr('offsetDone')==="true"){f.attr('transform',"translate(0,0)");var o=f.attr('translateOffsetX');var g=f.attr('translateOffsetY');var d=f.node()["__extra_data__"];var h=d.decoras;if(h&&o&&g){b(h,function(){delete h.dataset["transitionx"];delete h.dataset["transitiony"];});}f.attr('offsetDone',false);}}});}};return P;});define('sap/viz/controls/plugins/infochart/interaction/DesignTimeBehavior',["sap/viz/controls/plugins/infochart/interaction/DesignTimeUtils","sap/viz/controls/plugins/infochart/interaction/DesignTimeLineUtils","sap/viz/controls/plugins/infochart/interaction/PieBehaviorHelper","sap/viz/controls/common/utils/Utils","jquery"],function(D,a,P,U,$){var b=new sap.viz.api.interaction.Behavior({id:"DesignTimeBehavior"});var p="v-plot-bound",c="v-datapoint",f="v-lines",g="v-datalabel",l="v-m-legendGroup",k="v-m-axisBody",q="v-m-axisTitle",r="v-m-title";var u=["info/bar","info/column","info/dual_column","info/dual_bar","info/stacked_bar","info/stacked_column","info/100_stacked_bar","info/100_stacked_column","info/mekko","info/100_mekko","info/horizontal_mekko","info/100_horizontal_mekko"];var v=["info/donut","info/pie"];var w=["info/line","info/horizontal_line","info/dual_line","info/dual_horizontal_line","info/combination","info/horizontal_combination"];var z=["info/bubble","info/scatter"];var A=["info/treemap"];var B=["info/mekko","info/100_mekko","info/horizontal_mekko","info/100_horizontal_mekko"];var C=[];var E=[];var F=['info/trellis_bar','info/trellis_line','info/trellis_horizontal_line','info/trellis_column','info/trellis_donut','info/trellis_dual_column','info/trellis_dual_line','info/trellis_dual_horizontal_line','info/trellis_dual_bar','info/trellis_pie','info/trellis_bubble','info/trellis_scatter','info/trellis_100_stacked_column','info/trellis_stacked_column','info/trellis_stacked_bar','info/trellis_100_stacked_bar','info/trellis_combination','info/trellis_horizontal_combination'];var G=['info/trellis_line','info/trellis_dual_line','info/trellis_dual_horizontal_line','info/trellis_horizontal_line','info/trellis_combination','info/trellis_horizontal_combination'];var H=D.hasClass,I=D.findAncestor,J=D.hasChild,K=D.findParent,L=D.getData,M=D.getExtraData;function N(n,d,h,m){m=m||0;if(U.isArray(n)){return n.map(function(e){return N(e,d,h,m);});}var i=T(n,m);if(i===undefined||i===null){return;}var j=O(n),s=i.style,o={},t=1;d=d||{"stroke":"blue","stroke-width":t+"px","stroke-dasharray":3*t+","+3*t,"fill-opacity":1,"stroke-opacity":1};for(var x in d){if(d.hasOwnProperty(x)){if(j){o[x]=s[x];}s[x]=d[x];}}if(j&&!$(i).data("vizSelectOrigStyle")){$(i).data("vizSelectOrigStyle",o);}return i;}function O(n){return H(n,'v-datapoint')||H(n,'v-datapoint-marker')||H(n,'v-lines')||H(n,'v-combination-lines');}function Q(n){if(O(n)){return n;}return $(n).data("v-select-indicator");}function R(o,d,e){if(o==null){return o;}var i=o.indexOf(d);if(i===-1){return o;}return o.replace(RegExp(d+"\\([^)]+\\)"),d+"("+e.join(",")+")");}function S(n){var t=n.getBoundingClientRect();if(t.width===0&&t.height===0&&n.firstChild){n=n.firstChild;}return n;}function T(n,m){var i=Q(n);if(O(n)){return i;}var d=n,e,h,j;h=K(n);if(i){d3.select(i).remove();}j=h.getBoundingClientRect();if(H(n,"v-m-title")){d=n.querySelector(".v-title");}else if(H(n,"v-m-axisTitle")){d=n.querySelector("text");}else if(H(n,"v-axis-item")&&!H(n,"v-axis-mekko-item")){d=n.querySelector(".viz-axis-label-rect");}else if(J(n,"v-clippath")){d=n.querySelector(".v-clippath");d=S(d);}else if(H(n,"v-m-axisBody")&&n.parentNode&&n.parentNode.parentNode&&H(n.parentNode.parentNode,"v-m-categoryAxis")){d=n.querySelector(".v-label-group text");if(d&&/rotate\([+-]?\d+/.test(d.getAttribute("transform"))){d=n.parentNode.querySelector(".v-clippath");d=S(d);}else{d=n;}}var x,y,s,o,t;if(d===undefined||d===null){return;}e=d.getBoundingClientRect();t=d;if(H(t,"v-m-root")){t=d.querySelector(".v-m-title")||d;}if((d.getAttribute("transform")||"").match(/rotate\s*\(\s*-?(?:90|270)/)){s=t.getBBox().height/t.getBoundingClientRect().width;o=t.getBBox().width/t.getBoundingClientRect().height;}else{s=t.getBBox().width/t.getBoundingClientRect().width;o=t.getBBox().height/t.getBoundingClientRect().height;}if(isNaN(s)){s=1;}if(isNaN(o)){o=1;}if(H(n,"v-label")&&$(".v-m-categoryAxis").find(n)[0]===n){var w1=d.getBBox();i=d3.select(d.parentNode).append("rect").attr("class","v-select-indicator").style({"visibility":"hidden","fill":"none"}).node();if(e.width>0&&e.height>0){d3.select(i).attr({x:w1.x+1,y:w1.y+1,width:Math.max(w1.width-m*2,0),height:Math.max(w1.height-m*2,0)}).style("visibility","visible");(function(x1,y1){if(!x1){return;}if(y1.exec(x1)){x1=R(x1,"skewX",[-20]);d.setAttribute('transform',x1);}i.setAttribute('transform',x1);})(d.getAttribute('transform'),/skewX\s*\(\s*-45\s*\)/);}$(n).data("v-select-indicator",i);return i;}if(H(n,"v-m-root")||H(n,"v-m-title")||H(n,"v-m-legendGroup")){x=(e.left-j.left)*s;y=(e.top-j.top)*o;}else{x=(e.left-j.left)*s+h.getBBox().x;y=(e.top-j.top)*o+h.getBBox().y;}i=d3.select(h).append("rect").attr("class","v-select-indicator").style({"visibility":"hidden","fill":"none"}).node();if(e.width>0&&e.height>0){d3.select(i).attr({x:x+m,y:y+m,width:Math.max(e.width*s-m*2,0),height:Math.max(e.height*o-m*2,0)}).style("visibility","visible");}$(n).data("v-select-indicator",i);return i;}function V(n){if(U.isArray(n)){n.forEach(function(e){V(e);});return;}var i=Q(n);if(!i){return;}if(O(n)){var o=$(i).data("vizSelectOrigStyle")||{},s=i.style;for(var d in o){if(o.hasOwnProperty(d)){if(o[d]===undefined){delete s[d];}else{s[d]=o[d];}}}$(i).removeData("vizSelectOrigStyle");}else{d3.select(i).remove();}}function W(s,d){var h=false;for(var i=-1;++i<d.length;){if(s&&s.indexOf(d[i])>-1){h=true;}else{if(h){return'some';}}}return h?'all':'none';}b.add({"id":"initialized_datapoint","trigger":{"name":"afterBehaviorLoaded"},"handler":function(e,s){s.setStatus("selectedUnits",[]);s.getProperties().add("selectedPropertyZone",{set:function(d){if(d==null){t1(s);}else{v1(s,d);}},get:function(){return u1(s);}});}});b.add({"id":"selectItem_scatter","trigger":{"name":"selectItem","supportedChartTypes":z},"handler":function(e,s){var d=e.data.targets;var h=i1(d[0]);if(!U.isArray(d)){d=[d];}if(H(d[0],"v-datapoint")){d.forEach(function(i){var j=i1(i);var m=i.firstChild.getAttribute('stroke');h=j<h?j:h;if(m!==null){i['__extra_data__']['stroke']=m;}i.firstChild.removeAttribute('stroke');});}N(d,{"stroke":"blue","stroke-width":h+"px","stroke-dasharray":3*h+","+3*h,"fill-opacity":1,"stroke-opacity":1});}});b.add({"id":"deselectItem_scatter","trigger":{"name":"deselectItem","supportedChartTypes":z},"handler":function(e,s){var d=e.data.targets;if(!U.isArray(d)){d=[d];}V(d);if(H(d[0],"v-datapoint")){d.forEach(function(h){var i=h['__extra_data__']['stroke'];if(i!==null){h.firstChild.setAttribute('stroke',i);}});}}});b.add({"id":"afterChartRendered","trigger":{"name":"afterChartRendered"},"handler":function(e,s){if(s.getStatus("selectedPropertyZoneData")){v1(s,u1(s));var d=s.getStatus("selectedUnits");if(d&&d.length){s.fireEvent("selectItem",{targets:d});}}}});b.add({"id":"select_on_plotArea","trigger":{"name":"click","targets":["v-plot-bound"],"supportedChartTypes":u.concat(w).concat(v).concat(z).concat(A)},"handler":function(e,s){var d=s.getStatus("selected"),h=s.getStatus("selectedUnits"),t=e.data.currentTarget;var i=a.fuzzilyMatch(s._rootNode.node(),e.data.point),j;if(i){if(H(i,"v-datapoint")){_({data:{currentTarget:i,target:i,ctrlKey:e.data.ctrlKey}},s,"v-datapoint");return;}if(H(i,"v-datapoint-marker")){_({data:{currentTarget:i,target:i,ctrlKey:e.data.ctrlKey}},s,"v-datapoint-marker");return;}if(H(i,"v-lines")||H(i,"v-combination-lines")){c1({data:{currentTarget:i,target:i,ctrlKey:e.data.ctrlKey}},s);return;}}o1(s,{targets:t,ctrlKeyPressed:e.data.ctrlKey,force:true});}});b.add({"id":"select_on_plotArea_of_chart_withoutInfographic","trigger":{"name":"click","targets":["v-plot-bound"],"supportedChartTypes":E.concat(C)},"handler":function(e,s){d1(e,s);}});b.add({"id":"select_on_plotArea_of_trellis","trigger":{"name":"click","targets":["v-plot-bound"],"supportedChartTypes":F},"handler":function(e,s){e1(e,s);}});b.add({"id":"select_on_dataPoint_of_trellis","trigger":{"name":"click","targets":["v-datapoint"],"supportedChartTypes":F},"handler":function(e,s){e1(e,s);}});b.add({"id":"select_on_plotArea_when_axisItem_for_tree","trigger":{"name":"click","targets":["v-axis-item"],"supportedChartTypes":"info/treemap"},"handler":function(e,s){d1(e,s);}});b.add({"id":"select_on_datalabel","trigger":{"name":"click","targets":["v-datalabel"],"supportedChartTypes":u.concat(w).concat(v).concat(F)},"handler":function(e,s){_(e,s,"v-datalabel");}});b.add({"id":"select_on_datalabel_scatter","trigger":{"name":"click","targets":["v-datalabel"],"supportedChartTypes":z},"handler":function(e,s){a1(e,s,"v-datalabel");}});b.add({"id":"select_on_datalabel_treemap","trigger":{"name":"click","targets":["v-datalabel"],"supportedChartTypes":A},"handler":function(e,s){X(e,s);}});b.add({"id":"select_on_all_datalabel","trigger":{"name":"click","targets":["v-datalabel"],"supportedChartTypes":C.concat(E)},"handler":function(e,s){if(e.data.ctrlKey){return;}b1(e,s);}});b.add({"id":"select_on_treemap_dimensionlabel","trigger":{"name":"click","targets":["v-treemapdimensionlabel"],"supportedChartTypes":A},"handler":function(e,s){Y(e,s);}});function X(e,s){var d=s.getStatus("selected"),h=s.getStatus("selectedUnits");if("v-datalabel"!==d||h.length===0){b1(e,s,"v-datalabel");}else{o1(s,{targets:e.data.currentTarget,ctrlKeyPressed:e.data.ctrlKey,force:true});}}function Y(e,s){var d=s.getStatus("selected"),h=s.getStatus("selectedUnits"),t=e.data.currentTarget,i=t&&L(t)&&L(t).level===L(t).levelNum-1,j=t&&L(t)?t&&L(t).level:0,m=h&&h[0]&&L(h[0])?L(h[0]).level:0;if("v-treemapdimensionlabel"!==d||h.length===0||j!==m){Z(e,s);}else{if(i){o1(s,{targets:e.data.currentTarget,ctrlKeyPressed:e.data.ctrlKey,force:true});}}}function Z(e,s){var t=e.data.currentTarget,d;if(t&&L(t)){d=L(t).level;t=r1(s,"v-treemapdimensionlabel").filter(function(n){return n&&L(n)&&D.matchCtx({level:d},L(n));});o1(s,{targets:t,force:true});}}function _(e,s,i){var d=s.getStatus("selected"),h=s.getStatus("selectedUnits"),t=e.data.currentTarget;var j,m,n=false;function o(t,n){o1(s,{targets:t,ctrlKeyPressed:e.data.ctrlKey,force:true,bySeries:n});}if(!e.data.ctrlKey){j=p1(s,t,i);m=W(h,j);if(m==='none'||(m==='all'&&h.length>j.length)){t=j;n=true;}}o(t,n);}function a1(e,s,i){var d=s.getStatus("selected"),h=s.getStatus("selectedUnits"),t=e.data.currentTarget;var j,m,n=false;function o(t,n){o1(s,{targets:t,ctrlKeyPressed:e.data.ctrlKey,force:true,bySeries:n});}if(!e.data.ctrlKey){j=q1(s,t,i);m=W(h,j);if(m==='none'||(m==='all'&&h.length>j.length)){t=j;n=true;}}o(t,n);}function b1(e,s,i){o1(s,{targets:r1(s,i),ctrlKeyPressed:false,force:true});}function c1(e,s){var d=s.getStatus("selected"),h=s.getStatus("selectedUnits"),t=e.data.currentTarget,i;o1(s,{targets:t,ctrlKeyPressed:e.data.ctrlKey,force:true});}b.add({"id":"select_on_datapoint","trigger":{"name":"click","targets":["v-datapoint"],"excludeTargets":["v-treemapdimensionlabel"],"supportedChartTypes":u.concat(v).concat(w)},"handler":function(e,s){_(e,s,"v-datapoint");}});b.add({"id":"select_on_scatter_datapoint","trigger":{"name":"click","targets":["v-datapoint"],"excludeTargets":["v-treemapdimensionlabel"],"supportedChartTypes":z},"handler":function(e,s){a1(e,s,"v-datapoint");}});b.add({"id":"select_on_datapoint_marker","trigger":{"name":"click","targets":["v-datapoint-marker"]},"handler":function(e,s){_(e,s,"v-datapoint-marker");}});b.add({"id":"select_on_datapoint_of_charts_without_infographic","trigger":{"name":"click","targets":["v-datapoint"],"excludeTargets":["v-treemapdimensionlabel"],"supportedChartTypes":C.concat(E).concat(A)},"handler":function(e,s){d1(e,s);}});function d1(e,s){var d=s.getStatus("selected"),h=s.getStatus("selectedUnits"),t=Array.prototype.slice.call(s._rootNode.node().querySelectorAll(".v-plot-bound"));o1(s,{targets:t,ctrlKeyPressed:e.data.ctrlKey,force:true,suppressEvent:false,selectAllData:false});}function e1(e,s){var d=s.getStatus("selected"),h=s.getStatus("selectedUnits"),t=Array.prototype.slice.call(s._rootNode.node().querySelectorAll(".v-trellis-plot-bound"));o1(s,{targets:t,ctrlKeyPressed:e.data.ctrlKey,force:true,suppressEvent:false,selectAllData:false});}b.add({"id":"select_on_line","trigger":{"name":"click","targets":["v-lines","v-combination-lines"],"supportedChartTypes":w},"handler":function(e,s){c1(e,s);}});b.add({"id":"select_on_line_of_dual_line_chart","trigger":{"name":"click","targets":["v-lines"],"supportedChartTypes":E},"handler":function(e,s){d1(e,s);}});b.add({"id":"select_on_line_trellis","trigger":{"name":"click","targets":["v-lines"],"supportedChartTypes":G},"handler":function(e,s){e1(e,s);}});function f1(e,s){var d=s.getStatus("selectedUnits").splice(0);h1(s);s.fireEvent("deselectItem",{targets:d});if(d.length){m1(s,d,"deselect");}}b.add({"id":"deselect_all","trigger":{"name":"click","excludeTargets":["v-datapoint","v-datapoint-marker","v-m-legendGroup","v-axis-item","v-datalabel","v-m-axisBody","v-plot-bound","v-m-axisTitle","v-m-title","v-lines","v-combination-lines","v-treemapdimensionlabel"]},"handler":function(e,s){var d=s.getStatus("selected"),h=s.getStatus("selectedUnits"),t=e.data.currentTarget;if(e.data.ctrlKey){return;}f1(e,s);t=s._rootNode.node();s.setStatus("selected","v-m-root");s.setStatus("selectedPropertyZoneData",D.constructEventData([t]));h.push(t);s.fireEvent("selectItem",{targets:[t]});m1(s,[t],"select");}});function g1(s){var d=s.getNodes(s.NodeType.DATA_POINT_GROUP).node();d.setAttribute("fill-opacity","0.2");d.setAttribute("stroke-opacity","0.2");}function h1(s){var d=s.getNodes(s.NodeType.DATA_POINT_GROUP).node();d.removeAttribute("fill-opacity");d.removeAttribute("stroke-opacity");}function i1(e){var d=1,m,t;if(O(e)){m=e.querySelector("circle")||e.querySelector("path")||e.querySelector("rect")||e.querySelector("ellipse")||e.querySelector("line")||e.querySelector("polyline")||e.querySelector("polygon");if(m){t=m.getTransformToElement(e);var h=m.getBoundingClientRect();var i=m.getBBox();d=i.width/h.width;}}return d;}function j1(e,d){var h=1,m;if(O(e)){m=e.querySelector("circle")||e.querySelector("path")||e.querySelector("rect")||e.querySelector("ellipse")||e.querySelector("line")||e.querySelector("polyline")||e.querySelector("polygon");if(m){var i=m.getBoundingClientRect();var j=m.getBBox();if(d===undefined){var n;if(m.parentNode){n=M(m.parentNode);if(n!==undefined&&n.rotateAngle!==undefined){d=(Number(n.rotateAngle)%180===90);}}}h=d?j.height/i.width:j.width/i.width;}}return h;}function k1(d){var e=d[0];var m=e.querySelector("circle")||e.querySelector("path")||e.querySelector("rect")||e.querySelector("ellipse")||e.querySelector("line")||e.querySelector("polyline")||e.querySelector("polygon");var h,i=false;if(m&&m.parentNode){var j=M(m.parentNode);if(j){h=j.mode;if(j.rotateAngle!==undefined){i=(Number(j.rotateAngle)%180===90);}}}if(h==="scale"){d.forEach(function(o){var n=j1(o,i);N(o,{"stroke":"blue","stroke-width":n+"px","stroke-dasharray":3*n+","+3*n,"fill-opacity":1,"stroke-opacity":1},null,1);});}else{var n=j1(d[0],i);N(d,{"stroke":"blue","stroke-width":n+"px","stroke-dasharray":3*n+","+3*n,"fill-opacity":1,"stroke-opacity":1},null,1);}}b.add({"id":"selectItem_general","trigger":{"name":"selectItem"},"handler":function(e,s){var d=e.data.targets;if(!U.isArray(d)){d=[d];}var h=i1(d[0]);N(d,{"stroke":"blue","stroke-width":h+"px","stroke-dasharray":3*h+","+3*h,"fill-opacity":1,"stroke-opacity":1});}});b.add({"id":"selectItem_trellis","trigger":{"name":"selectItem","supportedChartTypes":F,},"handler":function(e,s){var d=e.data.targets;if(!U.isArray(d)){d=[d];}var h=i1(d[0]);N(d,{"stroke":"blue","stroke-width":h+"px","stroke-dasharray":3*h+","+3*h,"fill-opacity":1,"stroke-opacity":1},null,1);}});b.add({"id":"selectItem_bar","trigger":{"name":"selectItem","supportedChartTypes":u,},"handler":function(e,s){var d=e.data.targets;if(!U.isArray(d)){d=[d];}k1(d);}});b.add({"id":"selectItem_line","trigger":{"name":"selectItem","supportedChartTypes":w},"handler":function(e,s){var d=e.data.targets;if(!U.isArray(d)){d=[d];}if(H(d[0],"v-lines")||H(d[0],"v-combination-lines")){N(d,{"stroke-opacity":'1'});}else{if(d[0].getAttribute("combination-column")==="true"){k1(d);}else{d.forEach(function(h){var i=j1(h);N(h,{"stroke":"blue","stroke-width":i+"px","stroke-dasharray":3*i+","+3*i,"fill-opacity":1,"stroke-opacity":1},null,1);});}}}});b.add({"id":"deselectItem_general","trigger":{"name":"deselectItem"},"handler":function(e,s){var d=e.data.targets;if(!U.isArray(d)){d=[d];}V(d);}});b.add({"id":"selectItem_pie","trigger":{"name":"selectItem","supportedChartTypes":v},"handler":function(e,s){var d=e.data.targets;if(!U.isArray(d)){d=[d];}var h=i1(d[0]);var j=N(d,{"stroke":"blue","stroke-width":h+"px","stroke-dasharray":3*h+","+3*h,"fill-opacity":1,"stroke-opacity":1});if(H(d[0],'v-datapoint')){P.selectDataPoint(d);}else if(H(d[0],'v-datalabel')){d.forEach(function(m,i){var n=m.dataset["transitionx"],o=m.dataset["transitiony"];if(j[i]&&n!=null){P.calcTranslate(j[i],-n,-o);}});}}});b.add({"id":"deselectItem_pie","trigger":{"name":"deselectItem","supportedChartTypes":v},"handler":function(d,s){var h=d.data.targets;if(!U.isArray(h)){h=[h];}h.forEach(function(e){V(e);});if(H(h[0],'v-datapoint')){P.deselectDataPoint(h);}}});function l1(e,s){var d=s.getStatus("selected"),h=s.getStatus("selectedUnits"),t=e.data.currentTarget;o1(s,{targets:t,ctrlKeyPressed:e.data.ctrlKey,force:true});}b.add({"id":"select_on_title","trigger":{"name":"click","targets":["v-m-title"]},"handler":function(e,s){l1(e,s);}});b.add({"id":"select_on_axisTitle","trigger":{"name":"click","targets":["v-m-axisTitle"],"supportedChartTypes":u.concat(v).concat(w).concat(C).concat(E).concat(A).concat(z)},"handler":function(e,s){l1(e,s);}});b.add({"id":"select_on_axisTitle_trellis","trigger":{"name":"click","targets":["v-title viz-axis-title v-trellistitle-bottom","v-title viz-axis-title v-trellistitle-left","v-title viz-axis-title v-trellistitle-top","v-title viz-axis-title v-trellistitle-right"],"supportedChartTypes":F},"handler":function(e,s){l1(e,s);}});b.add({"id":"select_on_legendGroup","trigger":{"name":"click","targets":["v-m-legendGroup"]},"handler":function(e,s){l1(e,s);}});function m1(d,t,s){var e=D.constructEventData(t),h=s==="select"?"selectPropertyZone":"deselectPropertyZone";d.fireExternalEvent(h,e);}function n1(d,e,s){var h=e,i=s==="select"?"selectPropertyZone":"deselectPropertyZone";d.fireExternalEvent(i,h);}function o1(s,d){var h=s.getStatus("selectedUnits"),t=d.targets,m=D.featureClassesMap.isMultiselectable(t);if(!d.force&&h.length===1&&t.length===1&&h[0]===t[0]&&!m){return;}if(d.ctrlKeyPressed&&!m&&h.length){return;}if(!U.isArray(t)){t=[t];}if(h.length===0){}var j=[],n=[],x,y;if(d.ctrlKeyPressed){for(var i=-1;++i<t.length;){y=t[i];if((x=h.indexOf(y))>-1){Array.prototype.push.apply(n,h.splice(x,1));}else if(!s.getStatus("selected")||H(y,s.getStatus("selected"))){h.push(y);j.push(y);}}if(!h.length){var w1=D.featureClassesMap.chart;var x1=s._rootNode.node();if(!H(x1,w1)){x1=x1.querySelector("."+w1);}h.push(x1);j.push(x1);}}else{if(h.length===t.length){if(h.every(function(e,i){return e===t[i];})){return;}}Array.prototype.push.apply(n,h);h.splice(0);Array.prototype.push.apply(h,t);Array.prototype.push.apply(j,t);}var y1=h.length===0?null:D.featureClassesMap.featureClass(h[0]);if(y1!==s.getStatus("selected")&&(y1==="v-datapoint"||y1==="v-datapoint-marker"||y1===D.featureClassesMap.dataLine)||y1===D.featureClassesMap.combinationDataLine){g1(s);}else if(y1!=="v-datapoint"&&y1!=="v-datapoint-marker"&&y1!==D.featureClassesMap.dataLine&&y1!==D.featureClassesMap.combinationDataLine){h1(s);}s.setStatus("selected",y1);var z1={};z1.isBySeries=d.bySeries;var A1=s.getStatus("seriesDef");if(A1){z1.seriesBindings=A1;}else{var B1=s.getDataModel();var C1=B1.getBindingMetaData();z1.seriesBindings=((C1&&C1["color"])||[]).map(function(o){return o.id;});}var D1=s._rootNode.node().querySelectorAll("."+y1).length;var E1=h[0];var F1=!!(s._rootNode.node()&&h.length===D1);if(E1&&(E1.getAttribute("combination-line")==="true"||E1.getAttribute("combination-column")==="true")){F1=false;}s.setStatus("selectedPropertyZoneData",D.constructEventData(h,z1,F1));if(n.length>0){s.fireEvent("deselectItem",{targets:n});if(!d.suppressEvent){m1(s,n,"deselect");}}if(j.length>0){s.fireEvent("selectItem",{targets:j});if(!d.suppressEvent){n1(s,s.getStatus("selectedPropertyZoneData"),"select");}}}function p1(s,n,e){var h=s.getDataModel();var j=h.getBindingMetaData();var m=d3.select(n).datum(),t={},x=[],y=((j&&j["color"])||[]).map(function(o){return o.id;});for(var i=-1;y&&++i<y.length;){t[y[i]]=m[y[i]];}s._rootNode.selectAll('.'+e).filter(function(d){for(var o in t){if(t.hasOwnProperty(o)){if(d[o]!==t[o]){return;}}}x.push(this);});return x;}function q1(s,n,e){var h=s.getDataModel();var i=h.getBindingMetaData();var j=d3.select(n).datum(),m={},t=[],x=[],y=((i&&i["color"])||[]).map(function(o){return o.id;}),w1=((i&&i["shape"])||[]).map(function(o){return o.id;});if(y.length>0){m[y[0]]=j[y[0]];x.push(y[0]);}if(w1.length>0){m[w1[0]]=j[w1[0]];x.push(w1[0]);}s.setStatus("seriesDef",x);s._rootNode.selectAll('.'+e).filter(function(d){for(var o in m){if(m.hasOwnProperty(o)){if(d[o]!==m[o]){return;}}}t.push(this);});return t;}function r1(s,d){return Array.prototype.slice.call(s._rootNode.node().querySelectorAll('.'+d));}function s1(t,s){var e=s.getDataModel();var h=e.getBindingMetaData();var j=d3.select(t).datum(),m={},n=[],x=((h&&h["color"])||[]).map(function(o){return o.id;});for(var i=-1;x&&++i<x.length;){m[x[i]]=j[x[i]];}s._rootNode.selectAll("."+D.featureClassesMap.dataPoint).filter(function(d){for(var o in m){if(m.hasOwnProperty(o)){if(d[o]!==m[o]){return;}}}n.push(this);});return n;}b.add({"id":"select_on_axisBody","trigger":{"name":"click","targets":["v-m-axisBody"],"supportedChartTypes":u.concat(v).concat(w).concat(A).concat(z)},"handler":function(e,s){var d=s.getStatus("selected"),h=s.getStatus("selectedUnits"),t=e.data.currentTarget;var i=h[0];if(!H(t,"v-value-axis2-mekko-body")&&((!i)||(i&&(i===t||(H(i,'v-axis-item')))))){t=I('v-axis-item',e.data.target,t)||t;}o1(s,{targets:t,ctrlKeyPressed:e.data.ctrlKey,force:true});}});b.add({"id":"select_on_axisBody_withoutInfographic","trigger":{"name":"click","targets":["v-m-axisBody"],"supportedChartTypes":C.concat(E)},"handler":function(e,s){o1(s,{targets:e.data.currentTarget,ctrlKeyPressed:e.data.ctrlKey,force:true});}});b.add({"id":"select_on_axisBody_trellis","trigger":{"name":"click","targets":["v-m-axis-position-bound v-gridcontainer-left","v-m-axis-position-bound v-gridcontainer-bottom","v-m-axis-position-bound v-gridcontainer-right","v-m-axis-position-bound v-gridcontainer-top"],"supportedChartTypes":F},"handler":function(e,s){o1(s,{targets:e.data.currentTarget,ctrlKeyPressed:e.data.ctrlKey,force:true,suppressEvent:false,selectAllData:false});}});b.add({"id":"getSelection","trigger":{"name":"getSelection"},"handler":function(e,s){return u1(s);}});b.add({"id":"setSelection","trigger":{"name":"setSelection"},"handler":function(e,s){return v1(s,e.data);}});b.add({"id":"clearSelection","trigger":{"name":"clearSelection"},"handler":function(e,s){return t1(s);}});function t1(s){s.fireEvent("deselectItem",{targets:s.getStatus("selectedUnits").splice(0)});h1(s);s.setStatus("selected",null);s.setStatus("selectedPropertyZoneData",null);}function u1(s){return s.getStatus("selectedPropertyZoneData");}function v1(s,e){var o;if(e&&e.type==="dataPointMarker"){o=D.featureClassesMap["dataPoint"];}else if(e&&e.type==="combinationDataLine"){o=D.featureClassesMap["dataLine"];}else{o=D.featureClassesMap[e.type];}var t=[],x=e.data&&e.data.length;if(!o){throw"Unsupported property zone type: "+e.type;}var y=s._rootNode.selectAll("."+o.replace(/ /g,"."));var w1=function(d){for(var i=-1;++i<e.data.length;){if(D.matchCtx(e.data[i],d)){return true;}}return false;};var x1=e.selectAllData||false;switch(e.type){case"dataPoint":g1(s);if(x){y=y.filter(w1);}else{x1=true;}for(var i=0;i<y.length;i++){for(var j=0;j<y[i].length;j++){var y1=y[i][j];if(y1.getAttribute("combination-marker")==="true"){y[i][j]=null;}}}break;case"dataPointMarker":g1(s);if(x){y=y.filter(w1);}else{x1=true;}for(var n=0;n<y.length;n++){for(var m=0;m<y[n].length;m++){var z1=y[n][m];if(z1.getAttribute("combination-marker")!=="true"){y[n][m]=null;}}}break;case"dataLine":g1(s);if(x){y=y.filter(w1);}else{x1=true;}break;case"combinationDataLine":g1(s);if(x){if(s.getStatus("selected")===null&&e&&e.type==="combinationDataLine"){y=y.filter(function(d){for(var h=0;h<e.data.length;h++){if(D.matchCtx(d,e.data[h])){return true;}}return false;});}else{y=y.filter(w1);}}else{x1=true;}break;case"dataLabel":case"dimensionLabel":if(x){y=y.filter(w1);}else{x1=true;}break;case"axis":case"axisItem":case"axisTitle":y=y.filter(function(d){var h=D.axisSubType(this);if(h!==e.subType){return false;}if(e.type!=="axisItem"||!x){if(e.type==="axisTitle"){return this.querySelector(".viz-axis-title");}return true;}for(var i=-1;++i<e.data.length;){if(D.matchCtx(e.data[i],d.ctx)){return true;}}return false;});break;case"title":y=y.filter(function(d){return this.querySelector(".v-title");});break;default:break;}y.each(function(){t.push(this);});if(H(s._rootNode.node(),o)){t.push(s._rootNode.node());}o1(s,{targets:t,ctrlKeyPressed:false,force:true,suppressEvent:true,bySeries:!!e.seriesData,selectAllData:x1});if(!t.length){s.setStatus("selectedPropertyZoneData",e);}return true;}return b;});define('sap/viz/controls/plugins/infochart/DimensionLabelRendererGenerator',["./getPropertiesByCtx","./SVG"],function(g,S){return{name:"dimensionLabelRenderer",fn:function(c){var d=function(a){var p=g(a,c);var t;if(p){t=S.create("text");if(p.textVisible!==false){t.textContent=a.text;var s="";var b;var e=a.properties.get('dimensionLabel').style;if((b=p.fontColor)){s+="fill:"+b+";";}else if((b=a.defaultColor)){s+="fill:"+b+";";}else if((b=e.color)){s+="fill:"+b+";";}if((b=p.fontFamily)){s+="font-family:"+b+";";}else if((b=e.fontFamily)){s+="font-family:"+b+";";}if((b=p.fontSize)){s+="font-size:"+b+";";}else if((b=e.fontSize)){s+="font-size:"+b+";";}if((b=p.fontWeight)){s+="font-weight:"+b+";";}else if((b=e.fontWeight)){s+="font-weight:"+b+";";}if((b=p.fontStyle)){s+="font-style:"+b+";";}else if((b=e.fontStyle)){s+="font-style:"+b+";";}if(s){t.setAttribute("style",s);}}}return t;};d.getPreferedSize=function(a){var p=g(a,c);if(!p){return;}if(p.textVisible&&p.textVisible===false){return;}var b="";if(p.fontColor&&p.fontColor!==""){b+='fill:'+p.fontColor+';';}if(p.fontFamily&&p.fontFamily!==""){b+='font-family:'+p.fontFamily+';';}if(p.fontSize&&p.fontSize!==""){b+='font-size:'+p.fontSize+';';}if(p.fontStyle&&p.fontStyle!==""){b+='font-style:'+p.fontStyle+';';}if(p.fontWeight&&p.fontWeight!==""){b+='font-weight:'+p.fontWeight+';';}var t=S.measureText(a.text,b);return{width:t.width,height:t.height}};return d;}};});define('sap/viz/controls/plugins/infochart/LegendSyncSeriesGenerator',["jquery","./getPropertiesByCtx","./SVG","./Icon",'sap/viz/controls/common/utils/Utils','sap/viz/controls/plugins/infochart/DataUtils'],function($,g,S,I,U,D){var q='<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"'+'width="50px" height="50px" viewBox="0 0 50 50" enable-background="new 0 0 50 50" xml:space="preserve">'+'<path d="M24.576,9.322c5.424,0,10.764,2.498,10.764,8.473c0,5.51-6.314,7.629-7.67,9.62c-1.018,1.482-0.678,3.561-3.475,3.561'+'c-1.822,0-2.712-1.482-2.712-2.838c0-5.045,7.414-6.188,7.414-10.342c0-2.287-1.523-3.643-4.067-3.643'+'c-5.424,0-3.306,5.592-7.414,5.592c-1.483,0-2.756-0.89-2.756-2.584C14.66,13.005,19.406,9.322,24.576,9.322z M24.365,33.729'+'c1.905,0,3.475,1.566,3.475,3.475c0,1.91-1.568,3.475-3.475,3.475c-1.907,0-3.476-1.564-3.476-3.475'+'C20.889,35.295,22.458,33.729,24.365,33.729z"/></svg>';function c(a){return e(a[0].ctx);}function e(a){var b=Object.keys(a);var j=D.DIMENSION_DISPLAYNAME;for(var i=b.length-1;i>=0;i--){if(b[i].indexOf(j,b[i].length-j.length)!==-1){b.splice(i,1);}}return b;}function d(a,b){var i={};for(var j=a.length-1;j>=0;j--){var u={};u.ctx=a[j].ctx;u.color=a[j].color;u.shape=a[j].shape;i[m(a[j].ctx,b)]=u;}return i;}function f(a,b,i){return i[a][h(b)];}function s(a,b,i,j){j[a][h(b)]=i;}function h(a){return{legendItemColorFill:"color",legendItemShape:"shape"}[a];}function k(a,b,i,j){var u={};b.forEach(function(v){var w=v.paras[a];if(!w){return;}var x;if(v.ctx===undefined){var y={ctx:v.ctx,all:true};y[a]=w;for(x in j){if(j.hasOwnProperty(x)){if(!u[x]){u[x]=[];}u[x].splice(0,0,y);}}return;}x=m(v.ctx,i);if(x&&j[x]){if(!u[x]){u[x]=[];}var z=e(v.ctx);if(l(z,i)){var A={ctx:z,bySeries:true};A[a]=w;if(u[x].length>0&&u[x][0].all===true){u[x].splice(1,0,A);}else{u[x].splice(0,0,A);}return;}var B={ctx:z};B[a]=w;u[x].push(B);}});return u;}function l(a,b){if(a===b){return true;}if(a===undefined||a===null||b===undefined||b===null){return false;}if(a.length!==b.length){return false;}a=a.slice(0).sort();b=b.slice(0).sort();for(var i=a.length-1;i>=0;i--){if(a[i]!==b[i]){return false;}}return true;}function m(a,b){var i="";for(var j=b.length-1;j>=0;j--){if(a[b[j]]){i+=(a[b[j]]+"__");}else{i=null;break;}}if(i){return i;}return null;}function n(a,b,j){var u=a.selectAll("g.v-legend-item")[0];for(var i=u.length-1;i>=0;i--){var v=D.getData(u[i]);if(v&&U.deepEqual(v.ctx,j[b].ctx)){return u[i];}}return null;}function o(a,b,i){var j=new i(a);var u=j.getDataPoints(b);if(u){return u.length;}else{return 0;}}function p(a,b,j,u,v,w,x){var y=k(a,b,j,u);for(var z in y){if(y.hasOwnProperty(z)){var A=y[z];var B=null;var C=null;var E=true;var F=A.length;for(var i=0;i<A.length;i++){if(A[i].all||A[i].bySeries){C=A[i][a];F--;}else{if(!B){B=A[i][a];}else{if(B!==A[i][a]){E=false;break;}}}}var G=f(z,a,u);if(C!==null&&C!==G){G=C;s(z,a,C,u);}if(E&&B!==null&&B!==G){if(o(u[z].ctx,v.dataModel,v.DataSelector)===F){s(z,a,B,u);}else{E=false;}}if(!u[z].consistency){u[z].consistency={};}u[z].consistency[a]=E;x(z,E,u,w);}}}function r(a,b,i,j,u){function v(y,i,u){var z=n(u.target,y,i);if(z){var A=S.create("g");var B=new I(q);var C=u.markerSize/50;var E=u.markerSize/50;B.render(A,[C,E],"#FFFFFF");B.destroy();A.setAttribute("class","v-legend-questionMark");var F=(u.x+u.markerSize)*C;var G=(u.y+u.markerSize/4)*E;A.setAttribute("transform",'translate('+F+','+G+')');z.appendChild(A);}}function w(y,z,i,u){var A=n(u.target,y,i);if(A){var B=$("g.v-legend-questionMark",A);B.remove();var C=$(".v-legend-marker",A);C.attr("fill",z);}}function x(y,z,i,u){if(z){w(y,f(y,"legendItemColorFill",i),i,u);}else{w(y,f(y,"legendItemColorFill",i),i,u);v(y,i,u);}}p("legendItemColorFill",a,b,i,j,u,x);}function t(a,b,j,u,v){var w=['circle','square','diamond','triangleUp','triangleDown','triangleLeft','triangleRight','cross','intersection'];function x(z,A,j,v){var B=n(v.target,z,j);if(B){if(w.indexOf(A)>-1){var C=$("g.v-legend-marker",B);if(C.children().length>0){for(var i=0,E=C.children().length;i<E;i++){B.appendChild(C.children()[i]);}}C.remove();}else{$(".v-legend-marker",B).remove();var F=new I(A);var G=F.render(B,undefined,f(z,"legendItemColorFill",j));F.destroy();var H=G.getBBox();var J=v.markerSize/H.width;var K=v.markerSize/H.height;var L=v.x-J*v.markerSize/2;var M=v.y-K*v.markerSize/2;G.setAttribute("transform",'translate('+L+','+M+') scale('+J+','+K+')');G.setAttribute("class","v-legend-marker");}}}function y(i,z,j,v){var A=f(i,"legendItemShape",j);x(i,A,j,v);}p("legendItemShape",a,b,j,u,v,y);}return{name:"legendPostRenderer",fn:function(a){return function(b,i){if(!b.domain||b.domain.length<=0){return;}var j=c(b.domain);var u=d(b.domain,j);t(a,j,u,b,i);r(a,j,u,b,i);return u;};}};});define('sap/viz/controls/plugins/infochart/setup',['sap/viz/controls/chart/adapters/PropFnGeneratorRegistry','./StackDecoratorGenerator','./BarShapeRendererGenerator','./StackedBarShapeRendererGenerator','./CategoryAxisLabelRendererGenerator','./PieSliceRendererGenerator','./DataLabelRendererGenerator','./LineMarkerRendererGenerator','./LineRendererGenerator','./ScatterMarkerGenerator','./BubbleMarkerGenerator','./CombinationDataPointRendererGenerator','./interaction/DesignTimeBehavior','./DimensionLabelRendererGenerator','./LegendSyncSeriesGenerator'],function(P,S,B,a,C,b,D,L,c,d,e,f,g,h,i){function r(k){P.register(k.name,k.fn);}var j=[S,B,a,C,b,D,L,c,d,e,f,h,i];j.forEach(r);sap.viz.api.interaction.add(g);});define('sap/viz/controls/contextmenu/ContextMenuConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var C={};C.instance=function(){return{'menu':[["sap.viz.controls.contextmenu.item.direction","sap.viz.controls.contextmenu.item.stacking"],["sap.viz.controls.contextmenu.item.title","sap.viz.controls.contextmenu.item.legend","sap.viz.controls.contextmenu.item.mbclegend","sap.viz.controls.contextmenu.item.datalabels","sap.viz.controls.contextmenu.item.negative","sap.viz.controls.contextmenu.item.mnd","sap.viz.controls.contextmenu.item.gridlines","sap.viz.controls.contextmenu.item.setAxisScale"]]};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_CONTEXTMENU,C);return C;});define('sap/viz/controls/contextmenu/ContextMenuEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var C=function(t,a,d){C.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.ContextMenuEvent";};O.extend(C,E);C.POPUP_CONTEXT_MENU="popupContextMenu";C.REQUEST_LEGEND_COLOR="chooseLegendColors";C.POPUP_CHART_EDITOR='popupChartEditor';C.MENU_ITEM_SELECTED='menuItemSelected';return C;});define('sap/viz/controls/contextmenu/views/MenuItem',['jquery','sap/viz/controls/common/constants/CSSConst'],function($,C){var c=C.CONTEXTMENU_PREFIX;var a=c+"MnuItm";var b=c+"MnuItmIco";var d=c+"MnuItmTxt";var e=c+"MnuItm-Show";var f=c+"MnuItm-Hide";var g=c+"MnuItmIco-Show";var h=c+"MnuItmIco-Hide";var i=c+"MnuItmOpen";var j=C.COMMON_PREFIX+'menu-list-suffix-icon-submenu';var k=C.CONTEXTMENU_PREFIX+"disabled";function M(p,q,r){this.__className="sap.viz.controls.contextmenu.views.MenuItem";p=p||{};var s=this.dom=document.createElement('li');var t=b;var u=j+' '+C.ICON_PREFIX+'arrow-right';s.className=a+' '+C.ICON_PREFIX+'checkmark';s.innerHTML='<div id="'+p.name+'" class="'+a+'">'+'<div class="'+t+'"></div>'+'<div class="'+d+'">'+(p.text===undefined?'':p.text)+'</div>'+'<div class="'+u+'"></div>'+'</div>';this._menuItemNode=s.firstChild;this._iconNode=this._menuItemNode.firstChild;this._textNode=this._iconNode.nextSibling;this._arrowNode=this._menuItemNode.lastChild;this._arrowNode.style.visibility='hidden';this.name=p.name;this.menu=q;if(p.icon){this.setIcon(p.icon);}if(p.tooltip){this.setTooltip(p.tooltip);}if(p.disabled){this.setDisablaed(p.disabled);}if($.isArray(p.submenu)&&p.submenu.length){this.setSubmenu(new r(p.submenu,q));}if(!p.disabled){this.onExecute=p.click;this._setupEvents();}}M.prototype._setupEvents=function(){var s=this;var p=$(this.dom);function q(){s.showSubmenu();}function r(){if(!s._submenu){s._onExecute();}}p.on('mouseenter',q).on('click',r);s._cleanupEvents=function(){p.off('mouseenter',q).off('click',r);};};M.prototype.setDisablaed=function(p){$(this.dom).toggleClass(k,!!p);};M.prototype.destroy=function(){if(this._submenu){this._submenu.destroy();}if(this._cleanupEvents){this._cleanupEvents();}$(this.dom).remove();};M.prototype.text=function(){return this._textNode.innerHTML;};M.prototype.setText=function(t){this._textNode.innerHTML=t;};M.prototype.setIcon=function(p){this._iconNode.innerHTML='<img src="'+p+'" />';};M.prototype.setTooltip=function(t){_(this.dom,t,this.menu.container());};M.prototype.submenu=function(){return this._submenu;};M.prototype.setSubmenu=function(p){this._submenu=p;this._arrowNode.style.visibility=p?'':'hidden';};M.prototype.showSubmenu=function(){this.menu.hideSubmenus();if(this._submenu){$(this.dom).addClass(i);this._submenu.show({dock:this.dom},this.menu._hDir+'-down');}};M.prototype.hideSubmenu=function(){if(this._submenu){$(this.dom).removeClass(i);this._submenu.hideSubmenus();this._submenu.hide();}};M.prototype._onExecute=function(){if(this.onExecute){this.onExecute();}this.menu.hideAll();};var T={top:15,left:20};var l=C.CONTEXTMENU_PREFIX+"MnuItmTooltip";function _(p,t,q){var s;var r=$(p);var u=$(q);r.on('mouseover',function(v){var w=$(document.createElement('div')).addClass(l).appendTo($("body"));w.text(t);o(u,w,n(u,m(r)),T);s=setTimeout(function(){$("."+l).animate({opacity:1},500);},1000);});r.on("mouseout mousedown",function(){$("."+l).remove();clearTimeout(s);});}function m(p){var q=p.offset(),w=p.innerWidth(),r=p.innerHeight();return{pageX:q.left+w/2,pageY:q.top+r/2};}function n(p,q){return{pageX:q.pageX-p.offset().left,pageY:q.pageY-p.offset().top};}function o(p,q,r,s){if(!s){s={top:0,left:0};}if(r){var t=p.innerWidth();var u=q.outerWidth();var v=r.pageX+s.left;if(t<u+v){v=r.pageX-u-s.left;}var w=r.pageY+s.top;var x=p.innerHeight();var y=q.outerHeight();if(x<y+w){w=r.pageY-y-s.top;}q.css({position:"fixed",left:p.offset().left+v+"px",top:p.offset().top+w+"px"});}}return M;});define('sap/viz/controls/contextmenu/views/CheckedMenuItem',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/contextmenu/views/MenuItem'],function($,O,C,M){var c=C.CONTEXTMENU_PREFIX+"MnuItm-Show";var a=C.CONTEXTMENU_PREFIX+"MnuItm-Hide";var b=C.CONTEXTMENU_PREFIX+"MnuItmIco-Show";var d=C.CONTEXTMENU_PREFIX+"MnuItmIco-Hide";function e(f){e.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.views.CheckedMenuItem";this._iconNode.style.display='none';this.setChecked(f.checked);}O.extend(e,M);e.prototype.setChecked=function(f){$(this.dom).toggleClass(b,!!f).toggleClass(d,!f);$(this._menuItemNode).toggleClass(c,!!f).toggleClass(a,!f);};e.prototype.checked=function(){return $(this.dom).hasClass(b);};e.prototype._onExecute=function(){this.setChecked(!this.checked());e.superclass._onExecute.apply(this,arguments);};return e;});define('sap/viz/controls/contextmenu/views/BlankMenuItem',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/contextmenu/views/MenuItem'],function($,O,C,L,M){var c=C.CONTEXTMENU_PREFIX+"blank-MnuItem";var a=C.CONTEXTMENU_PREFIX+'blank-MnuItmTxt';function B(){B.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.views.BlankMenuItem";$(this.dom).addClass(c);$(this._textNode).addClass(a).text(L.get('VIZ_CONTEXTMENU_NO_MENU_ITEMS'));}O.extend(B,M);return B;});define('sap/viz/controls/contextmenu/views/MenuSeparator',['sap/viz/controls/common/constants/CSSConst'],function(C){function M(){this.__className="sap.viz.controls.contextmenu.views.MenuSeparator";var d=this.dom=document.createElement('div');d.className=C.CONTEXTMENU_PREFIX+"MnuItem-separator";}return M;});define('sap/viz/controls/contextmenu/views/Menu',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/contextmenu/views/MenuItem','sap/viz/controls/contextmenu/views/CheckedMenuItem','sap/viz/controls/contextmenu/views/BlankMenuItem','sap/viz/controls/contextmenu/views/MenuSeparator'],function($,C,M,a,B,b){var c=C.PREFIX+'contextmenu';var d=C.CONTEXTMENU_PREFIX+'list';var e=C.CONTEXTMENU_PREFIX+'list-hovered';var f=document;var w=window;function g(i,p,h){this.__className="sap.viz.controls.contextmenu.views.Menu";var j=this.dom=f.createElement('div');j.className=c;j.innerHTML='<ul class="'+d+'"></ul>';this._listNode=j.firstChild;this._items=[];this._parentMenu=p;this.setContainer(h);this._opennedSubmenuCount=0;this._shown=0;this._setupEvents();this.create(i);}g.prototype.marginOffset=6;g.prototype._setupEvents=function(){var s=this;function n(i,j){var r=false;for(var m=i;m&&!r;m=m._parentMenu){r=$.contains(m.dom,j);}return r;}function o(i){if(s._shown&&s._opennedSubmenuCount===0&&!n(s,i.target)){s.hideAll();}}function h(){s.hide();}$(f).on('mousedown',o);$(w).on('blur',h);this._cleanupEvents=function(){$(f).off('mousedown',o);$(w).off('blur',h);};};g.prototype._createMenuItem=function(h){h=h||{};var m={checked:a,blank:B,separator:b}[h.menuItemType]||M;return new m(h,this,g);};g.prototype.create=function(h){h=$.isArray(h)?h:[];this._destroyChildren();$(this._listNode).toggleClass(e,!!h.length);if(!h.length){h.push({menuItemType:'blank'});}for(var i=0;i<h.length;++i){var j=this._createMenuItem(h[i]);if(j){this.addChild(j);}}};g.prototype._destroyChildren=function(){for(var i=0;i<this._items.length;++i){var h=this._items[i];if(h.destroy){h.destroy();}}this._listNode.innerHTML='';this._items=[];};g.prototype.destroy=function(){this._destroyChildren();this._cleanupEvents();$(this.dom).remove();};g.prototype.setContainer=function(h){this._container=h||(this._parentMenu&&this._parentMenu.container())||f.body;};g.prototype.container=function(){return this._container;};g.prototype.isShown=function(){return!!this._shown;};g.prototype._calcPopupPosition=function(p,h){var i=this.dom;var j=this._container;var l=0;var t=0;var k;if(p){l=p.left||0;t=p.top||0;k=p.dock;}h=String(h).toLowerCase().split('-');var m=h[0];var v=h[1];this._hDir='right';this._vDir='down';if(j){var n=j.clientHeight;var o=j.clientWidth;var q=i.offsetWidth;var r=i.offsetHeight;var s=$(j).offset();var u=s.left;var x=s.top;if(k){var y=$(k).offset();var z=y.left;var A=y.top;var D=k.offsetWidth;var E=k.offsetHeight;var F=this.marginOffset;if((m==='left'&&u<=z-q)||(m!=='left'&&u+o<z+D+q)){l=z-q;this._hDir='left';}else{l=z+D;}if((v==='up'&&x<=A+E-r)||(v!=='up'&&x+n<A+r)){t=A+E-r+F;this._vDir='up';}else{t=A-F;}}else{if((m==='left'&&l>=q)||(m!=='left'&&o<l+q)){l-=q;this._hDir='left';}if((v==='up'&&t>=r)||(v!=='up'&&n<t+r)){t-=r;this._vDir='up';}l+=u;t+=x;}l-=f.body.scrollLeft;t-=f.body.scrollTop;}return{left:l,top:t};};g.prototype.show=function(p,h){if(!this._shown){if(this._parentMenu){this._parentMenu._opennedSubmenuCount++;}this._shown=1;f.body.appendChild(this.dom);var i=this.dom.style;i.display='block';var j=this._calcPopupPosition(p,h);i.left=j.left+'px';i.top=j.top+'px';}};g.prototype.hide=function(){if(this._shown){if(this._parentMenu){this._parentMenu._opennedSubmenuCount--;}this._shown=0;var h=this.dom;h.style.display='none';if(h.parentNode){h.parentNode.removeChild(this.dom);}}};g.prototype.hideAll=function(){if(this._parentMenu){this._parentMenu.hideAll();}else{this.hideSubmenus();this.hide();}};g.prototype.children=function(){return this._items;};g.prototype.addChild=function(m){var i=this._items.indexOf(m);if(i<0){this._items.push(m);this._listNode.appendChild(m.dom);}};g.prototype.removeChild=function(m){var i=this._items.indexOf(m);if(i>=0){this._items.splice(i,1);this._listNode.removeChild(m.dom);}};g.prototype.hideSubmenus=function(){this._items.forEach(function(i){if(i.hideSubmenu){i.hideSubmenu();}});};return g;});define('sap/viz/controls/contextmenu/constants/MenuItemConst',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/managers/LangManager'],function(C,L){var M={};M.getText=function(t){return L.get(t);};M.DEFAULT={"icon":"/contextmenu/uncheck.png"};M.LEGEND=(function(){var s={};s[C.TYPE_BAR]=true;s[C.TYPE_COLUMN]=true;s[C.TYPE_STACKED_BAR]=true;s[C.TYPE_STACKED_COLUMN]=true;s[C.TYPE_DUAL_BAR]=true;s[C.TYPE_DUAL_COLUMN]=true;s[C.TYPE_3D_COLUMN]=true;s[C.TYPE_100_MEKKO]=true;s[C.TYPE_LINE]=true;s[C.TYPE_AREA]=true;s[C.TYPE_COMBINATION]=true;s[C.TYPE_DUAL_LINE]=true;s[C.TYPE_DUAL_COMBINATION]=true;s[C.TYPE_PIE]=true;s[C.TYPE_DONUT]=true;s[C.TYPE_PIE_WITH_DEPTH]=true;s[C.TYPE_GEO_BUBBLE]=true;s[C.TYPE_GEO_CHOROPLETH]=true;s[C.TYPE_GEO_PIE]=true;s[C.TYPE_GEO_MAP]=true;s[C.TYPE_SCATTER]=true;s[C.TYPE_BUBBLE]=true;s[C.TYPE_SCATTER_MATRIX]=true;s[C.TYPE_HEATMAP]=true;s[C.TYPE_TREEMAP]=true;s[C.TYPE_RADAR]=true;s[C.TYPE_BOXPLOT]=true;s[C.TYPE_TAG_CLOUD]=true;s[C.TYPE_FUNNEL]=true;s[C.TYPE_PC]=true;return{"name":"sap.viz.controls.contextmenu.item.legend","text":"VIZ_CONTEXTMENU_SHOW_LEGEND","supportType":s};})();M.DATALABELS=(function(){var s={};s[C.TYPE_BAR]=true;s[C.TYPE_COLUMN]=true;s[C.TYPE_STACKED_BAR]=true;s[C.TYPE_STACKED_COLUMN]=true;s[C.TYPE_DUAL_BAR]=true;s[C.TYPE_DUAL_COLUMN]=true;s[C.TYPE_100_MEKKO]=true;s[C.TYPE_LINE]=true;s[C.TYPE_AREA]=true;s[C.TYPE_COMBINATION]=true;s[C.TYPE_DUAL_LINE]=true;s[C.TYPE_DUAL_COMBINATION]=true;s[C.TYPE_PIE]=true;s[C.TYPE_DONUT]=true;s[C.TYPE_GEO_BUBBLE]=true;s[C.TYPE_GEO_CHOROPLETH]=true;s[C.TYPE_GEO_PIE]=true;s[C.TYPE_SCATTER]=true;s[C.TYPE_BUBBLE]=true;s[C.TYPE_SCATTER_MATRIX]=true;s[C.TYPE_HEATMAP]=true;s[C.TYPE_TREEMAP]=true;s[C.TYPE_RADAR]=true;s[C.TYPE_GEO_MAP]=true;s[C.TYPE_WATERFALL]=true;return{"name":"sap.viz.controls.contextmenu.item.datalabels","text":"VIZ_CONTEXTMENU_SHOW_DATALABELS","supportType":s};})();M.DIRECTION=(function(){var s={};s[C.TYPE_3D_COLUMN]=true;s[C.TYPE_100_MEKKO]=true;s[C.TYPE_LINE]=true;s[C.TYPE_AREA]=true;s[C.TYPE_COMBINATION]=true;s[C.TYPE_DUAL_LINE]=true;s[C.TYPE_DUAL_COMBINATION]=true;s[C.TYPE_BOXPLOT]=true;s[C.TYPE_WATERFALL]=true;return{"name":"sap.viz.controls.contextmenu.item.direction","text":{"horizontal":"VIZ_CONTEXTMENU_VERTICAL","vertical":"VIZ_CONTEXTMENU_HORIZONTAL"},"supportType":s};})();M.STACKING=(function(){var s={};s[C.TYPE_STACKED_BAR]=true;s[C.TYPE_STACKED_COLUMN]=true;s[C.TYPE_100_MEKKO]=true;s[C.TYPE_AREA]=true;return{"name":"sap.viz.controls.contextmenu.item.stacking","text":{"full":"VIZ_CONTEXTMENU_NORMAL_STACKING","normal":"VIZ_CONTEXTMENU_FULL_STACKING"},"supportType":s};})();M.COMMENT=(function(){var s={};s[C.TYPE_BAR]=true;s[C.TYPE_COLUMN]=true;s[C.TYPE_STACKED_BAR]=true;s[C.TYPE_STACKED_COLUMN]=true;s[C.TYPE_DUAL_BAR]=true;s[C.TYPE_DUAL_COLUMN]=true;s[C.TYPE_100_MEKKO]=true;s[C.TYPE_LINE]=true;s[C.TYPE_AREA]=true;s[C.TYPE_COMBINATION]=true;s[C.TYPE_DUAL_LINE]=true;s[C.TYPE_DUAL_COMBINATION]=true;s[C.TYPE_PIE]=true;s[C.TYPE_DONUT]=true;s[C.TYPE_GEO_BUBBLE]=true;s[C.TYPE_GEO_CHOROPLETH]=true;s[C.TYPE_GEO_PIE]=true;s[C.TYPE_SCATTER]=true;s[C.TYPE_BUBBLE]=true;s[C.TYPE_SCATTER_MATRIX]=true;s[C.TYPE_HEATMAP]=true;s[C.TYPE_TREEMAP]=true;s[C.TYPE_RADAR]=true;s[C.TYPE_BOXPLOT]=true;return{"name":"sap.viz.controls.contextmenu.item.comment","text":"VIZ_CONTEXTMENU_INSERT_COMMENT","supportType":s};})();M.CHARTEDITOR=(function(){var s={};s[C.TYPE_BAR]=true;s[C.TYPE_COLUMN]=true;s[C.TYPE_STACKED_BAR]=true;s[C.TYPE_STACKED_COLUMN]=true;s[C.TYPE_DUAL_BAR]=true;s[C.TYPE_DUAL_COLUMN]=true;s[C.TYPE_3D_COLUMN]=true;s[C.TYPE_100_MEKKO]=true;s[C.TYPE_LINE]=true;s[C.TYPE_AREA]=true;s[C.TYPE_COMBINATION]=true;s[C.TYPE_DUAL_LINE]=true;s[C.TYPE_DUAL_COMBINATION]=true;s[C.TYPE_PIE]=true;s[C.TYPE_DONUT]=true;s[C.TYPE_PIE_WITH_DEPTH]=true;s[C.TYPE_GEO_BUBBLE]=true;s[C.TYPE_GEO_CHOROPLETH]=true;s[C.TYPE_GEO_PIE]=true;s[C.TYPE_SCATTER]=true;s[C.TYPE_BUBBLE]=true;s[C.TYPE_SCATTER_MATRIX]=true;s[C.TYPE_HEATMAP]=true;s[C.TYPE_TREEMAP]=true;s[C.TYPE_RADAR]=true;s[C.TYPE_BOXPLOT]=true;s[C.TYPE_TAG_CLOUD]=true;s[C.TYPE_TREE]=true;s[C.TYPE_NETWORK]=true;s[C.TYPE_FUNNEL]=true;s[C.TYPE_PC]=true;return{"name":"sap.viz.controls.contextmenu.item.charteditor","text":"VIZ_CONTEXTMENU_MENU_CHART_EDITOR","supportType":s};})();M.MBCLEGEND=(function(){var s={};s[C.TYPE_GEO_CHOROPLETH]=true;s[C.TYPE_HEATMAP]=true;s[C.TYPE_TREEMAP]=true;s[C.TYPE_TAG_CLOUD]=true;return{"name":"sap.viz.controls.contextmenu.item.mbclegend","text":"VIZ_CONTEXTMENU_CHANGE_MBCLEGEND_COLOR","supportType":s};})();M.MND=(function(){var s={};s[C.TYPE_BAR]=true;s[C.TYPE_COLUMN]=true;s[C.TYPE_STACKED_BAR]=true;s[C.TYPE_STACKED_COLUMN]=true;s[C.TYPE_DUAL_BAR]=true;s[C.TYPE_DUAL_COLUMN]=true;s[C.TYPE_3D_COLUMN]=true;s[C.TYPE_100_MEKKO]=true;s[C.TYPE_LINE]=true;s[C.TYPE_AREA]=true;s[C.TYPE_COMBINATION]=true;s[C.TYPE_DUAL_LINE]=true;s[C.TYPE_DUAL_COMBINATION]=true;s[C.TYPE_PIE]=true;s[C.TYPE_DONUT]=true;s[C.TYPE_PIE_WITH_DEPTH]=true;s[C.TYPE_GEO_BUBBLE]=true;s[C.TYPE_GEO_CHOROPLETH]=true;s[C.TYPE_GEO_PIE]=true;s[C.TYPE_SCATTER]=true;s[C.TYPE_BUBBLE]=true;s[C.TYPE_SCATTER_MATRIX]=true;s[C.TYPE_HEATMAP]=true;s[C.TYPE_TREEMAP]=true;s[C.TYPE_RADAR]=true;s[C.TYPE_BOXPLOT]=true;s[C.TYPE_TAG_CLOUD]=true;s[C.TYPE_TREE]=true;s[C.TYPE_NETWORK]=true;s[C.TYPE_FUNNEL]=true;s[C.TYPE_PC]=true;return{"name":"sap.viz.controls.contextmenu.item.mnd","text":"VIZ_CONTEXTMENU_SHOW_MND","tooltip":"VIZ_CONTEXTMENU_SHOW_MND_TOOLTIP","supportType":s};})();M.TITLE={"name":"sap.viz.controls.contextmenu.item.title","text":"VIZ_CONTEXTMENU_SHOW_TITLE","notSupportType":{"viz/geomap":true}};M.SETAXISSCALE=(function(){var s={};s[C.TYPE_BAR]=true;s[C.TYPE_COLUMN]=true;s[C.TYPE_STACKED_BAR]=true;s[C.TYPE_STACKED_COLUMN]=true;s[C.TYPE_DUAL_BAR]=true;s[C.TYPE_DUAL_COLUMN]=true;s[C.TYPE_LINE]=true;s[C.TYPE_AREA]=true;s[C.TYPE_COMBINATION]=true;s[C.TYPE_DUAL_LINE]=true;s[C.TYPE_DUAL_COMBINATION]=true;s[C.TYPE_100_MEKKO]=true;s[C.TYPE_SCATTER]=true;s[C.TYPE_BUBBLE]=true;s[C.TYPE_BOXPLOT]=true;s[C.TYPE_WATERFALL]=true;return{"name":"sap.viz.controls.contextmenu.item.setAxisScale","text":"VIZ_CONTEXTMENU_SET_AXIS_SCALE","supportType":s};})();M.GRIDLINES=(function(){var s={};s[C.TYPE_BAR]=true;s[C.TYPE_COLUMN]=true;s[C.TYPE_STACKED_BAR]=true;s[C.TYPE_STACKED_COLUMN]=true;s[C.TYPE_DUAL_BAR]=true;s[C.TYPE_DUAL_COLUMN]=true;s[C.TYPE_100_MEKKO]=true;s[C.TYPE_LINE]=true;s[C.TYPE_AREA]=true;s[C.TYPE_SCATTER_MATRIX]=true;s[C.TYPE_COMBINATION]=true;s[C.TYPE_DUAL_LINE]=true;s[C.TYPE_SCATTER]=true;s[C.TYPE_BUBBLE]=true;s[C.TYPE_DUAL_COMBINATION]=true;return{"name":"sap.viz.controls.contextmenu.item.gridlines","text":"VIZ_CONTEXTMENU_SHOW_GRIDLINES","supportType":s};})();M.NEGATIVE=(function(){var s={};s[C.TYPE_GEO_BUBBLE]=true;s[C.TYPE_BUBBLE]=true;return{"name":"sap.viz.controls.contextmenu.item.negative","text":"VIZ_CONTEXTMENU_SHOW_NEGATIVE_VALUES","supportType":s};})();return M;});define('sap/viz/controls/contextmenu/MenuModelGenerator',['jquery','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/property/VizPropertyZone','sap/viz/controls/common/metadata/MetadataFactory','sap/viz/controls/contextmenu/constants/MenuItemConst'],function($,C,U,V,D,F,a,b,L,c,M,d){var g=(function(e){var f,i={};for(f in e){if(e[f]["name"]){i[e[f]["name"]]=e[f];}}return i;})(d);function h(i,v){var e=g[i];if(!e){return true;}if(e.supportType){return!!e.supportType[v];}if(e.notSupportType){return!e.notSupportType[v];}return true;}var j={"separator":function(i,e,f,v,p){return{type:"separator"};},"sap.viz.controls.contextmenu.item.direction":function(i,e,f,v,p){var k=b.getDirection(e().type());return{id:i,label:L.get(g[i].text[k])};},"sap.viz.controls.contextmenu.item.stacking":function(i,e,f,v,p){var s=b.getStacking(e().type());return{id:i,label:L.get(g[i].text[s])};},"sap.viz.controls.contextmenu.item.title":function(i,e,f,v,p){var k=function(v){var o=f().getProperties();o=o||{};o.title=o.title||{visible:true};var q=o.title.visible;return q;};return{id:i,label:L.get(g[i].text),checked:k(v)};},"sap.viz.controls.contextmenu.item.legend":function(i,e,f,v,p){var k=function(v){var o=f().getProperties();o=o||{};o.legend=o.legend||{visible:true};var q=o.legend.visible;if(v.search('geo')>-1){var s=o.sizeLegend;q=q&&(s?s.visible:true);}return q;};return{id:i,label:L.get(g[i].text),checked:k(v)};},"sap.viz.controls.contextmenu.item.mbclegend":function(e,f,k,v,p){var o=function(v){if(k().isFakeChart()){return false;}var r=f().feedingItems();for(var i=0;i<r.length;i++){var s=r[i];if(v===C.TYPE_TAG_CLOUD&&s.id()==="tagFamily"&&s.values().length===0){return false;}if(v===C.TYPE_TREEMAP&&s.id()==="rectangleColor"&&s.values().length===0){return false;}}return true;};if(!o(v)){return;}var q=function(v){var i=k().getProperties();i=i||{};i.legend=i.legend||{visible:true};var r=i.legend.visible;if(v.search('geo')>-1){var s=i.sizeLegend;r=r&&(s?s.visible:true);}return r;};return{id:e,label:L.get(g[e].text)};},"sap.viz.controls.contextmenu.item.datalabels":function(i,e,f,v,p){var k=function(v){var o=f();var q=o.getProperties();q=q||{};if(b.isInfoChart(v)&&q.plotArea){q.dataLabel=q.plotArea.dataLabel;}q.dataLabel=q.dataLabel||{visible:false};var k;if(b.hasCustomerRendererFor("plotArea.dataLabel.renderer",v)){var r=o.getPropertyZones();var z=new c(c.DATA_LABEL);o.setPropertyZones([z]);var s=o.getPropertyZones();if(s&&s[0]){var t=o.queryProperties({'propertyZones':s,'propertyFields':{'textVisible':true},'chartType':v});if(t.textVisible===null||t.textVisible===true){k=true;}else if(t.textVisible!==undefined){k=false;}}o.setPropertyZones(r);}if(k===undefined){k=b.isDataLabelValueVisible(v,q.dataLabel.visible,q.dataLabel.type);}return k;};return{id:i,label:L.get(g[i].text),checked:k(v)};},"sap.viz.controls.contextmenu.item.mnd":function(e,f,o,v,p){var q=function(v){var s=false;var r;var k=-1;var t=M.get(v),u;if(t){u=t.getBindingDefs();for(k=0;k<u.length;k++){if(u[k].mndMode()!=='none'){s=true;break;}}}if(!s&&!b.isMultipleChart(v)&&b.supportMultiChart(v)){var w=b.toMultiChartType(v);t=M.get(w);u=t.getBindingDefs();for(k=0;k<u.length;k++){if(u[k].mndMode()!=='none'){s=true;break;}}}if(!s){return false;}var x=f().feedingItems();for(var i=0;i<x.length;i++){var y=x[i];if(y.type()===F.MEASURE&&y.values().length>0){return true;}}return false;};if(!q(v)){return;}return{id:e,label:L.get(g[e].text),tooltip:L.get(g[e].tooltip),checked:f().isMNDVisible()};},"sap.viz.controls.contextmenu.item.setAxisScale":function(i,e,f,v,p){if(b.isFullStacking(e().type())){return;}if(p==="valueAxis2"&&b.isMekkoChart(e().type())){return;}var k=function(v){if(b.isMultipleChart(v)){return false;}return true;};if(!k(e().type())){return;}return{id:i,label:L.get(g[i].text)};},"sap.viz.controls.contextmenu.item.negative":function(i,e,f,v,p){var k=function(v){var o=f().getProperties();o=o||{};o.plotArea=o.plotArea||{showNagativeValues:false};var q=o.plotArea.showNegativeValues;return q;};if(!D.hasNegativeMeasureValue(e().type(),e().feedingItems(),f().getDataset())){return;}return{id:i,label:L.get(g[i].text),checked:k(v)};},"sap.viz.controls.contextmenu.item.gridlines":function(i,e,f,v,p){if(b.isMultipleChart(e().type())){return;}var k=function(v){var o=f().getProperties();o=o||{};var q=e().type();var r;if(b.isVizChart(q)){if(b.isHorizontal(q)){r='xAxis.gridline.visible';}else{r='yAxis.gridline.visible';}}else{r='plotArea.gridline.visible';}return!!l(o,r);};return{id:i,label:L.get(g[i].text),checked:k(v)};}};function l(o,p){var e=p.split('.'),i,f,k=o;for(i=0,f=e.length;i<f;i++){k=k[e[i]];if(k===undefined){return undefined;}}return k;}function m(i,k,o,p,v,q){var r=i.reduce(function(f,e){if(U.isArray(e)){Array.prototype.push.apply(f,e);f.push({type:"separator"});}else{if(!(U.isBoolean(e.visible)&&e.visible===false)){f.push(e);}}return f;},[]).map(function(e){var f;if(e&&e.id&&e.id.charAt(7)===":"&&e.id.substring(0,7)==="builtIn"){e.id=e.id.substring(8);f=k.generate([e.id],o,p,v,q)[0];if(f){$.extend(true,f,e);}return f;}else{return e;}}).reduce(function(f,e){if(!e){return f;}if(e.type==="separator"&&f[f.length-1]&&f[f.length-1].type==="separator"){return f;}f.push(e);if(e.subMenus){e.subMenus=m(e.subMenus);}return f;},[]);if(r[0]&&r[0].type==="separator"){r.shift();}if(r[r.length-1]&&r[r.length-1].type==="separator"){r.pop();}return r;}function n(){this.__className="sap.viz.controls.contextmenu.MenuModelGenerator";this._index={};}n.isSupport=h;n.prototype.merge=function(e,f,i,v,p){return m(e,this,f,i,v,p);};n.prototype.generate=function(f,i,k,v,p){var o=this,q;q=f.filter(function(e){if(e==="separator"){return true;}return h(e,v);}).map(function(e){var r=(o._index[e]||j[e]);if(!U.isFunction(r)){return r;}return r?r(e,i,k,v,p):null;}).filter(function(e){return!!e;});if(q[0]&&q[0].type==="separator"){q.shift();}if(q[q.length-1]&&q[q.length-1].type==="separator"){q.pop();}return q;};n.prototype.put=function(i,e){this._index[i]=e;};return n;});define('sap/viz/controls/contextmenu/DefaultMenuItemHandlers',['sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/utils/VizUtils','sap/viz/controls/common/utils/DatasetUtil','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/property/VizPropertyZone'],function(C,V,D,F,a,b,c){var d={"sap.viz.controls.contextmenu.item.title":function(f,h,v,p){var i=h.getProperties();var j=false;var m=0;if(i&&i.title){j=!i.title.visible;}var n={};n.title={};n.title.visible=j;h.setProperties(n,{trigger:"CONTEXT_MENU"});},"sap.viz.controls.contextmenu.item.datalabels":function(f,h,v,p,m){var i;var j=h.getProperties();if(m&&m.hasOwnProperty('checked')){i=!m.checked;}else{if(b.isInfoChart(v)){i=!j.plotArea.dataLabel.visible;}else{i=!j.dataLabel.visible;}}var n;if(b.isInfoChart(v)){n=b.updateDataLabelType(v,j.plotArea.dataLabel.type,i);}if(!b.hasCustomerRendererFor("plotArea.dataLabel.renderer",v)){var k={};if(b.isInfoChart(v)){k.plotArea={};k.plotArea.dataLabel={};k.plotArea.dataLabel.visible=i;k.plotArea.dataLabel.type=n;}else{k.dataLabel={};k.dataLabel.visible=i;}h.setProperties(k,{trigger:"CONTEXT_MENU"});}else{var l=h.getPropertyZones();var z=new c(c.DATA_LABEL);h.setPropertyZones([z]);var o=h.getPropertyZones();if(o&&o[0]){var q={};q['textVisible']=i;var r=h.queryProperties({'propertyZones':o,'propertyFields':{'iconVisible':true},'chartType':v});if(n==="value"&&r&&(r.iconVisible===false||r.iconVisible===undefined)){q['dataLabelVisible']=i;}else if(i){q['dataLabelVisible']=i;if(n==="color"||n==="valueAndColor"){q['legendVisible']=i;}}q['type']=n;h.updateProperties({'propertyZones':o,'properties':q,'chartType':v},{trigger:"CONTEXT_MENU"});}else{var s={plotArea:{dataLabel:{}}};s.plotArea.dataLabel.visible=i;s.plotArea.dataLabel.type=n;h.setProperties(s,{trigger:"CONTEXT_MENU"});}h.setPropertyZones(l);}},"sap.viz.controls.contextmenu.item.direction":function(f,h,v,p){var i=f.type();var j=b.getDirection(i);if(j==C.DIRECTION_VERTICAL){j=C.DIRECTION_HORIZONTAL;}else{j=C.DIRECTION_VERTICAL;}var n=b.changeDirection(i,j);f.type(n);},"sap.viz.controls.contextmenu.item.legend":function(f,h,v,p){var i=h.getProperties();var j=false;if(i&&i.legend){j=!i.legend.visible;}else if(i&&i.sizeLegend){j=!i.sizeLegend.visible;}else if(i&&i.geomap){var l=i.geomap.layers;j=!l[0].options.legendVisible;}var n={};n.legend={};n.legend.visible=j;if(f.type().search('geo')>-1||f.type().search('bubble')>-1){n.sizeLegend={};n.sizeLegend.visible=j;}h.setProperties(n,{trigger:"CONTEXT_MENU"});},"sap.viz.controls.contextmenu.item.mbclegend":function(f,h,v,p){},"sap.viz.controls.contextmenu.item.mnd":function(f,h,v,p){var i=f.isMNDVisible();f.isMNDVisible(!i);},"sap.viz.controls.contextmenu.item.setAxisScale":function(f,h,v,p){var i=h.getProperties();if(b.isInfoChart(v)){if(["valueAxis","valueAxis2"].indexOf(p)===-1){p=null;}}else{var j=V.getValueAxis(v);if(!j||j.indexOf(p)===-1){p=null;}}h.setAxisScale(p);},"sap.viz.controls.contextmenu.item.negative":function(f,h,v,p){var i=h.getProperties();i=i||{};i.plotArea=i.plotArea||{};var s=!i.plotArea.showNegativeValues;var n={};n.plotArea={};n.plotArea.showNegativeValues=s;h.setProperties(n);},"sap.viz.controls.contextmenu.item.gridlines":function(f,h,v,p){var i=h.getProperties();i=i||{};var j=f.type();var k,l;var m={};if(b.isVizChart(j)){if(b.isHorizontal(j)){i.xAxis=i.xAxis||{};k=['xAxis.gridline.visible'];}else if(j==='viz/scatter_matrix'){i.xAxis=i.xAxis||{};i.yAxis=i.yAxis||{};k=['xAxis.gridline.visible','yAxis.gridline.visible'];}else{i.xAxis=i.yAxis||{};k=['yAxis.gridline.visible'];}}else{i.plotArea=i.plotArea||{};k=['plotArea.gridline.visible'];}m=g(i,k);h.setProperties(m,{trigger:"CONTEXT_MENU"});},"sap.viz.controls.contextmenu.item.stacking":function(f,h,v,p){var i=f.type();var s=b.getStacking(i);if(s==C.STACKING_NORMAL){s=C.STACKING_FULL;}else{s=C.STACKING_NORMAL;}var n=b.changeStacking(i,s);f.type(n);}};function g(r,v){var p={};for(var j=0;j<v.length;j++){var f=p;var n=r;var h=v[j].split('.');for(var i=0;i<h.length-1;i++){n=n[h[i]];f[h[i]]={};f=f[h[i]];}f[h[h.length-1]]=!n[h[h.length-1]];}return p;}function e(i){return d[i];}return{get:e};});define('sap/viz/controls/contextmenu/ContextMenu',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/contextmenu/ContextMenuConfig','sap/viz/controls/contextmenu/ContextMenuEvent','sap/viz/controls/contextmenu/views/Menu','sap/viz/controls/contextmenu/MenuModelGenerator','sap/viz/controls/contextmenu/DefaultMenuItemHandlers'],function($,O,U,F,V,G,C,a,c,M,d,D){var f=function(b,u){f.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.ContextMenu";this._div$=$(b);this._uiConfig=u?u:a.instance();this._uiConfig.contextMenuAssetFolderPath=G.defaultAssetsRoot()+'/common/assets';this._vizModelProvider=$.proxy(this._vizModel,this);this._vizProxyProvider=$.proxy(this._vizProxy,this);this._menu=new M();this._menuModelGenerator=new d();r(this);};O.extend(f,V);function l(b){if(!b){return b;}if(b.charAt(37)==="."&&b.substring(0,38)==="sap.viz.controls.contextmenu.location."){return b.substring(38);}return b;}function r(b){b.addEventListener("menuItemSelected",function(e){var i=D.get(e.data.menuItem.id);if(i){i(b._vizModelProvider(),b._vizProxyProvider(),e.data.vizType,l(e.data.location),e.data.menuItem);}if(e.data.menuItem.id==="sap.viz.controls.contextmenu.item.mbclegend"){b._dispatchEvent(new c("chooseLegendColors",b));}});}function g(b){var e=Array.prototype.slice.call(arguments,1);return function(){return b.apply(this,e.concat(Array.prototype.slice.call(arguments)));};}function h(b,i){var e=new c("menuItemSelected",b,i);b._dispatchEvent(e);}f.prototype._onVizModelChanged=function(e){};f.prototype.create=function(i,m){var v=C.getVizType(this._vizModel().type()),j=this,k,n;i=i||null;if(m){k=this._menuModelGenerator.merge(m,this._vizModelProvider,this._vizProxyProvider,v,l(i));}if(!k){n=this._uiConfig.menu.reduce(function(e,b){if(e.length>0){e.push("separator");}Array.prototype.push.apply(e,b);return e;},[]);k=this._menuModelGenerator.generate(n,this._vizModelProvider,this._vizProxyProvider,v,l(i));}function t(k){return k.map(function(e){return{name:e.id,text:e.label,tooltip:e.tooltip,icon:e.icon&&e.icon.url,menuItemType:(U.isBoolean(e.checked)?"checked":e.type),checked:e.checked,disabled:(U.isBoolean(e.enabled)?!e.enabled:false),submenu:e.subMenus&&t(e.subMenus),click:g(h,j,{menuItem:e,vizType:v,location:i})};});}this._menu.create(t(k));return this;};f.prototype.show=function(p){this._menu.setContainer(this._div$.parent().get(0));var v=C.getVizType(this._vizModel().type());if(C.isValid(v)){this._menu.show(p&&{left:p.pageX,top:p.pageY});}};f.prototype.hide=function(){this._menu.hide();};f.prototype.save=function(){var b={};return b;};f.prototype.load=function(v){};f.prototype.addMenuItem=function(i,b){this._menuModelGenerator.put(i,b);this._addDefaultMenuItem(i);};f.prototype._addDefaultMenuItem=function(i){var b=this._uiConfig.menu.some(function(j){return j.some(function(e){return i===e;});});if(!b){this._uiConfig.menu.push([i]);}return!b;};f.prototype.getEventNames=function(){var b=[c.MENU_ITEM_SELECTED,c.REQUEST_LEGEND_COLOR];return b;};return f;});define('sap/viz/controls/custombutton/CustomButtonConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var C={};C.instance=function(){return{"visible":true,"title":"Button"};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_CUSTOMBUTTON,C);return C;});define('sap/viz/controls/custombutton/CustomButtonEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var C=function(t,a,d){C.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.custombutton.CustomButtonEvent";};O.extend(C,E);C.CLICK_CUSTOM_BUTTON="clickCustomButton";return C;});define('sap/viz/controls/custombutton/CustomButton',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/custombutton/CustomButtonConfig','sap/viz/controls/custombutton/CustomButtonEvent'],function($,O,U,V,C,a,b){var c=function(d,u){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.custombutton.CustomButton";this._div=d;this._uiConfig=u?u:a.instance();this._button$=null;this._icon$=null;this._createChildren();};O.extend(c,V);c.prototype._createChildren=function(){if(this._uiConfig.visible!==false){this._button$=$(document.createElement("div")).appendTo(this._div);this._button$.addClass(C.CUSTOMBUTTON_PREFIX+"button");this._icon$=$(document.createElement("div")).appendTo(this._button$);if(this._uiConfig.title){this.setTitle(this._uiConfig.title);}var _=this;this._button$.click(function(e){var d=_._button$.offset();_._dispatchEvent(new b(b.CLICK_CUSTOM_BUTTON,_,d));});}};c.prototype.setIcon=function(i){if(arguments.length>0){this._icon$.removeAttr('class');this._icon$.addClass(i);return this;}};c.prototype.setTitle=function(t){if(arguments.length>0){this._icon$.attr("title",t);return this;}};return c;});define('sap/viz/controls/common/VizControlHost',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/EventDispatcher','sap/viz/controls/common/VizControlBase'],function(O,E,V){var a=function a(){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.VizControlHost";this._children=[];};O.extend(a,V);a.prototype._onConnect=function(v){a.superclass._onConnect.apply(this,arguments);for(var i=0;i<this._children.length;i++){this._children[i].connect(v);}};a.prototype._onDisconnect=function(){a.superclass._onDisconnect.apply(this,arguments);for(var i=0;i<this._children.length;i++){this._children[i].disconnect();}};a.prototype._addChild=function(c,f,e){if(!c){return;}this._children.push(c);var _=this;f&&f.forEach(function(n){_[n]=function(){return c[n].apply(c,arguments);};});e&&e.forEach(function(b){c.addEventListener(b,function(d){_._dispatchEvent(d);});});};a.prototype.destroy=function(){var c;while((c=this._children.shift())){try{c.destroy();}catch(e){}}a.superclass.destroy.apply(this,arguments);};return a;});define('sap/viz/controls/filterbar0/FilterBarConfig',['sap/viz/controls/common/config/GlobalConfig'],function(G){var F={};F.instance=function(){return{"module":{"visible":true}};};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_FILTERBAR0,F);return F;});define('sap/viz/controls/frame/VizFrameConfig',['sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/annotation/AnnotationConfig','sap/viz/controls/annotationcontrol/AnnotationControlConfig','sap/viz/controls/chart/ChartConfig','sap/viz/controls/filterbar0/FilterBarConfig','sap/viz/controls/contextmenu/ContextMenuConfig','sap/viz/controls/custombutton/CustomButtonConfig','sap/viz/controls/common/constants/ChartConst'],function(G,A,a,C,F,b,c,d){var V={};V.instance=function(){var r={"enableAnnotation":false,"enableAnnotationControl":false,"enableContextMenu":true,"enableFilterMenu":true,"enableFilterBar":true,"enableTitleEditor":true,"enableSettingButton":true,"enableFullScreenButton":true,"enablePlayControl":true,"enableResponsiveLegend":false,"useCustomizedContextMenu":false,"controls":{"chart":C.instance(),"filterBar":F.instance(),"contextMenu":b.instance(),"annotation":A.instance(),"annotationControl":a.instance(),"settingButton":c.instance(),"fullScreenButton":c.instance()}};return r;};G.registerUIConfig(G.DEFAULT_UICONFIG_TYPE_FRAME,V);return V;});define('sap/viz/controls/frame/VizFrameEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var V=function(t,a,d){V.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.VizFrameEvent";};O.extend(V,E);V.FILTERS_CHANGED="filtersChanged";V.CONTEXT_MENU_CHANGED='contextMenuChanged';V.ENTER_FULL_SCREEN="enterFullScreen";V.EXIT_FULL_SCREEN="exitFullScreen";V.ADD_COMMENT='addComment';V.ADD_FILTER='addFilter';V.REQUEST_LEGEND_COLOR='chooseLegendColors';V.POPUP_CHART_EDITOR='popupChartEditor';V.SLICE_DIMENSION_CHANGED="sliceDimensionChanged";return V;});define('sap/viz/controls/frame/chartEditor/ChartEditorEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);};O.extend(F,E);F.FILTER_CLICKED="filterClicked";F.EXCLUDE_CLICKED="excludeClicked";return F;});define('sap/viz/controls/frame/chartEditor/ChartEditor',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/frame/chartEditor/ChartEditorEvent'],function($,C,L,O,U,a){var b=function(d,c){b.superclass.constructor.apply(this,arguments);this._dom$=$(d);this._createChildren(c);};O.extend(b,U);b.prototype._createChildren=function(c){var _=this;this._dom$.addClass(C.FRAME_PREFIX+'editor');var d=$('<div/>').appendTo(this._dom$);d.addClass(C.FRAME_PREFIX+'editor-main');d.addClass(C.COMMON_PREFIX+'popUp');var e=$('<div/>').appendTo(d).addClass(C.FRAME_PREFIX+'editor-header');var f=$('<h3/>').appendTo(e).text(L.get("VIZ_FRAME_CHART_EDITOR"));var g=$('<div/>').appendTo(d).addClass(C.FRAME_PREFIX+'editor-content');var h=$('<img/>').appendTo(g).addClass(C.FRAME_PREFIX+'editor-content-img');h.attr('src',c+'/chartEditorPH.png');var i=$('<div/>').appendTo(d).addClass(C.FRAME_PREFIX+'editor-footer');var j=$('<button/>').appendTo(i).text(L.get("VIZ_COMMON_OK"));j.addClass(C.FRAME_PREFIX+'editor-footer-button');j.addClass(C.COMMON_PREFIX+'button');var k=$('<button/>').appendTo(i).text(L.get("VIZ_COMMON_CANCEL"));k.addClass(C.FRAME_PREFIX+'editor-footer-button');k.addClass(C.COMMON_PREFIX+'button');var l=$('<div/>').appendTo(d);l.addClass(C.COMMON_PREFIX+'havanaSharedSprite16');l.addClass(C.FRAME_PREFIX+'editor-close');var m=function(){_._dispatchEvent(new a(a.EDIT_CANCELED,this));_._dispatchEvent(new a(a.EDITOR_CLOSED,this));_._dom$.detach();};var n=function(){_._dispatchEvent(new a(a.EDIT_CONFIRMED,this,{}));_._dispatchEvent(new a(a.EDITOR_CLOSED,this));_._dom$.detach();};j.click(n);k.click(m);l.click(m);};return b;});define('sap/viz/controls/frame/chartEditor/ChartEditorPlugin',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/frame/chartEditor/ChartEditor','sap/viz/controls/frame/chartEditor/ChartEditorEvent'],function($,C,a,b){var c=function(d,v,u){this.__className="sap.viz.controls.frame.chartEditor.ChartEditorPlugin";this._vizFrame=v;this._uiConfig=u;this._div=d;this._chartEditor=null;};c.prototype.validateSize=function(w,h){this._locateChartEditor();};c.prototype.destroy=function(){if(this._chartEditor){this._chartEditor.removeAllEventListeners();this._chartEditor.destroy();this._chartEditor=null;}};c.prototype._popUpEditor=function(){var d=$(this._div);var e=this._uiConfig.chartEditorAssetFolderPath?this._uiConfig.chartEditorAssetFolderPath:'../src/controls/frame/assets';d.children().addClass(C.COMMON_PREFIX+'blur');var f=$(document.createElement('div')).appendTo(d);this._chartEditor=new a(f[0],e);this._locateChartEditor();this._chartEditor.addEventListener(b.EDITOR_CLOSED,function(g){d.children().removeClass(C.COMMON_PREFIX+'blur');});};c.prototype._locateChartEditor=function(){if(this._chartEditor){var d=$(this._div);var e=$(this._chartEditor._dom);e.css({'left':(d.width()-e.width())/2,'top':Math.min(120,(d.height()-e.height())/2)});}};return c;});define('sap/viz/controls/common/utils/StyleUtils',[],function(){var S={};S.inLumira=function(){var t;try{t=sap.ui.getCore().getConfiguration().getTheme();}catch(e){}return t==='vi_theme';};return S;});define('sap/viz/controls/common/constants/KeyboardEventConst',[],function(){var K={};K.UP=38;K.DOWN=40;K.ENTER=13;K.SPACE=32;K.ESC=27;K.SUBTRACT=45;K.DECIMAL=46;K.NUM_0=48;K.NUM_9=57;return K;});define('sap/viz/controls/common/views/feed/FeedList',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/StyleUtils','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/constants/KeyboardEventConst'],function($,C,u,O,S,U,F,L,A,a,b,K){var c=function(f,g,h,k){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedList";this._dom$=$(f);this._analyses=g;this._feedingType=h;this._dataProvider=[];var i,j;var l=function(n){for(var i=0;i<k.length;i++){if(k[i].id()===n){return true;}}return false;};if(g){for(i=0;i<g.length;i++){var m=g[i];if(l(m.id())){continue;}if(b.feedCompatible(this._feedingType,m.type(),m.dataType())){this._dataProvider.push({'label':m.name(),'analysis':m});}}}this._header={'label':L.get(c.langProps[this._feedingType]),'suffix':this._dataProvider.length};this._container$=null;this._content$=null;this._header$=null;this._ul$=null;this._arrow$=null;this._createChildren();this._dock=null;this._calDockPosFun=null;this._resizeHandler=null;this._documentHandler=null;this._keyDownHandlerProvider=$.proxy(this._keyDownHandler,this);this._mouseMoveHandlerProvider=$.proxy(this._mouseMoveHandler,this);};O.extend(c,U);c.langProps={'Measure':'VIZ_COMMON_MEASURES','Dimension':'VIZ_COMMON_DIMENSIONS','Geography':'VIZ_COMMON_DIMENSIONS','Subtotal':'VIZ_COMMON_SUBTOTALS'};var d='down';var e='up';c.prototype.locate=function(f,o){var g=this._dom$;var h=this._ul$;var i=h.outerHeight();var j=Math.max($(document.body).height(),$(window).height());var m=j-this._header$.outerHeight()-15;if(i>m){i=m;}h.outerHeight(i);var k=i+this._header$.outerHeight()+5;var l=Math.max(h.outerWidth(),this._header$.outerWidth());var n=this._arrow$.outerWidth();var p='left';if(o==='left'||o==='right'){p=o;}else if(l+n*3/4>f.x){p='right';}var q=8;var r=this._arrow$.outerHeight()+18;var s=Math.max(0,f.y-j+r/2+q);f.y=Math.min(f.y,j-r/2-q);var t=Math.max(f.y-s+r/2+q-k,5);var v=Math.min(f.y-t-12,j-r-q-t-s);var w=2;if(p==='right'){this._container$.addClass(C.COMMON_PREFIX+'feedlist-container-right');g.css({"left":f.x+f.shelfWidth+n*3/4,"top":t});this._arrow$.css({"left":-n/2+w,"top":v});}else if(p==='left'){this._container$.addClass(C.COMMON_PREFIX+'feedlist-container-left');g.css({"left":f.x-l-n*3/4,"top":t});this._arrow$.css({"left":l-n/2-w,"top":v});}this._content$.css({'width':l+'px','height':k+'px'});this._container$.css({'width':l+2+'px','height':k+'px'});};c.prototype.open=function(f){if(typeof(f)==='function'){this._dock=f();this._calDockPosFun=f;}else{this._dock=f;}var g=this._dom$;g.appendTo($("body"));this._dispatchEvent(new F(F.DROP_DOWN_OPENED,this));this.locate(this._dock);this._documentHandler=$.proxy(function(h){if(!$.contains(this._dom,h.target)){this.close();}},this);this._addEventListeners();document.addEventListener("mousedown",this._documentHandler,true);document.addEventListener("keydown",this._keyDownHandlerProvider,true);$(window).on('blur',this._documentHandler);this._cursorShowed=true;};c.prototype.close=function(){var f=this._dom$;var g=1;if(this._classVisible){f.removeClass(this._classVisible);g=2000;}setTimeout(function(){f.detach();},g);document.removeEventListener("mousedown",this._documentHandler,true);document.removeEventListener("keydown",this._keyDownHandlerProvider,true);document.removeEventListener("mousemove",this._mouseMoveHandlerProvider,true);$(window).off('blur',this._documentHandler);$(window).off('resize',this._resizeHandler);this._dispatchEvent(new F(F.DROP_DOWN_CLOSED,this));if(!this._cursorShowed){$('.'+C.COMMON_PREFIX+'hide-cursor').removeClass(C.COMMON_PREFIX+'hide-cursor');}this._calDockPosFun=null;this.destroy();};c.prototype._createChildren=function(f){this._dom$.addClass(C.COMMON_PREFIX+'feedlist');var _=this;var g=this._container$=$(document.createElement('div')).appendTo(this._dom$);g.addClass(C.COMMON_PREFIX+'feedlist-container');var h=this._arrow$=$(document.createElement('div')).appendTo(g);h.addClass(C.COMMON_PREFIX+'feedlist-arrow');h.addClass(C.PREFIX+'feedlist');var j=this._content$=$(document.createElement('div')).appendTo(g);j.addClass(C.COMMON_PREFIX+'feedlist-content');var k=this._header$=$(document.createElement('div')).appendTo(j).text(this._header.label);k.addClass(C.COMMON_PREFIX+'feedlist-content-header');var l=this._ul$=$(document.createElement('ul')).appendTo(j);l.addClass(C.COMMON_PREFIX+'scrollable');l.addClass(C.COMMON_PREFIX+'scrollable-y');var i;var m;for(i=0;i<this._dataProvider.length;i++){var n=$(document.createElement('li')).appendTo(l);var o=$(document.createElement('a')).appendTo(n);m=this._dataProvider[i];var p,q;var r=m.analysis.dataType();var s=b.isGeoHierarchyFeed(this._feedingType,m.analysis.type(),r);if(((this._feedingType===a.DIMENSION||this._feedingType===a.SUBTOTAL)&&m.analysis.type()===A.HIERARCHY)||s){var t=this._setHierarchyAnalysis(m.analysis.clone(),0);n.data('__item',t);p=$(document.createElement('div')).appendTo(n);p.addClass(C.COMMON_PREFIX+'feedlist-li-hierarchy-indicator');q=$(document.createElement('div')).appendTo(p);if(S.inLumira()){if(r&&r.toLowerCase()===a.GEOGRAPHY.toLowerCase()){q.addClass('vxt-geo-icon-16');}else{q.addClass('vxt-hier-lvl-based-icon-16');}}else{if(r&&r.toLowerCase()===a.GEOGRAPHY.toLowerCase()){q.addClass(C.ICON_PREFIX+'geo');}else{q.addClass(C.SAP_ICON_PREFIX+'tree');}}var v=$(document.createElement('div')).appendTo(n);v.data('__items',m.analysis);v.addClass(C.COMMON_PREFIX+'feedlist-li-button');var w=$(document.createElement('div')).appendTo(v);w.addClass(C.ICON_PREFIX+'plus');v.attr('command','open');v.click(function(x){x.stopPropagation();_._expandButtonHandler(x);});n.click($.proxy(this._analysisSelectedHandler,this));}else{if(r&&r.toLowerCase()===a.GEOGRAPHY.toLowerCase()){p=$(document.createElement('div')).appendTo(n);p.addClass(C.COMMON_PREFIX+'feedlist-li-hierarchy-indicator');q=$(document.createElement('div')).appendTo(p);q.addClass(C.ICON_PREFIX+'geo');}n.data('__item',m.analysis);n.click($.proxy(this._analysisSelectedHandler,this));}n.hover($.proxy(function(x){this._highlightItem($(x.currentTarget));},this),$.proxy(function(x){this._unhighlightItem($(x.currentTarget));},this));o.text(m.label);o.addClass(C.COMMON_PREFIX+'text-ellipsis');if(m.suffix){o.addClass(C.COMMON_PREFIX+'feedlist-li-a_suffix').attr('__suffix',m.suffix);}if(m.icon){}}};c.prototype._expandButtonHandler=function(f){var g=$(f.currentTarget);if(g.attr('command')==='open'){this._openHierarchyItem(g);}else{this._closeHierarchyItem(g);}};c.prototype._setHierarchyAnalysis=function(h,i){var f=h.hierarchyLevels();for(var j=0;j<f.length;j++){var l=f[j];if(j===i){l.selected(true);}else{l.selected(false);}}return h;};c.prototype._analysisSelectedHandler=function(f){var _=this;var l=$(f.currentTarget);var i=l.data('__item');_._dispatchEvent(new F(F.ITEM_SELECTED,_,{'selectedItem':i}));_.close();};c.prototype._keyDownHandler=function(f){var k=f.keyCode;if(!f.ctrlKey&&(k===K.DOWN||k===K.UP)){if(this._cursorShowed){$("*").addClass(C.COMMON_PREFIX+'hide-cursor');this._cursorShowed=false;setTimeout($.proxy(function(){document.addEventListener('mousemove',this._mouseMoveHandlerProvider,true);},this),200);}}var l=$('.'+C.COMMON_PREFIX+'feedlist-li-highlight',this._ul$);switch(k){case K.UP:if(f.ctrlKey){var m=$('.'+C.ICON_PREFIX+'remove'+' '+'.'+C.ICON_PREFIX+'white',l);if(m[0]){this._closeHierarchyItem(m.parent());}}else if(l[0]!=this._ul$[0].firstChild){this._unhighlightItem(l);this._highlightItem(l.prev());if(l.offset().top-this._ul$.offset().top<l.height()){this._updateScrollBarPosition(l,e);}}break;case K.DOWN:if(f.ctrlKey){var p=$('.'+C.ICON_PREFIX+'plus',l);if(p[0]){this._openHierarchyItem(p.parent());}}else{if(!l[0]){this._highlightItem($(this._ul$[0].firstChild));}else if(l[0]!=this._ul$[0].lastChild){this._unhighlightItem(l);this._highlightItem(l.next());if(l.offset().top+l.height()>this._ul$.offset().top+this._ul$.height()){this._updateScrollBarPosition(l,d);}}}break;case K.ENTER:case K.SPACE:if(l[0]){this._selectItem(l);}break;case K.ESC:this.close();break;}};c.prototype._validateSize=function(){if(!!this._calDockPosFun&&typeof(this._calDockPosFun)==='function'){this.locate(this._calDockPosFun());}};c.prototype._resizer=function(f){var _=this;if(!f.data.invalidateSize){setTimeout(function(){f.data.invalidateSize=false;_._validateSize();},1000/24);}f.data.invalidateSize=true;};c.prototype._addEventListeners=function(){this._resizeHandler=$.proxy(this._resizer,this);$(window).resize({'invalidateSize':false},this._resizeHandler);};c.prototype._mouseMoveHandler=function(f){if(!this._cursorShowed){$('.'+C.COMMON_PREFIX+'hide-cursor').removeClass(C.COMMON_PREFIX+'hide-cursor');this._cursorShowed=true;document.removeEventListener('mousemove',this._mouseMoveHandlerProvider,true);var l=$('.'+C.COMMON_PREFIX+'feedlist-li-highlight',this._ul$);this._unhighlightItem(l);}};c.prototype._highlightItem=function(l){l.addClass(C.COMMON_PREFIX+'feedlist-li-highlight');};c.prototype._unhighlightItem=function(l){l.removeClass(C.COMMON_PREFIX+'feedlist-li-highlight');};c.prototype._selectItem=function(l){var i=l.data('__item');this._dispatchEvent(new F(F.ITEM_SELECTED,this,{'selectedItem':i}));this.close();};c.prototype._openHierarchyItem=function(f){var g=f.data('__items');var h=g.hierarchyLevels();var j=f.parent();for(var i=0;i<h.length;i++){var l=$(document.createElement('li'));$(j).after(l);j=l;var s=$(document.createElement('span')).appendTo(l);var k=this._setHierarchyAnalysis(g.clone(),i);l.data('__item',k);s.text(h[i].name());s.addClass(C.COMMON_PREFIX+'text-ellipsis');l.click($.proxy(this._analysisSelectedHandler,this));l.hover($.proxy(function(m){this._highlightItem($(m.currentTarget));},this),$.proxy(function(m){this._unhighlightItem($(m.currentTarget));},this));}f.attr('command','close');f.addClass(C.COMMON_PREFIX+'feedlist-li-button-close');f.children().attr('class',C.ICON_PREFIX+'remove'+' '+C.ICON_PREFIX+'white');this._updateAllExpandButtons();};c.prototype._closeHierarchyItem=function(f){var g=f.data('__items');var h=g.hierarchyLevels();for(var j=0;j<h.length;j++){f.parent().next().remove();}f.attr('command','open');f.removeClass(C.COMMON_PREFIX+'feedlist-li-button-close');f.children().attr('class',C.ICON_PREFIX+'plus');this._updateAllExpandButtons();};c.prototype._updateAllExpandButtons=function(){var h=this._ul$[0].scrollHeight>this._ul$.outerHeight();$('.'+C.COMMON_PREFIX+'feedlist-li-button').each(function(){$(this).removeClass(C.COMMON_PREFIX+'feedlist-li-button-offset');if(h){$(this).addClass(C.COMMON_PREFIX+'feedlist-li-button-offset');}});};c.prototype._updateScrollBarPosition=function(l,f){var g=this._ul$.scrollTop();if(f===d){var n=l.nextAll();var h=l.height()*n.length;if(h<=this._ul$.height()){g+=h;}else{g+=(this._ul$.scrollHeight()/l.height());}}else{var p=l.prevAll();var i=l.height()*p.length;if(i<=this._ul$.height()){g=0;}else{g-=(this._ul$.scrollHeight()/l.height());}}this._cursorShowed=true;this._ul$.scrollTop(g);setTimeout($.proxy(function(){this._cursorShowed=false;},this),500);};return c;});define('sap/viz/controls/filterbar0/Tooltip',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/managers/LangManager'],function($,C,A,L){var d=1000;var o={x:8,y:16};var T=function(a){this._div=a;this._showing=false;this._tooltip$=null;};T.prototype._getTitle=function(f){if(f.getType()!==A.VALUE_TYPE){return f.filterTitle();}var c=f.values().length;var t=f.filterName()+' ('+c+' ';if(f.isExcluded()){t+=L.get('VIZ_FILTERBAR_ITEMS_EXCLUDED');}else{t+=L.get('VIZ_FILTERBAR_ITEMS_INCLUDED');}t+=')';return t;};T.prototype._showTooltip=function(f){if(!this._showing){return;}if(!this._tooltip$){this._tooltip$=$(document.createElement('div')).appendTo(this._div);}else{this._tooltip$.empty();}var t=this._tooltip$;t.addClass(C.FILTERBAR0_PREFIX+'filter-item-tooltip');if(f.isGlobalFilter()){var g=L.get('VIZ_FILTERBAR_GLOBAL_FILTER');var a=$(document.createElement('span')).appendTo(t).text(g);a.addClass(C.FILTERBAR0_PREFIX+'filter-item-tooltip-globalfilter');}var b=$(document.createElement('span')).appendTo(t).text(this._getTitle(f));b.addClass(C.FILTERBAR0_PREFIX+'filter-item-tooltip-title');var c=$(document.createElement('span')).appendTo(t);c.addClass(C.FILTERBAR0_PREFIX+'filter-item-tooltip-value');if(f.isExcluded()){c.addClass(C.FILTERBAR0_PREFIX+'filter-exclude');}c.text(f.filterContent());var m=15*15;while(c.height()>m){c.text(c.text().replace(/(\s)*([a-zA-Z0-9]+|\W)(\.\.\.)?$/,"..."));}var l=this._position.left+o.x;var r=this._div.offset().left+this._div.outerWidth();l=Math.min(l,r-t.outerWidth());t.offset({"left":l,"top":this._position.top+o.y});};T.prototype.show=function(f,p){this._position=p;if(this._showing){return;}this._showing=true;var _=this;setTimeout(function(){_._showTooltip(f);},d);};T.prototype.position=function(p){this._position=p;};T.prototype.hide=function(){this._showing=false;if(this._tooltip$){this._tooltip$.remove();this._tooltip$=null;}};return T;});define('sap/viz/controls/filterbar0/FilterBarEvent',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function(O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar0.FilterBarEvent";};O.extend(F,E);F.DELETE_FILTER="deleteFilter";F.HEIGHT_CHANGED="heightExtend";return F;});define('sap/viz/controls/filterbar0/FilterBar',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/views/drag/DropAction','sap/viz/controls/common/views/feed/FeedList','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/helpers/Rectangle','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/DateRangeFilter','sap/viz/controls/common/filter/NumericRangeFilter','sap/viz/controls/common/filter/ValueFilter','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/filterbar0/Tooltip','sap/viz/controls/filterbar0/FilterBarConfig','sap/viz/controls/filterbar0/FilterBarEvent'],function($,V,C,E,a,D,L,O,U,b,F,c,A,d,R,f,g,N,h,j,T,k,l){var m=function(e,u){m.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar0.FilterBar";this._div=e;this._uiConfig=u?u:k.instance();this._containerCurrentPosition=0;this._allAnalyses=null;this._settings=null;this._visualLines=2;this._description$=null;this._layout$=null;this._headerVisible=false;this._isFullScreen=false;this._tooltip=new T(this._div);this._createChildren();};var n=0.8;var o=40;var p=190;O.extend(m,V);m.TYPE_STRING='string';m.TYPE_INTEGER='integer';m.TYPE_NUMBER='number';m.TYPE_DATE='date';var I=16;m.prototype.filterItems=function(e){if(arguments.length>0){this._vizModel().filterItems(e);return this;}else{return this._vizModel().filterItems();}};m.prototype.save=function(){var e={};e['filterItems']=j.toJSON(this._vizModel().filterItems());return e;};m.prototype.load=function(v){var e=null;if(v&&v.filterItems){e=j.fromJSON(v.filterItems);}e=e||[];this._vizModel().filterItems(e);};m.prototype._onVizModelChanged=function(e){if(e.data.filterChanged){this._filtersChanged();}};m.prototype._createChildren=function(){var _=this;var i=this._uiConfig.module;if(i&&(i.visible!==false)){this._headerVisible=true;this._plus$=$(document.createElement("div")).appendTo(this._div);this._plus$.addClass(C.COMMON_PREFIX+'havanaVXTabSprite16');this._plus$.addClass(C.FILTERBAR0_PREFIX+'header-plus');this._plus$.click(function(e){_._plusClickHandler(e);});var q=i.label?i.label:L.get('VIZ_FILTERBAR_DESCRIPTION');this._description$=$(document.createElement("span")).text(q).appendTo(this._div);this._description$.addClass(C.FILTERBAR0_PREFIX+"description");}this._layout$=$(document.createElement('div')).appendTo(this._div);this._layout$.addClass(C.FILTERBAR0_PREFIX+'layout');this._layout$.addClass(C.COMMON_PREFIX+'scrollable');this._layout$.addClass(C.COMMON_PREFIX+'scrollable-y');this._layout$.css({'max-height':this._visualLines*o});this._filterItemsContainer$=$(document.createElement('div')).appendTo(this._layout$);this._filterItemsContainer$.addClass(C.FILTERBAR0_PREFIX+'filterItems-container');if(this._headerVisible===true){this._layout$.hide();}else{this._layout$.css({'left':'0px'});}$(this._div).droppable({tolerance:'pointer',accept:'.'+D.DRAGGABLE_CLASS_ANALYSIS,over:$.proxy(this._dragOver,this),out:$.proxy(this._dragOut,this),drop:$.proxy(this._drop,this)});};m.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e;}else{return this._allAnalyses;}};m.prototype._plusClickHandler=function(e){var i=document.createElement('div');var q=this._getExcludeGlobalFilter(this._vizModel().filterItems());var r=new F(i,this._allAnalyses,d.DIMENSION,q);r.addEventListener(c.ITEM_SELECTED,function(t){var u=t.data.selectedItem;if(u){this._addFilterItem(u);}},this);var s=this._plus$.offset();r.open({x:s.left,y:s.top,shelfWidth:this._plus$.width()});};m.prototype._getExcludeGlobalFilter=function(e){var q=[];if(e){for(var i=0;i<e.length;i++){if(e[i].isGlobalFilter()===false){q.push(e[i]);}}}return q;};m.prototype._getDroppableAnalysisObject=function(t){if(!t||!t.analysisObject){return null;}var e=t.analysisObject;var i=e.type();var q=j.getFilterInfo(e);if(A.compatible(A.DIMENSION,i)&&!j.isFilterItemExisted(this._vizModel(),q.id,q.hierarchyLevelId)&&i!==A.MND){return e;}else{return null;}};m.prototype._dragOver=function(e,u){var t=D.instance().getAnalysisToken(u.helper);if(!t){return;}var i=this._getDroppableAnalysisObject(t);if(i){t.currentAction(b.ACCEPT_AS_COPY);}else{t.currentAction(b.DENY);}};m.prototype._dragOut=function(e,u){var t=D.instance().getAnalysisToken(u.helper);if(t){t.currentAction(b.DENY);}};m.prototype._drop=function(e,u){var t=D.instance().getAnalysisToken(u.helper);if(!t){return;}var i=this._getDroppableAnalysisObject(t);if(i){t.currentAction(b.ACCEPT_AS_COPY);this._addFilterItem(i);}else{t.currentAction(b.DENY);}t.dropTarget(this._dom);};m.prototype._addFilterItem=function(e){var i=j.getFilterInfo(e);var q=i.name;var r=i.id;var s=e.dataType();var t;switch(s){case m.TYPE_INTEGER:case m.TYPE_NUMBER:t=new N(r,q);break;case m.TYPE_DATE:t=new g(r,q);break;default:t=new h(r,q);if(i.hierarchyLevelId){t.hierarchyLevelId=i.hierarchyLevelId;}break;}var u=this._vizModel().filterItems();u.push(t);this._vizModel().filterItems(u);this._dispatchRequestFilterEvent(t);};m.prototype._filtersChanged=function(){if(this._filterItemsContainer$){this._filterItemsContainer$.empty();}var e=this._vizModel().filterItems();if(!e||e.length===0){this._updateDescription();return this;}if(this._headerVisible===true){this._description$.hide();this._layout$.show();}this._updateFilterItemContainer();};m.prototype._dispatchRequestFilterEvent=function(e){var _=this;var v=function(r){var s=_._vizModel().filterItems();if(e.isEmpty()){var t=s.indexOf(e);if(t>=0){s.splice(t,1);_._vizModel().filterItems(s);_._tooltip.hide();}return;}if(r){_._vizModel().filterItems(s);}};var i=$('#'+e.id(),this._filterItemsContainer$);var q={bounds:R.toJSON(R.parseDOM(i)),filterName:e.filterName(),analysisObjectId:e.analysisObjectId(),filterItem:e,validate:v};this._dispatchEvent(new a(E.REQUEST_FILTER_VALUES,this,q));};m.prototype._createFilterTitle=function(e,i){if(e.getType()!==f.VALUE_TYPE){var q=$(document.createElement('span')).appendTo(i).text(e.filterTitle());q.addClass(C.FILTERBAR0_PREFIX+'filter-item-text');q.addClass(C.FILTERBAR0_PREFIX+'range-filter-item-text');return;}var t=$(document.createElement('div')).appendTo(i);var r=$(document.createElement('div')).appendTo(t).text(e.filterName()).css("display",'inline');r.addClass(C.FILTERBAR0_PREFIX+'filter-item-text').attr('id','filterName');var s=$(document.createElement('div')).appendTo(t).css("display",'inline').attr('id','countInfo');s.addClass(C.FILTERBAR0_PREFIX+'filter-item-info');$(document.createElement('span')).appendTo(s).text('(');var u=$(document.createElement('span')).appendTo(s).text(e.values().length);if(e.isExcluded()){u.addClass(C.FILTERBAR0_PREFIX+'filter-exclude');}$(document.createElement('span')).appendTo(s).text(')');};m.prototype._createFilterItem=function(i){var q=i.filterName();var _=this;var r=document.createElement('div');var s=$(r).appendTo(this._filterItemsContainer$);this._createFilterTitle(i,s);if(i.isGlobalFilter()){s.attr({'id':'GLOBAL-'+i.id()});s.addClass(C.FILTERBAR0_PREFIX+'global-filter-item');}else{s.attr({'id':i.id()});s.addClass(C.FILTERBAR0_PREFIX+'filter-item');s.click(function(){_._dispatchRequestFilterEvent(i);});var t=$(document.createElement('div')).appendTo(s);t.addClass(C.FILTERBAR0_PREFIX+'delete-icon');t.addClass(C.ICON_PREFIX+'error');t.click(function(e){_._removeFilterItem(i);_._dispatchEvent(new l(l.DELETE_FILTER,_));_._tooltip.hide();e.stopPropagation();});}return s;};m.prototype._stringToNumber=function(v){if(!v){return 0;}return parseInt(v.replace('px',''),10);};m.prototype.validateSize=function(){var e=this._filterItemsContainer$.children();if(e.length===0){return this;}e.css({'width':p});this._updateFilterItemsWidth();};m.prototype._needAdjust=function(){var e=this._filterItemsContainer$.innerHeight();var i=e>o;if(i){return true;}else{return false;}};m.prototype._updateFilterItemContainer=function(){var e=this._vizModel().filterItems();var i;for(i=0;i<e.length;i++){this._createFilterUI(e[i]);}this._updateFilterItemsWidth();return this;};m.prototype._createFilterUI=function(e){var i=e.filterName();var q;var _=this;q=this._createFilterItem(e);q.mouseover(function(r){_._tooltip.show(e,{left:r.clientX,top:r.clientY});$('.'+C.FILTERBAR0_PREFIX+'filter-values',r.currentTarget).addClass(C.FILTERBAR0_PREFIX+'filter-values-active');});q.mousemove(function(r){_._tooltip.position({left:r.clientX,top:r.clientY});});q.mouseout(function(r){_._tooltip.hide();$('.'+C.FILTERBAR0_PREFIX+'filter-values',r.currentTarget).removeClass(C.FILTERBAR0_PREFIX+'filter-values-active');});this._addFilterValues(e,q);};m.prototype._updateFiltersTitle=function(){var u=function(i,e){var q=$('#filterName',e);if(q.length===0){return;}q.css({'width':'auto'});var t=q.parent();var r=$('#countInfo',e);var s=q.position();var v=q.width()+s.left+2;var w=t.width()-I;var x=r.width();var y=Math.min(v,w-x);q.css({'width':y-s.left});r.css({'left':y});};$('.'+C.FILTERBAR0_PREFIX+'filter-item',this._div).each(u);$('.'+C.FILTERBAR0_PREFIX+'global-filter-item',this._div).each(u);};m.prototype._updateFilterItemsWidth=function(){var e;if(this._filterItemsContainer$.children().length===0){this._updateDescription();return this;}if(!this._needAdjust()){e={'height':o};this._dispatchEvent(new l(l.HEIGHT_CHANGED,this,e));this._updateFiltersTitle();return this;}var i=0;while(this._needAdjust()&&i<2){i++;var q=$('.'+C.FILTERBAR0_PREFIX+'filter-item');var w=$($('.'+C.FILTERBAR0_PREFIX+'filter-item')[0]).outerWidth()*n;q.css({'width':w});}if(this._needAdjust()){e={'height':this._avaliableHeightForHeader()};this._dispatchEvent(new l(l.HEIGHT_CHANGED,this,e));if(e.height<this._filterItemsContainer$.outerHeight()){$(this._layout$).scrollTop(this._filterItemsContainer$.outerHeight());}}if(!this._needAdjust()){e={'height':o};this._dispatchEvent(new l(l.HEIGHT_CHANGED,this,e));}this._updateFiltersTitle();return this;};m.prototype._avaliableHeightForHeader=function(){var e=this._filterItemsContainer$.outerHeight();var q=o-2;var r=o;var s=this._visualLines-1;for(var i=2;i<=this._visualLines;i++){if(q*i<=e&&e<=r*i){s=i-1;break;}}var t=2;return s*q+r+t;};m.prototype._addFilterValues=function(e,i){var v=e.filterContent();var q=i.find("span[id='values']");if(q.length===0){q=$(document.createElement('span')).appendTo(i);q.addClass(C.FILTERBAR0_PREFIX+'filter-values');q.attr({id:'values'});}q.text(v);var r=C.FILTERBAR0_PREFIX+'filter-exclude';if(e.isExcluded()){q.addClass(r);}else{q.removeClass(r);}};m.prototype._removeFilterItem=function(e){var i=this._vizModel().filterItems().slice(0);var q=i.indexOf(e);i.splice(q,1);this._vizModel().filterItems(i);return i;};m.prototype._updateDescription=function(){var e=this._vizModel().filterItems();if(e.length===0&&this._headerVisible===true){this._description$.show();this._layout$.hide();}};return m;});define('sap/viz/controls/frame/views/FilterMenuEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var F=function(t,a,d){F.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.views.FilterMenuEvent";};O.extend(F,E);F.FILTER_CLICKED="filterClicked";F.EXCLUDE_CLICKED="excludeClicked";return F;});define('sap/viz/controls/frame/views/FilterMenu',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/managers/LangManager','sap/viz/controls/frame/views/FilterMenuEvent'],function($,O,U,C,L,F){var a=function(d,u){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.views.FilterMenu";this._div=d;this._uiConfig=u;this._container=null;this._createChildren();};O.extend(a,U);a.prototype._createChildren=function(){this._container=$(document.createElement('div')).appendTo(this._div);$(this._container).addClass(C.FRAME_PREFIX+"filtermenu");var b=$(document.createElement('div')).appendTo(this._container);var f=$(document.createElement('div')).appendTo(b);f.addClass(C.ICON_PREFIX+'exclude').addClass('viz-controls-icon-filter');var c=$(document.createElement('div')).appendTo(b);c.text(L.get('VIZ_FRAME_FILTERMENU_FILTER'));b.click($.proxy(function(){this._dispatchEvent(new F(F.FILTER_CLICKED),this);},this));var d=$(document.createElement('div')).appendTo(this._container);var e=$(document.createElement('div')).appendTo(d);e.addClass(C.ICON_PREFIX+'circle-close').addClass('viz-controls-icon-exclude');var g=$(document.createElement('div')).appendTo(d);g.text(L.get('VIZ_FRAME_FILTERMENU_EXCLUDE'));$(d).click($.proxy(function(){this._dispatchEvent(new F(F.EXCLUDE_CLICKED),this);},this));};a.prototype.show=function(s,b){if(s||b){$(this._container).css({bottom:2+'px','visibility':'visible','display':'block'});$(this._container).show();}else{$(this._container).hide();}};a.prototype.hide=function(){$(this._container).hide();};a.prototype.size=function(s){$(this._container).css({left:(s.width-$(this._container).outerWidth())/2+'px'});};return a;});define('sap/viz/controls/common/utils/OSUtil',[],function(){function _(){return undefined!==document.documentElement.style.webkitBoxAlign;}function a(){return!!window.XDomainRequest;}function b(){return!!window.chrome;}function c(){return(undefined!==document.documentElement.style.MozBoxAlign)&&("Gecko"===window.navigator.product);}function d(){return(/javafx\//i).test(window.navigator.userAgent);}function e(){return _()&&!b();}function f(){return(undefined!==window.navigator.standalone)&&_()&&!b();}return{isIE:a,isChrome:b,isFirefox:c,isJavaFx:d,isSafari:e,isSafariMobile:f,isWebkit:_};});define('sap/viz/controls/chart/views/TitleContextMenu',['sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/OSUtil','sap/viz/controls/common/UIControl','sap/viz/controls/common/constants/CSSConst','jquery'],function(O,a,U,C,$){var b=function(d,i){b.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.TitleContextMenu";this._div=d;this._menu=null;this._visible=true;this._shown=false;this._cusMenuItems=i;this._createContextMenu();this._mousedownHandler=$.proxy(this._handleMousedownEvent,this);};O.extend(b,U);b.prototype._createContextMenu=function(){var _=this;this._menu=document.createElement('div');$(this._menu).addClass(C.PREFIX+'contextmenu');$(this._div).append(this._menu);this.hide();this._ul=document.createElement('ul');$(this._ul).addClass([C.CONTEXTMENU_PREFIX+'list',C.CONTEXTMENU_PREFIX+'list-hovered'].join(' '));$(this._ul).appendTo(this._menu);};var E=[];b.prototype._getCusMenuItem=function(n){if(this._cusMenuItems&&this._cusMenuItems.length>0){for(var i=0;i<this._cusMenuItems.length;i++){var m=this._cusMenuItems[i];if(m.name===n){return m;}}}return null;};b.prototype.updateMenu=function(){var v=[];$(this._ul).empty();for(var i=0;i<this._cusMenuItems.length;i++){var c=this._cusMenuItems[i];this._createMenuItemUI(c);}};b.prototype._createMenuItemUI=function(c){var t=c.text;var e={};e.clickHandler=c.clickHandler;e.scope=c.scope;var d=c.enableValidator.apply(c.scope);var i=c.name;var l=document.createElement('li');var m=document.createElement('div');$(l).addClass(C.CONTEXTMENU_PREFIX+"MnuItm");$(m).addClass(C.CONTEXTMENU_PREFIX+"MnuItm");$(l).appendTo(this._ul);$(m).appendTo(l);var T=$("<div>",{"class":C.CONTEXTMENU_PREFIX+"MnuItmTxt"});$(T).appendTo(m);$(T).text(t);if(d){$(T).css("color","black");}else{$(T).css("color","grey");}m.id=i;var _=this;if(d){$(m).click(function(f){if(e.clickHandler){e.clickHandler.apply(e.scope);}_.hide();});}else{$(m).click(function(f){_.hide();});}};b.prototype.isShown=function(){return this._shown;};b.prototype.show=function(o){this.updateMenu();if(o&&o.position){var p=$(this._div).innerWidth();var m=$(this._menu).outerWidth();var l=o.position.pageX;if(p<m+l){l=p-m;}var t=o.position.pageY;var c=$(this._div).parent().innerHeight();var d=$(this._menu).outerHeight();if(c<d+t){t=c-d;}t+=$(this._div).parent().offset().top;if(l<0){l=$(this._div).parent().offset().left;}else{l+=$(this._div).parent().offset().left;}$(this._menu).css({position:"fixed",left:l+"px",top:t+"px"});}$(this._menu).css('visibility','visible');this._shown=true;document.removeEventListener("mousedown",this._mousedownHandler,true);$(window).off('blur',this._mousedownHandler);document.addEventListener("mousedown",this._mousedownHandler,true);$(window).on('blur',this._mousedownHandler);};b.prototype._handleMousedownEvent=function(e){var i=e.target.id;if(a.isIE()&&i===""){i=e.target.parentNode.id;}var c=this._getCusMenuItem(i);if(c){return;}this.hide();};b.prototype.hide=function(){$(this._menu).find('*').removeData().off();$(this._menu).css('visibility','hidden');this._shown=false;};return b;});define('sap/viz/controls/chart/views/TitleEditor',['jquery','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/OSUtil','sap/viz/controls/common/events/Event','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/helpers/Rectangle','sap/viz/controls/chart/views/TitleContextMenu','sap/viz/controls/common/managers/LangManager','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/chart/Chart'],function($,C,O,a,E,V,R,T,L,b,c){var d=function(e,u){d.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.TitleEditor";this._targetDiv=e;this._uiconfig=u;this._editing=false;this.createChildren();};O.extend(d,V);d.prototype.createChildren=function(){var p=this._targetDiv;this._div=$(document.createElement("DIV"));this._textInput=$('<input type="text" spellcheck="false"/>');this._textInput.addClass(C.CHART_PREFIX+'title-text');this._textInput.attr('value',this._vizProxy().getTitleText());this._settingBtn=$(document.createElement("div"));this._settingBtn.addClass(C.CHART_PREFIX+'title-button');var s=$(document.createElement("div")).appendTo(this._settingBtn);s.addClass(C.CHART_PREFIX+"setting-icon");s.addClass(C.ICON_PREFIX+'settings').addClass(C.ICON_PREFIX+'button');this._settingBtn.hide();var m=[{text:L.get('VIZ_CHART_TITLE_CONTEXT_MENU_EDIT'),name:'edit',clickHandler:this.enterEditMode,enableValidator:function(){return true;},scope:this},{text:L.get('VIZ_CHART_TITLE_CONTEXT_MENU_RESTORE'),name:'restore',clickHandler:this.restore,enableValidator:function(){return this.edited();},scope:this}];this._contextMenu=new T(p,m);this._div.append(this._textInput).append(this._settingBtn).appendTo(p);var _=this;document.addEventListener("mousedown",function(e){_._documentMouseDownHandler(e);},true);this._settingBtn.click(function(e){_._popupContextMenu();});this._div.bind("mouseover",function(){_.mouseOver();}).bind("mouseout",function(){_.mouseOut();}).bind("dblclick",function(){_.dblClick();}).bind('keypress',function(e){if(e.keyCode==13){_._documentKeyPressHandler(e);e.preventDefault();}});};d.prototype.editable=function(){return!this._vizProxy().isFakeChart();};d.prototype.edited=function(){return this._vizProxy().isTitleCustomized();};d.prototype.restore=function(){this._editing=false;this._vizProxy().setTitleMode(c.VIZ_TITLE_MODE.auto);this._vizProxy().restoreTitleText();};d.prototype.enterEditMode=function(){if(this.editable()){this._settingBtn.hide();this._editing=true;this._layoutTitleDiv();this._textInput.css({'display':'block'});this._textInput.val(this._vizProxy().getTitleText());this._textInput.focus().select();}};d.prototype._layoutTitleDiv=function(){var e=this._vizProxy().getTitleZone();if(e&&e.length>0){var s=this._targetDiv.scrollLeft();var l=e[0][0],t=e[0][1],w=e[2][0]-e[0][0],h=e[2][1]-e[0][1];var f="position:absolute;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;";if(this._editing){var p=8;f+="left:"+s+"px;top:"+(t-p)+"px;width:100%;"+"height:"+(h+p*2)+"px;";this._div.addClass(C.CHART_PREFIX+'title-edit');}else{f+="left:"+l+"px;top:"+t+"px;width:"+(w+16)+"px;height:"+h+"px;";if(a.isIE()){f+="background-color:rgba(0,0,0,0)";}this._div.removeClass(C.CHART_PREFIX+'title-edit');}this._div.attr('style',f);}};d.prototype.init=function(t){var p=this._vizProxy().getProperties()||null;var i=p?p.interaction:null;var e=i?i.behaviorType:null;if(t){this._div.attr('title',this._vizProxy().getTitleText());}else{this._div.removeAttr('title');}if(b.supportTitle(this._vizModel().type())&&e!=="DesignTimeBehavior"){this.size();this._show();}else{this._hide();}};d.prototype._show=function(){this.show();};d.prototype._hide=function(){this.hide();};d.prototype.dblClick=function(){if(this.editable()&&!this._editing){this.enterEditMode();}};d.prototype._popupContextMenu=function(){var e=this._vizProxy().getTitleZone();var l=e[0][0],t=e[0][1],w=e[2][0]-e[0][0],h=e[2][1]-e[0][1];var o=95;var p={pageX:l+w-o-this._targetDiv.scrollLeft(),pageY:t+h-this._targetDiv.scrollTop()};this._contextMenu.show({position:p});};d.prototype.mouseOver=function(){var t=this._vizProxy().getProperties().title||{visible:true};if(this.editable()&&!this._editing&&t.visible){this._layoutTitleDiv();this._settingBtn.show();}};d.prototype.mouseOut=function(){if(this.editable()&&!this._editing){this._layoutTitleDiv();if(a.isIE()){this._div.css({'border-width':'0px','background-color':'rgba(0,0,0,0)'});}else{this._div.css({'border-width':'0px','background-color':'transparent'});}this._textInput.css({'display':'none'});this._textInput.blur();if(!this._contextMenu.isShown()){this._settingBtn.hide();}}};d.prototype._documentMouseDownHandler=function(e){if(this._editing&&e.target!==this._textInput[0]){this._commitTitleEdit();e.stopPropagation();}if(this._contextMenu.isShown()&&e.target!=this._settingBtn[0]&&e.target.parentElement!=this._settingBtn[0]){this._settingBtn.hide();}if(!this._editing&&e.which===3&&e.target===this._div[0]){this._div.hide();}};d.prototype._documentKeyPressHandler=function(e){if(this._editing&&e.target===this._textInput[0]){this._commitTitleEdit();e.stopPropagation();}};d.prototype._onVizModelChanged=function(){this.init();};d.prototype._commitTitleEdit=function(){this._editing=false;var t=this._textInput[0].value;if(t!=this._vizProxy().getTitleText()){this._vizProxy().setTitleMode(c.VIZ_TITLE_MODE.manual);this._vizProxy().setTitleText(t);}this.mouseOut();};d.prototype.size=function(){this._layoutTitleDiv();if(this._contextMenu.isShown()){this._popupContextMenu();}};d.prototype.load=function(){this.init();};return d;});define('sap/viz/controls/playcontrol/PlayControlEvent',['jquery','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/events/Event'],function($,O,E){var P=function(t,a,d){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.playcontrol.PlayControlEvent";};O.extend(P,E);P.SLICE_DIMENSION_CHANGED="sliceDimensionChanged";P.UPDATE_CHART_COMPLETE="updateChartComplete";return P;});define('sap/viz/controls/playcontrol/PlayControl',["jquery","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/config/GlobalConfig",'sap/viz/controls/common/metadata/MetadataFactory',"sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/playcontrol/PlayControlEvent",'sap/viz/controls/common/feeds/AnalysisObject',"sap/viz/controls/common/utils/Utils","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/constants/DatasetTypeConst",'sap/viz/controls/common/managers/LangManager'],function($,C,V,G,M,a,O,P,A,U,F,b,c,D,L){var d=0,f=1,g=2,k=1,l=1000,m="/controls/playcontrol/assets/paused.svg",n="/controls/playcontrol/assets/inprogress.svg",o=48;var p=function(e){this._player=e;this._t=null;this._lastUpdateTstmp=0;};p.prototype._playerUpdateHandler=function(){if(this._player){var t=(new Date()).getTime();if(t-this._lastUpdateTstmp>=l){this._player._progressing();this._lastUpdateTstmp=t;}else{if(!this._t){this._t=setTimeout($.proxy(function(){clearTimeout(this._t);this._t=null;this._playerUpdateHandler();},this),t-this._lastUpdateTstmp);}}}};p.prototype.start=function(){this._player._start();if(!this._player.hasEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)){this._player.addEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this);}this._playerUpdateHandler();};p.prototype.pause=function(){if(this._t){clearTimeout(this._t);this._t=null;}if(this._player.hasEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)){this._player.removeEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this);}this._player._pause();};p.prototype.stop=function(){if(this._t){clearTimeout(this._t);this._t=null;}if(this._player.hasEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)){this._player.removeEventListener(P.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this);}this._player._stop();};var q=function(e,u){q.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.playcontrol.PlayControl";this._div=e;this._body=null;this._slider=null;this._playBtn=null;this._slicedData=[];this._labelDiv=null;this._timer=new p(this);this._state=d;this._currentVal=0;this._step=k;this._visible=false;this._chartFeedings=[];this._createChildren();this._chartUpdateCompleteHandler=$.proxy(function(){this._dispatchEvent(new P(P.UPDATE_CHART_COMPLETE,this));},this);};O.extend(q,V);q.prototype.sliceDimension=function(e){if(arguments.length>0){this._vizModel().playerField(e);return this;}else{return this._vizModel().playerField();}};q.prototype.slicedData=function(s){if(arguments.length>0){this._slicedData=s;this._resetControls();if(!b.isInfoChart(this._vizModel().type())){if(!$.isEmptyObject(s)){this._resetChartFrameDataScale();}this._timer.stop();}}else{return this._slicedData;}};q.prototype._createChildren=function(){var _=this;var e=this._uiConfig;if(!this._body){this._body=$(document.createElement("div")).appendTo(this._div);this._body.addClass(a.PLAYCTRL_PREFIX+"body");}if(!this._playBtnDiv){this._playBtnDiv=$(document.createElement("div")).appendTo(this._body);this._playBtnDiv.addClass(a.PLAYCTRL_PREFIX+"playbtn");this._playBtn=new sap.ui.commons.Button({icon:G.defaultAssetsRoot()+m,iconDesityAware:true,press:$.proxy(_._btnPress,this)});this._playBtn.addStyleClass(a.PLAYCTRL_PREFIX+"playbtn");this._playBtn.placeAt(this._playBtnDiv);}if(!this._sliderDiv){this._sliderDiv=$(document.createElement("div")).appendTo(this._body);this._sliderDiv.addClass(a.PLAYCTRL_PREFIX+"slider");this._slider=new sap.ui.commons.Slider({editable:false,min:0,max:1,smallStepWidth:1,liveChange:$.proxy(this._sliderValueChange,this)});this._slider.placeAt(this._sliderDiv);}if(!this._labelDiv){this._labelDiv=$(document.createElement("div")).appendTo(this._body);this._labelDiv.addClass(a.PLAYCTRL_PREFIX+"label").text("");}this._resetControls();};q.prototype._progressing=function(){this._vizProxy().setAnimationLayer();this._currentVal+=this._step;if(this._currentVal>this._slider.getMax()){this._timer.stop();return;}this._updateControls();this._updateChartData();};q.prototype._start=function(){this._state=f;this._updateControls();this._updateChartScale();this._enableChartInteraction(false);};q.prototype._stop=function(){this._state=d;this._currentVal=0;this._updateControls();this._updateChartData();this._enableChartInteraction(true);};q.prototype._pause=function(){this._state=g;this._updateControls();this._enableChartInteraction(true);};q.prototype._updateChartData=function(){if(!b.isInfoChart(this._vizModel().type())){if(this._slicedData&&this._slicedData.slices){if(this._slicedData.slices.length===0){var e;var h=b.getDatasetType(this._vizModel().type());if(h===D.CROSS_TABLE){e=new sap.viz.api.data.CrosstableDataset();}else if(h===D.FLAT_TABLE){e=new sap.viz.api.data.FlatTableDataset({data:[],metadata:{fields:[]},info:[]});}else{e=null;}this._slicedData.slices.push({data:e});}if(this._slicedData.slices[this._currentVal]!==undefined){this._vizProxy().SetDataset(this._slicedData.slices[this._currentVal].data);}}}else if(this._hasData()){this._vizProxy().setScales([{feed:'dataFrame',type:'frame',currentValue:this._slicedData[this._currentVal]}]);}};q.prototype._updateChartScale=function(){if(this._vizModel().type()===C.TYPE_GEO_BUBBLE){var e=this._vizProxy().getProperties();if(e&&e.geoContainer){this._vizProxy().updateProperties({properties:{geoContainer:{isFixedScale:true,scale:e.geoContainer.scale,center:e.geoContainer.center}},disableDispatchInteractionCompleteEvent:true});}}};q.prototype._resetChartFixScale=function(){if(this._vizModel().type()===C.TYPE_GEO_BUBBLE){this._vizProxy().updateProperties({properties:{geoContainer:{isFixedScale:this.sliceDimension()!=null,scale:null,center:[]}},disableDispatchInteractionCompleteEvent:true});}};q.prototype._resetChartFrameDataScale=function(){if(this._vizModel().type()===C.TYPE_GEO_BUBBLE){var e=function(j,E){var i,H,I=Number.MAX_VALUE,J=Number.MIN_VALUE,K=false;if(j&&E){for(i=0;i<j.length;i++){H=j[i].name();if(E[H]){I=Math.min(E[H][0],I);J=Math.max(E[H][1],J);K=true;}}}return K?[I,J]:[0,0];};var u=function(i,E,H){var I=E.split("."),j,J;for(j=0,J=i;j<I.length;j++){if(j==I.length-1){J[I[j]]=H;}else{J[I[j]]=J[I[j]]||{};J=J[I[j]];}}};var h={},r=[],s=this._vizModel().type(),t=M.get(s),v={},w,x,y,z={},B=t?t.dataScale():null;if(!B){return;}if(this._slicedData&&U.isArray(this._slicedData.measuresInfo)){this._slicedData.measuresInfo.forEach(function(i){v[i.name]=i.range;});}if(this._chartFeedings){r=this._chartFeedings.filter(function(i){return i&&i.type()===F.MEASURE;});if(r.length>0){r.forEach(function(i){z[i.id()]=e(i.values(),v);});}}for(w in z){if(z.hasOwnProperty(w)){y=z[w];}if(B[w]&&U.isArray(B[w].minValue)){B[w].minValue.forEach(function(i){u(h,i,y[0]);});}if(B[w]&&U.isArray(B[w].maxValue)){B[w].maxValue.forEach(function(i){u(h,i,y[1]);});}}this._vizProxy().updateProperties({properties:h,disableDispatchInteractionCompleteEvent:true});}};q.prototype._enableChartInteraction=function(e){if(this._vizModel().type()===C.TYPE_GEO_BUBBLE){this._vizProxy().updateProperties({properties:{geoController:{disableInteraction:!e}},disableDispatchInteractionCompleteEvent:true});}};q.prototype._updateControls=function(){switch(this._state){case d:this._playBtn.setIcon(G.defaultAssetsRoot()+m);break;case f:this._playBtn.setIcon(G.defaultAssetsRoot()+n);break;case g:this._playBtn.setIcon(G.defaultAssetsRoot()+m);break;}this._slider.setValue(this._currentVal);if(this._slicedData&&this._slicedData.slices&&this._slicedData.slices[this._currentVal]){this._labelDiv.text(this._slicedData.slices[this._currentVal].dimensionMember);this._alignLabelWithSliderThumb();}if(this._slicedData&&U.isArray(this._slicedData)){var v=this._slicedData[this._currentVal];var e=U.isString(v)?v:((v&&v.d)?v.d:null);if(e===null){e=L.get("IDS_ISNOVALUE");}this._labelDiv.text(e);this._alignLabelWithSliderThumb();}};q.prototype._alignLabelWithSliderThumb=function(){this._labelDiv.width("auto");var s=this._sliderDiv.offset().left,e=this._sliderDiv.width(),h=Math.min(e,this._labelDiv.width()),t=$(".sapUiSliGrip",this._sliderDiv).offset()?$(".sapUiSliGrip",this._sliderDiv).offset().left:0;this._labelDiv.width(h+1);this._labelDiv.offset({left:h+t<s+e?t:s+e-h});};q.prototype._resetControls=function(){var h=this._hasData();var e=this._isEnable();this._playBtn.setEnabled(e);this._slider.setEditable(e);this._slider.setEnabled(e);this._slider.setMin(0);this._slider.setMax(this._calculateMax());this._updateControls();this._updateLabelVisiblity();};q.prototype._btnPress=function(){switch(this._state){case d:case g:this._timer.start();break;case f:this._timer.pause();break;}};q.prototype._onConnect=function(e){q.superclass._onConnect.apply(this,arguments);this._chartFeedings=this._vizModel().feedingItems();this._sliceDimensionChanged();};q.prototype.requestNextFrame=function(){if(this._timer&&this._state===f){this._timer._playerUpdateHandler();}};q.prototype._onVizModelChanged=function(e){if(e.data.feedingItemsChanged){this._chartFeedings=this._vizModel().feedingItems();if(!b.isInfoChart(this._vizModel().type())){this.slicedData([]);}}if(e.data.sliceDimensionChanged){this._sliceDimensionChanged();}};q.prototype._sliderValueChange=function(){this._currentVal=this._slider.getValue();this._updateControls();this._updateChartScale();this._updateChartData();};q.prototype._sliceDimensionChanged=function(){this.slicedData([]);this._resetChartFixScale();var e={"sliceDimension":this.sliceDimension()};this._dispatchEvent(new P(P.SLICE_DIMENSION_CHANGED,this,e));};q.prototype.validateSize=function(w,h){var e=0,i=0,s,j=$(this._body).height();var r;$(this._body).css({width:w});if(this._playBtnDiv){e=this._playBtnDiv.outerWidth();i=this._playBtnDiv.outerHeight();this._playBtnDiv.css({top:j/2-i/2+"px",left:0+"px",position:"absolute"});}if(this._sliderDiv){s=w-e;this._slider.setWidth(s+"px");r=this._slider.getHeight();this._sliderDiv.css({top:j/2+"px",left:e+"px",position:"absolute"});}if(this._labelDiv){setTimeout($.proxy(function(){this._alignLabelWithSliderThumb();},this),0);}if(this._slider.oGrip&&this._slider.oGrip.title){$(".viz-controls-playcontrol-slider #__slider0-grip").mouseover(function(t){$('#__slider0-grip').attr('title'," ");});}};q.prototype.visible=function(v){q.superclass.visible.apply(this,arguments);this._visible=v;this._updateLabelVisiblity();};q.prototype._updateLabelVisiblity=function(){var h=this._hasData();this._labelDiv.css("visibility",h&&this._visible?"visible":"hidden");};q.prototype.save=function(e){var s={},i=0;if(!b.isInfoChart(this._vizModel().type())){if(e&&e.emptyDataset===true){s.measuresInfo=[];s.slices=[];}else if(this._slicedData&&this._slicedData.measuresInfo){s.measuresInfo=this._slicedData.measuresInfo;if(U.isArray(this._slicedData.slices)){s.slices=[];for(;i<this._slicedData.slices.length;i++){if(this._slicedData.slices[i].data){s.slices.push({data:this._slicedData.slices[i].data.toJSON(),dimensionMember:this._slicedData.slices[i].dimensionMember});}}}}}else if(this._hasData()){s=this._slicedData;}return{sliceDimension:A.toJSON(this.sliceDimension()),slicedData:s,value:this._currentVal};};q.prototype.load=function(v){var t=this._vizModel().type();if(!b.supportAnimation(t)||!(v&&v.sliceDimension)){return;}var s=v.slicedData;var h=this._isSlicedDataValid(s);this.sliceDimension(A.fromJSON(v.sliceDimension));if(b.isInfoChart(t)){if(h){this._slicedData=s;this._currentVal=h?v.value:0;this._resetControls();this._resetChartFixScale();this._updateChartData();}}else{if(h){s.slices=s.slices.map(function(i){var r={dimensionMember:i.dimensionMember};if(i.data.id==='sap.viz.data.CrosstableDataset'){r.data=sap.viz.api.data.CrosstableDataset.fromJSON(i.data);}else{r.data=sap.viz.api.data.FlatTableDataset.fromJSON(i.data);}return r;});}this._slicedData=s;this._currentVal=h?Math.min(v.value,s.slices.length):0;this._resetControls();this._resetChartFrameDataScale();this._resetChartFixScale();this._updateChartData();}};q.prototype.destroy=function(){q.superclass.destroy.apply(this,arguments);if(this._playBtn){this._playBtn.destroy(true);}if(this._slider){this._slider.destroy(true);}$(".viz-controls-playcontrol-slider #__slider0-grip").unbind('mouseover');};q.prototype._hasData=function(){return this._isSlicedDataValid(this._slicedData);};q.prototype._isSlicedDataValid=function(s){if(s&&s.slices){return!!(s&&s.slices&&U.isArray(s.slices)&&s.slices.length>0);}else{return!!(s&&U.isArray(s)&&s.length>0);}};q.prototype._isEnable=function(){if(!this._hasData()){return false;}var e=false;if(!b.isInfoChart(this._vizModel().type())){if(this._slicedData.slices&&this._slicedData.slices[0]&&this._slicedData.slices[0].data){e=!c.hasFakeData(this._slicedData.slices[0].data);}}else{e=!c.hasFakeData(this._vizProxy().getDataset());}return e;};q.prototype._calculateMax=function(){if(this._hasData()){if(!b.isInfoChart(this._vizModel().type())){return this._slicedData.slices.length-1;}else{return this._slicedData.length-1;}}else{return 1;}};return q;});define('sap/viz/controls/dedicatedlegend/DedicatedLegend',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/managers/LangManager'],function($,V,O,u,L){var D=function(o){D.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.DedicatedLegend.DedicatedLegend";this._defaultChartOption=undefined;this._position='right';this._openBy=null;this._isShown=null;try{$.sap.require("sap.m.ResponsivePopover");}catch(e){throw u.substitute(L.get('VIZ_COMMON_DEPENDENCY_ERROR'),'sap.m','DedicatedLegend');}};O.extend(D,V);D.prototype._onConnect=function(v,m){D.superclass._onConnect.apply(this,arguments);this._olegendDOMID=this._createId('legends');this._oLegendDOM=new sap.ui.core.HTML();this._oPopover=new sap.m.ResponsivePopover(this._createId('legendPopover'),{placement:sap.m.PlacementType.Auto,contentWidth:"18rem",title:'Legends',content:[this._oLegendDOM]});this._oPopover.addStyleClass('viz-controls-dedicatedLegend');this._oPopover.attachAfterClose($.proxy(function(){this._hideLegend();this._isShown=false;},this));this._oPopover.attachBeforeOpen($.proxy(function(){var s=document.createElementNS("http://www.w3.org/2000/svg","svg");var o={};$.extend(true,o,{legendGroup:{renderTo:function(){return s;}}},(this._defaultChartOption?this._defaultChartOption:b()));this._vizProxy().setProperties(o);var e=parseInt($(s).attr('height'),10)+5+f(0.5625),g=this._vizProxy().getSize().height*0.8-48-f(0.4375),h=f(1.625);this._oLegendDOM.setContent($(s).outerHTML());if(e>g){if(g<h){this._oPopover.setContentHeight(h+'px');}else{this._oPopover.setContentHeight(g+'px');}}else{this._oPopover.setContentHeight(null);}},this));};D.prototype._open=function(o){this._oPopover.openBy(o);};D.prototype._onDisconnect=function(){D.superclass._onDisconnect.apply(this,arguments);};D.prototype.destroy=function(){D.superclass.destroy.apply(this,arguments);if(this._oLegendDOM){this._oLegendDOM.destroy();}if(this._oPopover){this._oPopover.destroy();}this._olegendDOMID=undefined;this._isShown=null;};D.prototype._createId=function(i){return this._uid+"-"+i;};D.prototype.show=function(){if(this._isDefaultLegend()){if(this._defaultChartOption){this._vizProxy().setProperties(this._defaultChartOption);}else{this._showLegend();}}else{if(this._openBy){this._open(this._openBy);}}this._isShown=true;};D.prototype.hide=function(){if(this._isDefaultLegend()){this._hideLegend();}else{if(this._oPopover.isOpen()){this._oPopover.close();}}this._isShown=false;};D.prototype.setOpenBy=function(o){if(!arguments.length){return this._openBy;}this._openBy=o;};D.prototype.parseDefaultLegendProperties=function(p){return p;};D.prototype.isOpen=function(){return this._oPopover.isOpen();};D.prototype._isDefaultLegend=function(){var p=this._position;return(!sap.ui.Device.system.phone)&&((p==='top'||p==='bottom')?(this._vizProxy().getSize().height>=480):(this._vizProxy().getSize().width>=600));};D.prototype._showLegend=function(){this._vizProxy().setProperties(b());};D.prototype._hideLegend=function(){this._vizProxy().setProperties(a());};var _=function(p,v){if(p&&p.legend&&p.legend.visible!==undefined){p.legend.visible=v;}if(p&&p.sizeLegend&&p.sizeLegend.visible!==undefined){p.sizeLegend.visible=v;}};var a=function(){return{legend:{visible:false},sizeLegend:{visible:false}};};var b=function(p){if(p){var r={};if(p.legend){r.legend={visible:true};}if(p.sizeLegend){r.sizeLegend={visible:true};}return r;}else{return{legend:{visible:true},sizeLegend:{visible:true}};}};var c=function(p){var r={};if(p&&p.legend&&p.legend.visible!==undefined){r.legend={visible:p.legend.visible};}if(p&&p.sizeLegend&&p.sizeLegend.visible!==undefined){r.sizeLegend={visible:p.sizeLegend.visible};}return r;};var d=function(){return parseFloat(window.getComputedStyle(document.documentElement).fontSize);};var f=function(v){return d()*v;};return D;});define('sap/viz/controls/frame/VizFrame',['jquery','sap/viz/controls/common/VizControlHost','sap/viz/controls/common/constants/CSSConst','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/EventTypeConst','sap/viz/controls/common/events/Event','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedUtils','sap/viz/controls/common/utils/ChartTypeUtil','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/filter/AbstractFilter','sap/viz/controls/common/filter/FilterHelper','sap/viz/controls/common/managers/LangManager','sap/viz/controls/frame/VizFrameConfig','sap/viz/controls/frame/VizFrameEvent','sap/viz/controls/annotation/Annotation','sap/viz/controls/annotation/AnnotationEvent','sap/viz/controls/annotationcontrol/AnnotationControl','sap/viz/controls/annotationcontrol/AnnotationControlConfig','sap/viz/controls/annotationcontrol/AnnotationControlEvent','sap/viz/controls/frame/chartEditor/ChartEditorPlugin','sap/viz/controls/chart/Chart','sap/viz/controls/contextmenu/ContextMenu','sap/viz/controls/custombutton/CustomButton','sap/viz/controls/custombutton/CustomButtonEvent','sap/viz/controls/filterbar0/FilterBar','sap/viz/controls/filterbar0/FilterBarEvent','sap/viz/controls/frame/views/FilterMenu','sap/viz/controls/frame/views/FilterMenuEvent','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/views/TitleEditor','sap/viz/controls/playcontrol/PlayControl','sap/viz/controls/playcontrol/PlayControlEvent','sap/viz/controls/runtime/RuntimeManager','sap/viz/controls/runtime/VizModel','sap/viz/controls/Version','sap/viz/controls/annotation/AnnotationConfig','sap/viz/controls/chart/ChartConfig','sap/viz/controls/filterbar0/FilterBarConfig','sap/viz/controls/contextmenu/ContextMenuConfig','sap/viz/controls/custombutton/CustomButtonConfig','sap/viz/controls/common/utils/Serialization','sap/viz/controls/dedicatedlegend/DedicatedLegend','sap/viz/controls/common/utils/InfoChartUtil','sap/viz/controls/common/services/FeedValidationService'],function($,V,C,a,E,b,F,c,d,f,O,U,A,g,L,j,k,l,m,n,o,p,q,r,s,t,u,v,x,y,z,B,T,P,D,R,G,H,I,J,K,M,N,S,Q,W,X){var Y=function Y(h,i){if(h==null){throw new Error("div param is required in constructor of VizFrame.");}Y.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.VizFrame";this._div=h;this._uiConfig=i?i:j.instance();if(this._uiConfig.enablePlayControl){try{$.sap.require('sap.ui.commons.Button');$.sap.require('sap.ui.commons.Slider');}catch(e){throw U.substitute(L.get('VIZ_COMMON_DEPENDENCY_ERROR_WITH_UI_CONFIG'),'sap.ui.commons','VizFrame','{enablePlayControl: true}');}}this._layout=null;this._filterBar=null;this._chart=null;this._chartEditorPlugin=new q(this._div,this,this._uiConfig);this._contextMenu=null;this._popupLayout=null;this._annotation=null;this._settingBtn=null;this._fullScreenBtn=null;this._titleEditor=null;this._behaviorType="RunTimeBehavior";this._playControl=null;this._legendControl=null;this._createChildren();this._addChild(this._chart,['enableMorphing','feedAnalysisObjects'],[B.CHART_CHANGED,B.CHART_CHANGING,B.VIZTYPE_CHANGED,F.FEEDS_CHANGED,B.USER_INTERACTION_COMPLETE]);if(this._filterBar){this._addChild(this._filterBar,['analysisObjectsForPicker'],[E.REQUEST_FILTER_VALUES]);}if(this._annotationControl){this._addChild(this._annotationControl,[p.ANNOTATION_SELECTED_EVENT,p.ANNOTATION_LAYOUTED_EVENT]);}this._addChild(this._annotation,[],[]);if(this._contextMenu&&U.isFunction(this._contextMenu.getEventNames)){this._addChild(this._contextMenu,[],this._contextMenu.getEventNames());}this._addChild(this._fullScreenBtn,[],[k.ENTER_FULL_SCREEN,k.EXIT_FULL_SCREEN]);};O.extend(Y,V);Y.HEADER_HEIGHT=40;Y.prototype.vizType=function(e){return this._chart.vizType.apply(this._chart,arguments);};Y.prototype.filterItems=function(e){if(arguments.length>0){this._beginUpdateProperty();if(this._filterBar){this._filterBar.filterItems(e);}this._endUpdateProperty();return this;}else{if(this._filterBar){return this._filterBar.filterItems();}return[];}};Y.prototype.clearSelectedPropertyZone=function(){this._chart.clearSelectedPropertyZone();};Y.prototype._onVizModelChanged=function(e){if(e.data.filterChanged){var h=this._vizModel().filterItems();if(!this._inUpdatingProperty()){this._chart.showLoadingIcon();}this._dispatchPropertyEvent(new k(k.FILTERS_CHANGED,this,h));}if(e.data.sliceDimensionChanged){if(!this._playControl){var i=this._uiConfig.enablePlayControl===false?false:true;if(i){this._createPlayControl();}}}};Y.prototype._commentChangedHandler=function(e){var h={commentChanged:true};this._dispatchEvent(new b(E.VIZ_DEFINITION_CHANGED,this,h));};Y.prototype._vizDefinitionChanged=function(e){this._dispatchEvent(new b(E.VIZ_DEFINITION_CHANGED,this,e.data));};Y.prototype._vizViewChanged=function(e){var h=this._uiConfig.enableTitleEditor===false?false:true;if(h){if(this._titleEditor){this._titleEditor.destroy();this._titleEditor=null;}var i=e.data.type;if(f.supportTitle(i)){this._createTitleEditor();this._titleEditor.connect(this.vizUid());}}};Y.prototype._createChart=function(){this._layout=document.createElement('div');$(this._div).append(this._layout);var h=J.instance();if(this._uiConfig.controls&&this._uiConfig.controls.chart){h=this._uiConfig.controls.chart;}h=$.extend({},h);this._chart=new r(this._layout,h);this._chart.addEventListener(E.VIZ_DEFINITION_CHANGED,this._vizDefinitionChanged,this);this._chart.addEventListener(B.SELECT_PROPERTY_ZONE,$.proxy(function(e){this._dispatchEvent(new B(B.SELECT_PROPERTY_ZONE,this,e.data));},this));this._chart.addEventListener(B.VIZ_VIEW_CHANGED,this._vizViewChanged,this);this._chart.addEventListener(B.CHART_CHANGED,this._chartChangedHandler,this);this._chart.addEventListener(B.BEHAVIOR_TYPE_CHANGED,this._behaviorTypeChangedHandler,this);this._validateSize();this.__vizModel=this._chart.chartModel();this.__vizModel.addEventListener(G.PropertiesChangedEvent,this._onVizModelChanged,this);};Y.prototype._chartChangedHandler=function(){if(this._titleEditor){this._titleEditor.init(this._isTitleTooltipVisible());}};Y.prototype._behaviorTypeChangedHandler=function(e){if(!e||!this._titleEditor){return;}var i=e.data;if(i.behaviorType==="DesignTimeBehavior"){this._behaviorType="DesignTimeBehavior";this._titleEditor._hide();}else if(i.behaviorType===null){this._behaviorType="RunTimeBehavior";this._titleEditor._show();}};Y.prototype.popupLayer=function(){return this._popupLayout;};Y.prototype._createPopupLayer=function(){this._popupLayout=document.createElement('div');this._popupLayout.id="popupLayout";$(this._div).append(this._popupLayout);};Y.prototype._createHeader=function(){if(!this._header$){this._header$=$(document.createElement('div')).appendTo(this._div);this._header$.addClass(C.FRAME_PREFIX+"header");}};Y.prototype._createFullScreenButton=function(){var e=N.instance();if(this._uiConfig.controls&&this._uiConfig.controls.fullScreenButton){e=this._uiConfig.controls.fullScreenButton;}this._fullScreenBtn=new t(this._header$,e);this._fullScreenBtn.setIcon([C.ICON_PREFIX+'expand',C.ICON_PREFIX+'button'].join(' '));this._fullScreenBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_MAXIMIZE'));this._fullScreenBtn.addEventListener(u.CLICK_CUSTOM_BUTTON,$.proxy(function(h){this._isFullScreen=!this._isFullScreen;if(this._isFullScreen){this._fullScreenBtn.setIcon([C.ICON_PREFIX+'restore',C.ICON_PREFIX+'button'].join(' '));this._fullScreenBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_RESTORE_DOWN'));this._dispatchEvent(new k(k.ENTER_FULL_SCREEN,this,this._isFullScreen));}else{this._fullScreenBtn.setIcon([C.ICON_PREFIX+'expand',C.ICON_PREFIX+'button'].join(' '));this._fullScreenBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_MAXIMIZE'));this._dispatchEvent(new k(k.EXIT_FULL_SCREEN,this,this._isFullScreen));}},this),this);};Y.prototype._createSettingButton=function(){var e=N.instance();if(this._uiConfig.controls&&this._uiConfig.controls.settingButton){e=this._uiConfig.controls.settingButton;}this._settingBtn=new t(this._header$,e);this._settingBtn.setIcon([C.ICON_PREFIX+'settings',C.ICON_PREFIX+'button'].join(' '));this._settingBtn.setTitle(L.get('VIZ_CUSTOMBUTTON_SETTINGS'));this._settingBtn.addEventListener(u.CLICK_CUSTOM_BUTTON,$.proxy(function(h){var i=34;var w={pageX:$(this._div).width(),pageY:i};this._contextMenu.create(null).show(w);},this),this);};Y.prototype._createFilterBar=function(){this._filterBarContainer$=$(document.createElement('div')).appendTo(this._header$);this._filterBarContainer$.addClass(C.FRAME_PREFIX+'header-filterbar-container');this._filterBarContainer$.addClass(C.ICON_PREFIX+'add-filter').addClass(C.ICON_PREFIX+'button');var e=K.instance();if(this._uiConfig.controls&&this._uiConfig.controls.filterBar){e=this._uiConfig.controls.filterBar;}this._filterBar=new v(this._filterBarContainer$,e);this._filterBar.addEventListener(x.HEIGHT_CHANGED,function(h){if(!this._header$){return this;}this._header$.css({'height':h.data.height});this._validateSize(true);},this);};Y.prototype._createContextMenu=function(){var h;if(this._uiConfig.controls&&this._uiConfig.controls.contextMenu){h=this._uiConfig.controls.contextMenu;}else{h=M.instance();}this._contextMenu=new s($(this._popupLayout),h);$(this._layout).bind('contextmenu',$.proxy(function(e){if(this.chart().isFake()){return false;}if(U.getPropValue(this.vizProperties(),"interaction.behaviorType")!=null||this._uiConfig.useCustomizedContextMenu===false){var i=U.getEventPosition(e);var w={pageX:i.pageX-$(this._div).offset().left,pageY:i.pageY-$(this._div).offset().top};this._contextMenu.create(null).show(w);}return false;},this));this._contextMenu.addEventListener("menuItemSelected",(function(e){if(e.data.menuItem.id==="sap.viz.controls.contextmenu.item.comment"){var i=this.vizSelection({'withDataCtx':true});this._dispatchEvent(new k(k.ADD_COMMENT,this,{context:i[0]}));}}).bind(this));if(this._uiConfig.useCustomizedContextMenu===true&&(sap&&sap.bi&&sap.bi.framework&&sap.bi.framework.getService)){this._chart.addEventListener(B.CONTEXT_MENU_TRIGGERED,function(e){var i=f.map2semanticAxis(e.data.type,this.vizType(),"forward"),w='sap.viz.controls.contextmenu.location.'+i,Z=[];var _=sap.bi.framework.getService('sap.viz.controls.aio','sap.viz.controls.contextmenu.builtIn');if(_){if(_.generator){Z=_.generator(i,this);}else if(_.menus){Z=_.menus;}if(!$.isArray(Z)){Z=[];}}var a1={},b1=this;a1['sap.viz.controls.contextmenu.custom.'+i]=true;var c1=sap.bi.framework.getService('sap.viz.controls.contextmenu','sap.viz.controls.contextmenu.custom.'+i);if(c1){var d1=[];if(c1.generator){d1=c1.generator(w,this,e.data.data);}else if(c1.menus){d1=c1.menus;}if(!$.isArray(d1)){d1=[];}d1.forEach(function(g1){function h1(g1){function i1(j1){if(!$.isArray(j1)){return;}var k1=[];j1.forEach(function(l1){if(l1!==null&&typeof l1==='string'){if(l1 in a1){return;}else{a1[l1]=true;}var m1=sap.bi.framework.getService('sap.viz.controls.contextmenu',l1);if(m1){var n1=[];if(m1.generator){n1=m1.generator(w,b1,e.data.data);}else if(m1.menus){n1=m1.menus;}if(!$.isArray(n1)){n1=[];}n1.forEach(function(g1){function o1(p1){if(p1&&p1.subMenus){p1.subMenus=i1(p1.subMenus);}return p1;}if($.isArray(g1)){g1.forEach(function(p1){p1=o1(p1);});}else{g1=o1(g1);}k1.push(g1);});}}});return k1;}if(g1&&g1.subMenus){g1.subMenus=i1(g1.subMenus);}return g1;}if($.isArray(g1)){g1.forEach(function(i1){i1=h1(i1);});}else{g1=h1(g1);}Z.push(g1);});}var e1=e.data.point;var f1={pageX:e1.x-$(this._div).offset().left,pageY:e1.y-$(this._div).offset().top};if(Z.length===0){Z=null;}this._contextMenu.create(w,Z).show(f1);},this);}};Y.prototype._createFilterMenu=function(){this._filterMenu=new y($(this._popupLayout),this._uiConfig);this._filterMenu.addEventListener(z.FILTER_CLICKED,function(e){this._filterMenu.hide();this._addFilter(false);},this);this._filterMenu.addEventListener(z.EXCLUDE_CLICKED,function(e){this._filterMenu.hide();this._addFilter(true);},this);this._chart.addEventListener(B.CHANGED_SELECTED_DATA,function(e){var h=this.vizSelection();var i=h?h.length:0;var w=i>0;var Z=i>0;this._filterMenu.show(w,Z);},this);this.vizOn("initialized.filterMenu",$.proxy(function(e){if(this._filterMenu){var h=this.vizSelection();var i=h?h.length:0;if(i>0){this._filterMenu.show(true,true);}else{this._filterMenu.hide();}}},this));};Y.prototype._createPlayControl=function(){var h=document.createElement('div');this._playControlContainer$=$(h);$(h).css({"position":"relative"});$(this._div).append(h);this._playControl=new P($(h));this._validateSize();this._playControl.addEventListener(D.SLICE_DIMENSION_CHANGED,$.proxy(function(e){this._redrawPlayControl();var i=this._playControl.sliceDimension();if(!i){this._clearDataFrame();}this._dispatchPropertyEvent(new k(k.SLICE_DIMENSION_CHANGED,this,this._playControl.sliceDimension()));},this));this._chart.addEventListener(B.RENDER_COMPLETE,function(e){this._playControl.requestNextFrame();}.bind(this));this._chart.addEventListener("DescriptionChanged",$.proxy(function(e){var i=!e.data.isDataEmpty;this._playControl.visible(i);if(i){this._redrawPlayControl();}},this));this.vizOn("initialized.playControl",$.proxy(function(e){if(f.isInfoChart(this.vizType())){this._updatePlayControlDomain();}this._validatePlayControlSize();},this));this._playControl.connect(this.vizUid());};Y.prototype._updatePlayControlDomain=function(){var e=this.vizScales();if(e){for(var h in e){if(e[h].feed===a.DATA_FRAME&&e[h].domain&&U.isArray(e[h].domain)){this.playControl().slicedData(e[h].domain);}}}};Y.prototype._redrawPlayControl=function(){if(this._playControl){var e=this._playControl.sliceDimension();this._playControl.visible(!!e);if(!e){for(var h in this._chart._scales){if(this._chart._scales[h].feed&&this._chart._scales[h].feed==="dataFrame"){this._chart._scales.splice(h,1);}}}this._validateSize();}};Y.prototype._clearDataFrame=function(){for(var e in this._chart._scales){if(this._chart._scales[e].feed&&this._chart._scales[e].feed==="dataFrame"){this._chart._scales.splice(e,1);}}};Y.prototype._validatePlayControlSize=function(){var e=this.vizFeedingZone();var h;for(var i=0;i<e.length;i++){var w=e[i];if(w.name==='plot'){h=w.bound[0];break;}}if(h&&h.length>0){var Z=h[1][0]-h[0][0];var _=h[0][0];$(this._playControlContainer$).css({"width":Z,'left':_});this._playControl.validateSize(Z);}};Y.prototype._addFilter=function(i){this._dispatchEvent(new b(B.USER_INTERACTION_COMPLETE,this,{'filterChanged':true}));if(this._filterBar){var e=this.vizSelection({'withDataCtx':true});this._vizModel().updateFilterItems(e,i,this.vizData(),this._chart.feeding());}else{var h={"isExclude":i,"feeding":W.isInfoChart(this.vizType())?null:this._chart.feeding()};this._dispatchEvent(new k(k.ADD_FILTER,this,h));}};Y.prototype._createTitleEditor=function(){var h=$(this._layout).find("."+C.CHART_PREFIX+"holder");this._titleEditorContainer$=$(document.createElement('div'));h.append(this._titleEditorContainer$);this._titleEditorContainer$.css({position:'absolute',width:'100%'});this._titleEditor=new T(this._titleEditorContainer$);this.vizOn("initialized.titleEditor",$.proxy(function(e){if(this._titleEditor&&this._behaviorType==="RunTimeBehavior"){this._titleEditor.init(this._isTitleTooltipVisible());}},this));};Y.prototype._isTitleTooltipVisible=function(){return $(this._layout).find('.v-title.viz-title-label title').length>0;};Y.prototype._createAnnotation=function(){var h=I.instance();if(this._uiConfig.controls&&this._uiConfig.controls.annotation){h=this._uiConfig.controls.annotation;}this._annotation=new l(this._div,h);this._annotation.popupLayer(this._popupLayout);if(this._contextMenu){this._contextMenu.addMenuItem("sap.viz.controls.contextmenu.item.comment",{id:"sap.viz.controls.contextmenu.item.comment",label:L.get("VIZ_CONTEXTMENU_INSERT_COMMENT")});}this.addEventListener(B.CHART_CHANGED,$.proxy(function(e){if(this._annotation){this._annotation.setChartInfo({'vizType':this._chart.vizType(),'vizData':this._chart.vizData()});var i=this._chart.size();this._annotation.validateSize(i.width,i.height);}},this));this.addEventListener(B.CHART_CHANGING,$.proxy(function(e){if(this._annotation){this._annotation.clean();}},this));this.addEventListener(F.FEEDS_CHANGED,$.proxy(function(e){if(this._annotation){this._annotation.feedsChanged();}},this));this.addEventListener(k.ADD_COMMENT,$.proxy(function(e){if(this._annotation){this._annotation.addComment(this.vizSelection({'withDataCtx':true}));}},this));this.vizOn("initialized.annotation",$.proxy(function(e){if(this._annotation){this._annotation.redraw();}},this));};Y.prototype._createAnnotationControl=function(){var e=null;if(this._uiConfig.controls&&this._uiConfig.controls.annotationControl){e=this._uiConfig.controls.annotationControl;}else{e=o.instance();}var h=$(document.createElement('div')).insertBefore(this._popupLayout);this._annotationControl=new n(h[0],e);if(this._contextMenu){this._contextMenu.addMenuItem("sap.viz.controls.contextmenu.item.comment",{id:"sap.viz.controls.contextmenu.item.comment",label:L.get("VIZ_CONTEXTMENU_INSERT_COMMENT")});}};Y.prototype._createChildren=function(){var e=this._uiConfig.enableFilterBar===false?false:true;var h=this._uiConfig.enableFullScreenButton===false?false:true;var i=this._uiConfig.enableSettingButton===false?false:true;if(e||h||i){this._createHeader();}if(e){this._createFilterBar();}if(h){this._createFullScreenButton();}if(i){this._createSettingButton();}this._createChart();if(this._uiConfig.enableResponsiveLegend===true){this._createDedicatedLegendControl();}this._createPopupLayer();var w=this._uiConfig.enableContextMenu===false?false:true;if(w){this._createContextMenu();}var Z=this._uiConfig.enableAnnotation===false?false:true;if(Z){this._createAnnotation();}if(this._uiConfig.enableAnnotationControl===true){this._createAnnotationControl();}var _=this._uiConfig.enableFilterMenu===false?false:true;if(_){this._createFilterMenu();}var a1=this._uiConfig.enableTitleEditor===false?false:true;if(a1){this._createTitleEditor();}if(this._filterBar){this._filterBar.connect(this.vizUid());}if(this._contextMenu){this._contextMenu.connect(this.vizUid());}if(this._titleEditor){this._titleEditor.connect(this.vizUid());}if(this._annotation){this._annotation.connect(this.vizUid());}if(this._annotationControl){this._annotationControl.connect(this.vizUid());}if(this._legendControl){this._legendControl.connect(this.vizUid());}};Y.prototype._validateSize=function(i){var w=$(this._div).width();var h=$(this._div).height();if(this._header$&&this._header$.css('display')!='none'&&!isNaN(this._header$.outerHeight())){if(this._filterBar&&(i!==true)){this._filterBar.validateSize();}h-=this._header$.outerHeight();}if(this._playControl&&this._playControlContainer$.css('visibility')==='visible'&&!isNaN(this._playControlContainer$.outerHeight())){h-=this._playControlContainer$.outerHeight();}$(this._layout).css({width:w+"px",height:h+"px",visibility:"visible",display:''});if(this._chart){this._chart.size({width:w,height:h});if(this._legendControl&&this._vizModel().type()){var e={};this._parseLegendProperties(e);this._chart.vizProperties(e);}}if(this._annotation){this._annotation.validateSize(w,h);}if(this._chartEditorPlugin){this._chartEditorPlugin.validateSize(w,h);}if(this._filterMenu){this._filterMenu.size({width:w});}if(this._playControl){this._validatePlayControlSize();}if(this._titleEditor){this._titleEditor.size();}};Y.prototype._chartControl=function(){return this._chart;};Y.prototype.connect=function(e){};Y.prototype.disconnect=function(){};Y.prototype.destroy=function(){if(this._contextMenu){this._contextMenu.removeAllEventListeners();this._contextMenu.destroy();this._contextMenu=null;}if(this._filterMenu){this._filterMenu.removeAllEventListeners();this._filterMenu.destroy();this._filterMenu=null;}if(this._chartEditorPlugin){this._chartEditorPlugin.destroy();this._chartEditorPlugin=null;}if(this._annotation){this._annotation.destroy();this._annotation=null;}if(this._playControl){this._playControl.destroy();this._playControl=null;}if(this._legendControl){this._legendControl.destroy();this._legendControl=null;}Y.superclass.destroy.apply(this,arguments);this._chart=null;this._filterBar=null;};Y.prototype.vizUid=function(){return this._chart.vizUid();};Y.prototype.scaleGroup=function(e,i){return this._chart.scaleGroup.apply(this._chart,arguments);};Y.prototype.vizData=function(e){return this._chart.vizData.apply(this._chart,arguments);};Y.prototype.vizCss=function(e){return this._chart.vizCss.apply(this._chart,arguments);};Y.prototype.vizProperties=function(e){if(!arguments.length){var h=this._chart.vizProperties.apply(this._chart,arguments);if(this._legendControl&&h){h.legendGroup.computedVisibility=h.legendGroup.computedVisibility||this._legendControl.isOpen();}return h;}else{if(this._legendControl){this._parseLegendProperties(e);}return this._chart.vizProperties.apply(this._chart,arguments);}};Y.prototype.vizScales=function(e){return this._chart.vizScales.apply(this._chart,arguments);};Y.prototype.vizDescription=function(){return this._chart.vizDescription.apply(this._chart,arguments);};Y.prototype.vizUpdate=function(e){var h;if(!e){return;}this._beginUpdateProperty();try{if(e.filters&&this._filterBar){var i=e.filters.value?e.filters.value:e.filters;this._filterBar.filterItems(i);}if(e.properties&&this._legendControl){this._parseLegendProperties(e.properties);}h=this._chart.vizUpdate.apply(this._chart,arguments);}catch(w){this._endUpdateProperty();throw w;}this._endUpdateProperty();return h;};Y.prototype.vizOn=function(e,h){this._chart.vizOn.apply(this._chart,arguments);return this;};Y.prototype.vizOff=function(e){this._chart.vizOff.apply(this._chart,arguments);return this;};Y.prototype.vizAction=function(e,h){this._chart.vizAction.apply(this._chart,arguments);return this;};Y.prototype.vizSelection=function(e,h){return this._chart.vizSelection.apply(this._chart,arguments);};Y.prototype.vizFeedingZone=function(){return this._chart.vizFeedingZone.apply(this._chart,arguments);};Y.prototype.vizTitle=function(e){return(e=this._chart.vizTitle.apply(this._chart,arguments));};Y.prototype.createViz=function(e){if(arguments.length>0){this._chart.reset();if(this._legendControl){e.properties=e.properties||{};this._parseLegendProperties(e.properties);}this._chart.createViz(e);return this;}};Y.prototype.changeTemplate=function(){return this._chart.changeTemplate.apply(this._chart);};Y.prototype.exportViz=function(e){return this._chart.exportViz(e);};Y.prototype.loadViz=function(e){this._chart.loadViz(e);};Y.prototype.save=function(e){var h={};h['version']=H.VERSION;h["chart"]=this._chart.save(e);if(this._filterBar){h["filterBar"]=this._filterBar.save();}if(this._contextMenu){h["contextMenu"]=this._contextMenu.save();}if(this._annotation){h["annotation"]=this._annotation.save();}if(this._titleEditor){h['titleEditor']=this._titleEditor.save();}if(this._playControl){h['playControl']=this._playControl.save(e);}return h;};Y.prototype.load=function(e){this._chart.reset();this._beginUpdateProperty();try{var h=S.migrateVizFrame(e,true);this._vizModel().restorePlayerField(null);this._redrawPlayControl();var i=h['version'];i=h["filterBar"];if(i&&this._filterBar){this._filterBar.load(i);}i=h["contextMenu"];if(i&&this._contextMenu){this._contextMenu.load(i);}i=h["chart"];if(i){this._chart.load(i);}i=h["annotation"];if(i&&this._annotation){this._annotation.load(i);}i=h["titleEditor"];if(i&&this._titleEditor){this._titleEditor.load(i);}i=h["playControl"];if(i){if(!this._playControl){var w=this._uiConfig.enablePlayControl===false?false:true;if(w){this._createPlayControl();}}if(this._playControl){this._chart._beginUpdateProperty();this._playControl.load(i);this._chart._endUpdateProperty();}}}finally{this._endUpdateProperty();}};Y.prototype.feeds=function(e){return this._chart.feeds.apply(this._chart,arguments);};Y.prototype.getChangedProperties=function(){return this._chart.getChangedProperties();};Y.prototype.getChangedScales=function(){return this._chart.getChangedScales();};Y.getDefaultIncompleteOptions=function(e){return r.getDefaultIncompleteOptions.apply(r,arguments);};Y.prototype.showMessage=function(e){if(arguments.length==1){this._chart.showMessage(e);}};Y.prototype.pauseRender=function(){this._chart.pauseRender();};Y.prototype.resumeRender=function(){this._chart.resumeRender();};Y.prototype.setTitleGeneratorFunc=function(e){this._chart.setTitleGeneratorFunc(e);};Y.prototype.vizTitleMode=function(e){if(arguments.length>0){this._chart.vizTitleMode(e);}else{return this._chart.vizTitleMode();}};Y.prototype.annotationControl=function(){return this._annotationControl;};Y.prototype.chart=function(){return this._chart;};Y.prototype.filterBar=function(){return this._filterBar;};Y.prototype.contextMenu=function(){return this._contextMenu;};Y.prototype.titleEditor=function(){return this._titleEditor;};Y.prototype.playControl=function(){return this._playControl;};Y.prototype.exportToSVGString=function(e){return this._chart.exportToSVGString(e);};Y.prototype.supportExportToSVG=function(){var e=false;if(this.vizType()){e=f.isBuildInType(this.vizType())||e;}return e;};Y.prototype.selectedPropertyZone=function(e){return this._chart.selectedPropertyZone.apply(this._chart,arguments);};Y.prototype.responsiveLegend=function(){if(this._legendControl){return this._legendControl;}};Y.prototype._createDedicatedLegendControl=function(){this._legendControl=new Q();};Y.prototype._parseLegendProperties=function(e){if(this._legendControl){return this._legendControl.parseDefaultLegendProperties(e);}};Y.prototype.getPictogramInfo=function(){return this._chart.getPictogramInfo();};Y.prototype.zoom=function(e){return this._chart.zoom.apply(this._chart,arguments);};return Y;});define('sap/viz/controls/popover/chartpopover/ShapeMarker',['jquery'],function(q){var _=function(){
/*
         * Copyright (C) 2009-2013 SAP BOBJ or an SAP affiliate company. All rights reserved
         */
q.sap.declare('sap.viz.chartpopover.ShapeMarker');sap.ui.core.Control.extend('sap.viz.chartpopover.ShapeMarker',{metadata:{properties:{'type':'string','color':'string','markerSize':'int'}},renderer:{render:function(r,C){var m=C.getMarkerSize()?C.getMarkerSize():10;var p={rx:m/2,ry:m/2,type:C.getType(),borderWidth:0};r.write('<div');r.writeClasses();r.write('>');r.write('<svg width='+m+'px height='+m+'px ');r.write('>');if(p.type){r.write("<path d = '"+C._generateShapePath(p)+"'");r.write(" fill = '"+C.getColor()+"'");r.write(" transform = 'translate("+m/2+","+m/2+")'");r.write('</path>');}r.write('</svg>');r.write('</div>');r.writeStyles();}}});sap.viz.chartpopover.ShapeMarker.prototype._generateShapePath=function(p){var a;var t=p.borderWidth/2;switch(p.type){case"circle":a="M"+(-p.rx-t)+",0 A"+(p.rx+t)+","+(p.ry+t)+" 0 1,0 "+(p.rx+t)+",0 A";a+=(p.rx+t)+","+(p.ry+t)+" 0 1,0 "+(-p.rx-t)+",0z";break;case"cross":a="M"+(-p.rx-t)+","+(-p.ry/3-t)+"H"+(-p.rx/3-t)+"V"+(-p.ry-t)+"H"+(p.rx/3+t);a+="V"+(-p.ry/3-t)+"H"+(p.rx+t)+"V"+(p.ry/3+t)+"H"+(p.rx/3+t);a+="V"+(p.ry+t)+"H"+(-p.rx/3-t)+"V"+(p.ry/3+t)+"H"+(-p.rx-t)+"Z";break;case"diamond":a="M0,"+(-p.ry-t)+"L"+(p.rx+t)+",0"+" 0,"+(p.ry+t)+" "+(-p.rx-t)+",0"+"Z";break;case"square":a="M"+(-p.rx-t)+","+(-p.ry-t)+"L"+(p.rx+t)+",";a+=(-p.ry-t)+"L"+(p.rx+t)+","+(p.ry+t)+"L"+(-p.rx-t)+","+(p.ry+t)+"Z";break;case"triangle-down":case"triangleDown":a="M0,"+(p.ry+t)+"L"+(p.rx+t)+","+-(p.ry+t)+" "+-(p.rx+t)+","+-(p.ry+t)+"Z";break;case"triangle-up":case"triangleUp":a="M0,"+-(p.ry+t)+"L"+(p.rx+t)+","+(p.ry+t)+" "+-(p.rx+t)+","+(p.ry+t)+"Z";break;case"triangle-left":case"triangleLeft":a="M"+-(p.rx+t)+",0L"+(p.rx+t)+","+(p.ry+t)+" "+(p.rx+t)+","+-(p.ry+t)+"Z";break;case"triangle-right":case"triangleRight":a="M"+(p.rx+t)+",0L"+-(p.rx+t)+","+(p.ry+t)+" "+-(p.rx+t)+","+-(p.ry+t)+"Z";break;case"intersection":a="M"+(p.rx+t)+","+(p.ry+t)+"L"+(p.rx/3+t)+",0L"+(p.rx+t)+","+-(p.ry+t)+"L";a+=(p.rx/2-t)+","+-(p.ry+t)+"L0,"+(-p.ry/3-t)+"L"+(-p.rx/2+t)+","+-(p.ry+t)+"L";a+=-(p.rx+t)+","+-(p.ry+t)+"L"+-(p.rx/3+t)+",0L"+-(p.rx+t)+","+(p.ry+t)+"L";a+=(-p.rx/2+t)+","+(p.ry+t)+"L0,"+(p.ry/3+t)+"L"+(p.rx/2-t)+","+(p.ry+t)+"Z";break;case'squareWithRadius':var r=p.rx;var b=r-3;a="M0,"+-r+"L"+-b+","+-r+"Q"+-r+","+-r+" "+-r+","+-b+"L"+-r+","+b+"Q"+-r+","+r+" "+-b+","+r;a+="L"+b+","+r+"Q"+r+","+r+" "+r+","+b+"L"+r+","+-b+"Q"+r+","+-r+" "+b+","+-r+"Z";break;}return a;};};function c(i,s){try{return new sap.viz.chartpopover.ShapeMarker(i,s);}catch(e){_();return c.apply(this,arguments);}}return{'create':c};});define('sap/viz/controls/popover/chartpopover/ContentPanel',['jquery','sap/viz/controls/popover/chartpopover/ShapeMarker','sap/viz/controls/common/managers/LangManager'],function(q,S,L){var _=function(){q.sap.declare('sap.viz.chartpopover.ContentPanel');sap.ui.core.Control.extend('sap.viz.chartpopover.ContentPanel',{metadata:{publicMethods:["setContentData"]},renderer:{render:function(r,C){r.write('<div');r.addClass("viz-controls-chartPopover-contentPanel");r.writeClasses();r.write('>');r.renderControl(C._oShapeLabel);r.renderControl(C._oPanel);r.write('</div>');}}});sap.viz.chartpopover.ContentPanel.prototype.init=function(){this._measureItemsLen=0;this._maxMeasureLableLen=15,this._maxMeasureValueLen=12;this._oShapeLabel=S.create(this._createId('vizShapeMarker'),{}).addStyleClass('viz-controls-chartPopover-dimension-marker');this._oDimLabel=new sap.m.Text(this._createId('vizDimensionLabel'),{}).addStyleClass('viz-controls-chartPopover-dimension-label');this._oForm=new sap.ui.layout.form.SimpleForm({editable:false,maxContainerCols:2,layout:"ResponsiveGridLayout",labelSpanL:6,labelSpanM:6,labelSpanS:6,emptySpanL:0,emptySpanM:0,emptySpanS:0,columnsL:2,columnsM:2,content:[]});this._oPanel=new sap.ui.layout.Grid({width:'100%',defaultSpan:"L12 M12 S12",content:[this._oDimLabel,this._oForm]}).addStyleClass('viz-controls-chartPopover-Vlt');};sap.viz.chartpopover.ContentPanel.prototype.setContentData=function(d){var v=d.val,a='',m=[];this._measureItemsLen=0;if(v){this._oForm.removeAllContent();var b=false,i;for(i=0;i<v.length;i++){if(v[i].type&&v[i].type.toLowerCase()==='measure'){if(v[i].name.length>this._maxMeasureLableLen||v[i].value.length>this._maxMeasureValueLen){b=true;break;}}}for(i=0;i<v.length;i++){if(v[i].type&&v[i].type.toLowerCase()==='dimension'){if(a===null||a===undefined){a=L.get("IDS_ISNOVALUE");}else if(a.length>0){a=a+' - '+v[i].value;}else{a=v[i].value;}}else if(v[i].type&&v[i].type.toLowerCase()==='measure'){if(b){this._oForm.setLabelSpanS(12);this._oForm.addContent(new sap.m.Text({text:v[i].name}).addStyleClass('viz-controls-chartPopover-measure-labels').addStyleClass('viz-controls-chartPopover-measure-labels-wrapper-name'));this._oForm.addContent(new sap.m.Text({text:v[i].value,textAlign:sap.ui.core.TextAlign.Start}).addStyleClass('viz-controls-chartPopover-measure-labels').addStyleClass('viz-controls-chartPopover-measure-labels-wrapper-value'));}else{this._oForm.setLabelSpanS(6);this._oForm.addContent(new sap.m.Label({text:v[i].name}).addStyleClass('viz-controls-chartPopover-measure-labels'));this._oForm.addContent(new sap.m.Text({text:v[i].value,textAlign:sap.ui.core.TextAlign.End}).addStyleClass('viz-controls-chartPopover-measure-labels'));}}}if(typeof d.color==='string'){var e=this._oDimLabel.$().css('margin-left');if(e){e=parseInt(e.substr(0,e.length-2),10);this._oShapeLabel.setMarkerSize(e);}this._oShapeLabel.setColor(d.color).setType((d.shape?d.shape:'square'));}else{this._oPanel.removeContent(this._oShapeLabel);}this._oDimLabel.setText(a);this._measureItemsLen=d.val.length;}};sap.viz.chartpopover.ContentPanel.prototype.isMultiSelected=function(){return this._measureItemsLen===0;};sap.viz.chartpopover.ContentPanel.prototype._createId=function(i){return this.getId()+"-"+i;};sap.viz.chartpopover.ContentPanel.prototype.exit=function(i){if(this._oForm){this._oForm.destroy();this._oForm=null;}if(this._oShapeLabel){this._oShapeLabel.destroy();this._oShapeLabel=null;}if(this._oDimLabel){this._oDimLabel.destroy();this._oDimLabel=null;}if(this._oPanel){this._oPanel.destroy();this._oPanel=null;}};};function c(i,s){try{return new sap.viz.chartpopover.ContentPanel(i,s);}catch(e){_();return c.apply(this,arguments);}}return{'create':c};});define('sap/viz/controls/popover/chartpopover/HeaderBar',['jquery'],function(q){var _=function(){q.sap.declare('sap.viz.chartpopover.HeaderBar');sap.m.Bar.extend('sap.viz.chartpopover.HeaderBar',{metadata:{properties:{'showNavButton':'boolean','title':'string'},publicMethods:[],events:{"navButtonPress":{},"closeButtonPress":{}}},renderer:{}});sap.viz.chartpopover.HeaderBar.prototype.getContentLeft=function(){if(!this._oNavButton){this._oNavButton=new sap.m.Button(this._createId("popoverNavButton"),{type:sap.m.ButtonType.Back,press:q.proxy(function(){this.fireNavButtonPress();},this)}).addStyleClass('sapUiIcon');}this._oNavButton.setVisible(this.getShowNavButton());return[this._oNavButton];};sap.viz.chartpopover.HeaderBar.prototype.getContentMiddle=function(){if(!this._oTitleLabel){this._oTitleLabel=new sap.m.Label(this._createId('popoverHeaderTitle'));}this._oTitleLabel.setText(this.getTitle());return[this._oTitleLabel];};sap.viz.chartpopover.HeaderBar.prototype.getContentRight=function(){if(!this._oCloseButton){this._oCloseButton=new sap.m.Button(this._createId("popoverCloseButton"),{icon:sap.ui.core.IconPool.getIconURI("decline"),press:q.proxy(function(){this.fireCloseButtonPress();},this)}).addStyleClass('sapUiIcon');}return[this._oCloseButton];};sap.viz.chartpopover.HeaderBar.prototype.exit=function(){if(this._oCloseButton){this._oCloseButton.destroy();this._oCloseButton=null;}if(this._oTitleLabel){this._oTitleLabel.destroy();this._oTitleLabel=null;}if(this._oNavButton){this._oNavButton.destroy();this._oNavButton=null;}};sap.viz.chartpopover.HeaderBar.prototype._createId=function(i){return this.getId()+"-"+i;};};function c(i,s){try{return new sap.viz.chartpopover.HeaderBar(i,s);}catch(e){_();return c.apply(this,arguments);}}return{'create':c};});define('sap/viz/controls/popover/chartpopover/SubActionItemsPage',['jquery'],function(q){var _=function(){q.sap.declare('sap.viz.chartpopover.SubActionItemsPage');sap.ui.core.Control.extend('sap.viz.chartpopover.SubActionItemsPage',{metadata:{properties:{items:{type:'sap.m.ListBase[]'}}},renderer:{render:function(r,C){r.write('<div');r.addClass("viz-controls-chartPopover-subActionItemsPage");r.writeClasses();r.write('>');r.renderControl(C._oList);r.write('</div>');}}});sap.viz.chartpopover.SubActionItemsPage.prototype.init=function(){this._oList=new sap.m.List({});};sap.viz.chartpopover.SubActionItemsPage.prototype.exit=function(){if(this._oList){this._oList.destroy();this._oList=null;}};sap.viz.chartpopover.SubActionItemsPage.prototype.setItems=function(a){this._oList.removeAllItems();var b;for(var i=0;i<a.length;i++){b=new sap.m.ActionListItem({text:a[i].text,press:a[i].press?a[i].press:function(){}});this._oList.addItem(b);}};sap.viz.chartpopover.SubActionItemsPage.prototype._createId=function(i){return this.getId()+"-"+i;};};function c(i,s){try{return new sap.viz.chartpopover.SubActionItemsPage(i,s);}catch(e){_();return c.apply(this,arguments);}}return{'create':c};});define('sap/viz/controls/popover/chartpopover/ChartPopover',['jquery','sap/viz/controls/popover/chartpopover/ContentPanel','sap/viz/controls/popover/chartpopover/HeaderBar','sap/viz/controls/popover/chartpopover/SubActionItemsPage'],function(q,C,H,S){var _=function(){q.sap.declare('sap.viz.chartpopover.ChartPopover');sap.ui.core.Control.extend('sap.viz.chartpopover.ChartPopover',{metadata:{properties:{'customDataControl':{type:'any'},'actionItems':{type:'object[]'},'formatString':{type:'any'}}}});sap.viz.chartpopover.ChartPopover.prototype.init=function(){this._listItemHeight=3;this._isActionItemsChanged=true;this._options=null;this._oContentPanel=C.create(this._createId('vizContentPanel'),{});this._oSelectedLabel=new sap.m.Label(this._createId('vizSelectedLabel'),{});this._oSelectedBar=new sap.m.Bar(this._createId('vizSelectedBar'),{contentMiddle:[this._oSelectedLabel]}).addStyleClass('viz-controls-chartPopover-vizSelectedBar').addStyleClass('viz-controls-chartPopover-vizSelectedBarBorder');this._oCustomHeader=H.create(this._createId('vizHeaderBar'),{title:'Current Selection',showNavButton:false,closeButtonPress:q.proxy(this.close,this),navButtonPress:q.proxy(this._navigateBack,this)});this._oPopover=new sap.m.ResponsivePopover(this._createId('vizChartPopover'),{horizontalScrolling:false,placement:sap.m.PlacementType.Horizontal,contentWidth:"18rem",customHeader:this._oCustomHeader,content:[this._oContentPanel]});this._oPopover.addStyleClass('viz-controls-chartPopover');this._oPopover.attachAfterClose(q.proxy(this._afterClose,this));this._oPopover.attachAfterOpen(q.proxy(this._afterOpen,this));this._infoDiv=null;};sap.viz.chartpopover.ChartPopover.prototype._afterOpen=function(){this._oCustomHeader._oCloseButton.focus();};sap.viz.chartpopover.ChartPopover.prototype._afterClose=function(){this._navigateBack();if(this._options&&this._options.selectedValues<1){this._oPopover.removeContent(this._oSelectedBar);}if(this._infoDiv){this._infoDiv.focus();}};sap.viz.chartpopover.ChartPopover.prototype.isOpen=function(){return this._oPopover.isOpen();};function h(n,a){if(!n||!n.getAttribute){return false;}var b=n.getAttribute('class')||"";return(' '+b+' ').indexOf(' '+a+' ')>=0;}sap.viz.chartpopover.ChartPopover.prototype.openBy=function(o,s){if(o){this._updateContent();this._updateActionItems();var t=this._updatePopoverSettings(o);var a=this._oPopover.getContent();if(a.length>0){this._oPopover.setInitialFocus(a[0].getId());}setTimeout((function(){this._oPopover.openBy(t,s);}).bind(this),0);if(!this._infoDiv){var n=o;while((n=n.parentNode)&&!h(n,"v-info")){}this._infoDiv=n;}}return this;};sap.viz.chartpopover.ChartPopover.prototype.close=function(){this._oPopover.close();return this;};sap.viz.chartpopover.ChartPopover.prototype.exit=function(){if(this._oContentPanel){this._oContentPanel.destroy();this._oContentPanel=null;}if(this._oSelectedLabel){this._oSelectedLabel.destroy();this._oSelectedLabel=null;}if(this._oCustomHeader){this._oCustomHeader.destroy();this._oCustomHeader=null;}if(this._oCustomPanel){this._oCustomPanel.destroy();this._oCustomPanel=null;}if(this._oPopover){this._oPopover.destroy();this._oPopover=null;}if(this._targetElement){this._targetElement.remove();this._targetElement=null;}this._options=null;this._infoDiv=null;};sap.viz.chartpopover.ChartPopover.prototype.setOptions=function(o){var d=this._formatData(o.data);this._options=o;this._oContentPanel.setContentData(d);if(!d.val||o.selectedValues>1){this._oSelectedLabel.setText(o.selectedValues+' values selected');this._oPopover.insertContent(this._oSelectedBar,1);if(d.val===undefined){this._oSelectedBar.removeStyleClass('viz-controls-chartPopover-vizSelectedBarBorder');}}else{this._oPopover.removeContent(this._oSelectedBar);}return this;};sap.viz.chartpopover.ChartPopover.prototype.setActionItems=function(i){this._actionItems=[];this._actionItems=q.extend(true,this._actionItems,i);this._isActionItemsChanged=true;};sap.viz.chartpopover.ChartPopover.prototype.getActionItems=function(i){return this._actionItems;};sap.viz.chartpopover.ChartPopover.prototype._updateContent=function(){var a=this.getCustomDataControl();if(a){if(this._oCustomPanel){this._oPopover.removeContent(this._oCustomPanel);}this._oCustomPanel=a(this._options);this._oPopover.removeContent(this._oContentPanel);this._oPopover.insertContent(this._oCustomPanel,0);this._oSelectedBar.addStyleClass('viz-controls-chartPopover-vizSelectedBarBorder');}else{this._oCustomPanel=null;if(this._oContentPanel.isMultiSelected()){this._oPopover.removeContent(this._oContentPanel);}else if(this._oPopover.indexOfContent(this._oContentPanel)===-1){this._oPopover.insertContent(this._oContentPanel,0);this._oSelectedBar.addStyleClass('viz-controls-chartPopover-vizSelectedBarBorder');}}return this;};sap.viz.chartpopover.ChartPopover.prototype._updateActionItems=function(){if(this._isActionItemsChanged){var a=this._actionItems;if(!this._oActionList){a=this.getActionItems();if(a&&a.length>0){this._actionItems=q.extend(true,this._actionItems,a);this._oActionList=new sap.m.List({}).addStyleClass('viz-controls-chartPopover-actionList');this._oPopover.addContent(this._oActionList);}}if(a&&a.length>0){this._oActionList.removeAllItems();var b;for(var i=0,l=a.length;i<l;i++){b=a[i];if(b.type==='action'){this._oActionList.addItem(new sap.m.ActionListItem({text:b.text,press:b.press?b.press:function(){}}));}else if(b.type==='navigation'){this._oActionList.addItem(new sap.m.StandardListItem({title:b.text,type:'Navigation',press:q.proxy(function(e){var d=this._oActionList.indexOfItem(e.getSource());var s=this._actionItems[d].children;if(s&&s.length>0){this._oSubActionItemsPage=S.create();this._oPopover.insertContent(this._oSubActionItemsPage);this._oSubActionItemsPage.setItems(s);this._oCustomHeader.setTitle(this._actionItems[d].text);this._navigateTo();}},this)}));}}}else{if(this._oActionList){this._oActionList.destroy();this._oActionList=null;}}this._isActionItemsChanged=false;}};sap.viz.chartpopover.ChartPopover.prototype._navigateBack=function(){this._oPopover.removeContent(this._oSubActionItemsPage);this._oCustomHeader.setShowNavButton(false).setTitle('Current Selection');};sap.viz.chartpopover.ChartPopover.prototype._navigateTo=function(p){this._oCustomHeader.setShowNavButton(true);};sap.viz.chartpopover.ChartPopover.prototype._createId=function(i){return this.getId()+"-"+i;};sap.viz.chartpopover.ChartPopover.prototype._formatData=function(d){if(!d.val){return d;}var f=sap.viz.api.env.Format.format,a=q.extend(true,{},d),t=a.val.hasOwnProperty("timeMeasure")?a.val.timeMeasure:-1,b=this.getFormatString(),e=null,g={},p;if(typeof b==="string"){e=b;}else if(b instanceof Object){g=b;}if(t!==-1){var j=a.val.filter(function(i){return(i.type)&&(i.type.toLowerCase()==="measure");})[t];j.value=new Date(j.value);}a.val.forEach(function(v){if(v.type&&v.type.toLowerCase()==="measure"){p=g[v.id]||e;if(p){v.value=f(v.value,p);}else{v.value=f(v.value);}}});return a;};sap.viz.chartpopover.ChartPopover.prototype._updatePopoverSettings=function(t){var d=this._options.data.val;var a=t.firstChild;var b=t.getBoundingClientRect(),m;var o={x:parseInt(b.width,10),y:parseInt(b.height/2,10)};if(d!==undefined){for(var i=0,l=d.length;i<l;i++){if(d[i].type&&(d[i].type.toLowerCase()==="measure")){m=d[i].value;break;}}}this._oPopover.setPlacement(sap.m.PlacementType.Horizontal);switch(this._proxy.getType()){case'info/bar':if(d===undefined&&t.__data__&&t.__data__.measureNames){m=t.__data__[t.__data__.measureNames];}if(m<0){o.x=0;}this._oPopover.setOffsetX(o.x).setOffsetY(o.y);break;case'info/bullet':this._oPopover.setOffsetX(o.x).setOffsetY(o.y);a=t;break;case'info/column':if(d===undefined&&t.__data__&&t.__data__.measureNames){m=t.__data__[t.__data__.measureNames];}if(m<0){o.x=parseInt(b.width/2,10);o.y=parseInt(b.height,10);}else{o.x=parseInt(b.width/2,10);o.y=0;}this._oPopover.setOffsetX(o.x).setOffsetY(o.y);this._oPopover.setPlacement(sap.m.PlacementType.Vertical);break;case'info/pie':this._oPopover.setOffsetX(parseInt(o.x/2,10)).setOffsetY(o.y);break;case'info/vertical_bullet':this._oPopover.setOffsetX(parseInt(o.x/2,10)).setOffsetY(0);this._oPopover.setPlacement(sap.m.PlacementType.Vertical);a=t;break;case'info/line':case'info/bubble':case'info/time_bubble':case'info/scatter':case'info/stacked_bar':case'info/dual_stacked_bar':case'info/100_stacked_bar':case'info/100_dual_stacked_bar':this._oPopover.setPlacement(sap.m.PlacementType.Vertical);a=this._createOpenByElement(t);break;case'info/stacked_column':case'info/dual_stacked_column':case'info/100_stacked_column':case'info/100_dual_stacked_column':a=this._createOpenByElement(t);break;case'info/combination':this._oPopover.setPlacement(sap.m.PlacementType.Vertical);if(this._options.data.type&&this._options.data.type==='line'){this._oPopover.setOffsetX(undefined).setOffsetY(undefined);a=this._createOpenByElement(t);}else{if(m<0){o.x=parseInt(b.width/2,10);o.y=parseInt(b.height,10);}else{o.x=parseInt(b.width/2,10);o.y=0;}this._oPopover.setOffsetX(o.x).setOffsetY(o.y);}break;case'info/stacked_combination':case'info/dual_stacked_combination':if(this._options.data.type&&this._options.data.type==='line'){this._oPopover.setPlacement(sap.m.PlacementType.Vertical);}else{this._oPopover.setPlacement(sap.m.PlacementType.Horizontal);}a=this._createOpenByElement(t);break;case'info/horizontal_stacked_combination':case'info/dual_horizontal_stacked_combination':if(this._options.data.type&&this._options.data.type==='line'){this._oPopover.setPlacement(sap.m.PlacementType.Horizontal);}else{this._oPopover.setPlacement(sap.m.PlacementType.Vertical);}a=this._createOpenByElement(t);break;}return a;};sap.viz.chartpopover.ChartPopover.prototype._createOpenByElement=function(t){var b=t.getBoundingClientRect();if(!this._targetElement){this._targetElement=q('<div></div>').attr('class','viz-controls-chartPopover-dpMarker').attr('style','position: fixed;').css('visibility','hidden');q('body').append(this._targetElement);}this._targetElement.css('width',b.width+'px').css('height',b.height+'px').css('left',b.left).css('top',b.top);return this._targetElement[0];};sap.viz.chartpopover.ChartPopover.prototype.setProxy=function(p){this._proxy=p;};};function c(i,s){try{if(arguments.length===0){return new sap.viz.chartpopover.ChartPopover();}else if(arguments.length===1){return new sap.viz.chartpopover.ChartPopover(i);}else{return new sap.viz.chartpopover.ChartPopover(i,s);}}catch(e){_();return c.apply(this,arguments);}}return{'create':c};});define('sap/viz/controls/popover/PopOver',['jquery','sap/viz/controls/common/VizControlBase','sap/viz/controls/common/utils/OOUtil','sap/viz/controls/common/utils/Utils','sap/viz/controls/common/managers/LangManager','sap/viz/controls/popover/chartpopover/ChartPopover'],function(q,V,O,u,L,C){var P=function(o){P.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.popover.PopOver";try{q.sap.require("sap.m.Label");q.sap.require("sap.m.List");q.sap.require("sap.m.Bar");q.sap.require("sap.m.Page");q.sap.require("sap.m.ActionListItem");q.sap.require("sap.m.ResponsivePopover");q.sap.require("sap.m.StandardListItem");q.sap.require("sap.m.DisplayListItem");q.sap.require("sap.m.Panel");q.sap.require("sap.m.Button");}catch(e){throw u.substitute(L.get('VIZ_COMMON_DEPENDENCY_ERROR'),'sap.m','PopOver');}this._chartPopover=C.create(o);};O.extend(P,V);P.prototype._onConnect=function(v,m){P.superclass._onConnect.apply(this,arguments);this._vizProxy().on('showTooltip.PopOver',q.proxy(function(e){this._chartPopover.setOptions(e.data).openBy(e.data.target);},this));this._vizProxy().on('hideTooltip.PopOver',q.proxy(function(){this._chartPopover.close();},this));this._chartPopover.setProxy(this._vizProxy());};P.prototype._onDisconnect=function(){P.superclass._onDisconnect.apply(this,arguments);this._vizProxy().off('showTootip.PopOver');this._vizProxy().off('hideTooltip.PopOver');};P.prototype.destroy=function(){P.superclass.destroy.apply(this,arguments);this._vizProxy().off('showTooltip.PopOver');this._vizProxy().off('hideTooltip.PopOver');this._chartPopover.destroy();};P.prototype.setContents=function(c){this._chartPopover.setCustomDataControl(c);};P.prototype.setActionItems=function(i){this._chartPopover.setActionItems(i);};P.prototype.setSubActionItems=function(i){this._chartPopover.setSubActionItems(i);};P.prototype.setFormatString=function(v){this._chartPopover.setFormatString(v);};return P;});(function(g){var a=("sap/viz/controls/Version,sap/viz/controls/common/config/GlobalConfig,sap/viz/controls/common/constants/ChartConst,sap/viz/controls/common/constants/DatasetTypeConst,sap/viz/controls/common/constants/FilterEventConst,sap/viz/controls/common/feeds/AnalysisObject,sap/viz/controls/common/feeds/AnalyticalType,sap/viz/controls/common/feeds/FeedItem,sap/viz/controls/common/feeds/FeedItemType,sap/viz/controls/common/feeds/HierarchyLevelObject,sap/viz/controls/common/feeds/SubtotalItemType,sap/viz/controls/common/filter/DateRangeFilter,sap/viz/controls/common/filter/NumericRangeFilter,sap/viz/controls/common/filter/ValueFilter,sap/viz/controls/common/managers/DragManager,sap/viz/controls/common/utils/Serialization,sap/viz/controls/common/utils/Feeds,sap/viz/controls/common/views/menu/MenuGroup,sap/viz/controls/common/views/menu/MenuItem,sap/viz/controls/common/views/feed/FeedListEvent,sap/viz/controls/common/events/FeedEvent,sap/viz/controls/services/FakeDataService,sap/viz/controls/chart/Chart,sap/viz/controls/chart/Metadata,sap/viz/controls/chart/views/ChartEvent,sap/viz/controls/frame/VizFrame,sap/viz/controls/frame/VizFrameEvent,sap/viz/controls/playcontrol/PlayControl,sap/viz/controls/popover/PopOver,sap/viz/controls/dedicatedlegend/DedicatedLegend").split(/,\s*/);if(a[0]==="// REPLACE_"+"EXPORT_LIST_HERE")a=['sap/viz/controls/builder/VizBuilder','sap/viz/controls/chart/Chart','sap/viz/controls/chart/views/ChartEvent','sap/viz/controls/chart/Metadata','sap/viz/controls/common/config/GlobalConfig','sap/viz/controls/common/constants/ChartConst','sap/viz/controls/common/constants/DatasetTypeConst','sap/viz/controls/common/constants/FilterEventConst','sap/viz/controls/common/feeds/AnalysisObject','sap/viz/controls/common/feeds/AnalyticalType','sap/viz/controls/common/feeds/FeedItem','sap/viz/controls/common/feeds/FeedItemType','sap/viz/controls/common/feeds/HierarchyLevelObject','sap/viz/controls/common/filter/DateRangeFilter','sap/viz/controls/common/filter/NumericRangeFilter','sap/viz/controls/common/filter/ValueFilter','sap/viz/controls/common/feeds/SubtotalItemType','sap/viz/controls/common/managers/DragManager','sap/viz/controls/common/utils/Serialization','sap/viz/controls/common/utils/Feeds','sap/viz/controls/common/views/menu/MenuGroup','sap/viz/controls/common/views/menu/MenuItem','sap/viz/controls/common/views/feed/FeedListEvent','sap/viz/controls/common/events/FeedEvent','sap/viz/controls/feeding/FeedingPanel','sap/viz/controls/filterbar/FilterBar','sap/viz/controls/filterbar/FilterBarEvent','sap/viz/controls/filterbar/FilterItem','sap/viz/controls/frame/VizFrame','sap/viz/controls/frame/VizFrameEvent','sap/viz/controls/mapbuilder/MapBuilder','sap/viz/controls/playcontrol/PlayControl','sap/viz/controls/propertyeditor/PropertyEditor','sap/viz/controls/services/FakeDataService','sap/viz/controls/switchbar/SwitchBar','sap/viz/controls/popover/PopOver','sap/viz/controls/dedicatedlegend/DedicatedLegend','sap/viz/controls/Version'];var j=g.jQuery;if(j){if(jQuery.holdReady){jQuery.holdReady(true);}else{jQuery.readyWait+=1;}}require(a,function(){var b=arguments;a.forEach(function(m,i){var n=m.split("/");n.reduce(function(p,c,d){if(!p[c]){if(d<n.length-1){p[c]={};}else{p[c]=b[i];}}return p[c];},g);});if(j){if(jQuery.holdReady){jQuery.holdReady(false);}else{jQuery.ready(true);}}});try{void require(['sap/viz/controls/plugins/infochart/setup']);}catch(e){}})(this);if(window.__sap_viz_internal_requirejs_nextTick__!==undefined){if(requirejs&&requirejs.s&&requirejs.s.contexts&&requirejs.s.contexts._){requirejs.s.contexts._.nextTick=window.__sap_viz_internal_requirejs_nextTick__;}window.__sap_viz_internal_requirejs_nextTick__=undefined;}
